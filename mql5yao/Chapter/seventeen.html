<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>智能交易*姚 文档站</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/mql5yao/favicon.ico">
    <meta name="description" content="这是智能交易的文档站点。">
    <meta name="keywords" content="MQL,EA,智能交易,自动交易,量化,编程,培训">
    
    <link rel="preload" href="/mql5yao/assets/css/0.styles.c167a2d0.css" as="style"><link rel="preload" href="/mql5yao/assets/js/app.f23448f4.js" as="script"><link rel="preload" href="/mql5yao/assets/js/3.a8269cb7.js" as="script"><link rel="preload" href="/mql5yao/assets/js/12.a5634cbb.js" as="script"><link rel="prefetch" href="/mql5yao/assets/js/10.a59489eb.js"><link rel="prefetch" href="/mql5yao/assets/js/11.1fde020f.js"><link rel="prefetch" href="/mql5yao/assets/js/13.1e1b93d8.js"><link rel="prefetch" href="/mql5yao/assets/js/14.17d955a5.js"><link rel="prefetch" href="/mql5yao/assets/js/15.429599a3.js"><link rel="prefetch" href="/mql5yao/assets/js/16.bcf982ab.js"><link rel="prefetch" href="/mql5yao/assets/js/17.76fde0dd.js"><link rel="prefetch" href="/mql5yao/assets/js/18.49626d28.js"><link rel="prefetch" href="/mql5yao/assets/js/19.0f21f003.js"><link rel="prefetch" href="/mql5yao/assets/js/2.45a03fa6.js"><link rel="prefetch" href="/mql5yao/assets/js/20.18311061.js"><link rel="prefetch" href="/mql5yao/assets/js/21.63b34e06.js"><link rel="prefetch" href="/mql5yao/assets/js/22.a49527a7.js"><link rel="prefetch" href="/mql5yao/assets/js/23.2584759c.js"><link rel="prefetch" href="/mql5yao/assets/js/24.05b32517.js"><link rel="prefetch" href="/mql5yao/assets/js/25.991ff096.js"><link rel="prefetch" href="/mql5yao/assets/js/26.07e08c10.js"><link rel="prefetch" href="/mql5yao/assets/js/27.11150f9e.js"><link rel="prefetch" href="/mql5yao/assets/js/28.b5c9f3ea.js"><link rel="prefetch" href="/mql5yao/assets/js/29.a1ad142f.js"><link rel="prefetch" href="/mql5yao/assets/js/30.6da01d3d.js"><link rel="prefetch" href="/mql5yao/assets/js/31.28fa5dac.js"><link rel="prefetch" href="/mql5yao/assets/js/32.46aab1c1.js"><link rel="prefetch" href="/mql5yao/assets/js/33.f178c7a3.js"><link rel="prefetch" href="/mql5yao/assets/js/34.cd1eae3b.js"><link rel="prefetch" href="/mql5yao/assets/js/35.ee55e50b.js"><link rel="prefetch" href="/mql5yao/assets/js/36.56370362.js"><link rel="prefetch" href="/mql5yao/assets/js/37.2cc5b283.js"><link rel="prefetch" href="/mql5yao/assets/js/38.c3bba64a.js"><link rel="prefetch" href="/mql5yao/assets/js/39.86103eac.js"><link rel="prefetch" href="/mql5yao/assets/js/4.ffd96de7.js"><link rel="prefetch" href="/mql5yao/assets/js/40.0e36f079.js"><link rel="prefetch" href="/mql5yao/assets/js/41.17bccbf6.js"><link rel="prefetch" href="/mql5yao/assets/js/42.a40ca8ac.js"><link rel="prefetch" href="/mql5yao/assets/js/43.5a883397.js"><link rel="prefetch" href="/mql5yao/assets/js/44.19bdddfe.js"><link rel="prefetch" href="/mql5yao/assets/js/45.dec8257c.js"><link rel="prefetch" href="/mql5yao/assets/js/46.ed29615c.js"><link rel="prefetch" href="/mql5yao/assets/js/47.b6d07db1.js"><link rel="prefetch" href="/mql5yao/assets/js/48.d7ca24ca.js"><link rel="prefetch" href="/mql5yao/assets/js/5.47d44717.js"><link rel="prefetch" href="/mql5yao/assets/js/6.1f5c1ae1.js"><link rel="prefetch" href="/mql5yao/assets/js/7.1a679445.js"><link rel="prefetch" href="/mql5yao/assets/js/8.e80e8a9d.js"><link rel="prefetch" href="/mql5yao/assets/js/9.261aef18.js">
    <link rel="stylesheet" href="/mql5yao/assets/css/0.styles.c167a2d0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/mql5yao/" class="home-link router-link-active"><img src="/mql5yao/logo.png" alt="智能交易*姚 文档站" class="logo"> <span class="site-name can-hide">智能交易*姚 文档站</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/mql5yao/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/mql5yao/Chapter/start.html" class="nav-link">
  文档
</a></div><div class="nav-item"><a href="/mql5yao/Cutleeks/" class="nav-link">
  割韭菜XX招
</a></div><div class="nav-item"><a href="/mql5yao/support/" class="nav-link">
  支持本站
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/mql5yao/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/mql5yao/Chapter/start.html" class="nav-link">
  文档
</a></div><div class="nav-item"><a href="/mql5yao/Cutleeks/" class="nav-link">
  割韭菜XX招
</a></div><div class="nav-item"><a href="/mql5yao/support/" class="nav-link">
  支持本站
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>MQL5线上手册</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mql5yao/Chapter/start.html" class="sidebar-link">MQL5 参考</a></li><li><a href="/mql5yao/Chapter/one.html" class="sidebar-link">01 第一章 语言基础</a></li><li><a href="/mql5yao/Chapter/two.html" class="sidebar-link">02 第二章 标准常量，列举和架构</a></li><li><a href="/mql5yao/Chapter/three.html" class="sidebar-link">03 第三章 MQL5程序</a></li><li><a href="/mql5yao/Chapter/four.html" class="sidebar-link">04 第四章 预定义变量</a></li><li><a href="/mql5yao/Chapter/five.html" class="sidebar-link">05 第五章 普通函数</a></li><li><a href="/mql5yao/Chapter/six.html" class="sidebar-link">06 第六章 数组函数</a></li><li><a href="/mql5yao/Chapter/add1.html" class="sidebar-link">07 第add1章 矩阵和向量方法</a></li><li><a href="/mql5yao/Chapter/seven.html" class="sidebar-link">07 第七章 函数转换</a></li><li><a href="/mql5yao/Chapter/eight.html" class="sidebar-link">08 第八章 数学函数</a></li><li><a href="/mql5yao/Chapter/nine.html" class="sidebar-link">09 第九章 字符串函数</a></li><li><a href="/mql5yao/Chapter/ten.html" class="sidebar-link">10 第十章 日期和时间</a></li><li><a href="/mql5yao/Chapter/eleven.html" class="sidebar-link">11 第十一章 账户信息</a></li><li><a href="/mql5yao/Chapter/twelve.html" class="sidebar-link">12 第十二章 检测</a></li><li><a href="/mql5yao/Chapter/thirteen.html" class="sidebar-link">13 第十三章 事件处理</a></li><li><a href="/mql5yao/Chapter/fourteen.html" class="sidebar-link">14 第十四章 市场信息</a></li><li><a href="/mql5yao/Chapter/fifteen.html" class="sidebar-link">15 第十五章 经济日历函数</a></li><li><a href="/mql5yao/Chapter/sixteen.html" class="sidebar-link">16 第十六章 时间序列和指标访问</a></li><li><a href="/mql5yao/Chapter/seventeen.html" aria-current="page" class="active sidebar-link">17 第十七章 自定义交易品种</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/seventeen.html#_17-1-customsymbolcreate" class="sidebar-link">17.1 CustomSymbolCreate</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/seventeen.html#_17-2-customsymboldelete" class="sidebar-link">17.2 CustomSymbolDelete</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/seventeen.html#_17-3-customsymbolsetinteger" class="sidebar-link">17.3 CustomSymbolSetInteger</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/seventeen.html#_17-4-customsymbolsetdouble" class="sidebar-link">17.4 CustomSymbolSetDouble</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/seventeen.html#_17-5-customsymbolsetstring" class="sidebar-link">17.5 CustomSymbolSetString</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/seventeen.html#_17-6-customsymbolsetmarginrate" class="sidebar-link">17.6 CustomSymbolSetMarginRate</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/seventeen.html#_17-7-customsymbolsetsessionquote" class="sidebar-link">17.7 CustomSymbolSetSessionQuote</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/seventeen.html#_17-8-customsymbolsetsessiontrade" class="sidebar-link">17.8 CustomSymbolSetSessionTrade</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/seventeen.html#_17-9-customratesdelete" class="sidebar-link">17.9 CustomRatesDelete</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/seventeen.html#_17-10-customratesreplace" class="sidebar-link">17.10 CustomRatesReplace</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/seventeen.html#_17-11-customratesupdate" class="sidebar-link">17.11 CustomRatesUpdate</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/seventeen.html#_17-12-customticksadd" class="sidebar-link">17.12 CustomTicksAdd</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/seventeen.html#_17-13-customticksdelete" class="sidebar-link">17.13 CustomTicksDelete</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/seventeen.html#_17-14-customticksreplace" class="sidebar-link">17.14 CustomTicksReplace</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/seventeen.html#_17-15-custombookadd" class="sidebar-link">17.15 CustomBookAdd</a></li></ul></li><li><a href="/mql5yao/Chapter/eighteen.html" class="sidebar-link">18 第十八章 图表操作</a></li><li><a href="/mql5yao/Chapter/ninteen.html" class="sidebar-link">19 第十九章 交易函数</a></li><li><a href="/mql5yao/Chapter/twenty.html" class="sidebar-link">20 第二十章 交易信号</a></li><li><a href="/mql5yao/Chapter/twentyone.html" class="sidebar-link">21 第二十一章 网络函数</a></li><li><a href="/mql5yao/Chapter/twentytwo.html" class="sidebar-link">22 第二十二章 程序端全局变量</a></li><li><a href="/mql5yao/Chapter/twentythree.html" class="sidebar-link">23 第二十三章 文件函数</a></li><li><a href="/mql5yao/Chapter/twentyfour.html" class="sidebar-link">24 第二十四章 自定义指标</a></li><li><a href="/mql5yao/Chapter/twentyfive.html" class="sidebar-link">25 第二十五章 物件函数</a></li><li><a href="/mql5yao/Chapter/twentysix.html" class="sidebar-link">26 第二十六章 技术指标</a></li><li><a href="/mql5yao/Chapter/twentyseven.html" class="sidebar-link">27 第二十七章 处理优化结果</a></li><li><a href="/mql5yao/Chapter/twentyeight.html" class="sidebar-link">28 第二十八章 工作事件</a></li><li><a href="/mql5yao/Chapter/twentynine.html" class="sidebar-link">29 第二十九章 使用OpenCL工作</a></li><li><a href="/mql5yao/Chapter/thirty.html" class="sidebar-link">30 第三十章 使用数据库</a></li><li><a href="/mql5yao/Chapter/thirtyone.html" class="sidebar-link">31 第三十一章 使用DirectX</a></li><li><a href="/mql5yao/Chapter/thirtytwo.html" class="sidebar-link">32 第三十二章 集成</a></li><li><a href="/mql5yao/Chapter/add2.html" class="sidebar-link">32 第add2章 ONNX模型</a></li><li><a href="/mql5yao/Chapter/thirtythree.html" class="sidebar-link">33 第三十三章 标准程序库</a></li><li><a href="/mql5yao/Chapter/AppendixI.html" class="sidebar-link">34 附录一 来自MQL4</a></li><li><a href="/mql5yao/Chapter/AppendixII.html" class="sidebar-link">35 附录二 MQL5 函数列表</a></li><li><a href="/mql5yao/Chapter/AppendixIII.html" class="sidebar-link">36 附录三 MQL5常量列表</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2> 第十七章 自定义交易品种</h2> <p>此函数用于 创建 和 编辑 自定义交易品种的属性。</p> <p>当客户端连接到某个交易服务器时，用户能够处理经纪平台提供的金融工具的 时间序列。 可用的金融交易品种列表显示在 市场报价 窗口中。一组独立的函数允许接收 交易品种属性，交易时段和市场深度更新等数据。</p> <p>本部分描述的这组函数可以创建自定义交易品种。为此，用户可以使用交易服务器现有的交易品种，文本文件或外部数据源。</p> <table><thead><tr><th>函数</th> <th>操作</th></tr></thead> <tbody><tr><td>CustomSymbolCreate</td> <td>使用指定组中的指定名称创建一个自定义的交易品种</td></tr> <tr><td>CustomSymbolDelete</td> <td>删除指定名称的自定义交易品种</td></tr> <tr><td>CustomSymbolSetInteger</td> <td>为自定义交易品种设置 整型 属性值</td></tr> <tr><td>CustomSymbolSetDouble</td> <td>为自定义交易品种设置 真实型 属性值</td></tr> <tr><td>CustomSymbolSetString</td> <td>为自定义交易品种设置 字符串型 属性值</td></tr> <tr><td>CustomSymbolSetMarginRate</td> <td>按照订单类型和方向，为自定义交易品种设置预付款比率</td></tr> <tr><td>CustomSymbolSetSessionQuote</td> <td>为指定的交易品种和工作日设置报价时段的起止时间</td></tr> <tr><td>CustomSymbolSetSessionTrade</td> <td>为指定的交易品种和工作日设置交易时段的起止时间</td></tr> <tr><td>CustomRatesDelete</td> <td>删除指定时间间隔内自定义交易品种历史价格的全部K线柱图形</td></tr> <tr><td>CustomRatesReplace</td> <td>以MqlRates类型数组的数据完全替换指定时间间隔内自定义交易品种的历史价格</td></tr> <tr><td>CustomRatesUpdate</td> <td>将缺失的K线柱图形添加到自定义交易品种的历史价格中，并用MqlRates类型数组的数据替换现有数据</td></tr> <tr><td>CustomTicksAdd</td> <td>添加MqlTick类型的数组的数据到自定义交易品种的历史价格中。自定义交易品种一定要在 市场报价 窗口中选中</td></tr> <tr><td>CustomTicksDelete</td> <td>删除指定时间间隔内自定义交易品种历史价格中的全部报价</td></tr> <tr><td>CustomTicksReplace</td> <td>以MqlTick类型数组的数据完全替换指定时间间隔内的自定义交易品种的历史价格</td></tr> <tr><td>CustomBookAdd</td> <td>为自定义交易品种传递市场深度的状态</td></tr></tbody></table> <h2 id="_17-1-customsymbolcreate"><a href="#_17-1-customsymbolcreate" class="header-anchor">#</a> 17.1 CustomSymbolCreate</h2> <p>使用指定组中的指定名称创建一个自定义的交易品种</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  <span class="token function">CustomSymbolCreate</span><span class="token punctuation">(</span> 
   <span class="token keyword">const</span> string     symbol_name<span class="token punctuation">,</span>         <span class="token comment">// 自定义交易品种名称 </span>
   <span class="token keyword">const</span> string     symbol_path<span class="token operator">=</span><span class="token string">&quot;&quot;</span>       <span class="token comment">// 将要创建交易品种的组的名称 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>参数</p> <p>symbol_name</p> <p>[in] 自定义交易品种名称。它不应包含交易品种所在的组或分组。</p> <p>symbol_path</p> <p>[in] 交易品种所在的 组 名称。</p> <p>返回值</p> <p>true —— 成功，否则 —— false。若要获得错误信息，请调用GetLastError()函数。</p> <p>注意</p> <p>无论创建所在的 组 名称是什么，自定义交易品种名称都应该是独一无二的。</p> <p>交易品种 和 组 的名称只能包含拉丁字母，不可带有标点符号，空格或特殊字符（只可以包括以下符号&quot;.&quot;，&quot;_&quot;，&quot;&amp;&quot; 和 &quot;#&quot;）。不建议使用下列字符&lt;，&gt;，:，&quot;，/，|，?，*。</p> <p>相关参考</p> <p>SymbolName，SymbolSelect，CustomSymbolDelete</p> <h2 id="_17-2-customsymboldelete"><a href="#_17-2-customsymboldelete" class="header-anchor">#</a> 17.2 CustomSymbolDelete</h2> <p>删除指定名称的自定义交易品种。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  <span class="token function">CustomSymbolDelete</span><span class="token punctuation">(</span> 
   <span class="token keyword">const</span> string     symbol_name          <span class="token comment">// 自定义交易品种名称 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>参数</p> <p>symbol_name</p> <p>[in] 自定义交易品种名称。不应该与现有交易品种名称相同。</p> <p>返回值</p> <p>true —— 成功，否则 —— false。若要获得错误信息，请调用GetLastError()函数。</p> <p>注意</p> <p>不可以删除在 市场报价 窗口显示的 或 图表已打开的 自定义交易品种。</p> <p>相关参考<br>
SymbolName，SymbolSelect，CustomSymbolCreate</p> <h2 id="_17-3-customsymbolsetinteger"><a href="#_17-3-customsymbolsetinteger" class="header-anchor">#</a> 17.3 CustomSymbolSetInteger</h2> <p>为自定义交易品种设置 整型 属性值。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  <span class="token function">CustomSymbolSetInteger</span><span class="token punctuation">(</span> 
   <span class="token keyword">const</span> string              symbol_name<span class="token punctuation">,</span>      <span class="token comment">// 交易品种名称 </span>
   ENUM_SYMBOL_INFO_INTEGER  property_id<span class="token punctuation">,</span>      <span class="token comment">// 属性 ID </span>
   <span class="token keyword">long</span>                      property_value    <span class="token comment">// 属性值 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>参数</p> <p>symbol_name</p> <p>[in] 自定义交易品种名称。</p> <p>property_id</p> <p>[in] 交易品种属性ID。取值范围 是ENUM_SYMBOL_INFO_INTEGER枚举值之一。</p> <p>property_value</p> <p>[in] 包含属性值的 长整型 变量。</p> <p>返回值</p> <p>true —— 成功，否则 —— false。若要获得错误信息，请调用GetLastError()函数。</p> <p>相关参考<br>
SymbolInfoInteger</p> <h2 id="_17-4-customsymbolsetdouble"><a href="#_17-4-customsymbolsetdouble" class="header-anchor">#</a> 17.4 CustomSymbolSetDouble</h2> <p>为自定义交易品种设置 真实型 属性值。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  <span class="token function">CustomSymbolSetDouble</span><span class="token punctuation">(</span> 
   <span class="token keyword">const</span> string              symbol_name<span class="token punctuation">,</span>      <span class="token comment">// 交易品种名称 </span>
   ENUM_SYMBOL_INFO_DOUBLE   property_id<span class="token punctuation">,</span>      <span class="token comment">// 属性ID </span>
   <span class="token keyword">double</span>                    property_value    <span class="token comment">// 属性值 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>参数 symbol_name</p> <p>[in] 自定义交易品种名称。</p> <p>property_id</p> <p>[in] 交易品种属性ID。取值范围是ENUM_SYMBOL_INFO_DOUBLE枚举值之一。</p> <p>property_value</p> <p>[in] 包含属性值的 双精度类型 变量。</p> <p>返回值</p> <p>true —— 成功，否则 —— false。若要获得错误信息，请调用GetLastError()函数。</p> <p>相关参考<br>
SymbolInfoDouble</p> <h2 id="_17-5-customsymbolsetstring"><a href="#_17-5-customsymbolsetstring" class="header-anchor">#</a> 17.5 CustomSymbolSetString</h2> <p>为自定义交易品种设置 字符串类型 属性值。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  <span class="token function">CustomSymbolSetString</span><span class="token punctuation">(</span> 
   <span class="token keyword">const</span> string              symbol_name<span class="token punctuation">,</span>      <span class="token comment">// 交易品种名称 </span>
   ENUM_SYMBOL_INFO_STRING   property_id<span class="token punctuation">,</span>      <span class="token comment">// 属性 ID </span>
   string                    property_value    <span class="token comment">// 属性值 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>参数</p> <p>symbol_name</p> <p>[in] 自定义交易品种名称。</p> <p>property_id</p> <p>[in] 交易品种属性ID。取值范围是ENUM_SYMBOL_INFO_STRING枚举值之一。</p> <p>property_value</p> <p>[in] 包含属性值的 字符串类型 变量。</p> <p>返回值</p> <p>true —— 成功，否则 —— false。若要获得错误信息，请调用GetLastError()函数。</p> <p>相关参考<br>
SymbolInfoString</p> <h2 id="_17-6-customsymbolsetmarginrate"><a href="#_17-6-customsymbolsetmarginrate" class="header-anchor">#</a> 17.6 CustomSymbolSetMarginRate</h2> <p>按照订单类型和方向，为自定义交易品种设置预付款比率。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  <span class="token function">CustomSymbolSetMarginRate</span><span class="token punctuation">(</span> 
   <span class="token keyword">const</span> string       symbol_name<span class="token punctuation">,</span>              <span class="token comment">// 交易品种名称 </span>
   ENUM_ORDER_TYPE    order_type<span class="token punctuation">,</span>               <span class="token comment">// 订单类型 </span>
   <span class="token keyword">double</span>             initial_margin_rate<span class="token punctuation">,</span>      <span class="token comment">// 初始预付款比率 </span>
   <span class="token keyword">double</span>             maintenance_margin_rate   <span class="token comment">// 维持预付款比率 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>参数</p> <p>symbol_name</p> <p>[in] 自定义交易品种名称。</p> <p>order_type</p> <p>[in] 订单类型。</p> <p>initial_margin_rate</p> <p>[in] 具有初始预付款(保证金)比率的 双精度类型 变量。初始预付款(保证金)是指，在适当方向上进行1标准手交易的保证金。乘以初始预付款(保证金)比率后，我们会获得指定类型订单下单账户上保留的资金数额。</p> <p>maintenance_margin_rate</p> <p>[in] 具有维持预付款比率的 双精度类型 变量。维持预付款是指，在适当方向保持1标准手持仓的最低金额。乘以维持预付款比率后，我们会获得激活指定类型订单后账户上保留的资金数额。</p> <p>返回值</p> <p>true —— 成功，否则 —— false。若要获得错误信息，请调用GetLastError()函数。</p> <p>相关参考<br>
SymbolInfoMarginRate</p> <h2 id="_17-7-customsymbolsetsessionquote"><a href="#_17-7-customsymbolsetsessionquote" class="header-anchor">#</a> 17.7 CustomSymbolSetSessionQuote</h2> <p>为指定交易品种和工作日设置指定报价时段的起止时间。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  <span class="token function">CustomSymbolSetSessionQuote</span><span class="token punctuation">(</span> 
   <span class="token keyword">const</span> string      symbol_name<span class="token punctuation">,</span>         <span class="token comment">// 交易品种名称 </span>
   ENUM_DAY_OF_WEEK  day_of_week<span class="token punctuation">,</span>         <span class="token comment">// 工作日 </span>
   uint              session_index<span class="token punctuation">,</span>       <span class="token comment">// 时段索引 </span>
   datetime          from<span class="token punctuation">,</span>                <span class="token comment">// 开始时段 </span>
   datetime          to                   <span class="token comment">// 结束时段 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>参数</p> <p>symbol_name</p> <p>[in] 自定义交易品种名称。</p> <p>ENUM_DAY_OF_WEEK</p> <p>[in] 工作日，取值范围是ENUM_DAY_OF_WEEK枚举值之一。</p> <p>uint</p> <p>[in] 报价时段的索引编号，设置起止时间。时段索引编号从0开始。</p> <p>from</p> <p>[in] 设置开始时间，时段按照00:00的格式以秒为单位计算，忽略变量中的数据值。</p> <p>to</p> <p>[in] 设置结束时间，时段按照00:00的格式以秒为单位计算，忽略变量中的数据值。</p> <p>返回值</p> <p>true —— 成功，否则 —— false。若要获得错误信息，请调用GetLastError()函数。</p> <p>注意</p> <p>如果session_index指定的时段已经存在，那么该函数只需编辑时段的起止时间。</p> <p>如果这个时段传递的起止参数均为零(from=0 and to=0)，那么将会删除session_index对应的时段，而时段索引向下移动。</p> <p>只能按照顺序添加时段。换句话说，只有索引编号 0 时段存在时您才能添加session_index = 1。如果打破这个规则，则不会创建新时段，而函数本身也会返回 'false'。</p> <p>相关参考<br>
SymbolInfoSessionQuote，Symbol info，TimeToStruct，Date structure</p> <h2 id="_17-8-customsymbolsetsessiontrade"><a href="#_17-8-customsymbolsetsessiontrade" class="header-anchor">#</a> 17.8 CustomSymbolSetSessionTrade</h2> <p>为指定交易品种和工作日设置指定交易时段的起止时间</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  <span class="token function">CustomSymbolSetSessionTrade</span><span class="token punctuation">(</span> 
   <span class="token keyword">const</span> string      symbol_name<span class="token punctuation">,</span>         <span class="token comment">// 交易品种名称 </span>
   ENUM_DAY_OF_WEEK  day_of_week<span class="token punctuation">,</span>         <span class="token comment">// 工作日 </span>
   uint              session_index<span class="token punctuation">,</span>       <span class="token comment">// 时段索引 </span>
   datetime          from<span class="token punctuation">,</span>                <span class="token comment">// 开始时段 </span>
   datetime          to                   <span class="token comment">// 结束时段 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>参数</p> <p>symbol_name</p> <p>[in] 自定义交易品种名称。</p> <p>ENUM_DAY_OF_WEEK</p> <p>[in] 工作日，取值范围是ENUM_DAY_OF_WEEK枚举值之一。</p> <p>uint</p> <p>[in] 允许交易时段的索引编号，设置起止时间。时段索引编号从0开始。</p> <p>from</p> <p>[in] 设置开始时间，时段按照00:00的格式以秒为单位计算，忽略变量中的数据值。</p> <p>to</p> <p>[in] 设置结束时间，时段按照00:00的格式以秒为单位计算，忽略变量中的数据值。</p> <p>返回值</p> <p>true —— 成功，否则 —— false。若要获得错误信息，请调用GetLastError()函数。</p> <p>注意</p> <p>如果session_index指定的时段已经存在，那么该函数只需编辑时段的起止时间。</p> <p>如果这个时段传递的起止参数均为零(from=0 and to=0)，那么将会删除session_index对应的时段，而时段索引向下移动。</p> <p>只能按照顺序添加时段。换句话说，只有索引编号 0 时段存在时您才能添加session_index = 1。如果打破这个规则，则不会创建新时段，而函数本身也会返回 'false'。</p> <p>相关参考</p> <p>SymbolInfoSessionQuote，Symbol info，TimeToStruct，Date structure</p> <h2 id="_17-9-customratesdelete"><a href="#_17-9-customratesdelete" class="header-anchor">#</a> 17.9 CustomRatesDelete</h2> <p>删除指定时间间隔内自定义交易品种历史价格的全部K线柱图形。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">int</span>  <span class="token function">CustomRatesDelete</span><span class="token punctuation">(</span> 
   <span class="token keyword">const</span> string     symbol<span class="token punctuation">,</span>       <span class="token comment">// 交易品种名称 </span>
   datetime         from<span class="token punctuation">,</span>         <span class="token comment">// 开始日期 </span>
   datetime         to<span class="token punctuation">,</span>           <span class="token comment">// 结束日期 </span>
   <span class="token keyword">const</span> MqlRates<span class="token operator">&amp;</span>  rates<span class="token punctuation">[</span><span class="token punctuation">]</span>       <span class="token comment">// 即将用于自定义交易品种的数据数组 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>参数</p> <p>交易品种</p> <p>[in] 自定义交易品种名称。</p> <p>from</p> <p>[in] 指定删除历史价格范围内的第一根K线柱的时间。</p> <p>to</p> <p>[in] 指定删除历史价格范围内的最后一根K线柱的时间。</p> <p>rates[]</p> <p>[in] MqlRates类型历史数据数组。</p> <p>返回值</p> <p>已删除柱形图的数量， 如果发生错误，则返回 -1。</p> <p>相关参考<br>
CustomRatesReplace，CustomRatesUpdate，CopyRates</p> <h2 id="_17-10-customratesreplace"><a href="#_17-10-customratesreplace" class="header-anchor">#</a> 17.10 CustomRatesReplace</h2> <p>以MqlRates类型数组的数据完全替换指定时间间隔内自定义交易品种的历史价格</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">int</span>  <span class="token function">CustomRatesReplace</span><span class="token punctuation">(</span> 
   <span class="token keyword">const</span> string     symbol<span class="token punctuation">,</span>       <span class="token comment">// 交易品种名称 </span>
   datetime         from<span class="token punctuation">,</span>         <span class="token comment">// 开始日期 </span>
   datetime         to<span class="token punctuation">,</span>           <span class="token comment">// 结束日期 </span>
   <span class="token keyword">const</span> MqlRates<span class="token operator">&amp;</span>  rates<span class="token punctuation">[</span><span class="token punctuation">]</span>       <span class="token comment">// 即将用于自定义交易品种的数据数组 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>参数</p> <p>交易品种</p> <p>[in] 自定义交易品种名称。</p> <p>from</p> <p>[in] 指定替换历史价格范围内的第一根K线柱的时间。</p> <p>to</p> <p>[in] 指定替换历史价格范围内的最后一根K线柱的时间。</p> <p>rates[]</p> <p>[in] M1的MqlRates类型历史数据数组。</p> <p>返回值</p> <p>已更新柱形图的数量，如果发生错误，则返回 -1。</p> <p>注意</p> <p>如果来自rates []数组的K线柱超出了指定的范围，它将被忽略。如果价格历史中已经存在这样的K线柱并且在给定的时间范围内，则它将被替换。当前价格历史中超出指定范围的所有其它K线柱线保持不变。 rate []数组数据在OHLC价格方面应该是正确的，而K线柱开盘时间应该与M1时间段相对应。</p> <p>相关参考<br>
CustomRatesDelete，CustomRatesUpdate，CopyRates CustomRatesUpdate</p> <p>将缺失的K线柱图形添加到自定义交易品种的历史价格中，并用MqlRates类型数组的数据替换现有数据</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">int</span>  <span class="token function">CustomRatesUpdate</span><span class="token punctuation">(</span> 
   <span class="token keyword">const</span> string           symbol<span class="token punctuation">,</span>       <span class="token comment">//自定义交易品种名称 </span>
   <span class="token keyword">const</span> MqlRates<span class="token operator">&amp;</span>        rates<span class="token punctuation">[</span><span class="token punctuation">]</span>       <span class="token comment">// 即将用于自定义交易品种的数据数组 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>参数</p> <p>交易品种</p> <p>[in] 自定义交易品种名称。</p> <p>rates[]</p> <p>[in] M1的MqlRates类型历史数据数组。</p> <p>返回值</p> <p>已更新柱形图的数量，如果发生错误，则返回 -1。</p> <p>注意</p> <p>如果指定的时间范围内，没有rates []数组中的K线柱，则会添加该K线柱图形。如果价格历史中已经存在这样的K线柱并且在给定的时间范围内，则它将被替换。当前价格历史中超出指定范围的所有其它K线柱线保持不变。 rate []数组数据在OHLC价格方面应该是正确的，而K线柱开盘时间应该与M1时间段相对应。</p> <p>相关参考</p> <p>CustomRatesReplace，CustomRatesDelete，CopyRates</p> <h2 id="_17-11-customratesupdate"><a href="#_17-11-customratesupdate" class="header-anchor">#</a> 17.11 CustomRatesUpdate</h2> <p>将丢失的柱形图添加到自定义交易品种历史并用MqlRates类型数组数据替换现有数据。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">int</span>  <span class="token function">CustomRatesUpdate</span><span class="token punctuation">(</span>
   <span class="token keyword">const</span> string     symbol<span class="token punctuation">,</span>             <span class="token comment">//自定义交易品种名称</span>
   <span class="token keyword">const</span> MqlRates<span class="token operator">&amp;</span>  rates<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>            <span class="token comment">// 即将用于自定义交易品种的数据数组</span>
   uint             count<span class="token operator">=</span>WHOLE_ARRAY   <span class="token comment">// 即将使用的rates[]数组元素的数量</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>参数</p> <p>交易品种</p> <p>[in] 自定义交易品种名称。</p> <p>rates[]</p> <p>[in] M1的MqlRates类型历史数据数组。</p> <p>count=WHOLE_ARRAY</p> <p>[in] 即将用于更新的rates[]数组元素的数量。WHOLE_ARRAY意味着所有rates[]数组元素都应被使用。</p> <p>返回值</p> <p>已更新柱形图的数量，错误情况下为-1。</p> <p>注意</p> <p>如果当前自定义交易品种的历史中没有rates[]数组柱形图，则需要添加该柱形图。如果已存在这个柱形图，则它可被替换。当前价格历史的其他所有柱形图保持不变。有关高开低收价格应该是正确的rates[]数组数据，而开盘时间柱形图应该对应M1 时间周期。</p> <p>另见</p> <p>CustomRatesReplace，CustomRatesDelete，CopyRates</p> <h2 id="_17-12-customticksadd"><a href="#_17-12-customticksadd" class="header-anchor">#</a> 17.12 CustomTicksAdd</h2> <p>添加MqlTick类型的数组的数据到自定义交易品种的历史价格中。自定义交易品种一定要在 市场报价 窗口中选中</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">int</span>  <span class="token function">CustomTicksAdd</span><span class="token punctuation">(</span> 
   <span class="token keyword">const</span> string           symbol<span class="token punctuation">,</span>       <span class="token comment">// 交易品种名称 </span>
   <span class="token keyword">const</span> MqlTick<span class="token operator">&amp;</span>         ticks<span class="token punctuation">[</span><span class="token punctuation">]</span>       <span class="token comment">// 应该应用于自定义交易品种的报价数据数组 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>参数</p> <p>交易品种</p> <p>[in] 自定义交易品种的名称。</p> <p>ticks[]</p> <p>[in] MqlTick类型的报价数据数组按照从 最早 到 最新 的顺序排列，例如ticks[k].time_msc &lt;= ticks[n].time_msc，if k&lt;n。</p> <p>返回值</p> <p>添加报价的数量，如果发生错误，则返回 -1。</p> <p>注意</p> <p>CustomTicksAdd函数只能用于在 市场报价 窗口打开的自定义交易品种。如果没有在市场报价窗口选择交易品种，您应该使用CustomTicksReplace添加报价。</p> <p>MqlTick结构有两个关于时间值的字段：time (以秒表示的报价时间) 和 time_msc (以毫秒表示的报价时间)，从1970年1月1日开始计算。添加报价的这些字段按照以下顺序进行处理：</p> <ol><li>如果ticks[k].time_msc != 0，我们用它来填写ticks[k].time字段，例如为报价设置 ticks[k].time=ticks[k].time_msc/1000 (整除) 2. 如果ticks[k].time_msc == 0 并且 ticks[k].time != 0，那么将乘以1000来获得毫秒表示的时间，例如ticks[k].time_msc=ticks[k].time*1000 3. 如果ticks[k].time_msc==0和ticks[k].time==0，那么将调用CustomTicksApply函数时把当前交易服务器的毫秒时间写入这些字段。</li></ol> <p>如果ticks[k].bid，ticks[k].ask，ticks[k].last或ticks[k].volume的数值大于零，那么将适当的标识组合写入ticks[k].flags 字段：</p> <p>•TICK_FLAG_BID —— 报价已更改卖价(Bid)<br>
•TICK_FLAG_ASK —— 报价已更改买价(Ask)<br>
•TICK_FLAG_LAST —— 报价已更改最后交易价(last_price)<br>
•TICK_FLAG_VOLUME —— 报价已更改交易量(volume)</p> <p>如果字段的值 小于或等于 零，对应的标识将不写入ticks[k].flags字段。</p> <p>标志TICK_FLAG_BUY和TICK_FLAG_SELL不会添加到自定义符号的历史记录中。</p> <p>相关参考<br>
CustomRatesDelete，CustomRatesUpdate，CustomTicksReplace， CopyTicks，CopyTicksRange</p> <h2 id="_17-13-customticksdelete"><a href="#_17-13-customticksdelete" class="header-anchor">#</a> 17.13 CustomTicksDelete</h2> <p>删除指定时间间隔内自定义交易品种历史价格中的全部报价</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">int</span>  <span class="token function">CustomTicksDelete</span><span class="token punctuation">(</span> 
   conststring      symbol<span class="token punctuation">,</span>            <span class="token comment">// 交易品种名称 </span>
   <span class="token keyword">long</span>             from_msc<span class="token punctuation">,</span>          <span class="token comment">// 开始日期 </span>
   <span class="token keyword">long</span>             to_msc             <span class="token comment">// 结束日期 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>参数</p> <p>交易品种</p> <p>[in] 自定义交易品种名称。</p> <p>from_msc</p> <p>[in] 指定删除历史价格范围内的第一个报价时间。单位：毫秒，从1970.01.01开始计算。</p> <p>to_msc</p> <p>[in] 指定删除历史价格范围内的最后一个报价时间。单位：毫秒，从1970.01.01开始计算。</p> <p>返回值</p> <p>已删除报价的数量，如果发生错误，则返回 -1。</p> <p>相关参考<br>
CustomRatesDelete，CustomRatesUpdate，CustomTicksReplace， CopyTicks，CopyTicksRange</p> <h2 id="_17-14-customticksreplace"><a href="#_17-14-customticksreplace" class="header-anchor">#</a> 17.14 CustomTicksReplace</h2> <p>以MqlTick类型数组的数据完全替换指定时间间隔内的自定义交易品种的历史价格</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">int</span>  <span class="token function">CustomTicksReplace</span><span class="token punctuation">(</span> 
   <span class="token keyword">const</span> string     symbol<span class="token punctuation">,</span>            <span class="token comment">// 交易品种名称 </span>
   <span class="token keyword">long</span>             from_msc<span class="token punctuation">,</span>          <span class="token comment">// 开始日期 </span>
   <span class="token keyword">long</span>             to_msc<span class="token punctuation">,</span>            <span class="token comment">// 结束日期 </span>
   <span class="token keyword">const</span> MqlTick<span class="token operator">&amp;</span>   ticks<span class="token punctuation">[</span><span class="token punctuation">]</span>            <span class="token comment">// 即将用于自定义交易品种的数据数组 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>参数</p> <p>交易品种</p> <p>[in] 自定义交易品种名称。</p> <p>from_msc</p> <p>[in] 指定替换历史价格范围内的第一个报价时间。单位：毫秒，从1970.01.01开始计算。</p> <p>to_msc</p> <p>[in] 指定替换历史价格范围内的最后一个报价时间。单位：毫秒，从1970.01.01开始计算。</p> <p>ticks[]</p> <p>[in] 以升序时间顺序排列的MqlTick类型报价数据数组。</p> <p>返回值</p> <p>已更新报价的数量，如果发生错误，则返回 -1。</p> <p>注意</p> <p>由于在报价流中几个 跳价 可能通常具有相同的时间(精确的 跳价 时间存储在MqlTick结构的time_msc字段中)，因此CustomTicksReplace函数不会自动按时间排列ticks []数组元素。 因此，必须按时间升序预先排列 每次跳价 的数组。</p> <p>跳价 被连续地逐日替换，直至到达在to_msc中指定的时间 或 发生错误时停止。从指定范围的第一天开始处理，然后是第二天。一旦检测到 报价时间和升序(非下降)之间的不匹配，则 跳价 替换将在当天停止。所有之前的报价都被成功替换，而当天(在错误发生的那一天)以及指定时间间隔内的所有剩余天数则保持不变。</p> <p>如果ticks[] 数组包含任何时间的非报价数据（通常是任何时间间隔），那么使用ticks[]报价数据后，丢失数据对应的“hole”显示在自定义交易品种的历史中。换句话说，调用丢失报价的CustomTicksReplace函数等同于删除部分报价历史，就好比调用“hole”间隔的CustomTicksDelete函数。</p> <p>如果ticks []数组在任何一天(通常是任何时间间隔)都不包含任何 跳价 数据，则应用来自ticks []的跳价数据后，自定义交易品种的历史记录中会出现与缺失数据相对应的“洞(缺口)”。 换句话说，调用CustomTicksReplace时，如果缺少 跳价 ，就相当于删除了 跳价 历史记录的一部分，就好像CustomTicksDelete带有“空洞(缺口)”间隔被调用一样。</p> <p>相关参考<br>
CustomRatesDelete，CustomRatesUpdate，CustomTicksDelete，CopyTicks，CopyTicksRange</p> <h2 id="_17-15-custombookadd"><a href="#_17-15-custombookadd" class="header-anchor">#</a> 17.15 CustomBookAdd</h2> <p>为自定义交易品种传递市场深度的状态。该函数可以推广市场深度，类似于价格从交易商服务器到达。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">int</span>  <span class="token function">CustomBookAdd</span><span class="token punctuation">(</span> 
   <span class="token keyword">const</span> string        symbol<span class="token punctuation">,</span>            <span class="token comment">// 交易品种名称 </span>
   <span class="token keyword">const</span> MqlBookInfo<span class="token operator">&amp;</span>  books<span class="token punctuation">[</span><span class="token punctuation">]</span>            <span class="token comment">// 带有对市场深度元素描述的数组 </span>
   uint                count<span class="token operator">=</span>WHOLE_ARRAY  <span class="token comment">// 将要使用的元素数量 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>参数</p> <p>交易品种</p> <p>[in] 自定义交易品种名称。</p> <p>books[]</p> <p>[in] MqlBookInfo数组类型数据充分描述了市场深度状态 — 所有买卖请求。该传递的市场深度状态完全取代了过去的深度。</p> <p>count=WHOLE_ARRAY</p> <p>[in] 将要传递到函数的'books'数组元素的数量。默认使用整个数组。</p> <p>返回值</p> <p>添加报价的数量或错误情况下的-1。</p> <p>注意</p> <p>CustomBookAdd函数仅适用于市场深度所开放的自定义交易品种 — 通过平台界面或MarketBookAdd函数。</p> <p>当交易品种卖价和买价加入到市场深度时，不会更新。您应该控制最佳价格的变化，并使用CustomTicksAdd将其加入到报价中。</p> <p>检查传递数据的有效性：价格和交易量不应是负值，并且类型、价格和交易量(MqlBookInfo.volume or MqlBookInfo.volume_real)应该为每一个元素而指定。如果至少有一个市场深度元素描述错误，系统将完全丢弃传递的状态。</p> <p>MqlBookInfo.volume_real提高精确度交易量拥有高于常规MqlBookInfo.volume的优先级。如果两个值都为市场深度元素指定，那么会使用volume_real的值。</p> <p>MqlBookInfo元素在'books'数组中的顺序并不重要。当保存数据时，程序端将根据其价格进行排序。</p> <p>当保存数据时，检查接收人自定义交易品种的&quot;Book depth&quot; (SYMBOL_TICKS_BOOKDEPTH)参数。如果在传递的市场深度中，卖出请求的数量超过该值，则丢弃超出的部分。购买请求也是如此。</p> <p>'books'数组的采样填充：</p> <p><img src="/mql5yao/assets/img/depth.f9899b10.png" alt=""></p> <p>例如：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 专家初始化函数                          |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">int</span> <span class="token function">OnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 为我们将要检索数据的交易品种启用市场深度 from</span>
   <span class="token function">MarketBookAdd</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span>INIT_SUCCEEDED<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 专家去初始化函数                                                   |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">OnDeinit</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> reason<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 报价函数                                                          |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">OnTick</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   MqlTick ticks<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token function">ArrayResize</span><span class="token punctuation">(</span>ticks<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">//--- 将普通交易品种的当前价格复制到自定义交易品种 </span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">SymbolInfoTick</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ticks<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      string symbol_name<span class="token operator">=</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;.SYN&quot;</span><span class="token punctuation">;</span>
      <span class="token function">CustomTicksAdd</span><span class="token punctuation">(</span>symbol_name<span class="token punctuation">,</span>ticks<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| Book 函数                                                        |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">OnBookEvent</span><span class="token punctuation">(</span><span class="token keyword">const</span> string <span class="token operator">&amp;</span>book_symbol<span class="token punctuation">)</span>
  <span class="token punctuation">{</span> 
<span class="token comment">//--- 将普通交易品种的当前市场深度状态复制到自定义交易品种 </span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>book_symbol<span class="token operator">==</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      MqlBookInfo book_array<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">MarketBookGet</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>book_array<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
         string symbol_name<span class="token operator">=</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;.SYN&quot;</span><span class="token punctuation">;</span>
         <span class="token function">CustomBookAdd</span><span class="token punctuation">(</span>symbol_name<span class="token punctuation">,</span>book_array<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><p>另见<br>
MarketBookAdd，CustomTicksAdd， OnBookEvent</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/mql5yao/Chapter/sixteen.html" class="prev">
        16 第十六章 时间序列和指标访问
      </a></span> <span class="next"><a href="/mql5yao/Chapter/eighteen.html">
        18 第十八章 图表操作
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/mql5yao/assets/js/app.f23448f4.js" defer></script><script src="/mql5yao/assets/js/3.a8269cb7.js" defer></script><script src="/mql5yao/assets/js/12.a5634cbb.js" defer></script>
  </body>
</html>
