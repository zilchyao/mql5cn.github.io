<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>智能交易*姚 文档站</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/mql5yao/favicon.ico">
    <meta name="description" content="这是智能交易的文档站点。">
    <meta name="keywords" content="MQL,EA,智能交易,自动交易,量化,编程,培训">
    
    <link rel="preload" href="/mql5yao/assets/css/0.styles.7f3ae2a1.css" as="style"><link rel="preload" href="/mql5yao/assets/js/app.8a48e4d1.js" as="script"><link rel="preload" href="/mql5yao/assets/js/2.8ccfeae3.js" as="script"><link rel="preload" href="/mql5yao/assets/js/1.abd3212e.js" as="script"><link rel="preload" href="/mql5yao/assets/js/34.35c02b74.js" as="script"><link rel="prefetch" href="/mql5yao/assets/js/10.f43632ba.js"><link rel="prefetch" href="/mql5yao/assets/js/11.1d038644.js"><link rel="prefetch" href="/mql5yao/assets/js/12.e50722f3.js"><link rel="prefetch" href="/mql5yao/assets/js/13.bc6e6556.js"><link rel="prefetch" href="/mql5yao/assets/js/14.5cb8131f.js"><link rel="prefetch" href="/mql5yao/assets/js/15.bc368dfb.js"><link rel="prefetch" href="/mql5yao/assets/js/16.60e872ed.js"><link rel="prefetch" href="/mql5yao/assets/js/17.15a8a4c2.js"><link rel="prefetch" href="/mql5yao/assets/js/18.a3079194.js"><link rel="prefetch" href="/mql5yao/assets/js/19.2e53fae9.js"><link rel="prefetch" href="/mql5yao/assets/js/20.ff88a6ab.js"><link rel="prefetch" href="/mql5yao/assets/js/21.24994246.js"><link rel="prefetch" href="/mql5yao/assets/js/22.5048fb10.js"><link rel="prefetch" href="/mql5yao/assets/js/23.b0f62895.js"><link rel="prefetch" href="/mql5yao/assets/js/24.47212fdf.js"><link rel="prefetch" href="/mql5yao/assets/js/25.31655e4d.js"><link rel="prefetch" href="/mql5yao/assets/js/26.eaeeac1b.js"><link rel="prefetch" href="/mql5yao/assets/js/27.62ad36df.js"><link rel="prefetch" href="/mql5yao/assets/js/28.69609490.js"><link rel="prefetch" href="/mql5yao/assets/js/29.bd4055a1.js"><link rel="prefetch" href="/mql5yao/assets/js/3.0ebc6d24.js"><link rel="prefetch" href="/mql5yao/assets/js/30.f43e33e8.js"><link rel="prefetch" href="/mql5yao/assets/js/31.08aac79a.js"><link rel="prefetch" href="/mql5yao/assets/js/32.e40034cb.js"><link rel="prefetch" href="/mql5yao/assets/js/33.f14c86ef.js"><link rel="prefetch" href="/mql5yao/assets/js/35.048a5906.js"><link rel="prefetch" href="/mql5yao/assets/js/36.7be7df03.js"><link rel="prefetch" href="/mql5yao/assets/js/37.caf30399.js"><link rel="prefetch" href="/mql5yao/assets/js/38.7081ef66.js"><link rel="prefetch" href="/mql5yao/assets/js/39.8b16de3c.js"><link rel="prefetch" href="/mql5yao/assets/js/4.64cdca5a.js"><link rel="prefetch" href="/mql5yao/assets/js/40.c4bcc68d.js"><link rel="prefetch" href="/mql5yao/assets/js/41.9e814ceb.js"><link rel="prefetch" href="/mql5yao/assets/js/42.626ed300.js"><link rel="prefetch" href="/mql5yao/assets/js/43.9e56dbd2.js"><link rel="prefetch" href="/mql5yao/assets/js/44.b0aa6080.js"><link rel="prefetch" href="/mql5yao/assets/js/45.1ee1c2de.js"><link rel="prefetch" href="/mql5yao/assets/js/46.c7e60312.js"><link rel="prefetch" href="/mql5yao/assets/js/47.294d2506.js"><link rel="prefetch" href="/mql5yao/assets/js/48.9896cb6c.js"><link rel="prefetch" href="/mql5yao/assets/js/49.0b669611.js"><link rel="prefetch" href="/mql5yao/assets/js/5.6e0bc11f.js"><link rel="prefetch" href="/mql5yao/assets/js/50.d4317362.js"><link rel="prefetch" href="/mql5yao/assets/js/51.7cde1a30.js"><link rel="prefetch" href="/mql5yao/assets/js/52.593fbf2b.js"><link rel="prefetch" href="/mql5yao/assets/js/53.47314628.js"><link rel="prefetch" href="/mql5yao/assets/js/54.9177a36c.js"><link rel="prefetch" href="/mql5yao/assets/js/55.890a40de.js"><link rel="prefetch" href="/mql5yao/assets/js/56.950e221a.js"><link rel="prefetch" href="/mql5yao/assets/js/57.42541ac8.js"><link rel="prefetch" href="/mql5yao/assets/js/58.b782ed1e.js"><link rel="prefetch" href="/mql5yao/assets/js/59.0f7a8fa5.js"><link rel="prefetch" href="/mql5yao/assets/js/6.30ab1089.js"><link rel="prefetch" href="/mql5yao/assets/js/60.bb949f49.js"><link rel="prefetch" href="/mql5yao/assets/js/61.fb831bab.js"><link rel="prefetch" href="/mql5yao/assets/js/62.1d11fcd0.js"><link rel="prefetch" href="/mql5yao/assets/js/63.5e21940a.js"><link rel="prefetch" href="/mql5yao/assets/js/7.7481afc6.js"><link rel="prefetch" href="/mql5yao/assets/js/vendors~docsearch.b8e67d2d.js">
    <link rel="stylesheet" href="/mql5yao/assets/css/0.styles.7f3ae2a1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/mql5yao/" class="home-link router-link-active"><img src="/mql5yao/logo.png" alt="智能交易*姚 文档站" class="logo"> <span class="site-name can-hide">智能交易*姚 文档站</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/mql5yao/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/mql5yao/Chapter/start.html" class="nav-link">
  文档
</a></div><div class="nav-item"><a href="/mql5yao/Cutleeks/" class="nav-link">
  割韭菜XX招
</a></div><div class="nav-item"><a href="/mql5yao/support/" class="nav-link">
  支持本站
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/mql5yao/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/mql5yao/Chapter/start.html" class="nav-link">
  文档
</a></div><div class="nav-item"><a href="/mql5yao/Cutleeks/" class="nav-link">
  割韭菜XX招
</a></div><div class="nav-item"><a href="/mql5yao/support/" class="nav-link">
  支持本站
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>MQL5线上手册</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mql5yao/Chapter/start.html" class="sidebar-link">MQL5 参考</a></li><li><a href="/mql5yao/Chapter/one.html" class="sidebar-link">01 第一章 语言基础</a></li><li><a href="/mql5yao/Chapter/two.html" class="sidebar-link">02 第二章 标准常量，列举和架构</a></li><li><a href="/mql5yao/Chapter/three.html" class="sidebar-link">03 第三章 MQL5程序</a></li><li><a href="/mql5yao/Chapter/four.html" class="sidebar-link">04 第四章 预定义变量</a></li><li><a href="/mql5yao/Chapter/five.html" class="sidebar-link">05 第五章 普通函数</a></li><li><a href="/mql5yao/Chapter/six.html" class="sidebar-link">06 第六章 数组函数</a></li><li><a href="/mql5yao/Chapter/add1.html" class="sidebar-link">07 第七章 矩阵和向量方法</a></li><li><a href="/mql5yao/Chapter/seven.html" class="sidebar-link">08 第八章 函数转换</a></li><li><a href="/mql5yao/Chapter/eight.html" class="sidebar-link">09 第九章 数学函数</a></li><li><a href="/mql5yao/Chapter/nine.html" class="sidebar-link">10 第十章 字符串函数</a></li><li><a href="/mql5yao/Chapter/ten.html" class="sidebar-link">11 第十一章 日期和时间</a></li><li><a href="/mql5yao/Chapter/eleven.html" class="sidebar-link">12 第十二章 账户信息</a></li><li><a href="/mql5yao/Chapter/twelve.html" class="sidebar-link">13 第十三章 检测</a></li><li><a href="/mql5yao/Chapter/thirteen.html" class="sidebar-link">14 第十四章 事件处理</a></li><li><a href="/mql5yao/Chapter/fourteen.html" class="sidebar-link">15 第十五章 市场信息</a></li><li><a href="/mql5yao/Chapter/fifteen.html" class="sidebar-link">16 第十六章 经济日历函数</a></li><li><a href="/mql5yao/Chapter/sixteen.html" class="sidebar-link">17 第十七章 时间序列和指标访问</a></li><li><a href="/mql5yao/Chapter/seventeen.html" class="sidebar-link">18 第十八章 自定义交易品种</a></li><li><a href="/mql5yao/Chapter/eighteen.html" class="sidebar-link">19 第十九章 图表操作</a></li><li><a href="/mql5yao/Chapter/ninteen.html" class="sidebar-link">20 第二十章 交易函数</a></li><li><a href="/mql5yao/Chapter/twenty.html" class="sidebar-link">21 第廿一章 交易信号</a></li><li><a href="/mql5yao/Chapter/twentyone.html" class="sidebar-link">22 第廿二章 网络函数</a></li><li><a href="/mql5yao/Chapter/twentytwo.html" class="sidebar-link">23 第廿三章 程序端全局变量</a></li><li><a href="/mql5yao/Chapter/twentythree.html" class="sidebar-link">24 第廿四章 文件函数</a></li><li><a href="/mql5yao/Chapter/twentyfour.html" class="sidebar-link">25 第廿五章 自定义指标</a></li><li><a href="/mql5yao/Chapter/twentyfive.html" class="sidebar-link">26 第廿六章 物件函数</a></li><li><a href="/mql5yao/Chapter/twentysix.html" class="sidebar-link">27 第廿七章 技术指标</a></li><li><a href="/mql5yao/Chapter/twentyseven.html" class="sidebar-link">28 第甘八章 处理优化结果</a></li><li><a href="/mql5yao/Chapter/twentyeight.html" class="sidebar-link">29 第廿九章 工作事件</a></li><li><a href="/mql5yao/Chapter/twentynine.html" class="sidebar-link">30 第三十章 使用OpenCL工作</a></li><li><a href="/mql5yao/Chapter/thirty.html" class="sidebar-link">31 第卅一章 使用数据库</a></li><li><a href="/mql5yao/Chapter/thirtyone.html" class="sidebar-link">32 第卅二章 使用DirectX</a></li><li><a href="/mql5yao/Chapter/thirtytwo.html" aria-current="page" class="active sidebar-link">33 第卅三章 MetaTrader与Python集成的模块</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/thirtytwo.html#_32-1-metatrader与python集成的模块" class="sidebar-link">32.1 MetaTrader与Python集成的模块</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/thirtytwo.html#_32-1-1-initialize" class="sidebar-link">32.1.1 initialize</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/thirtytwo.html#_32-1-2-login" class="sidebar-link">32.1.2 login</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/thirtytwo.html#_32-1-3-shutdown" class="sidebar-link">32.1.3 shutdown</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/thirtytwo.html#_32-1-4-version" class="sidebar-link">32.1.4 version</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/thirtytwo.html#_32-1-5-last-error" class="sidebar-link">32.1.5 last_error</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/thirtytwo.html#_32-1-6-account-info" class="sidebar-link">32.1.6 account_info</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/thirtytwo.html#_32-1-7-terminal-info" class="sidebar-link">32.1.7 terminal_info</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/thirtytwo.html#_32-1-8-symbols-total" class="sidebar-link">32.1.8 symbols_total</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/thirtytwo.html#_32-1-9-symbols-get" class="sidebar-link">32.1.9  symbols_get</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/thirtytwo.html#_32-1-10-symbol-info" class="sidebar-link">32.1.10  symbol_info</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/thirtytwo.html#_32-1-11-symbol-info-tick" class="sidebar-link">32.1.11 symbolinfotick</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/thirtytwo.html#_32-1-12-symbol-select" class="sidebar-link">32.1.12  symbol_select</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/thirtytwo.html#_32-1-13-market-book-add" class="sidebar-link">32.1.13 marketbookadd</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/thirtytwo.html#_32-1-14-market-book-get" class="sidebar-link">32.1.14 marketbookget</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/thirtytwo.html#_32-1-15-market-book-release" class="sidebar-link">32.1.15 marketbookrelease</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/thirtytwo.html#_32-1-16-copy-rates-from" class="sidebar-link">32.1.16 copyratesfrom</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/thirtytwo.html#_32-1-17-copy-rates-from-pos" class="sidebar-link">32.1.17  copyratesfrom_pos</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/thirtytwo.html#_32-1-18-copy-rates-range" class="sidebar-link">32.1.18 copyratesrange</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/thirtytwo.html#_32-1-19-copy-ticks-from" class="sidebar-link">32.1.19 copyticksfrom</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/thirtytwo.html#_32-1-20-copy-ticks-range" class="sidebar-link">32.1.20  copyticksrange</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/thirtytwo.html#_32-1-21-orders-total" class="sidebar-link">32.1.21  orders_total</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/thirtytwo.html#_32-1-22-orders-get" class="sidebar-link">32.1.22  orders_get</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/thirtytwo.html#_32-1-23-order-calc-margin" class="sidebar-link">32.1.23  ordercalcmargin</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/thirtytwo.html#_32-1-24-order-calc-profit" class="sidebar-link">32.1.24  ordercalcprofit</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/thirtytwo.html#_32-1-25-order-check" class="sidebar-link">32.1.25  order_check</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/thirtytwo.html#_32-1-26-order-send" class="sidebar-link">32.1.26  order_send</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/thirtytwo.html#_32-1-27-positions-total" class="sidebar-link">32.1.27  positions_total</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/thirtytwo.html#_32-1-28-positions-get" class="sidebar-link">32.1.28  positions_get</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/thirtytwo.html#_32-1-29-history-deals-total" class="sidebar-link">32.1.29 historydealstotal</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/thirtytwo.html#_32-1-30-history-deals-get" class="sidebar-link">32.1.30  historydealsget</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/thirtytwo.html#_32-1-31-history-orders-total" class="sidebar-link">32.1.31 historyorderstotal</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/thirtytwo.html#_32-1-32-history-orders-get" class="sidebar-link">32.1.32  historyordersget</a></li></ul></li></ul></li><li><a href="/mql5yao/Chapter/add2.html" class="sidebar-link">34 第卅四章 ONNX模型</a></li><li><a href="/mql5yao/Chapter/thirtythree.html" class="sidebar-link">35 第卅五章 标准程序库</a></li><li><a href="/mql5yao/Chapter/AppendixI.html" class="sidebar-link">36 附录一 来自MQL4</a></li><li><a href="/mql5yao/Chapter/AppendixII.html" class="sidebar-link">37 附录二 MQL5 函数列表</a></li><li><a href="/mql5yao/Chapter/AppendixIII.html" class="sidebar-link">38 附录三 MQL5常量列表</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2>第三十二章 MetaTrader集成第三方程序</h2> <p>MQL5语言专门用于开发金融市场中的高性能交易应用程序，是算法交易使用的其他专门语言中无法比拟的。MQL5程序的语法和速度尽可能接近C++语言，支持OpenCL和与MS Visual Studio的集成。也可使用统计，模糊逻辑和ALGLIB程序库。MetaEditor开发环境通过&quot;smart&quot;函数导入对.NET程序库提供原生支持，消除开发特殊包装样式的需求。还可以使用第三方C++ DLL。С++源代码文件(CPP和H)可以直接从编辑器中编辑并编译成DLL。安装在用户电脑上的Microsoft Visual Studio也可作此用途。</p> <p>除了上述所有优势之外，MetaTrader 5平台还为MQL5开发人员提供了与其他受欢迎的解决方案集成的能力，来处理金融数据。它使得统计和机器学习方面的专家可以直接从MetaTrader 5接收数据，而无需开发额外的程序和适配器。</p> <p>在这部分，描述了以下MetaTrader 5集成解决方案：</p> <p>MetaTrader Python模块 – 用于Python程序的模块。</p> <p>所阐述的功能可以直接连接到MetaTrader 5程序端，并为平台中可用的任何交易品种请求所需金额和形式的价格历史。</p> <h2 id="_32-1-metatrader与python集成的模块"><a href="#_32-1-metatrader与python集成的模块" class="header-anchor">#</a> 32.1 MetaTrader与Python集成的模块</h2> <p>Python是一种用于开发脚本和应用程序的现代高水平编程语言。它包含用于机器学习、自动化处理以及数据分析和可视化的多个程序库。</p> <p>MetaTrader Python程序包是为方便快速地从MetaTrader 5程序端直接通过处理器通信获得交易所数据而设计的。通过这种方式接收的数据可以进一步用于统计计算和机器学习。</p> <p>从命令行安装程序包：</p> <p><code>pip install MetaTrader5</code></p> <p>从命令行更新程序包：</p> <p><code>pip install --upgrade MetaTrader5</code></p> <p>用于集成MetaTrader 5和Python的函数</p> <table><thead><tr><th>函数</th> <th>功能</th></tr></thead> <tbody><tr><td>initialize</td> <td>建立与MetaTrader 5程序端的连接</td></tr> <tr><td>login</td> <td>使用指定参数连接交易账户</td></tr> <tr><td>shutdown</td> <td>关闭之前建立的与MetaTrader 5程序端的连接</td></tr> <tr><td>version</td> <td>返回MetaTrader 5程序端版本</td></tr> <tr><td>last_error</td> <td>返回最后一个错误的数据</td></tr> <tr><td>account_info</td> <td>获取当前交易账户的信息</td></tr> <tr><td>terminal_Info</td> <td>获取所连接的MetaTrader 5程序端的状态和参数</td></tr> <tr><td>symbols_total</td> <td>获取MetaTrader 5程序端中所有交易品种的数量</td></tr> <tr><td>symbols_get</td> <td>获取MetaTrader 5程序端中的所有交易品种</td></tr> <tr><td>symbol_info</td> <td>获取指定交易品种的数据</td></tr> <tr><td>symbol_info_tick</td> <td>获取指定交易品种的最后报价</td></tr> <tr><td>symbol_select</td> <td>在MarketWatch（市场报价）窗口中选择一个交易品种或从该窗口移除一个交易品种</td></tr> <tr><td>market_book_add</td> <td>订阅MetaTrader 5程序端的指定交易品种的市场深度更改事件</td></tr> <tr><td>market_book_get</td> <td>从BookInfo返回一个元组，其中包含指定交易品种的市场深度条目</td></tr> <tr><td>market_book_release</td> <td>取消订阅MetaTrader 5程序端的指定交易品种的市场深度更改事件</td></tr> <tr><td>copy_rates_from</td> <td>从指定日期开始从MetaTrader 5程序端获取柱形图</td></tr> <tr><td>copy_rates_from_pos</td> <td>从指定索引开始从MetaTrader 5程序端获取柱形图</td></tr> <tr><td>copyrates_range</td> <td>从MetaTrader 5程序端获取指定日期范围内的柱形图</td></tr> <tr><td>copy_ticks_from</td> <td>从指定日期开始从MetaTrader 5程序端获取报价</td></tr> <tr><td>copy_ticks_range</td> <td>从MetaTrader 5程序端获取指定日期范围内的报价</td></tr> <tr><td>orders_total</td> <td>获取活动订单的数量</td></tr> <tr><td>orders_get</td> <td>获取可通过交易品种或单号筛选的活动订单</td></tr> <tr><td>order_calc_margin</td> <td>返回预付款（用账户货币表示）来执行指定的交易操作</td></tr> <tr><td>order_calc_profit</td> <td>返回指定交易操作的盈利（用账户货币表示）</td></tr> <tr><td>order_check</td> <td>检查是否有足够的资金执行所需的交易操作</td></tr> <tr><td>order_send</td> <td>发送请求来执行交易操作。</td></tr> <tr><td>positions_total</td> <td>获取未结持仓的数量</td></tr> <tr><td>positions_get</td> <td>获取可通过交易品种或单号筛选的未结持仓</td></tr> <tr><td>history_orders_total</td> <td>获取交易历史中指定时间间隔内的订单数量</td></tr> <tr><td>history_orders_get</td> <td>获取可通过单号或持仓筛选的交易历史中的订单</td></tr> <tr><td>history_deals_total</td> <td>获取交易历史中指定时间间隔内的交易数量</td></tr> <tr><td>history_deals_get</td> <td>获取可通过单号或持仓筛选的交易历史中的交易</td></tr></tbody></table> <p>连接Python与MetaTrader 5的示例</p> <ol><li>从https://www.python.org/downloads/windows下载最新版Python 3.8</li> <li>安装Python时，请检查“将Python 3.8添加到PATH%”，以便能够从命令行运行Python脚本。</li> <li>从命令行安装MetaTrader 5模块</li></ol> <p><code>pip install MetaTrader5</code></p> <ol start="4"><li>添加matplotlib和pandas程序包</li></ol> <p><code>pip install matplotlib pip install pandas</code></p> <ol start="5"><li>启动测试脚本</li></ol> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> pandas<span class="token punctuation">.</span>plotting <span class="token keyword">import</span> register_matplotlib_converters
register_matplotlib_converters<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">import</span> MetaTrader5 <span class="token keyword">as</span> mt5
 
<span class="token comment"># 连接到MetaTrader 5</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> mt5<span class="token punctuation">.</span>initialize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;initialize() failed&quot;</span><span class="token punctuation">)</span>
    mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 请求连接状态和参数</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>mt5<span class="token punctuation">.</span>terminal_info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 获取有关MetaTrader 5版本的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>mt5<span class="token punctuation">.</span>version<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 
<span class="token comment"># 从EURAUD请求1000个报价</span>
euraud_ticks <span class="token operator">=</span> mt5<span class="token punctuation">.</span>copy_ticks_from<span class="token punctuation">(</span><span class="token string">&quot;EURAUD&quot;</span><span class="token punctuation">,</span> datetime<span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">,</span> mt5<span class="token punctuation">.</span>COPY_TICKS_ALL<span class="token punctuation">)</span>
<span class="token comment"># 请求2019.04.01 13:00 - 2019.04.02 13:00之间的AUDUSD报价</span>
audusd_ticks <span class="token operator">=</span> mt5<span class="token punctuation">.</span>copy_ticks_range<span class="token punctuation">(</span><span class="token string">&quot;AUDUSD&quot;</span><span class="token punctuation">,</span> datetime<span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">27</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">,</span> datetime<span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mt5<span class="token punctuation">.</span>COPY_TICKS_ALL<span class="token punctuation">)</span>
 
<span class="token comment"># 通过多种方式获取不同交易品种的柱形图</span>
eurusd_rates <span class="token operator">=</span> mt5<span class="token punctuation">.</span>copy_rates_from<span class="token punctuation">(</span><span class="token string">&quot;EURUSD&quot;</span><span class="token punctuation">,</span> mt5<span class="token punctuation">.</span>TIMEFRAME_M1<span class="token punctuation">,</span> datetime<span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
eurgbp_rates <span class="token operator">=</span> mt5<span class="token punctuation">.</span>copy_rates_from_pos<span class="token punctuation">(</span><span class="token string">&quot;EURGBP&quot;</span><span class="token punctuation">,</span> mt5<span class="token punctuation">.</span>TIMEFRAME_M1<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
eurcad_rates <span class="token operator">=</span> mt5<span class="token punctuation">.</span>copy_rates_range<span class="token punctuation">(</span><span class="token string">&quot;EURCAD&quot;</span><span class="token punctuation">,</span> mt5<span class="token punctuation">.</span>TIMEFRAME_M1<span class="token punctuation">,</span> datetime<span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">27</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">,</span> datetime<span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 
<span class="token comment"># 断开与MetaTrader 5的连接</span>
mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment">#DATA</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'euraud_ticks('</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>euraud_ticks<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">')'</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> val <span class="token keyword">in</span> euraud_ticks<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token keyword">print</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
 
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'audusd_ticks('</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>audusd_ticks<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">')'</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> val <span class="token keyword">in</span> audusd_ticks<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token keyword">print</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
 
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'eurusd_rates('</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>eurusd_rates<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">')'</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> val <span class="token keyword">in</span> eurusd_rates<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token keyword">print</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
 
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'eurgbp_rates('</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>eurgbp_rates<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">')'</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> val <span class="token keyword">in</span> eurgbp_rates<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token keyword">print</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
 
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'eurcad_rates('</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>eurcad_rates<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">')'</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> val <span class="token keyword">in</span> eurcad_rates<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token keyword">print</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
 
<span class="token comment">#PLOT</span>
<span class="token comment"># 从所获得的数据创建DataFrame</span>
ticks_frame <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>euraud_ticks<span class="token punctuation">)</span>
<span class="token comment"># 将时间（以秒为单位）转换为日期时间格式</span>
ticks_frame<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span><span class="token operator">=</span>pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>ticks_frame<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> unit<span class="token operator">=</span><span class="token string">'s'</span><span class="token punctuation">)</span>
<span class="token comment"># 在图表上显示报价</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>ticks_frame<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ticks_frame<span class="token punctuation">[</span><span class="token string">'ask'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'r-'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'ask'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>ticks_frame<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ticks_frame<span class="token punctuation">[</span><span class="token string">'bid'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'b-'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'bid'</span><span class="token punctuation">)</span>
 
<span class="token comment"># 显示图例</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">'upper left'</span><span class="token punctuation">)</span>
 
<span class="token comment"># 添加标题</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'EURAUD ticks'</span><span class="token punctuation">)</span>
 
<span class="token comment"># 显示图表</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br></div></div><ol start="6"><li>获取数据和图表</li></ol> <p><img src="/mql5yao/assets/img/python_script_chart.3be14555.png" alt="python图形示例"></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[2, 'MetaQuotes-Demo', '16167573']
[500, 2325, '19 Feb 2020']
 
euraud_ticks( 1000 )
(1580209200, 1.63412, 1.63437, 0., 0, 1580209200067, 130, 0.)
(1580209200, 1.63416, 1.63437, 0., 0, 1580209200785, 130, 0.)
(1580209201, 1.63415, 1.63437, 0., 0, 1580209201980, 130, 0.)
(1580209202, 1.63419, 1.63445, 0., 0, 1580209202192, 134, 0.)
(1580209203, 1.6342, 1.63445, 0., 0, 1580209203004, 130, 0.)
(1580209203, 1.63419, 1.63445, 0., 0, 1580209203487, 130, 0.)
(1580209203, 1.6342, 1.63445, 0., 0, 1580209203694, 130, 0.)
(1580209203, 1.63419, 1.63445, 0., 0, 1580209203990, 130, 0.)
(1580209204, 1.63421, 1.63445, 0., 0, 1580209204194, 130, 0.)
(1580209204, 1.63425, 1.63445, 0., 0, 1580209204392, 130, 0.)
audusd_ticks( 40449 )
(1580122800, 0.67858, 0.67868, 0., 0, 1580122800244, 130, 0.)
(1580122800, 0.67858, 0.67867, 0., 0, 1580122800429, 4, 0.)
(1580122800, 0.67858, 0.67865, 0., 0, 1580122800817, 4, 0.)
(1580122801, 0.67858, 0.67866, 0., 0, 1580122801618, 4, 0.)
(1580122802, 0.67858, 0.67865, 0., 0, 1580122802928, 4, 0.)
(1580122809, 0.67855, 0.67865, 0., 0, 1580122809526, 130, 0.)
(1580122809, 0.67855, 0.67864, 0., 0, 1580122809699, 4, 0.)
(1580122813, 0.67855, 0.67863, 0., 0, 1580122813576, 4, 0.)
(1580122815, 0.67856, 0.67863, 0., 0, 1580122815190, 130, 0.)
(1580122815, 0.67855, 0.67863, 0., 0, 1580122815479, 130, 0.)
eurusd_rates( 1000 )
(1580149260, 1.10132, 1.10151, 1.10131, 1.10149, 44, 1, 0)
(1580149320, 1.10149, 1.10161, 1.10143, 1.10154, 42, 1, 0)
(1580149380, 1.10154, 1.10176, 1.10154, 1.10174, 40, 2, 0)
(1580149440, 1.10174, 1.10189, 1.10168, 1.10187, 47, 1, 0)
(1580149500, 1.10185, 1.10191, 1.1018, 1.10182, 53, 1, 0)
(1580149560, 1.10182, 1.10184, 1.10176, 1.10183, 25, 3, 0)
(1580149620, 1.10183, 1.10187, 1.10177, 1.10187, 49, 2, 0)
(1580149680, 1.10187, 1.1019, 1.1018, 1.10187, 53, 1, 0)
(1580149740, 1.10187, 1.10202, 1.10187, 1.10198, 28, 2, 0)
(1580149800, 1.10198, 1.10198, 1.10183, 1.10188, 39, 2, 0)
eurgbp_rates( 1000 )
(1582236360, 0.83767, 0.83767, 0.83764, 0.83765, 23, 9, 0)
(1582236420, 0.83765, 0.83765, 0.83764, 0.83765, 15, 8, 0)
(1582236480, 0.83765, 0.83766, 0.83762, 0.83765, 19, 7, 0)
(1582236540, 0.83765, 0.83768, 0.83758, 0.83763, 39, 6, 0)
(1582236600, 0.83763, 0.83768, 0.83763, 0.83767, 21, 6, 0)
(1582236660, 0.83767, 0.83775, 0.83765, 0.83769, 63, 5, 0)
(1582236720, 0.83769, 0.8377, 0.83758, 0.83764, 40, 7, 0)
(1582236780, 0.83766, 0.83769, 0.8376, 0.83766, 37, 6, 0)
(1582236840, 0.83766, 0.83772, 0.83763, 0.83772, 22, 6, 0)
(1582236900, 0.83772, 0.83773, 0.83768, 0.8377, 36, 5, 0)
eurcad_rates( 1441 )
(1580122800, 1.45321, 1.45329, 1.4526, 1.4528, 146, 15, 0)
(1580122860, 1.4528, 1.45315, 1.45274, 1.45301, 93, 15, 0)
(1580122920, 1.453, 1.45304, 1.45264, 1.45264, 82, 15, 0)
(1580122980, 1.45263, 1.45279, 1.45231, 1.45277, 109, 15, 0)
(1580123040, 1.45275, 1.4528, 1.45259, 1.45271, 53, 14, 0)
(1580123100, 1.45273, 1.45285, 1.45269, 1.4528, 62, 16, 0)
(1580123160, 1.4528, 1.45284, 1.45267, 1.45282, 64, 14, 0)
(1580123220, 1.45282, 1.45299, 1.45261, 1.45272, 48, 14, 0)
(1580123280, 1.45272, 1.45275, 1.45255, 1.45275, 74, 14, 0)
(1580123340, 1.45275, 1.4528, 1.4526, 1.4528, 94, 13, 0)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br></div></div><h3 id="_32-1-1-initialize"><a href="#_32-1-1-initialize" class="header-anchor">#</a> 32.1.1 initialize</h3> <p>建立与MetaTrader 5程序端的连接。共有三个调用选项。</p> <p>无参数调用。自动找到程序端连接。</p> <p><code>initialize()</code></p> <p>调用指定要连接到MetaTrader 5程序端的路径。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>initialize(
   path                      // 到MetaTrader 5程序端EXE文件的路径
   )
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>调用指定交易账户路径和参数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>initialize(
   path                      // 到MetaTrader 5程序端EXE文件的路径
   timeout=TIMEOUT,          // 超时
   login=LOGIN,              // 账号
   password=&quot;PASSWORD&quot;,      // 密码
   server=&quot;SERVER&quot;           // 在程序端指定的服务器名称
   )
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>参数</p> <p>path</p> <p>[in]  metatrader.exe或metatrader64.exe文件的路径。可选的未命名参数。首先显示，没有参数名称。如果没有指定此路径，模块会尝试自己查找可执行文件。</p> <p>timeout=TIMEOUT</p> <p>[in]  连接超时，以毫秒计算。可选的命名参数。如果没有指定，则应用60 000（60秒）的值。如果没有在指定时间内建立连接，则调用强制终止并生成异常。</p> <p>login=LOGIN</p> <p>[in]  交易账号。可选的命名参数。如果没有指定，则使用最后一个交易账户。</p> <p>password=&quot;PASSWORD&quot;</p> <p>[in]  交易账号密码。可选的命名参数。如果没有设置密码，则自动应用在程序端数据库中保存的密码。</p> <p>server=&quot;SERVER&quot;</p> <p>[in]  交易服务器名称。可选的命名参数。如果没有设置服务器，则自动应用最后使用的服务器。</p> <p>返回值</p> <p>成功连接MetaTrader 5程序端，返回True，否则，返回False。</p> <p>注意</p> <p>如果有需要，当执行initialize()调用时，启动MetaTrader 5程序端建立连接。</p> <p>例如：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> MetaTrader5 <span class="token keyword">as</span> mt5
<span class="token comment"># 显示有关MetaTrader 5程序包的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package author: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__author__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package version: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
 
<span class="token comment"># 建立MetaTrader 5到指定交易账户的连接</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> mt5<span class="token punctuation">.</span>initialize<span class="token punctuation">(</span>login<span class="token operator">=</span><span class="token number">25115284</span><span class="token punctuation">,</span> server<span class="token operator">=</span><span class="token string">&quot;MetaQuotes-Demo&quot;</span><span class="token punctuation">,</span>password<span class="token operator">=</span><span class="token string">&quot;4zatlbqx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;initialize() failed, error code =&quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 显示有关连接状态、服务器名称和交易账户的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>mt5<span class="token punctuation">.</span>terminal_info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 显示有关MetaTrader 5版本的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>mt5<span class="token punctuation">.</span>version<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 
<span class="token comment"># 断开与MetaTrader 5程序端的连接</span>
mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>另见</p> <p>shutdown、terminal_info、version</p> <h3 id="_32-1-2-login"><a href="#_32-1-2-login" class="header-anchor">#</a> 32.1.2 login</h3> <p>使用指定参数连接交易账户。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>login(
   login,                    // 账号
   password=&quot;PASSWORD&quot;,      // 密码
   server=&quot;SERVER&quot;,          // 在程序端指定的服务器名称
   timeout=TIMEOUT           // 超时
   )
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>参数</p> <p>login</p> <p>[in]  交易账号。所需的未命名参数。</p> <p>password</p> <p>[in]  交易账号密码。可选的命名参数。如果没有设置密码，则自动应用在程序端数据库中保存的密码。</p> <p>server</p> <p>[in]  交易服务器名称。可选的命名参数。如果没有设置服务器，则自动应用最后使用的服务器。</p> <p>timeout=TIMEOUT</p> <p>[in]  连接超时，以毫秒计算。可选的命名参数。如果没有指定，则应用60 000（60秒）的值。如果没有在指定时间内建立连接，则调用强制终止并生成异常。</p> <p>返回值</p> <p>成功连接交易账户，返回True，否则，返回False。</p> <p>例如：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> MetaTrader5 <span class="token keyword">as</span> mt5
<span class="token comment"># 显示有关MetaTrader 5程序包的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package author: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__author__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package version: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
 
<span class="token comment"># 建立与MetaTrader 5程序端的连接</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> mt5<span class="token punctuation">.</span>initialize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;initialize() failed, error code =&quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 显示有关MetaTrader 5版本的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>mt5<span class="token punctuation">.</span>version<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 连接到指定密码和服务器的交易账户</span>
account<span class="token operator">=</span><span class="token number">17221085</span>
authorized<span class="token operator">=</span>mt5<span class="token punctuation">.</span>login<span class="token punctuation">(</span>account<span class="token punctuation">)</span>  <span class="token comment"># the terminal database password is applied if connection data is set to be remembered</span>
<span class="token keyword">if</span> authorized<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;connected to account #{}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>account<span class="token punctuation">)</span><span class="token punctuation">)</span>
其他：
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;failed to connect at account #{}, error code: {}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>account<span class="token punctuation">,</span> mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 
<span class="token comment"># 现在连接到指定密码的另一个交易账户</span>
account<span class="token operator">=</span><span class="token number">25115284</span>
authorized<span class="token operator">=</span>mt5<span class="token punctuation">.</span>login<span class="token punctuation">(</span>account<span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">&quot;gqrtz0lbdm&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> authorized<span class="token punctuation">:</span>
    <span class="token comment"># display trading account data 'as is'</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>mt5<span class="token punctuation">.</span>account_info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># display trading account data in the form of a list</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Show account_info()._asdict():&quot;</span><span class="token punctuation">)</span>
    account_info_dict <span class="token operator">=</span> mt5<span class="token punctuation">.</span>account_info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>_asdict<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> prop <span class="token keyword">in</span> account_info_dict<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;  {}={}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>prop<span class="token punctuation">,</span> account_info_dict<span class="token punctuation">[</span>prop<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
其他：
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;failed to connect at account #{}, error code: {}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>account<span class="token punctuation">,</span> mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 
<span class="token comment"># 断开与MetaTrader 5程序端的连接</span>
mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
 
Result<span class="token punctuation">:</span>
MetaTrader5程序包作者：MetaQuotes Software Corp<span class="token punctuation">.</span>
MetaTrader5程序包版本：<span class="token number">5.0</span><span class="token number">.29</span>
<span class="token punctuation">[</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">2367</span><span class="token punctuation">,</span> <span class="token string">'23 Mar 2020'</span><span class="token punctuation">]</span>
 
connected to account <span class="token comment">#17221085</span>
 
connected to account <span class="token comment">#25115284</span>
AccountInfo<span class="token punctuation">(</span>login<span class="token operator">=</span><span class="token number">25115284</span><span class="token punctuation">,</span> trade_mode<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> leverage<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> limit_orders<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">,</span> margin_so_mode<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
account properties<span class="token punctuation">:</span>
   login<span class="token operator">=</span><span class="token number">25115284</span>
   trade_mode<span class="token operator">=</span><span class="token number">0</span>
   leverage<span class="token operator">=</span><span class="token number">100</span>
   limit_orders<span class="token operator">=</span><span class="token number">200</span>
   margin_so_mode<span class="token operator">=</span><span class="token number">0</span>
   trade_allowed<span class="token operator">=</span><span class="token boolean">True</span>
   trade_expert<span class="token operator">=</span><span class="token boolean">True</span>
   margin_mode<span class="token operator">=</span><span class="token number">2</span>
   currency_digits<span class="token operator">=</span><span class="token number">2</span>
   fifo_close<span class="token operator">=</span><span class="token boolean">False</span>
   balance<span class="token operator">=</span><span class="token number">99588.33</span>
   credit<span class="token operator">=</span><span class="token number">0.0</span>
   profit<span class="token operator">=</span><span class="token operator">-</span><span class="token number">45.23</span>
   equity<span class="token operator">=</span><span class="token number">99543.1</span>
   margin<span class="token operator">=</span><span class="token number">54.37</span>
   margin_free<span class="token operator">=</span><span class="token number">99488.73</span>
   margin_level<span class="token operator">=</span><span class="token number">183084.6054809638</span>
   margin_so_call<span class="token operator">=</span><span class="token number">50.0</span>
   margin_so_so<span class="token operator">=</span><span class="token number">30.0</span>
   margin_initial<span class="token operator">=</span><span class="token number">0.0</span>
   margin_maintenance<span class="token operator">=</span><span class="token number">0.0</span>
   assets<span class="token operator">=</span><span class="token number">0.0</span>
   liabilities<span class="token operator">=</span><span class="token number">0.0</span>
   commission_blocked<span class="token operator">=</span><span class="token number">0.0</span>
   name<span class="token operator">=</span>James Smith
   server<span class="token operator">=</span>MetaQuotes<span class="token operator">-</span>Demo
   currency<span class="token operator">=</span>USD
   company<span class="token operator">=</span>MetaQuotes Software Corp<span class="token punctuation">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br></div></div><p>另见</p> <p>initialize、shutdown</p> <h3 id="_32-1-3-shutdown"><a href="#_32-1-3-shutdown" class="header-anchor">#</a> 32.1.3 shutdown</h3> <p>关闭于之前建立的与MetaTrader 5程序端的连接。</p> <p><code>shutdown()</code></p> <p>返回值</p> <p>无。</p> <p>例如：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> MetaTrader5 <span class="token keyword">as</span> mt5
<span class="token comment"># 显示有关MetaTrader 5程序包的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package author: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__author__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package version: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
 
<span class="token comment"># 建立与MetaTrader 5程序端的连接</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> mt5<span class="token punctuation">.</span>initialize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;initialize() failed&quot;</span><span class="token punctuation">)</span>
    quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 显示有关连接状态、服务器名称和交易账户的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>mt5<span class="token punctuation">.</span>terminal_info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 显示有关MetaTrader 5版本的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>mt5<span class="token punctuation">.</span>version<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 
<span class="token comment"># 断开与MetaTrader 5程序端的连接</span>
mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>另见</p> <p>initialize、login_py、 terminal_info、version</p> <h3 id="_32-1-4-version"><a href="#_32-1-4-version" class="header-anchor">#</a> 32.1.4 version</h3> <p>返回MetaTrader 5程序端版本。</p> <p><code>version()</code></p> <p>返回值</p> <p>返回MetaTrader 5程序端版本、build和发布日期。错误情况下返回None。可使用last_error()获取错误信息。</p> <p>注意</p> <p>version()函数以三个值元组的形式返回程序端版本、build和发布日期：</p> <table><thead><tr><th>类型</th> <th>描述</th> <th>样本值</th></tr></thead> <tbody><tr><td>整数</td> <td>MetaTrader 5程序端版本</td> <td>500</td></tr> <tr><td>整数</td> <td>Build</td> <td>2007</td></tr> <tr><td>字符串</td> <td>Build发布日期</td> <td>'25 Feb 2019'</td></tr></tbody></table> <p>例如：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> MetaTrader5 <span class="token keyword">as</span> mt5
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token comment"># 显示有关MetaTrader 5程序包的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package author: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__author__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package version: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
 
<span class="token comment"># 建立与MetaTrader 5程序端的连接</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> mt5<span class="token punctuation">.</span>initialize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;initialize() failed, error code =&quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 显示有关MetaTrader 5版本的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>mt5<span class="token punctuation">.</span>version<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 
<span class="token comment"># display data on connection status, server name and trading account 'as is'</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>mt5<span class="token punctuation">.</span>terminal_info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 获取词典形式的属性</span>
terminal_info_dict<span class="token operator">=</span>mt5<span class="token punctuation">.</span>terminal_info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>_asdict<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 将词典转换为DataFrame和print</span>
df<span class="token operator">=</span>pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>terminal_info_dict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'property'</span><span class="token punctuation">,</span><span class="token string">'value'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;terminal_info() as dataframe:&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
 
<span class="token comment"># 断开与MetaTrader 5程序端的连接</span>
mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
 
Result<span class="token punctuation">:</span>
MetaTrader5程序包作者：MetaQuotes Software Corp<span class="token punctuation">.</span>
MetaTrader5程序包版本：<span class="token number">5.0</span><span class="token number">.29</span>
<span class="token punctuation">[</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">2367</span><span class="token punctuation">,</span> <span class="token string">'23 Mar 2020'</span><span class="token punctuation">]</span>
TerminalInfo<span class="token punctuation">(</span>community_account<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> community_connection<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> connected<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> dlls_allowed<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> trade_allowed<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
 
terminal_info<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> dataframe<span class="token punctuation">:</span>
                 <span class="token builtin">property</span>                         value
<span class="token number">0</span>       community_account                          <span class="token boolean">True</span>
<span class="token number">1</span>    community_connection                          <span class="token boolean">True</span>
<span class="token number">2</span>               connected                          <span class="token boolean">True</span>
<span class="token number">3</span>            dlls_allowed                         <span class="token boolean">False</span>
<span class="token number">4</span>           trade_allowed                         <span class="token boolean">False</span>
<span class="token number">5</span>       tradeapi_disabled                         <span class="token boolean">False</span>
<span class="token number">6</span>           email_enabled                         <span class="token boolean">False</span>
<span class="token number">7</span>             ftp_enabled                         <span class="token boolean">False</span>
<span class="token number">8</span>   notifications_enabled                         <span class="token boolean">False</span>
<span class="token number">9</span>                    mqid                         <span class="token boolean">False</span>
<span class="token number">10</span>                  build                          <span class="token number">2367</span>
<span class="token number">11</span>                maxbars                          <span class="token number">5000</span>
<span class="token number">12</span>               codepage                          <span class="token number">1251</span>
<span class="token number">13</span>              ping_last                         <span class="token number">77881</span>
<span class="token number">14</span>      community_balance                       <span class="token number">707.107</span>
<span class="token number">15</span>         retransmission                             <span class="token number">0</span>
<span class="token number">16</span>                company     MetaQuotes Software Corp<span class="token punctuation">.</span>
<span class="token number">17</span>                   name                  MetaTrader <span class="token number">5</span>
<span class="token number">18</span>               language                       Russian
<span class="token number">19</span>                   path  E<span class="token punctuation">:</span>\ProgramFiles\MetaTrader <span class="token number">5</span>
<span class="token number">20</span>              data_path  E<span class="token punctuation">:</span>\ProgramFiles\MetaTrader <span class="token number">5</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br></div></div><p>另见</p> <p>initialize、shutdown、 terminal_info</p> <h3 id="_32-1-5-last-error"><a href="#_32-1-5-last-error" class="header-anchor">#</a> 32.1.5 last_error</h3> <p>返回最后一个错误的数据。</p> <p><code>last_error()</code></p> <p>返回值</p> <p>以元组形式返回最后一个错误代码和描述。</p> <p>注意</p> <p>last_error()允许在MetaTrader 5程序库函数执行失败的情况下获取错误代码。它类似于GetLastError()。然而，它应用自己的错误代码。可能值：</p> <table><thead><tr><th>常量</th> <th>值</th> <th>描述</th></tr></thead> <tbody><tr><td>RES_S_OK</td> <td>1</td> <td>通用成功</td></tr> <tr><td>RES_E_FAIL</td> <td>-1</td> <td></td></tr> <tr><td>RES_E_INVALID_PARAMS</td> <td>-2</td> <td>无效参数</td></tr> <tr><td>RES_E_NO_MEMORY</td> <td>-3</td> <td>无存储条件</td></tr> <tr><td>RES_E_NOT_FOUND</td> <td>-4</td> <td>没有历史</td></tr> <tr><td>RES_E_INVALID_VERSION</td> <td>-5</td> <td>无效版本</td></tr> <tr><td>RES_E_AUTH_FAILED</td> <td>-6</td> <td>授权失败</td></tr> <tr><td>RES_E_UNSUPPORTED</td> <td>-7</td> <td>不受支持的方法</td></tr> <tr><td>RES_E_AUTO_TRADING_DISABLED</td> <td>-8</td> <td>禁用自动交易</td></tr> <tr><td>RES_E_INTERNAL_FAIL</td> <td>-10000</td> <td>内部IPC一般错误</td></tr> <tr><td>RES_E_INTERNAL_FAIL_SEND</td> <td>-10001</td> <td>内部IPC发送失败</td></tr> <tr><td>RES_E_INTERNAL_FAIL_RECEIVE</td> <td>-10002</td> <td>内部IPC接收失败</td></tr> <tr><td>RES_E_INTERNAL_FAIL_INIT</td> <td>-10003</td> <td>内部IPC初始化失败</td></tr> <tr><td>RES_E_INTERNAL_FAIL_CONNECT</td> <td>-10003</td> <td>内部IPC没有ipc</td></tr> <tr><td>RES_E_INTERNAL_FAIL_TIMEOUT</td> <td>-10005</td> <td>内部超时</td></tr></tbody></table> <p>例如：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> MetaTrader5 <span class="token keyword">as</span> mt5
<span class="token comment"># 显示有关MetaTrader 5程序包的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package author: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__author__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package version: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
 
<span class="token comment"># 建立与MetaTrader 5程序端的连接</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> mt5<span class="token punctuation">.</span>initialize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;initialize() failed, error code =&quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 断开与MetaTrader 5程序端的连接</span>
mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>另见</p> <p>version、GetLastError</p> <h3 id="_32-1-6-account-info"><a href="#_32-1-6-account-info" class="header-anchor">#</a> 32.1.6 account_info</h3> <p>获取当前交易账户的信息。</p> <p><code>account_info()</code></p> <p>返回值</p> <p>以指定元组结构(namedtuple)的形式返回信息。错误情况下返回None。可使用last_error()获取错误信息。</p> <p>注意</p> <p>该函数返回在一次调用中使用AccountInfoInteger、 AccountInfoDouble和AccountInfoString可获得的所有数据。</p> <p>例如：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> MetaTrader5 <span class="token keyword">as</span> mt5
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token comment"># 显示有关MetaTrader 5程序包的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package author: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__author__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package version: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
 
<span class="token comment"># 建立与MetaTrader 5程序端的连接</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> mt5<span class="token punctuation">.</span>initialize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;initialize() failed, error code =&quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 连接到指定密码和服务器的交易账户</span>
authorized<span class="token operator">=</span>mt5<span class="token punctuation">.</span>login<span class="token punctuation">(</span><span class="token number">25115284</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">&quot;gqz0343lbdm&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> authorized<span class="token punctuation">:</span>
    account_info<span class="token operator">=</span>mt5<span class="token punctuation">.</span>account_info<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> account_info<span class="token operator">!=</span><span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token comment"># display trading account data 'as is'</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>account_info<span class="token punctuation">)</span>
        <span class="token comment"># display trading account data in the form of a dictionary</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Show account_info()._asdict():&quot;</span><span class="token punctuation">)</span>
        account_info_dict <span class="token operator">=</span> mt5<span class="token punctuation">.</span>account_info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>_asdict<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> prop <span class="token keyword">in</span> account_info_dict<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;  {}={}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>prop<span class="token punctuation">,</span> account_info_dict<span class="token punctuation">[</span>prop<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 
       <span class="token comment"># 将词典转换为DataFrame和print</span>
        df<span class="token operator">=</span>pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>account_info_dict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'property'</span><span class="token punctuation">,</span><span class="token string">'value'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;account_info() as dataframe:&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
其他：
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;failed to connect to trade account 25115284 with password=gqz0343lbdm, error code =&quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 
<span class="token comment"># 断开与MetaTrader 5程序端的连接</span>
mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
 
结果：
MetaTrader5程序包作者：MetaQuotes Software Corp<span class="token punctuation">.</span>
MetaTrader5程序包版本：<span class="token number">5.0</span><span class="token number">.29</span>
AccountInfo<span class="token punctuation">(</span>login<span class="token operator">=</span><span class="token number">25115284</span><span class="token punctuation">,</span> trade_mode<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> leverage<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> limit_orders<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">,</span> margin_so_mode<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
Show account_info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>_asdict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  login<span class="token operator">=</span><span class="token number">25115284</span>
  trade_mode<span class="token operator">=</span><span class="token number">0</span>
  leverage<span class="token operator">=</span><span class="token number">100</span>
  limit_orders<span class="token operator">=</span><span class="token number">200</span>
  margin_so_mode<span class="token operator">=</span><span class="token number">0</span>
  trade_allowed<span class="token operator">=</span><span class="token boolean">True</span>
  trade_expert<span class="token operator">=</span><span class="token boolean">True</span>
  margin_mode<span class="token operator">=</span><span class="token number">2</span>
  currency_digits<span class="token operator">=</span><span class="token number">2</span>
  fifo_close<span class="token operator">=</span><span class="token boolean">False</span>
  balance<span class="token operator">=</span><span class="token number">99511.4</span>
  credit<span class="token operator">=</span><span class="token number">0.0</span>
  profit<span class="token operator">=</span><span class="token number">41.82</span>
  equity<span class="token operator">=</span><span class="token number">99553.22</span>
  margin<span class="token operator">=</span><span class="token number">98.18</span>
  margin_free<span class="token operator">=</span><span class="token number">99455.04</span>
  margin_level<span class="token operator">=</span><span class="token number">101398.67590140559</span>
  margin_so_call<span class="token operator">=</span><span class="token number">50.0</span>
  margin_so_so<span class="token operator">=</span><span class="token number">30.0</span>
  margin_initial<span class="token operator">=</span><span class="token number">0.0</span>
  margin_maintenance<span class="token operator">=</span><span class="token number">0.0</span>
  assets<span class="token operator">=</span><span class="token number">0.0</span>
  liabilities<span class="token operator">=</span><span class="token number">0.0</span>
  commission_blocked<span class="token operator">=</span><span class="token number">0.0</span>
  name<span class="token operator">=</span>MetaQuotes Dev Demo
  server<span class="token operator">=</span>MetaQuotes<span class="token operator">-</span>Demo
  currency<span class="token operator">=</span>USD
  company<span class="token operator">=</span>MetaQuotes Software Corp<span class="token punctuation">.</span>
 
account_info<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> dataframe
              <span class="token builtin">property</span>                      value
<span class="token number">0</span>                login                   <span class="token number">25115284</span>
<span class="token number">1</span>           trade_mode                          <span class="token number">0</span>
<span class="token number">2</span>             leverage                        <span class="token number">100</span>
<span class="token number">3</span>         limit_orders                        <span class="token number">200</span>
<span class="token number">4</span>       margin_so_mode                          <span class="token number">0</span>
<span class="token number">5</span>        trade_allowed                       <span class="token boolean">True</span>
<span class="token number">6</span>         trade_expert                       <span class="token boolean">True</span>
<span class="token number">7</span>          margin_mode                          <span class="token number">2</span>
<span class="token number">8</span>      currency_digits                          <span class="token number">2</span>
<span class="token number">9</span>           fifo_close                      <span class="token boolean">False</span>
<span class="token number">10</span>             balance                    <span class="token number">99588.3</span>
<span class="token number">11</span>              credit                          <span class="token number">0</span>
<span class="token number">12</span>              profit                     <span class="token operator">-</span><span class="token number">45.13</span>
<span class="token number">13</span>              equity                    <span class="token number">99543.2</span>
<span class="token number">14</span>              margin                      <span class="token number">54.37</span>
<span class="token number">15</span>         margin_free                    <span class="token number">99488.8</span>
<span class="token number">16</span>        margin_level                     <span class="token number">183085</span>
<span class="token number">17</span>      margin_so_call                         <span class="token number">50</span>
<span class="token number">18</span>        margin_so_so                         <span class="token number">30</span>
<span class="token number">19</span>      margin_initial                          <span class="token number">0</span>
<span class="token number">20</span>  margin_maintenance                          <span class="token number">0</span>
<span class="token number">21</span>              assets                          <span class="token number">0</span>
<span class="token number">22</span>         liabilities                          <span class="token number">0</span>
<span class="token number">23</span>  commission_blocked                          <span class="token number">0</span>
<span class="token number">24</span>                name                James Smith
<span class="token number">25</span>              server            MetaQuotes<span class="token operator">-</span>Demo
<span class="token number">26</span>            currency                        USD
<span class="token number">27</span>             company  MetaQuotes Software Corp<span class="token punctuation">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br></div></div><p>另见</p> <p>initialize、shutdown、login</p> <h3 id="_32-1-7-terminal-info"><a href="#_32-1-7-terminal-info" class="header-anchor">#</a> 32.1.7 terminal_info</h3> <p>获取已连接的MetaTrader 5客户端的状态和设置。</p> <p><code>terminal_info()</code></p> <p>返回值</p> <p>以指定元组结构(namedtuple)的形式返回信息。错误情况下返回None。可使用last_error()获取错误信息。</p> <p>注意</p> <p>该函数返回在一次调用中使用TerminalInfoInteger、 TerminalInfoDouble和TerminalInfoDouble可获得的所有数据。</p> <p>例如：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> MetaTrader5 <span class="token keyword">as</span> mt5
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token comment"># 显示有关MetaTrader 5程序包的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package author: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__author__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package version: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
<span class="token comment"># 显示有关MetaTrader 5程序包的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package author: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__author__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package version: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
 
<span class="token comment"># 建立与MetaTrader 5程序端的连接</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> mt5<span class="token punctuation">.</span>initialize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;initialize() failed, error code =&quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 显示有关MetaTrader 5版本的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>mt5<span class="token punctuation">.</span>version<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 显示有关程序端设置和状态的信息</span>
terminal_info<span class="token operator">=</span>mt5<span class="token punctuation">.</span>terminal_info<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> terminal_info<span class="token operator">!=</span><span class="token boolean">None</span><span class="token punctuation">:</span>
    <span class="token comment"># display the terminal data 'as is'</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>terminal_info<span class="token punctuation">)</span>
    <span class="token comment"># display data in the form of a list</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Show terminal_info()._asdict():&quot;</span><span class="token punctuation">)</span>
    terminal_info_dict <span class="token operator">=</span> mt5<span class="token punctuation">.</span>terminal_info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>_asdict<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> prop <span class="token keyword">in</span> terminal_info_dict<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;  {}={}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>prop<span class="token punctuation">,</span> terminal_info_dict<span class="token punctuation">[</span>prop<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token comment"># 将词典转换为DataFrame和print</span>
    df<span class="token operator">=</span>pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>terminal_info_dict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'property'</span><span class="token punctuation">,</span><span class="token string">'value'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;terminal_info() as dataframe:&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
 
<span class="token comment"># 断开与MetaTrader 5程序端的连接</span>
mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
 
结果：
MetaTrader5程序包作者：MetaQuotes Software Corp<span class="token punctuation">.</span>
MetaTrader5程序包版本：<span class="token number">5.0</span><span class="token number">.29</span>
<span class="token punctuation">[</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">2366</span><span class="token punctuation">,</span> <span class="token string">'20 Mar 2020'</span><span class="token punctuation">]</span>
TerminalInfo<span class="token punctuation">(</span>community_account<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> community_connection<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> connected<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
Show terminal_info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>_asdict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  community_account<span class="token operator">=</span><span class="token boolean">True</span>
  community_connection<span class="token operator">=</span><span class="token boolean">True</span>
  connected<span class="token operator">=</span><span class="token boolean">True</span>
  dlls_allowed<span class="token operator">=</span><span class="token boolean">False</span>
  trade_allowed<span class="token operator">=</span><span class="token boolean">False</span>
  tradeapi_disabled<span class="token operator">=</span><span class="token boolean">False</span>
  email_enabled<span class="token operator">=</span><span class="token boolean">False</span>
  ftp_enabled<span class="token operator">=</span><span class="token boolean">False</span>
  notifications_enabled<span class="token operator">=</span><span class="token boolean">False</span>
  mqid<span class="token operator">=</span><span class="token boolean">False</span>
  build<span class="token operator">=</span><span class="token number">2366</span>
  maxbars<span class="token operator">=</span><span class="token number">5000</span>
  codepage<span class="token operator">=</span><span class="token number">1251</span>
  ping_last<span class="token operator">=</span><span class="token number">77850</span>
  community_balance<span class="token operator">=</span><span class="token number">707.10668201585</span>
  retransmission<span class="token operator">=</span><span class="token number">0.0</span>
  company<span class="token operator">=</span>MetaQuotes Software Corp<span class="token punctuation">.</span>
  name<span class="token operator">=</span>MetaTrader <span class="token number">5</span>
  language<span class="token operator">=</span>Russian
  path<span class="token operator">=</span>E<span class="token punctuation">:</span>\ProgramFiles\MetaTrader <span class="token number">5</span>
  data_path<span class="token operator">=</span>E<span class="token punctuation">:</span>\ProgramFiles\MetaTrader <span class="token number">5</span>
  commondata_path<span class="token operator">=</span>C<span class="token punctuation">:</span>\Users\Rosh\AppData\Roaming\MetaQuotes\Terminal\Common
 
terminal_info<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> dataframe<span class="token punctuation">:</span>
                 <span class="token builtin">property</span>                      value
<span class="token number">0</span>       community_account                       <span class="token boolean">True</span>
<span class="token number">1</span>    community_connection                       <span class="token boolean">True</span>
<span class="token number">2</span>               connected                       <span class="token boolean">True</span>
<span class="token number">3</span>            dlls_allowed                      <span class="token boolean">False</span>
<span class="token number">4</span>           trade_allowed                      <span class="token boolean">False</span>
<span class="token number">5</span>       tradeapi_disabled                      <span class="token boolean">False</span>
<span class="token number">6</span>           email_enabled                      <span class="token boolean">False</span>
<span class="token number">7</span>             ftp_enabled                      <span class="token boolean">False</span>
<span class="token number">8</span>   notifications_enabled                      <span class="token boolean">False</span>
<span class="token number">9</span>                    mqid                      <span class="token boolean">False</span>
<span class="token number">10</span>                  build                       <span class="token number">2367</span>
<span class="token number">11</span>                maxbars                       <span class="token number">5000</span>
<span class="token number">12</span>               codepage                       <span class="token number">1251</span>
<span class="token number">13</span>              ping_last                      <span class="token number">80953</span>
<span class="token number">14</span>      community_balance                    <span class="token number">707.107</span>
<span class="token number">15</span>         retransmission                   <span class="token number">0.063593</span>
<span class="token number">16</span>                company  MetaQuotes Software Corp<span class="token punctuation">.</span>
<span class="token number">17</span>                   name               MetaTrader <span class="token number">5</span>
<span class="token number">18</span>               language                    Russian
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br></div></div><p>另见</p> <p>initialize、shutdown、version</p> <h3 id="_32-1-8-symbols-total"><a href="#_32-1-8-symbols-total" class="header-anchor">#</a> 32.1.8 symbols_total</h3> <p>获取MetaTrader 5程序端中所有交易品种的数量。</p> <p><code>symbols_total()</code></p> <p>返回值</p> <p>整数值。</p> <p>注意</p> <p>该函数类似于SymbolsTotal()。然而，它返回所有交易品种的数量，包括自定义交易品种，也包括市场报价中禁用的交易品种。</p> <p>例如：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> MetaTrader5 <span class="token keyword">as</span> mt5
<span class="token comment"># 显示有关MetaTrader 5程序包的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package author: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__author__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package version: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
 
<span class="token comment"># 建立与MetaTrader 5程序端的连接</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> mt5<span class="token punctuation">.</span>initialize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;initialize() failed, error code =&quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 获取交易品种的数量</span>
symbols<span class="token operator">=</span>mt5<span class="token punctuation">.</span>symbols_total<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> symbols<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Total symbols =&quot;</span><span class="token punctuation">,</span>symbols<span class="token punctuation">)</span>
其他：
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;symbols not found&quot;</span><span class="token punctuation">)</span>
 
<span class="token comment"># 断开与MetaTrader 5程序端的连接</span>
mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>另见</p> <p>symbols_get、symbol_select、 symbol_info</p> <h3 id="_32-1-9-symbols-get"><a href="#_32-1-9-symbols-get" class="header-anchor">#</a> 32.1.9  symbols_get</h3> <p>获取MetaTrader 5程序端中的所有交易品种。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>symbols_get(
   group=&quot;GROUP&quot;      // 交易品种选择过滤器
)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>group=&quot;GROUP&quot;</p> <p>[in]  用于跑了一组必要交易品种的过滤器。可选参数。如果指定了组，则函数只返回满足指定条件的交易品种。</p> <p>返回值</p> <p>以元组的形式返回交易品种。错误情况下返回None。可使用last_error()获取错误信息。</p> <p>注意</p> <p>group参数可以根据名称对交易品种进行分类。'*'可以用在字符串的开头和结尾。</p> <p>group参数可被用作命名的参数或未命名的参数。两个选项工作方式相同。命名的选项(group=&quot;GROUP&quot;)使代码更易于阅读。</p> <p>group参数可以包含多个逗号分隔条件。条件可以使用'*'设置为掩码。逻辑否定字符'!'可以用来表示排除条件。所有条件依序应用，这意味着应该先指定包含到组中的条件，然后再指定排除条件。例如，<code>group=&quot;*, !EUR&quot;</code>意味着应该先选择所有交易品种，然后排除名称中包含&quot;EUR&quot;的交易品种。</p> <p>不同于symbol_info()，symbols_get()函数在单个调用中返回所有请求交易品种的数据。</p> <p>例如：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> MetaTrader5 <span class="token keyword">as</span> mt5
<span class="token comment"># 显示有关MetaTrader 5程序包的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package author: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__author__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package version: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
 
<span class="token comment"># 建立与MetaTrader 5程序端的连接</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> mt5<span class="token punctuation">.</span>initialize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;initialize() failed, error code =&quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 获取所有交易品种</span>
symbols<span class="token operator">=</span>mt5<span class="token punctuation">.</span>symbols_get<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Symbols: '</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>symbols<span class="token punctuation">)</span><span class="token punctuation">)</span>
count<span class="token operator">=</span><span class="token number">0</span>
<span class="token comment"># 显示前五个交易品种</span>
<span class="token keyword">for</span> s <span class="token keyword">in</span> symbols<span class="token punctuation">:</span>
    count<span class="token operator">+=</span><span class="token number">1</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;{}. {}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span>s<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> count<span class="token operator">==</span><span class="token number">5</span><span class="token punctuation">:</span> <span class="token keyword">break</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 获取名称中包含RU的交易品种</span>
ru_symbols<span class="token operator">=</span>mt5<span class="token punctuation">.</span>symbols_get<span class="token punctuation">(</span><span class="token string">&quot;*RU*&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'len(*RU*): '</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ru_symbols<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> s <span class="token keyword">in</span> ru_symbols<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 获取名称中不包含USD、EUR、JPY和GBP的交易品种</span>
group_symbols<span class="token operator">=</span>mt5<span class="token punctuation">.</span>symbols_get<span class="token punctuation">(</span>group<span class="token operator">=</span><span class="token string">&quot;*,!*USD*,!*EUR*,!*JPY*,!*GBP*&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'len(*,!*USD*,!*EUR*,!*JPY*,!*GBP*):'</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>group_symbols<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> s <span class="token keyword">in</span> group_symbols<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>name<span class="token punctuation">,</span><span class="token string">&quot;:&quot;</span><span class="token punctuation">,</span>s<span class="token punctuation">)</span>
 
<span class="token comment"># 断开与MetaTrader 5程序端的连接</span>
mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
结果：
MetaTrader5程序包作者：MetaQuotes Software Corp<span class="token punctuation">.</span>
MetaTrader5程序包版本：<span class="token number">5.0</span><span class="token number">.29</span>
交易品种：<span class="token number">84</span>
<span class="token number">1.</span> EURUSD
<span class="token number">2.</span> GBPUSD
<span class="token number">3.</span> USDCHF
<span class="token number">4.</span> USDJPY
<span class="token number">5.</span> USDCNH
 
<span class="token builtin">len</span><span class="token punctuation">(</span><span class="token operator">*</span>RU<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token number">8</span>
EURUSD
USDRUB
USDRUR
EURRUR
EURRUB
FORTS<span class="token punctuation">.</span>RUB<span class="token punctuation">.</span>M5
EURUSD_T20
EURUSD4
 
<span class="token builtin">len</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">,</span>!<span class="token operator">*</span>USD<span class="token operator">*</span><span class="token punctuation">,</span>!<span class="token operator">*</span>EUR<span class="token operator">*</span><span class="token punctuation">,</span>!<span class="token operator">*</span>JPY<span class="token operator">*</span><span class="token punctuation">,</span>!<span class="token operator">*</span>GBP<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token number">13</span>
AUDCAD <span class="token punctuation">:</span> SymbolInfo<span class="token punctuation">(</span>custom<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> chart_mode<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> select<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> visible<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> session_deals<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> session_buy_orders<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> session<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
AUDCHF <span class="token punctuation">:</span> SymbolInfo<span class="token punctuation">(</span>custom<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> chart_mode<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> select<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> visible<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> session_deals<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> session_buy_orders<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> sessi<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
AUDNZD <span class="token punctuation">:</span> SymbolInfo<span class="token punctuation">(</span>custom<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> chart_mode<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> select<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> visible<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> session_deals<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> session_buy_orders<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> sessi<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
CADCHF <span class="token punctuation">:</span> SymbolInfo<span class="token punctuation">(</span>custom<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> chart_mode<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> select<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> visible<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> session_deals<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> session_buy_orders<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> sessi<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
NZDCAD <span class="token punctuation">:</span> SymbolInfo<span class="token punctuation">(</span>custom<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> chart_mode<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> select<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> visible<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> session_deals<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> session_buy_orders<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> sessi<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
NZDCHF <span class="token punctuation">:</span> SymbolInfo<span class="token punctuation">(</span>custom<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> chart_mode<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> select<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> visible<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> session_deals<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> session_buy_orders<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> sessi<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
NZDSGD <span class="token punctuation">:</span> SymbolInfo<span class="token punctuation">(</span>custom<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> chart_mode<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> select<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> visible<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> session_deals<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> session_buy_orders<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> sessi<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
CADMXN <span class="token punctuation">:</span> SymbolInfo<span class="token punctuation">(</span>custom<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> chart_mode<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> select<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> visible<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> session_deals<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> session_buy_orders<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> sessi<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
CHFMXN <span class="token punctuation">:</span> SymbolInfo<span class="token punctuation">(</span>custom<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> chart_mode<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> select<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> visible<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> session_deals<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> session_buy_orders<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> sessi<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
NZDMXN <span class="token punctuation">:</span> SymbolInfo<span class="token punctuation">(</span>custom<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> chart_mode<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> select<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> visible<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> session_deals<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> session_buy_orders<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> sessi<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
FORTS<span class="token punctuation">.</span>RTS<span class="token punctuation">.</span>M5 <span class="token punctuation">:</span> SymbolInfo<span class="token punctuation">(</span>custom<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> chart_mode<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> select<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> visible<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> session_deals<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> session_buy_orders<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
FORTS<span class="token punctuation">.</span>RUB<span class="token punctuation">.</span>M5 <span class="token punctuation">:</span> SymbolInfo<span class="token punctuation">(</span>custom<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> chart_mode<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> select<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> visible<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> session_deals<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> session_buy_orders<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
FOREX<span class="token punctuation">.</span>CHF<span class="token punctuation">.</span>M5 <span class="token punctuation">:</span> SymbolInfo<span class="token punctuation">(</span>custom<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> chart_mode<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> select<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> visible<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> session_deals<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> session_buy_orders<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br></div></div><p>另见</p> <p>symbols_total、symbol_select、 symbol_info</p> <h3 id="_32-1-10-symbol-info"><a href="#_32-1-10-symbol-info" class="header-anchor">#</a> 32.1.10  symbol_info</h3> <p>获取指定交易品种的数据。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>symbol_info(
   symbol      // 交易品种名称
)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>symbol</p> <p>[in]  交易品种名称。所需的未命名参数。</p> <p>返回值</p> <p>以指定元组结构(namedtuple)的形式返回信息。错误情况下返回None。可使用last_error()获取错误信息。</p> <p>注意</p> <p>该函数返回在一次调用中使用SymbolInfoInteger、 SymbolInfoDouble和SymbolInfoString可获得的所有数据。</p> <p>例如：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> MetaTrader5 <span class="token keyword">as</span> mt5
<span class="token comment"># 显示有关MetaTrader 5程序包的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package author: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__author__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package version: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
 
<span class="token comment"># 建立与MetaTrader 5程序端的连接</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> mt5<span class="token punctuation">.</span>initialize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;initialize() failed, error code =&quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 尝试在市场报价中启用显示EURJPY交易品种</span>
selected<span class="token operator">=</span>mt5<span class="token punctuation">.</span>symbol_select<span class="token punctuation">(</span><span class="token string">&quot;EURJPY&quot;</span><span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> selected<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to select EURJPY&quot;</span><span class="token punctuation">)</span>
    mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
    quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 显示EURJPY交易品种属性</span>
symbol_info<span class="token operator">=</span>mt5<span class="token punctuation">.</span>symbol_info<span class="token punctuation">(</span><span class="token string">&quot;EURJPY&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> symbol_info<span class="token operator">!=</span><span class="token boolean">None</span><span class="token punctuation">:</span>
    <span class="token comment"># display the terminal data 'as is'    </span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>symbol_info<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;EURJPY: spread =&quot;</span><span class="token punctuation">,</span>symbol_info<span class="token punctuation">.</span>spread<span class="token punctuation">,</span><span class="token string">&quot;  digits =&quot;</span><span class="token punctuation">,</span>symbol_info<span class="token punctuation">.</span>digits<span class="token punctuation">)</span>
    <span class="token comment"># display symbol properties as a list</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Show symbol_info(\&quot;EURJPY\&quot;)._asdict():&quot;</span><span class="token punctuation">)</span>
    symbol_info_dict <span class="token operator">=</span> mt5<span class="token punctuation">.</span>symbol_info<span class="token punctuation">(</span><span class="token string">&quot;EURJPY&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>_asdict<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> prop <span class="token keyword">in</span> symbol_info_dict<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;  {}={}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>prop<span class="token punctuation">,</span> symbol_info_dict<span class="token punctuation">[</span>prop<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 
<span class="token comment"># 断开与MetaTrader 5程序端的连接</span>
mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
 
结果：
MetaTrader5程序包作者：MetaQuotes Software Corp<span class="token punctuation">.</span>
MetaTrader5程序包版本：<span class="token number">5.0</span><span class="token number">.29</span>
SymbolInfo<span class="token punctuation">(</span>custom<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> chart_mode<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> select<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> visible<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> session_deals<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> session_buy_orders<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> session_sell_orders<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
EURJPY<span class="token punctuation">:</span> spread <span class="token operator">=</span> <span class="token number">17</span>   digits <span class="token operator">=</span> <span class="token number">3</span>
Show symbol_info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>_asdict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  custom<span class="token operator">=</span><span class="token boolean">False</span>
  chart_mode<span class="token operator">=</span><span class="token number">0</span>
  select<span class="token operator">=</span><span class="token boolean">True</span>
  visible<span class="token operator">=</span><span class="token boolean">True</span>
  session_deals<span class="token operator">=</span><span class="token number">0</span>
  session_buy_orders<span class="token operator">=</span><span class="token number">0</span>
  session_sell_orders<span class="token operator">=</span><span class="token number">0</span>
  volume<span class="token operator">=</span><span class="token number">0</span>
  volumehigh<span class="token operator">=</span><span class="token number">0</span>
  volumelow<span class="token operator">=</span><span class="token number">0</span>
  time<span class="token operator">=</span><span class="token number">1585069682</span>
  digits<span class="token operator">=</span><span class="token number">3</span>
  spread<span class="token operator">=</span><span class="token number">17</span>
  spread_float<span class="token operator">=</span><span class="token boolean">True</span>
  ticks_bookdepth<span class="token operator">=</span><span class="token number">10</span>
  trade_calc_mode<span class="token operator">=</span><span class="token number">0</span>
  trade_mode<span class="token operator">=</span><span class="token number">4</span>
  start_time<span class="token operator">=</span><span class="token number">0</span>
  expiration_time<span class="token operator">=</span><span class="token number">0</span>
  trade_stops_level<span class="token operator">=</span><span class="token number">0</span>
  trade_freeze_level<span class="token operator">=</span><span class="token number">0</span>
  trade_exemode<span class="token operator">=</span><span class="token number">1</span>
  swap_mode<span class="token operator">=</span><span class="token number">1</span>
  swap_rollover3days<span class="token operator">=</span><span class="token number">3</span>
  margin_hedged_use_leg<span class="token operator">=</span><span class="token boolean">False</span>
  expiration_mode<span class="token operator">=</span><span class="token number">7</span>
  filling_mode<span class="token operator">=</span><span class="token number">1</span>
  order_mode<span class="token operator">=</span><span class="token number">127</span>
  order_gtc_mode<span class="token operator">=</span><span class="token number">0</span>
  option_mode<span class="token operator">=</span><span class="token number">0</span>
  option_right<span class="token operator">=</span><span class="token number">0</span>
  bid<span class="token operator">=</span><span class="token number">120.024</span>
  bidhigh<span class="token operator">=</span><span class="token number">120.506</span>
  bidlow<span class="token operator">=</span><span class="token number">118.798</span>
  ask<span class="token operator">=</span><span class="token number">120.041</span>
  askhigh<span class="token operator">=</span><span class="token number">120.526</span>
  asklow<span class="token operator">=</span><span class="token number">118.828</span>
  last<span class="token operator">=</span><span class="token number">0.0</span>
  lasthigh<span class="token operator">=</span><span class="token number">0.0</span>
  lastlow<span class="token operator">=</span><span class="token number">0.0</span>
  volume_real<span class="token operator">=</span><span class="token number">0.0</span>
  volumehigh_real<span class="token operator">=</span><span class="token number">0.0</span>
  volumelow_real<span class="token operator">=</span><span class="token number">0.0</span>
  option_strike<span class="token operator">=</span><span class="token number">0.0</span>
  point<span class="token operator">=</span><span class="token number">0.001</span>
  trade_tick_value<span class="token operator">=</span><span class="token number">0.8977708350166538</span>
  trade_tick_value_profit<span class="token operator">=</span><span class="token number">0.8977708350166538</span>
  trade_tick_value_loss<span class="token operator">=</span><span class="token number">0.8978272580355541</span>
  trade_tick_size<span class="token operator">=</span><span class="token number">0.001</span>
  trade_contract_size<span class="token operator">=</span><span class="token number">100000.0</span>
  trade_accrued_interest<span class="token operator">=</span><span class="token number">0.0</span>
  trade_face_value<span class="token operator">=</span><span class="token number">0.0</span>
  trade_liquidity_rate<span class="token operator">=</span><span class="token number">0.0</span>
  volume_min<span class="token operator">=</span><span class="token number">0.01</span>
  volume_max<span class="token operator">=</span><span class="token number">500.0</span>
  volume_step<span class="token operator">=</span><span class="token number">0.01</span>
  volume_limit<span class="token operator">=</span><span class="token number">0.0</span>
  swap_long<span class="token operator">=</span><span class="token operator">-</span><span class="token number">0.2</span>
  swap_short<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1.2</span>
  margin_initial<span class="token operator">=</span><span class="token number">0.0</span>
  margin_maintenance<span class="token operator">=</span><span class="token number">0.0</span>
  session_volume<span class="token operator">=</span><span class="token number">0.0</span>
  session_turnover<span class="token operator">=</span><span class="token number">0.0</span>
  session_interest<span class="token operator">=</span><span class="token number">0.0</span>
  session_buy_orders_volume<span class="token operator">=</span><span class="token number">0.0</span>
  session_sell_orders_volume<span class="token operator">=</span><span class="token number">0.0</span>
  session_open<span class="token operator">=</span><span class="token number">0.0</span>
  session_close<span class="token operator">=</span><span class="token number">0.0</span>
  session_aw<span class="token operator">=</span><span class="token number">0.0</span>
  session_price_settlement<span class="token operator">=</span><span class="token number">0.0</span>
  session_price_limit_min<span class="token operator">=</span><span class="token number">0.0</span>
  session_price_limit_max<span class="token operator">=</span><span class="token number">0.0</span>
  margin_hedged<span class="token operator">=</span><span class="token number">100000.0</span>
  price_change<span class="token operator">=</span><span class="token number">0.0</span>
  price_volatility<span class="token operator">=</span><span class="token number">0.0</span>
  price_theoretical<span class="token operator">=</span><span class="token number">0.0</span>
  price_greeks_delta<span class="token operator">=</span><span class="token number">0.0</span>
  price_greeks_theta<span class="token operator">=</span><span class="token number">0.0</span>
  price_greeks_gamma<span class="token operator">=</span><span class="token number">0.0</span>
  price_greeks_vega<span class="token operator">=</span><span class="token number">0.0</span>
  price_greeks_rho<span class="token operator">=</span><span class="token number">0.0</span>
  price_greeks_omega<span class="token operator">=</span><span class="token number">0.0</span>
  price_sensitivity<span class="token operator">=</span><span class="token number">0.0</span>
  basis<span class="token operator">=</span>
  category<span class="token operator">=</span>
  currency_base<span class="token operator">=</span>EUR
  currency_profit<span class="token operator">=</span>JPY
  currency_margin<span class="token operator">=</span>EUR
  bank<span class="token operator">=</span>
  description<span class="token operator">=</span>Euro vs Japanese Yen
  exchange<span class="token operator">=</span>
  formula<span class="token operator">=</span>
  isin<span class="token operator">=</span>
  name<span class="token operator">=</span>EURJPY
  page<span class="token operator">=</span>http<span class="token punctuation">:</span><span class="token operator">//</span>www<span class="token punctuation">.</span>google<span class="token punctuation">.</span>com<span class="token operator">/</span>finance?q<span class="token operator">=</span>EURJPY
  path<span class="token operator">=</span>Forex\EURJPY
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br></div></div><p>另见</p> <p>account_info、terminal_info</p> <h3 id="_32-1-11-symbol-info-tick"><a href="#_32-1-11-symbol-info-tick" class="header-anchor">#</a> 32.1.11 symbol_info_tick</h3> <p>获取指定交易品种的最后报价。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>symbol_info_tick(
   symbol      // 交易品种名称
)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>symbol</p> <p>[in]  交易品种名称。所需的未命名参数。</p> <p>返回值</p> <p>以元组的形式返回信息。错误情况下返回None。可使用last_error()获取错误信息。</p> <p>注意</p> <p>该函数类似于SymbolInfoTick。</p> <p>例如：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> MetaTrader5 <span class="token keyword">as</span> mt5
<span class="token comment"># 显示有关MetaTrader 5程序包的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package author: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__author__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package version: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
 
<span class="token comment"># 建立与MetaTrader 5程序端的连接</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> mt5<span class="token punctuation">.</span>initialize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;initialize() failed, error code =&quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 尝试在市场报价中启用显示GBPUSD</span>
selected<span class="token operator">=</span>mt5<span class="token punctuation">.</span>symbol_select<span class="token punctuation">(</span><span class="token string">&quot;GBPUSD&quot;</span><span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> selected<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to select GBPUSD&quot;</span><span class="token punctuation">)</span>
    mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
    quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 显示GBPUSD最后报价</span>
lasttick<span class="token operator">=</span>mt5<span class="token punctuation">.</span>symbol_info_tick<span class="token punctuation">(</span><span class="token string">&quot;GBPUSD&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>lasttick<span class="token punctuation">)</span>
<span class="token comment"># 以列表的形式显示报价字段值</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Show symbol_info_tick(\&quot;GBPUSD\&quot;)._asdict():&quot;</span><span class="token punctuation">)</span>
symbol_info_tick_dict <span class="token operator">=</span> mt5<span class="token punctuation">.</span>symbol_info_tick<span class="token punctuation">(</span><span class="token string">&quot;GBPUSD&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>_asdict<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> prop <span class="token keyword">in</span> symbol_info_tick_dict<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;  {}={}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>prop<span class="token punctuation">,</span> symbol_info_tick_dict<span class="token punctuation">[</span>prop<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 
<span class="token comment"># 断开与MetaTrader 5程序端的连接</span>
mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
 
结果：
MetaTrader5程序包作者：MetaQuotes Software Corp<span class="token punctuation">.</span>
MetaTrader5程序包版本：<span class="token number">5.0</span><span class="token number">.29</span>
Tick<span class="token punctuation">(</span>time<span class="token operator">=</span><span class="token number">1585070338</span><span class="token punctuation">,</span> bid<span class="token operator">=</span><span class="token number">1.17264</span><span class="token punctuation">,</span> ask<span class="token operator">=</span><span class="token number">1.17279</span><span class="token punctuation">,</span> last<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">,</span> volume<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> time_msc<span class="token operator">=</span><span class="token number">1585070338728</span><span class="token punctuation">,</span> flags<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> volume_real<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">)</span>
Show symbol_info_tick<span class="token punctuation">.</span>_asdict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  time<span class="token operator">=</span><span class="token number">1585070338</span>
  bid<span class="token operator">=</span><span class="token number">1.17264</span>
  ask<span class="token operator">=</span><span class="token number">1.17279</span>
  last<span class="token operator">=</span><span class="token number">0.0</span>
  volume<span class="token operator">=</span><span class="token number">0</span>
  time_msc<span class="token operator">=</span><span class="token number">1585070338728</span>
  flags<span class="token operator">=</span><span class="token number">2</span>
  volume_real<span class="token operator">=</span><span class="token number">0.0</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><p>另见</p> <p>symbol_info、symbol_info</p> <h3 id="_32-1-12-symbol-select"><a href="#_32-1-12-symbol-select" class="header-anchor">#</a> 32.1.12  symbol_select</h3> <p>在MarketWatch（市场报价）窗口中选择一个交易品种或从该窗口移除一个交易品种。</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>symbol_select<span class="token punctuation">(</span>
   symbol<span class="token punctuation">,</span>      <span class="token operator">//</span> 交易品种名称
   enable       <span class="token operator">//</span> 启用或禁用
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>symbol</p> <p>[in]  交易品种名称。所需的未命名参数。</p> <p>enable</p> <p>[in]  切换。可选的未命名参数。如果是'false'，则交易品种应从MarketWatch（市场报价）窗口移除。否则，应该在市场报价窗口中将其选定。如果已存在一个交易品种的打开图表或有其未结持仓，则不可以删除此交易品种。</p> <p>返回值</p> <p>如果成功返回true，否则–false。</p> <p>注意</p> <p>该函数类似于SymbolSelect。</p> <p>例如：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> MetaTrader5 <span class="token keyword">as</span> mt5
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token comment"># 显示有关MetaTrader 5程序包的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package author: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__author__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package version: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 建立与MetaTrader 5程序端的连接</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> mt5<span class="token punctuation">.</span>initialize<span class="token punctuation">(</span>login<span class="token operator">=</span><span class="token number">25115284</span><span class="token punctuation">,</span> server<span class="token operator">=</span><span class="token string">&quot;MetaQuotes-Demo&quot;</span><span class="token punctuation">,</span>password<span class="token operator">=</span><span class="token string">&quot;4zatlbqx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;initialize() failed, error code =&quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 尝试在市场报价中启用显示EURCAD</span>
selected<span class="token operator">=</span>mt5<span class="token punctuation">.</span>symbol_select<span class="token punctuation">(</span><span class="token string">&quot;EURCAD&quot;</span><span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> selected<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to select EURCAD, error code =&quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
其他：
    symbol_info<span class="token operator">=</span>mt5<span class="token punctuation">.</span>symbol_info<span class="token punctuation">(</span><span class="token string">&quot;EURCAD&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>symbol_info<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;EURCAD: currency_base =&quot;</span><span class="token punctuation">,</span>symbol_info<span class="token punctuation">.</span>currency_base<span class="token punctuation">,</span><span class="token string">&quot;  currency_profit =&quot;</span><span class="token punctuation">,</span>symbol_info<span class="token punctuation">.</span>currency_profit<span class="token punctuation">,</span><span class="token string">&quot;  currency_margin =&quot;</span><span class="token punctuation">,</span>symbol_info<span class="token punctuation">.</span>currency_margin<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 
    <span class="token comment"># get symbol properties in the form of a dictionary</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Show symbol_info()._asdict():&quot;</span><span class="token punctuation">)</span>
    symbol_info_dict <span class="token operator">=</span> symbol_info<span class="token punctuation">.</span>_asdict<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> prop <span class="token keyword">in</span> symbol_info_dict<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;  {}={}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>prop<span class="token punctuation">,</span> symbol_info_dict<span class="token punctuation">[</span>prop<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 
   <span class="token comment"># 将词典转换为DataFrame和print</span>
    df<span class="token operator">=</span>pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>symbol_info_dict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'property'</span><span class="token punctuation">,</span><span class="token string">'value'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;symbol_info_dict() as dataframe:&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
 
<span class="token comment"># 断开与MetaTrader 5程序端的连接</span>
mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
 
结果：
MetaTrader5程序包作者：MetaQuotes Software Corp<span class="token punctuation">.</span>
MetaTrader5程序包版本：<span class="token number">5.0</span><span class="token number">.29</span>
SymbolInfo<span class="token punctuation">(</span>custom<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> chart_mode<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> select<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> visible<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> session_deals<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> session_buy_orders<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> session_sell_orders<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> volume<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> volumehigh<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
EURCAD<span class="token punctuation">:</span> currency_base <span class="token operator">=</span> EUR   currency_profit <span class="token operator">=</span> CAD   currency_margin <span class="token operator">=</span> EUR
 
Show symbol_info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>_asdict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  custom<span class="token operator">=</span><span class="token boolean">False</span>
  chart_mode<span class="token operator">=</span><span class="token number">0</span>
  select<span class="token operator">=</span><span class="token boolean">True</span>
  visible<span class="token operator">=</span><span class="token boolean">True</span>
  session_deals<span class="token operator">=</span><span class="token number">0</span>
  session_buy_orders<span class="token operator">=</span><span class="token number">0</span>
  session_sell_orders<span class="token operator">=</span><span class="token number">0</span>
  volume<span class="token operator">=</span><span class="token number">0</span>
  volumehigh<span class="token operator">=</span><span class="token number">0</span>
  volumelow<span class="token operator">=</span><span class="token number">0</span>
  time<span class="token operator">=</span><span class="token number">1585217595</span>
  digits<span class="token operator">=</span><span class="token number">5</span>
  spread<span class="token operator">=</span><span class="token number">39</span>
  spread_float<span class="token operator">=</span><span class="token boolean">True</span>
  ticks_bookdepth<span class="token operator">=</span><span class="token number">10</span>
  trade_calc_mode<span class="token operator">=</span><span class="token number">0</span>
  trade_mode<span class="token operator">=</span><span class="token number">4</span>
  start_time<span class="token operator">=</span><span class="token number">0</span>
  expiration_time<span class="token operator">=</span><span class="token number">0</span>
  trade_stops_level<span class="token operator">=</span><span class="token number">0</span>
  trade_freeze_level<span class="token operator">=</span><span class="token number">0</span>
  trade_exemode<span class="token operator">=</span><span class="token number">1</span>
  swap_mode<span class="token operator">=</span><span class="token number">1</span>
  swap_rollover3days<span class="token operator">=</span><span class="token number">3</span>
  margin_hedged_use_leg<span class="token operator">=</span><span class="token boolean">False</span>
  expiration_mode<span class="token operator">=</span><span class="token number">7</span>
  filling_mode<span class="token operator">=</span><span class="token number">1</span>
  order_mode<span class="token operator">=</span><span class="token number">127</span>
  order_gtc_mode<span class="token operator">=</span><span class="token number">0</span>
  option_mode<span class="token operator">=</span><span class="token number">0</span>
  option_right<span class="token operator">=</span><span class="token number">0</span>
  bid<span class="token operator">=</span><span class="token number">1.55192</span>
  bidhigh<span class="token operator">=</span><span class="token number">1.55842</span>
  bidlow<span class="token operator">=</span><span class="token number">1.5419800000000001</span>
  ask<span class="token operator">=</span><span class="token number">1.5523099999999999</span>
  askhigh<span class="token operator">=</span><span class="token number">1.55915</span>
  asklow<span class="token operator">=</span><span class="token number">1.5436299999999998</span>
  last<span class="token operator">=</span><span class="token number">0.0</span>
  lasthigh<span class="token operator">=</span><span class="token number">0.0</span>
  lastlow<span class="token operator">=</span><span class="token number">0.0</span>
  volume_real<span class="token operator">=</span><span class="token number">0.0</span>
  volumehigh_real<span class="token operator">=</span><span class="token number">0.0</span>
  volumelow_real<span class="token operator">=</span><span class="token number">0.0</span>
  option_strike<span class="token operator">=</span><span class="token number">0.0</span>
  point<span class="token operator">=</span><span class="token number">1e-05</span>
  trade_tick_value<span class="token operator">=</span><span class="token number">0.7043642408362214</span>
  trade_tick_value_profit<span class="token operator">=</span><span class="token number">0.7043642408362214</span>
  trade_tick_value_loss<span class="token operator">=</span><span class="token number">0.7044535553770941</span>
  trade_tick_size<span class="token operator">=</span><span class="token number">1e-05</span>
  trade_contract_size<span class="token operator">=</span><span class="token number">100000.0</span>
  trade_accrued_interest<span class="token operator">=</span><span class="token number">0.0</span>
  trade_face_value<span class="token operator">=</span><span class="token number">0.0</span>
  trade_liquidity_rate<span class="token operator">=</span><span class="token number">0.0</span>
  volume_min<span class="token operator">=</span><span class="token number">0.01</span>
  volume_max<span class="token operator">=</span><span class="token number">500.0</span>
  volume_step<span class="token operator">=</span><span class="token number">0.01</span>
  volume_limit<span class="token operator">=</span><span class="token number">0.0</span>
  swap_long<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1.1</span>
  swap_short<span class="token operator">=</span><span class="token operator">-</span><span class="token number">0.9</span>
  margin_initial<span class="token operator">=</span><span class="token number">0.0</span>
  margin_maintenance<span class="token operator">=</span><span class="token number">0.0</span>
  session_volume<span class="token operator">=</span><span class="token number">0.0</span>
  session_turnover<span class="token operator">=</span><span class="token number">0.0</span>
  session_interest<span class="token operator">=</span><span class="token number">0.0</span>
  session_buy_orders_volume<span class="token operator">=</span><span class="token number">0.0</span>
  session_sell_orders_volume<span class="token operator">=</span><span class="token number">0.0</span>
  session_open<span class="token operator">=</span><span class="token number">0.0</span>
  session_close<span class="token operator">=</span><span class="token number">0.0</span>
  session_aw<span class="token operator">=</span><span class="token number">0.0</span>
  session_price_settlement<span class="token operator">=</span><span class="token number">0.0</span>
  session_price_limit_min<span class="token operator">=</span><span class="token number">0.0</span>
  session_price_limit_max<span class="token operator">=</span><span class="token number">0.0</span>
  margin_hedged<span class="token operator">=</span><span class="token number">100000.0</span>
  price_change<span class="token operator">=</span><span class="token number">0.0</span>
  price_volatility<span class="token operator">=</span><span class="token number">0.0</span>
  price_theoretical<span class="token operator">=</span><span class="token number">0.0</span>
  price_greeks_delta<span class="token operator">=</span><span class="token number">0.0</span>
  price_greeks_theta<span class="token operator">=</span><span class="token number">0.0</span>
  price_greeks_gamma<span class="token operator">=</span><span class="token number">0.0</span>
  price_greeks_vega<span class="token operator">=</span><span class="token number">0.0</span>
  price_greeks_rho<span class="token operator">=</span><span class="token number">0.0</span>
  price_greeks_omega<span class="token operator">=</span><span class="token number">0.0</span>
  price_sensitivity<span class="token operator">=</span><span class="token number">0.0</span>
  basis<span class="token operator">=</span>
  category<span class="token operator">=</span>
  currency_base<span class="token operator">=</span>EUR
  currency_profit<span class="token operator">=</span>CAD
  currency_margin<span class="token operator">=</span>EUR
  bank<span class="token operator">=</span>
  description<span class="token operator">=</span>Euro vs Canadian Dollar
  exchange<span class="token operator">=</span>
  formula<span class="token operator">=</span>
  isin<span class="token operator">=</span>
  name<span class="token operator">=</span>EURCAD
  page<span class="token operator">=</span>http<span class="token punctuation">:</span><span class="token operator">//</span>www<span class="token punctuation">.</span>google<span class="token punctuation">.</span>com<span class="token operator">/</span>finance?q<span class="token operator">=</span>EURCAD
  path<span class="token operator">=</span>Forex\EURCAD
 
symbol_info_dict<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> dataframe<span class="token punctuation">:</span>
         <span class="token builtin">property</span>                                   value
<span class="token number">0</span>          custom                                   <span class="token boolean">False</span>
<span class="token number">1</span>      chart_mode                                       <span class="token number">0</span>
<span class="token number">2</span>          select                                    <span class="token boolean">True</span>
<span class="token number">3</span>         visible                                    <span class="token boolean">True</span>
<span class="token number">4</span>   session_deals                                       <span class="token number">0</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span>            <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>                                     <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token number">91</span>        formula                                        
<span class="token number">92</span>           isin                                        
<span class="token number">93</span>           name                                  EURCAD
<span class="token number">94</span>           page  http<span class="token punctuation">:</span><span class="token operator">//</span>www<span class="token punctuation">.</span>google<span class="token punctuation">.</span>com<span class="token operator">/</span>finance?q<span class="token operator">=</span>EURCAD
<span class="token number">95</span>           path                            Forex\EURCAD
 
<span class="token punctuation">[</span><span class="token number">96</span> rows x <span class="token number">2</span> columns<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br></div></div><p>另见</p> <p>symbol_info</p> <h3 id="_32-1-13-market-book-add"><a href="#_32-1-13-market-book-add" class="header-anchor">#</a> 32.1.13 market_book_add</h3> <p>订阅MetaTrader 5程序端的指定交易品种的市场深度更改事件。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>market_book_add(
   symbol      // 交易品种名称
)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>交易品种</p> <p>[in]  交易品种名称。所需的未命名参数。</p> <p>返回值</p> <p>如果成功返回true，否则–false。</p> <p>注意</p> <p>该函数类似于MarketBookAdd。</p> <p>另见</p> <p>market_book_get，market_book_release，市场深度结构</p> <h3 id="_32-1-14-market-book-get"><a href="#_32-1-14-market-book-get" class="header-anchor">#</a> 32.1.14 market_book_get</h3> <p>从BookInfo返回一个元组，其中包含指定交易品种的市场深度条目。</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>market_book_get<span class="token punctuation">(</span>
   symbol      <span class="token operator">//</span> 交易品种名称
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>交易品种</p> <p>[in]  交易品种名称。所需的未命名参数。</p> <p>返回值</p> <p>从BookInfo条目中以元组形式返回市场深度内容，其中包含订单类型、价格和手数交易量。BookInfo类似于MqlBookInfo结构。</p> <p>错误情况下返回None。可使用last_error()获取错误信息。</p> <p>注意</p> <p>应使用market_book_add()函数预先执行订阅市场深度更改事件。</p> <p>该函数类似于MarketBookGet。</p> <p>例如：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> MetaTrader5 <span class="token keyword">as</span> mt5
<span class="token keyword">import</span> time
<span class="token comment"># 显示有关MetaTrader 5程序包的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package author: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__author__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package version: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
 
<span class="token comment"># 建立与MetaTrader 5程序端的连接</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> mt5<span class="token punctuation">.</span>initialize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;initialize() failed, error code =&quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   <span class="token comment"># 断开与MetaTrader 5程序端的连接</span>
    mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
    quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 订阅EURUSD（市场深度）的市场深度更新</span>
<span class="token keyword">if</span> mt5<span class="token punctuation">.</span>market_book_add<span class="token punctuation">(</span><span class="token string">'EURUSD'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token comment"># 循环获取10次市场深度数据</span>
   <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 获取市场深度内容（市场深度）</span>
        items <span class="token operator">=</span> mt5<span class="token punctuation">.</span>market_book_get<span class="token punctuation">(</span><span class="token string">'EURUSD'</span><span class="token punctuation">)</span>
        <span class="token comment"># 以单个字符串'as is'（保持原来状态）显示整个市场深度</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>items<span class="token punctuation">)</span>
        <span class="token comment"># 现在为了更加清晰而分别显示每个订单</span>
        <span class="token keyword">if</span> items<span class="token punctuation">:</span>
            <span class="token keyword">for</span> it <span class="token keyword">in</span> items<span class="token punctuation">:</span>
                <span class="token comment"># order content</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span>_asdict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment"># 暂停5秒后再请求下一个市场深度数据</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
  <span class="token comment"># 取消订阅市场深度更新（市场深度）</span>
   mt5<span class="token punctuation">.</span>market_book_release<span class="token punctuation">(</span><span class="token string">'EURUSD'</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;mt5.market_book_add('EURUSD') failed, error code =&quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 
<span class="token comment"># 断开与MetaTrader 5程序端的连接</span>
mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
 
结果：
MetaTrader5程序包作者：MetaQuotes Software Corp<span class="token punctuation">.</span>
MetaTrader5程序包版本：<span class="token number">5.0</span><span class="token number">.34</span>
 
<span class="token punctuation">(</span>BookInfo<span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> price<span class="token operator">=</span><span class="token number">1.20038</span><span class="token punctuation">,</span> volume<span class="token operator">=</span><span class="token number">250</span><span class="token punctuation">,</span> volume_dbl<span class="token operator">=</span><span class="token number">250.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BookInfo<span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> price<span class="token operator">=</span><span class="token number">1.20032</span><span class="token punctuation">,</span> volume<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> volume<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20038</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">250.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20032</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">100.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.2003</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">50.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20028</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">36.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20026</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">36.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20025</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">50.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20023</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">100.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20017</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">250.0</span><span class="token punctuation">}</span>
<span class="token punctuation">(</span>BookInfo<span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> price<span class="token operator">=</span><span class="token number">1.2004299999999999</span><span class="token punctuation">,</span> volume<span class="token operator">=</span><span class="token number">250</span><span class="token punctuation">,</span> volume_dbl<span class="token operator">=</span><span class="token number">250.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BookInfo<span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> price<span class="token operator">=</span><span class="token number">1.20037</span><span class="token punctuation">,</span> volume<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.2004299999999999</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">250.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20037</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">100.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20036</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">50.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20034</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">36.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20031</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">36.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20029</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">50.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20028</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">100.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20022</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">250.0</span><span class="token punctuation">}</span>
<span class="token punctuation">(</span>BookInfo<span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> price<span class="token operator">=</span><span class="token number">1.2004299999999999</span><span class="token punctuation">,</span> volume<span class="token operator">=</span><span class="token number">250</span><span class="token punctuation">,</span> volume_dbl<span class="token operator">=</span><span class="token number">250.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BookInfo<span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> price<span class="token operator">=</span><span class="token number">1.20037</span><span class="token punctuation">,</span> volume<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.2004299999999999</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">250.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20037</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">100.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20036</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">50.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20034</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">36.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20031</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">36.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20029</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">50.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20028</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">100.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20022</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">250.0</span><span class="token punctuation">}</span>
<span class="token punctuation">(</span>BookInfo<span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> price<span class="token operator">=</span><span class="token number">1.20036</span><span class="token punctuation">,</span> volume<span class="token operator">=</span><span class="token number">250</span><span class="token punctuation">,</span> volume_dbl<span class="token operator">=</span><span class="token number">250.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BookInfo<span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> price<span class="token operator">=</span><span class="token number">1.20029</span><span class="token punctuation">,</span> volume<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> volume<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20036</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">250.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20029</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">100.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20028</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">50.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20026</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">36.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20023</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">36.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20022</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">50.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20021</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">100.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20014</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">250.0</span><span class="token punctuation">}</span>
<span class="token punctuation">(</span>BookInfo<span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> price<span class="token operator">=</span><span class="token number">1.20035</span><span class="token punctuation">,</span> volume<span class="token operator">=</span><span class="token number">250</span><span class="token punctuation">,</span> volume_dbl<span class="token operator">=</span><span class="token number">250.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BookInfo<span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> price<span class="token operator">=</span><span class="token number">1.20029</span><span class="token punctuation">,</span> volume<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> volume<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20035</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">250.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20029</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">100.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20027</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">50.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20025</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">36.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20023</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">36.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20022</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">50.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20021</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">100.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20014</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">250.0</span><span class="token punctuation">}</span>
<span class="token punctuation">(</span>BookInfo<span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> price<span class="token operator">=</span><span class="token number">1.20037</span><span class="token punctuation">,</span> volume<span class="token operator">=</span><span class="token number">250</span><span class="token punctuation">,</span> volume_dbl<span class="token operator">=</span><span class="token number">250.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BookInfo<span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> price<span class="token operator">=</span><span class="token number">1.20031</span><span class="token punctuation">,</span> volume<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> volume<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20037</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">250.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20031</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">100.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.2003</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">50.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20028</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">36.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20025</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">36.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20023</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">50.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20022</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">100.0</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">1.20016</span><span class="token punctuation">,</span> <span class="token string">'volume'</span><span class="token punctuation">:</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token string">'volume_dbl'</span><span class="token punctuation">:</span> <span class="token number">250.0</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br></div></div><p>另见</p> <p>market_book_add，market_book_release， 市场深度结构</p> <h3 id="_32-1-15-market-book-release"><a href="#_32-1-15-market-book-release" class="header-anchor">#</a> 32.1.15 market_book_release</h3> <p>取消订阅MetaTrader 5程序端的指定交易品种的市场深度更改事件。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>market_book_release(
   symbol      // 交易品种名称
)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>交易品种</p> <p>[in]  交易品种名称。所需的未命名参数。</p> <p>返回值</p> <p>如果成功返回true，否则–false。</p> <p>注意</p> <p>该函数类似于MarketBookRelease。</p> <p>另见</p> <p>market_book_add，market_book_get，市场深度结构</p> <h3 id="_32-1-16-copy-rates-from"><a href="#_32-1-16-copy-rates-from" class="header-anchor">#</a> 32.1.16 copy_rates_from</h3> <p>从指定日期开始从MetaTrader 5程序端获取柱形图。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>copy_rates_from(
   symbol,       // 交易品种名称
   timeframe,    // 时间周期
   date_from,    // 初始柱形图开盘日期
   count         // 柱形图数
   )
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>参数</p> <p>symbol</p> <p>[in]  交易品种名称，例如&quot;EURUSD&quot;。所需的未命名参数。</p> <p>timeframe</p> <p>[in]  请求柱形图的时间周期。根据TIMEFRAME枚举的值设置。所需的未命名参数。</p> <p>date_from</p> <p>[in]  请求样本中的第一个柱形图的开盘日期。通过'datetime'对象或根据1970.01.01以来过去的秒数设置。所需的未命名参数。</p> <p>count</p> <p>[in]  将要接收的柱形图数。所需的未命名参数。</p> <p>返回值</p> <p>返回numpy数据柱形图（包含以下指定列：时间、开盘价、最高价、最低价、收盘价、tick_volume、点差和real_volume）。错误情况下返回None。可使用last_error()获取错误信息。</p> <p>注意</p> <p>参见CopyRates()函数获取更多信息。</p> <p>MetaTrader 5程序端仅在用户可用的图表历史记录中提供柱形图。可供用户使用的柱形图数量设置在“图表中最大数量(Max.)柱形图”参数中。</p> <p>当创建'datetime'对象时，Python使用本地时区，而MetaTrader 5以UTC时区保存报价和柱形图开盘时间（没有时移）。 因此，'datetime'应在UTC时间内创建，用于执行使用时间的函数。从MetaTrader 5程序端接收到的数据使用UTC时间。</p> <p>TIMEFRAME 是一个包含可能图表周期值的枚举</p> <table><thead><tr><th>ID</th> <th>描述</th></tr></thead> <tbody><tr><td>TIMEFRAME_M1</td> <td>1分钟</td></tr> <tr><td>TIMEFRAME_M2</td> <td>2 分钟</td></tr> <tr><td>TIMEFRAME_M3</td> <td>3 分钟</td></tr> <tr><td>TIMEFRAME_M4</td> <td>4 分钟</td></tr> <tr><td>TIMEFRAME_M5</td> <td>5 分钟</td></tr> <tr><td>TIMEFRAME_M6</td> <td>6 分钟</td></tr> <tr><td>TIMEFRAME_M10</td> <td>10 分钟</td></tr> <tr><td>TIMEFRAME_M12</td> <td>12 分钟</td></tr> <tr><td>TIMEFRAME_M12</td> <td>15 分钟</td></tr> <tr><td>TIMEFRAME_M20</td> <td>20 分钟</td></tr> <tr><td>TIMEFRAME_M30</td> <td>30 分钟</td></tr> <tr><td>TIMEFRAME_H1</td> <td>1 小时</td></tr> <tr><td>TIMEFRAME_H2</td> <td>2 小时</td></tr> <tr><td>TIMEFRAME_H3</td> <td>3 小时</td></tr> <tr><td>TIMEFRAME_H4</td> <td>4 小时</td></tr> <tr><td>TIMEFRAME_H6</td> <td>6 小时</td></tr> <tr><td>TIMEFRAME_H8</td> <td>8 小时</td></tr> <tr><td>TIMEFRAME_H12</td> <td>12 小时</td></tr> <tr><td>TIMEFRAME_D1</td> <td>1 天</td></tr> <tr><td>TIMEFRAME_W1</td> <td>1 周</td></tr> <tr><td>TIMEFRAME_MN1</td> <td>1 个月</td></tr></tbody></table> <p>例如：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
<span class="token keyword">import</span> MetaTrader5 <span class="token keyword">as</span> mt5
<span class="token comment"># 显示有关MetaTrader 5程序包的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package author: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__author__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package version: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
 
<span class="token comment"># 导入'pandas'模块，用于以表格形式显示获得的数据</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'display.max_columns'</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span> <span class="token comment"># number of columns to be displayed</span>
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'display.width'</span><span class="token punctuation">,</span> <span class="token number">1500</span><span class="token punctuation">)</span>      <span class="token comment"># max table width to display</span>
<span class="token comment"># 导入用于处理时区的pytz模块</span>
<span class="token keyword">import</span> pytz
 
<span class="token comment"># 建立与MetaTrader 5程序端的连接</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> mt5<span class="token punctuation">.</span>initialize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;initialize() failed, error code =&quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 将时区设置为UTC</span>
timezone <span class="token operator">=</span> pytz<span class="token punctuation">.</span>timezone<span class="token punctuation">(</span><span class="token string">&quot;Etc/UTC&quot;</span><span class="token punctuation">)</span>
<span class="token comment"># 以UTC时区创建'datetime'对象，以避免实现本地时区偏移</span>
utc_from <span class="token operator">=</span> datetime<span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> tzinfo<span class="token operator">=</span>timezone<span class="token punctuation">)</span>
<span class="token comment"># 在UTC时区，获取01.10.2020开始的10个EURUSD H4柱形图</span>
rates <span class="token operator">=</span> mt5<span class="token punctuation">.</span>copy_rates_from<span class="token punctuation">(</span><span class="token string">&quot;EURUSD&quot;</span><span class="token punctuation">,</span> mt5<span class="token punctuation">.</span>TIMEFRAME_H4<span class="token punctuation">,</span> utc_from<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
 
<span class="token comment"># 断开与MetaTrader 5程序端的连接</span>
mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 在新行显示所获得数据的每个元素</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Display obtained data 'as is'&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> rate <span class="token keyword">in</span> rates<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>rate<span class="token punctuation">)</span>
 
<span class="token comment"># 从所获得的数据创建DataFrame</span>
rates_frame <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>rates<span class="token punctuation">)</span>
<span class="token comment"># 将时间（以秒为单位）转换为日期时间格式</span>
rates_frame<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span><span class="token operator">=</span>pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>rates_frame<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> unit<span class="token operator">=</span><span class="token string">'s'</span><span class="token punctuation">)</span>
                           
<span class="token comment"># 显示数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\nDisplay dataframe with data&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>rates_frame<span class="token punctuation">)</span>  
 
 
结果：
MetaTrader5程序包作者：MetaQuotes Software Corp<span class="token punctuation">.</span>
MetaTrader5程序包版本：<span class="token number">5.0</span><span class="token number">.29</span>
 
将获得的数据显示为“保持原来状态”
<span class="token punctuation">(</span><span class="token number">1578484800</span><span class="token punctuation">,</span> <span class="token number">1.11382</span><span class="token punctuation">,</span> <span class="token number">1.11385</span><span class="token punctuation">,</span> <span class="token number">1.1111</span><span class="token punctuation">,</span> <span class="token number">1.11199</span><span class="token punctuation">,</span> <span class="token number">9354</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1578499200</span><span class="token punctuation">,</span> <span class="token number">1.11199</span><span class="token punctuation">,</span> <span class="token number">1.11308</span><span class="token punctuation">,</span> <span class="token number">1.11086</span><span class="token punctuation">,</span> <span class="token number">1.11179</span><span class="token punctuation">,</span> <span class="token number">10641</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1578513600</span><span class="token punctuation">,</span> <span class="token number">1.11178</span><span class="token punctuation">,</span> <span class="token number">1.11178</span><span class="token punctuation">,</span> <span class="token number">1.11016</span><span class="token punctuation">,</span> <span class="token number">1.11053</span><span class="token punctuation">,</span> <span class="token number">4806</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1578528000</span><span class="token punctuation">,</span> <span class="token number">1.11053</span><span class="token punctuation">,</span> <span class="token number">1.11193</span><span class="token punctuation">,</span> <span class="token number">1.11033</span><span class="token punctuation">,</span> <span class="token number">1.11173</span><span class="token punctuation">,</span> <span class="token number">3480</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1578542400</span><span class="token punctuation">,</span> <span class="token number">1.11173</span><span class="token punctuation">,</span> <span class="token number">1.11189</span><span class="token punctuation">,</span> <span class="token number">1.11126</span><span class="token punctuation">,</span> <span class="token number">1.11182</span><span class="token punctuation">,</span> <span class="token number">2236</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1578556800</span><span class="token punctuation">,</span> <span class="token number">1.11181</span><span class="token punctuation">,</span> <span class="token number">1.11203</span><span class="token punctuation">,</span> <span class="token number">1.10983</span><span class="token punctuation">,</span> <span class="token number">1.10993</span><span class="token punctuation">,</span> <span class="token number">7984</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1578571200</span><span class="token punctuation">,</span> <span class="token number">1.10994</span><span class="token punctuation">,</span> <span class="token number">1.11173</span><span class="token punctuation">,</span> <span class="token number">1.10965</span><span class="token punctuation">,</span> <span class="token number">1.11148</span><span class="token punctuation">,</span> <span class="token number">7406</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1578585600</span><span class="token punctuation">,</span> <span class="token number">1.11149</span><span class="token punctuation">,</span> <span class="token number">1.11149</span><span class="token punctuation">,</span> <span class="token number">1.10923</span><span class="token punctuation">,</span> <span class="token number">1.11046</span><span class="token punctuation">,</span> <span class="token number">7468</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1578600000</span><span class="token punctuation">,</span> <span class="token number">1.11046</span><span class="token punctuation">,</span> <span class="token number">1.11097</span><span class="token punctuation">,</span> <span class="token number">1.11033</span><span class="token punctuation">,</span> <span class="token number">1.11051</span><span class="token punctuation">,</span> <span class="token number">3450</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1578614400</span><span class="token punctuation">,</span> <span class="token number">1.11051</span><span class="token punctuation">,</span> <span class="token number">1.11093</span><span class="token punctuation">,</span> <span class="token number">1.11017</span><span class="token punctuation">,</span> <span class="token number">1.11041</span><span class="token punctuation">,</span> <span class="token number">2448</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
 
显示带有数据的数据框
                 time     <span class="token builtin">open</span>     high      low    close  tick_volume  spread  real_volume
<span class="token number">0</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">08</span> <span class="token number">12</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span>  <span class="token number">1.11382</span>  <span class="token number">1.11385</span>  <span class="token number">1.11110</span>  <span class="token number">1.11199</span>         <span class="token number">9354</span>       <span class="token number">1</span>            <span class="token number">0</span>
<span class="token number">1</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">08</span> <span class="token number">16</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span>  <span class="token number">1.11199</span>  <span class="token number">1.11308</span>  <span class="token number">1.11086</span>  <span class="token number">1.11179</span>        <span class="token number">10641</span>       <span class="token number">1</span>            <span class="token number">0</span>
<span class="token number">2</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">08</span> <span class="token number">20</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span>  <span class="token number">1.11178</span>  <span class="token number">1.11178</span>  <span class="token number">1.11016</span>  <span class="token number">1.11053</span>         <span class="token number">4806</span>       <span class="token number">1</span>            <span class="token number">0</span>
<span class="token number">3</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">09</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span>  <span class="token number">1.11053</span>  <span class="token number">1.11193</span>  <span class="token number">1.11033</span>  <span class="token number">1.11173</span>         <span class="token number">3480</span>       <span class="token number">1</span>            <span class="token number">0</span>
<span class="token number">4</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">09</span> <span class="token number">04</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span>  <span class="token number">1.11173</span>  <span class="token number">1.11189</span>  <span class="token number">1.11126</span>  <span class="token number">1.11182</span>         <span class="token number">2236</span>       <span class="token number">1</span>            <span class="token number">0</span>
<span class="token number">5</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">09</span> <span class="token number">08</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span>  <span class="token number">1.11181</span>  <span class="token number">1.11203</span>  <span class="token number">1.10983</span>  <span class="token number">1.10993</span>         <span class="token number">7984</span>       <span class="token number">1</span>            <span class="token number">0</span>
<span class="token number">6</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">09</span> <span class="token number">12</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span>  <span class="token number">1.10994</span>  <span class="token number">1.11173</span>  <span class="token number">1.10965</span>  <span class="token number">1.11148</span>         <span class="token number">7406</span>       <span class="token number">1</span>            <span class="token number">0</span>
<span class="token number">7</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">09</span> <span class="token number">16</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span>  <span class="token number">1.11149</span>  <span class="token number">1.11149</span>  <span class="token number">1.10923</span>  <span class="token number">1.11046</span>         <span class="token number">7468</span>       <span class="token number">1</span>            <span class="token number">0</span>
<span class="token number">8</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">09</span> <span class="token number">20</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span>  <span class="token number">1.11046</span>  <span class="token number">1.11097</span>  <span class="token number">1.11033</span>  <span class="token number">1.11051</span>         <span class="token number">3450</span>       <span class="token number">1</span>            <span class="token number">0</span>
<span class="token number">9</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">10</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span>  <span class="token number">1.11051</span>  <span class="token number">1.11093</span>  <span class="token number">1.11017</span>  <span class="token number">1.11041</span>         <span class="token number">2448</span>       <span class="token number">1</span>            <span class="token number">0</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br></div></div><p>另见</p> <p>CopyRates、copy_rates_from_pos、 copy_rates_range、copy_ticks_from、 copy_ticks_range</p> <h3 id="_32-1-17-copy-rates-from-pos"><a href="#_32-1-17-copy-rates-from-pos" class="header-anchor">#</a> 32.1.17  copy_rates_from_pos</h3> <p>从指定索引开始从MetaTrader 5程序端获取柱形图。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>copy_rates_from_pos(
   symbol,       // 交易品种名称
   timeframe,    // 时间周期
   start_pos,    //初始柱形图索引
   count         // 柱形图数
   )
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>参数</p> <p>symbol</p> <p>[in]  交易品种名称，例如&quot;EURUSD&quot;。所需的未命名参数。</p> <p>timeframe</p> <p>[in]  请求柱形图的时间周期。根据TIMEFRAME枚举的值设置。所需的未命名参数。</p> <p>start_pos</p> <p>[in]  请求数据的初始柱形图索引。柱形图变化从现在到过去。因此，零柱形图意味着当前柱形图。所需的未命名参数。</p> <p>count</p> <p>[in]  将要接收的柱形图数。所需的未命名参数。</p> <p>返回值</p> <p>返回numpy数据柱形图（包含以下指定列：时间、开盘价、最高价、最低价、收盘价、tick_volume、点差和real_volume）。错误情况下返回None。可使用last_error()获取错误信息。</p> <p>注意</p> <p>参见CopyRates()函数获取更多信息。</p> <p>MetaTrader 5程序端仅在用户可用的图表历史记录中提供柱形图。可供用户使用的柱形图数量设置在“图表中最大数量(Max.)柱形图”参数中。</p> <p>例如：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
<span class="token keyword">import</span> MetaTrader5 <span class="token keyword">as</span> mt5
<span class="token comment"># 显示有关MetaTrader 5程序包的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package author: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__author__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package version: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
 
<span class="token comment"># 导入'pandas'模块，用于以表格形式显示获得的数据</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'display.max_columns'</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span> <span class="token comment"># number of columns to be displayed</span>
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'display.width'</span><span class="token punctuation">,</span> <span class="token number">1500</span><span class="token punctuation">)</span>      <span class="token comment"># max table width to display</span>
 
<span class="token comment"># 建立与MetaTrader 5程序端的连接</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> mt5<span class="token punctuation">.</span>initialize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;initialize() failed, error code =&quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 从当日获取10个GBPUSD D1柱形图</span>
rates <span class="token operator">=</span> mt5<span class="token punctuation">.</span>copy_rates_from_pos<span class="token punctuation">(</span><span class="token string">&quot;GBPUSD&quot;</span><span class="token punctuation">,</span> mt5<span class="token punctuation">.</span>TIMEFRAME_D1<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
 
<span class="token comment"># 断开与MetaTrader 5程序端的连接</span>
mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 在新行显示所获得数据的每个元素</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Display obtained data 'as is'&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> rate <span class="token keyword">in</span> rates<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>rate<span class="token punctuation">)</span>
 
<span class="token comment"># 从所获得的数据创建DataFrame</span>
rates_frame <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>rates<span class="token punctuation">)</span>
<span class="token comment"># 将时间（以秒为单位）转换为日期时间格式</span>
rates_frame<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span><span class="token operator">=</span>pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>rates_frame<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> unit<span class="token operator">=</span><span class="token string">'s'</span><span class="token punctuation">)</span>
 
<span class="token comment"># 显示数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\nDisplay dataframe with data&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>rates_frame<span class="token punctuation">)</span> 
 
结果：
MetaTrader5程序包作者：MetaQuotes Software Corp<span class="token punctuation">.</span>
MetaTrader5程序包版本：<span class="token number">5.0</span><span class="token number">.29</span>
 
将获得的数据显示为“保持原来状态”
<span class="token punctuation">(</span><span class="token number">1581552000</span><span class="token punctuation">,</span> <span class="token number">1.29568</span><span class="token punctuation">,</span> <span class="token number">1.30692</span><span class="token punctuation">,</span> <span class="token number">1.29441</span><span class="token punctuation">,</span> <span class="token number">1.30412</span><span class="token punctuation">,</span> <span class="token number">68228</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1581638400</span><span class="token punctuation">,</span> <span class="token number">1.30385</span><span class="token punctuation">,</span> <span class="token number">1.30631</span><span class="token punctuation">,</span> <span class="token number">1.3001</span><span class="token punctuation">,</span> <span class="token number">1.30471</span><span class="token punctuation">,</span> <span class="token number">56498</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1581897600</span><span class="token punctuation">,</span> <span class="token number">1.30324</span><span class="token punctuation">,</span> <span class="token number">1.30536</span><span class="token punctuation">,</span> <span class="token number">1.29975</span><span class="token punctuation">,</span> <span class="token number">1.30039</span><span class="token punctuation">,</span> <span class="token number">49400</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1581984000</span><span class="token punctuation">,</span> <span class="token number">1.30039</span><span class="token punctuation">,</span> <span class="token number">1.30486</span><span class="token punctuation">,</span> <span class="token number">1.29705</span><span class="token punctuation">,</span> <span class="token number">1.29952</span><span class="token punctuation">,</span> <span class="token number">62288</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1582070400</span><span class="token punctuation">,</span> <span class="token number">1.29952</span><span class="token punctuation">,</span> <span class="token number">1.3023</span><span class="token punctuation">,</span> <span class="token number">1.29075</span><span class="token punctuation">,</span> <span class="token number">1.29187</span><span class="token punctuation">,</span> <span class="token number">57909</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1582156800</span><span class="token punctuation">,</span> <span class="token number">1.29186</span><span class="token punctuation">,</span> <span class="token number">1.29281</span><span class="token punctuation">,</span> <span class="token number">1.28489</span><span class="token punctuation">,</span> <span class="token number">1.28792</span><span class="token punctuation">,</span> <span class="token number">61033</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1582243200</span><span class="token punctuation">,</span> <span class="token number">1.28802</span><span class="token punctuation">,</span> <span class="token number">1.29805</span><span class="token punctuation">,</span> <span class="token number">1.28746</span><span class="token punctuation">,</span> <span class="token number">1.29566</span><span class="token punctuation">,</span> <span class="token number">66386</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1582502400</span><span class="token punctuation">,</span> <span class="token number">1.29426</span><span class="token punctuation">,</span> <span class="token number">1.29547</span><span class="token punctuation">,</span> <span class="token number">1.28865</span><span class="token punctuation">,</span> <span class="token number">1.29283</span><span class="token punctuation">,</span> <span class="token number">66933</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1582588800</span><span class="token punctuation">,</span> <span class="token number">1.2929</span><span class="token punctuation">,</span> <span class="token number">1.30178</span><span class="token punctuation">,</span> <span class="token number">1.29142</span><span class="token punctuation">,</span> <span class="token number">1.30037</span><span class="token punctuation">,</span> <span class="token number">80121</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1582675200</span><span class="token punctuation">,</span> <span class="token number">1.30036</span><span class="token punctuation">,</span> <span class="token number">1.30078</span><span class="token punctuation">,</span> <span class="token number">1.29136</span><span class="token punctuation">,</span> <span class="token number">1.29374</span><span class="token punctuation">,</span> <span class="token number">49286</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
 
显示带有数据的数据框
        time     <span class="token builtin">open</span>     high      low    close  tick_volume  spread  real_volume
<span class="token number">0</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">13</span>  <span class="token number">1.29568</span>  <span class="token number">1.30692</span>  <span class="token number">1.29441</span>  <span class="token number">1.30412</span>        <span class="token number">68228</span>       <span class="token number">0</span>            <span class="token number">0</span>
<span class="token number">1</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">14</span>  <span class="token number">1.30385</span>  <span class="token number">1.30631</span>  <span class="token number">1.30010</span>  <span class="token number">1.30471</span>        <span class="token number">56498</span>       <span class="token number">0</span>            <span class="token number">0</span>
<span class="token number">2</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">17</span>  <span class="token number">1.30324</span>  <span class="token number">1.30536</span>  <span class="token number">1.29975</span>  <span class="token number">1.30039</span>        <span class="token number">49400</span>       <span class="token number">0</span>            <span class="token number">0</span>
<span class="token number">3</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">18</span>  <span class="token number">1.30039</span>  <span class="token number">1.30486</span>  <span class="token number">1.29705</span>  <span class="token number">1.29952</span>        <span class="token number">62288</span>       <span class="token number">0</span>            <span class="token number">0</span>
<span class="token number">4</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">19</span>  <span class="token number">1.29952</span>  <span class="token number">1.30230</span>  <span class="token number">1.29075</span>  <span class="token number">1.29187</span>        <span class="token number">57909</span>       <span class="token number">0</span>            <span class="token number">0</span>
<span class="token number">5</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">20</span>  <span class="token number">1.29186</span>  <span class="token number">1.29281</span>  <span class="token number">1.28489</span>  <span class="token number">1.28792</span>        <span class="token number">61033</span>       <span class="token number">0</span>            <span class="token number">0</span>
<span class="token number">6</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">21</span>  <span class="token number">1.28802</span>  <span class="token number">1.29805</span>  <span class="token number">1.28746</span>  <span class="token number">1.29566</span>        <span class="token number">66386</span>       <span class="token number">0</span>            <span class="token number">0</span>
<span class="token number">7</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">24</span>  <span class="token number">1.29426</span>  <span class="token number">1.29547</span>  <span class="token number">1.28865</span>  <span class="token number">1.29283</span>        <span class="token number">66933</span>       <span class="token number">0</span>            <span class="token number">0</span>
<span class="token number">8</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">25</span>  <span class="token number">1.29290</span>  <span class="token number">1.30178</span>  <span class="token number">1.29142</span>  <span class="token number">1.30037</span>        <span class="token number">80121</span>       <span class="token number">0</span>            <span class="token number">0</span>
<span class="token number">9</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">26</span>  <span class="token number">1.30036</span>  <span class="token number">1.30078</span>  <span class="token number">1.29136</span>  <span class="token number">1.29374</span>        <span class="token number">49286</span>       <span class="token number">0</span>            <span class="token number">0</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br></div></div><p>另见</p> <p>CopyRates、copy_rates_from、 copy_rates_range、copy_ticks_from、 copy_ticks_range</p> <h3 id="_32-1-18-copy-rates-range"><a href="#_32-1-18-copy-rates-range" class="header-anchor">#</a> 32.1.18 copy_rates_range</h3> <p>从MetaTrader 5程序端获取指定日期范围内的柱形图。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>copy_rates_range(
   symbol,       // 交易品种名称
   timeframe,    // 时间周期
   date_from,    // 请求柱形图的开始日期
   date_to       // 请求柱形图的结束日期
   )
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>参数</p> <p>symbol</p> <p>[in]  交易品种名称，例如&quot;EURUSD&quot;。所需的未命名参数。</p> <p>timeframe</p> <p>[in]  请求柱形图的时间周期。根据TIMEFRAME枚举的值设置。所需的未命名参数。</p> <p>date_from</p> <p>[in]  请求柱形图的开始日期。通过'datetime'对象或根据1970.01.01以来过去的秒数设置。包括开盘时间的柱形图 &gt;= 返回date_from。所需的未命名参数。</p> <p>date_to</p> <p>[in]  请求柱形图的结束日期。通过'datetime'对象或根据1970.01.01以来过去的秒数设置。包括开盘时间的柱形图 &lt;= 返回date_to。所需的未命名参数。</p> <p>返回值</p> <p>返回numpy数据柱形图（包含以下指定列：时间、开盘价、最高价、最低价、收盘价、tick_volume、点差和real_volume）。错误情况下返回None。可使用last_error()获取错误信息。</p> <p>注意</p> <p>参见CopyRates()函数获取更多信息。</p> <p>MetaTrader 5程序端仅在用户可用的图表历史记录中提供柱形图。可供用户使用的柱形图数量设置在“图表中最大数量(Max.)柱形图”参数中。</p> <p>当创建'datetime'对象时，Python使用本地时区，而MetaTrader 5以UTC时区保存报价和柱形图开盘时间（没有时移）。 因此，'datetime'应在UTC时间内创建，用于执行使用时间的函数。从MetaTrader 5程序端接收到的数据使用UTC时间。</p> <p>例如：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
<span class="token keyword">import</span> MetaTrader5 <span class="token keyword">as</span> mt5
<span class="token comment"># 显示有关MetaTrader 5程序包的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package author: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__author__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package version: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
 
<span class="token comment"># import the 'pandas' module for displaying data obtained in the tabular form</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'display.max_columns'</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span> <span class="token comment"># number of columns to be displayed</span>
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'display.width'</span><span class="token punctuation">,</span> <span class="token number">1500</span><span class="token punctuation">)</span>      <span class="token comment"># max table width to display</span>
<span class="token comment"># import pytz module for working with time zone</span>
<span class="token keyword">import</span> pytz
 
<span class="token comment"># 建立与MetaTrader 5程序端的连接</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> mt5<span class="token punctuation">.</span>initialize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;initialize() failed, error code =&quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># set time zone to UTC</span>
timezone <span class="token operator">=</span> pytz<span class="token punctuation">.</span>timezone<span class="token punctuation">(</span><span class="token string">&quot;Etc/UTC&quot;</span><span class="token punctuation">)</span>
<span class="token comment"># create 'datetime' objects in UTC time zone to avoid the implementation of a local time zone offset</span>
utc_from <span class="token operator">=</span> datetime<span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> tzinfo<span class="token operator">=</span>timezone<span class="token punctuation">)</span>
utc_to <span class="token operator">=</span> datetime<span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> hour <span class="token operator">=</span> <span class="token number">13</span><span class="token punctuation">,</span> tzinfo<span class="token operator">=</span>timezone<span class="token punctuation">)</span>
<span class="token comment"># get bars from USDJPY M5 within the interval of 2020.01.10 00:00 - 2020.01.11 13:00 in UTC time zone</span>
rates <span class="token operator">=</span> mt5<span class="token punctuation">.</span>copy_rates_range<span class="token punctuation">(</span><span class="token string">&quot;USDJPY&quot;</span><span class="token punctuation">,</span> mt5<span class="token punctuation">.</span>TIMEFRAME_M5<span class="token punctuation">,</span> utc_from<span class="token punctuation">,</span> utc_to<span class="token punctuation">)</span>
 
<span class="token comment"># shut down connection to the MetaTrader 5 terminal</span>
mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># display each element of obtained data in a new line</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Display obtained data 'as is'&quot;</span><span class="token punctuation">)</span>
counter<span class="token operator">=</span><span class="token number">0</span>
<span class="token keyword">for</span> rate <span class="token keyword">in</span> rates<span class="token punctuation">:</span>
    counter<span class="token operator">+=</span><span class="token number">1</span>
    <span class="token keyword">if</span> counter<span class="token operator">&lt;=</span><span class="token number">10</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>rate<span class="token punctuation">)</span>
 
<span class="token comment"># create DataFrame out of the obtained data</span>
rates_frame <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>rates<span class="token punctuation">)</span>
<span class="token comment"># convert time in seconds into the 'datetime' format</span>
rates_frame<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span><span class="token operator">=</span>pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>rates_frame<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> unit<span class="token operator">=</span><span class="token string">'s'</span><span class="token punctuation">)</span>
 
<span class="token comment"># display data</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\nDisplay dataframe with data&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>rates_frame<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 
结果：
MetaTrader5程序包作者：MetaQuotes Software Corp<span class="token punctuation">.</span>
MetaTrader5程序包版本：<span class="token number">5.0</span><span class="token number">.29</span>
 
将获得的数据显示为“保持原来状态”
<span class="token punctuation">(</span><span class="token number">1578614400</span><span class="token punctuation">,</span> <span class="token number">109.513</span><span class="token punctuation">,</span> <span class="token number">109.527</span><span class="token punctuation">,</span> <span class="token number">109.505</span><span class="token punctuation">,</span> <span class="token number">109.521</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1578614700</span><span class="token punctuation">,</span> <span class="token number">109.521</span><span class="token punctuation">,</span> <span class="token number">109.549</span><span class="token punctuation">,</span> <span class="token number">109.518</span><span class="token punctuation">,</span> <span class="token number">109.543</span><span class="token punctuation">,</span> <span class="token number">215</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1578615000</span><span class="token punctuation">,</span> <span class="token number">109.543</span><span class="token punctuation">,</span> <span class="token number">109.543</span><span class="token punctuation">,</span> <span class="token number">109.466</span><span class="token punctuation">,</span> <span class="token number">109.505</span><span class="token punctuation">,</span> <span class="token number">98</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1578615300</span><span class="token punctuation">,</span> <span class="token number">109.504</span><span class="token punctuation">,</span> <span class="token number">109.534</span><span class="token punctuation">,</span> <span class="token number">109.502</span><span class="token punctuation">,</span> <span class="token number">109.517</span><span class="token punctuation">,</span> <span class="token number">155</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1578615600</span><span class="token punctuation">,</span> <span class="token number">109.517</span><span class="token punctuation">,</span> <span class="token number">109.539</span><span class="token punctuation">,</span> <span class="token number">109.513</span><span class="token punctuation">,</span> <span class="token number">109.527</span><span class="token punctuation">,</span> <span class="token number">71</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1578615900</span><span class="token punctuation">,</span> <span class="token number">109.526</span><span class="token punctuation">,</span> <span class="token number">109.537</span><span class="token punctuation">,</span> <span class="token number">109.484</span><span class="token punctuation">,</span> <span class="token number">109.52</span><span class="token punctuation">,</span> <span class="token number">106</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1578616200</span><span class="token punctuation">,</span> <span class="token number">109.52</span><span class="token punctuation">,</span> <span class="token number">109.524</span><span class="token punctuation">,</span> <span class="token number">109.508</span><span class="token punctuation">,</span> <span class="token number">109.51</span><span class="token punctuation">,</span> <span class="token number">205</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1578616500</span><span class="token punctuation">,</span> <span class="token number">109.51</span><span class="token punctuation">,</span> <span class="token number">109.51</span><span class="token punctuation">,</span> <span class="token number">109.491</span><span class="token punctuation">,</span> <span class="token number">109.496</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1578616800</span><span class="token punctuation">,</span> <span class="token number">109.496</span><span class="token punctuation">,</span> <span class="token number">109.509</span><span class="token punctuation">,</span> <span class="token number">109.487</span><span class="token punctuation">,</span> <span class="token number">109.5</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1578617100</span><span class="token punctuation">,</span> <span class="token number">109.5</span><span class="token punctuation">,</span> <span class="token number">109.504</span><span class="token punctuation">,</span> <span class="token number">109.487</span><span class="token punctuation">,</span> <span class="token number">109.489</span><span class="token punctuation">,</span> <span class="token number">82</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
 
显示带有数据的数据框
                 time     <span class="token builtin">open</span>     high      low    close  tick_volume  spread  real_volume
<span class="token number">0</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">10</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span>  <span class="token number">109.513</span>  <span class="token number">109.527</span>  <span class="token number">109.505</span>  <span class="token number">109.521</span>           <span class="token number">43</span>       <span class="token number">2</span>            <span class="token number">0</span>
<span class="token number">1</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">10</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">05</span><span class="token punctuation">:</span><span class="token number">00</span>  <span class="token number">109.521</span>  <span class="token number">109.549</span>  <span class="token number">109.518</span>  <span class="token number">109.543</span>          <span class="token number">215</span>       <span class="token number">8</span>            <span class="token number">0</span>
<span class="token number">2</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">10</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token number">00</span>  <span class="token number">109.543</span>  <span class="token number">109.543</span>  <span class="token number">109.466</span>  <span class="token number">109.505</span>           <span class="token number">98</span>      <span class="token number">10</span>            <span class="token number">0</span>
<span class="token number">3</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">10</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">:</span><span class="token number">00</span>  <span class="token number">109.504</span>  <span class="token number">109.534</span>  <span class="token number">109.502</span>  <span class="token number">109.517</span>          <span class="token number">155</span>       <span class="token number">8</span>            <span class="token number">0</span>
<span class="token number">4</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">10</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">:</span><span class="token number">00</span>  <span class="token number">109.517</span>  <span class="token number">109.539</span>  <span class="token number">109.513</span>  <span class="token number">109.527</span>           <span class="token number">71</span>       <span class="token number">4</span>            <span class="token number">0</span>
<span class="token number">5</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">10</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">25</span><span class="token punctuation">:</span><span class="token number">00</span>  <span class="token number">109.526</span>  <span class="token number">109.537</span>  <span class="token number">109.484</span>  <span class="token number">109.520</span>          <span class="token number">106</span>       <span class="token number">9</span>            <span class="token number">0</span>
<span class="token number">6</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">10</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">30</span><span class="token punctuation">:</span><span class="token number">00</span>  <span class="token number">109.520</span>  <span class="token number">109.524</span>  <span class="token number">109.508</span>  <span class="token number">109.510</span>          <span class="token number">205</span>       <span class="token number">7</span>            <span class="token number">0</span>
<span class="token number">7</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">10</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">35</span><span class="token punctuation">:</span><span class="token number">00</span>  <span class="token number">109.510</span>  <span class="token number">109.510</span>  <span class="token number">109.491</span>  <span class="token number">109.496</span>           <span class="token number">44</span>       <span class="token number">8</span>            <span class="token number">0</span>
<span class="token number">8</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">10</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">40</span><span class="token punctuation">:</span><span class="token number">00</span>  <span class="token number">109.496</span>  <span class="token number">109.509</span>  <span class="token number">109.487</span>  <span class="token number">109.500</span>           <span class="token number">85</span>       <span class="token number">5</span>            <span class="token number">0</span>
<span class="token number">9</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">10</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">45</span><span class="token punctuation">:</span><span class="token number">00</span>  <span class="token number">109.500</span>  <span class="token number">109.504</span>  <span class="token number">109.487</span>  <span class="token number">109.489</span>           <span class="token number">82</span>       <span class="token number">7</span>            <span class="token number">0</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br></div></div><p>另见</p> <p>CopyRates、copy_rates_from、 copy_rates_range、copy_ticks_from、 copy_ticks_range</p> <h3 id="_32-1-19-copy-ticks-from"><a href="#_32-1-19-copy-ticks-from" class="header-anchor">#</a> 32.1.19 copy_ticks_from</h3> <p>从指定日期开始从MetaTrader 5程序端获取报价。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>copy_ticks_from(
   symbol,       // 交易品种名称
   date_from,    // 请求报价的日期
   count,        // 请求的报价数
   flags         // 定义请求报价类型的标识组合
   )
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>参数</p> <p>symbol</p> <p>[in]  交易品种名称，例如&quot;EURUSD&quot;。所需的未命名参数。</p> <p>date_from</p> <p>[in]  请求报价的开始日期。通过'datetime'对象或根据1970.01.01以来过去的秒数设置。所需的未命名参数。</p> <p>count</p> <p>[in]  将要接收的报价数。所需的未命名参数。</p> <p>flags</p> <p>[in]  确定请求报价类型的标记。COPY_TICKS_INFO – 卖价和/或买价变化的报价， COPY_TICKS_TRADE – 最后价和交易量变化的报价， COPY_TICKS_ALL – 全部报价。标识值在COPY_TICKS枚举中描述。所需的未命名参数。</p> <p>返回值</p> <p>返回numpy数据报价（包含以下指定列：时间、卖价、买价、最后价、标识）。'flags'值可以是TICK_FLAG枚举中的标识组合。错误情况下返回None。可使用last_error()获取错误信息。</p> <p>注意</p> <p>参见CopyTicks函数获取更多信息。</p> <p>当创建'datetime'对象时，Python使用本地时区，而MetaTrader 5以UTC时区保存报价和柱形图开盘时间（没有时移）。 因此，'datetime'应在UTC时间内创建，用于执行使用时间的函数。从MetaTrader 5程序端接收到的数据使用UTC时间。</p> <p>COPY_TICKS定义了可以使用copy_ticks_from()和copy_ticks_range()函数请求的报价类型。</p> <table><thead><tr><th>ID</th> <th>描述</th></tr></thead> <tbody><tr><td>COPY_TICKS_ALL</td> <td>所有报价</td></tr> <tr><td>COPY_TICKS_INFO</td> <td>包含卖价（Bid）和/或买价（Ask）价格变化的报价</td></tr> <tr><td>COPY_TICKS_TRADE</td> <td>包含最后价（Last）和/或交易量（Volume）价格变化的报价</td></tr></tbody></table> <p>TICK_FLAG 定义可能的报价标识。这些标识用于描述通过copy_ticks_from()和copy_ticks_range()函数获得的报价。</p> <table><thead><tr><th>ID</th> <th>描述</th></tr></thead> <tbody><tr><td>TICK_FLAG_BID</td> <td>卖价（Bid）已更改</td></tr> <tr><td>TICK_FLAG_ASK</td> <td>买价（Ask）已更改</td></tr> <tr><td>TICK_FLAG_LAST</td> <td>最后价（Last）已更改</td></tr> <tr><td>TICK_FLAG_VOLUME</td> <td>交易量已更改</td></tr> <tr><td>TICK_FLAG_BUY</td> <td>最近“买入”价格已更改</td></tr> <tr><td>TICK_FLAG_SELL</td> <td>最近“卖出”价格已更改</td></tr></tbody></table> <p>例如：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
<span class="token keyword">import</span> MetaTrader5 <span class="token keyword">as</span> mt5
<span class="token comment"># 显示有关MetaTrader 5程序包的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package author: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__author__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package version: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
 
<span class="token comment"># 导入'pandas'模块，用于以表格形式显示获得的数据</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'display.max_columns'</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span> <span class="token comment"># number of columns to be displayed</span>
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'display.width'</span><span class="token punctuation">,</span> <span class="token number">1500</span><span class="token punctuation">)</span>      <span class="token comment"># max table width to display</span>
<span class="token comment"># 导入用于处理时区的pytz模块</span>
<span class="token keyword">import</span> pytz
 
<span class="token comment"># 建立与MetaTrader 5程序端的连接</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> mt5<span class="token punctuation">.</span>initialize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;initialize() failed, error code =&quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># set time zone to UTC</span>
timezone <span class="token operator">=</span> pytz<span class="token punctuation">.</span>timezone<span class="token punctuation">(</span><span class="token string">&quot;Etc/UTC&quot;</span><span class="token punctuation">)</span>
<span class="token comment"># create 'datetime' object in UTC time zone to avoid the implementation of a local time zone offset</span>
utc_from <span class="token operator">=</span> datetime<span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> tzinfo<span class="token operator">=</span>timezone<span class="token punctuation">)</span>
<span class="token comment"># request 100 000 EURUSD ticks starting from 10.01.2019 in UTC time zone</span>
ticks <span class="token operator">=</span> mt5<span class="token punctuation">.</span>copy_ticks_from<span class="token punctuation">(</span><span class="token string">&quot;EURUSD&quot;</span><span class="token punctuation">,</span> utc_from<span class="token punctuation">,</span> <span class="token number">100000</span><span class="token punctuation">,</span> mt5<span class="token punctuation">.</span>COPY_TICKS_ALL<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Ticks received:&quot;</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>ticks<span class="token punctuation">)</span><span class="token punctuation">)</span>
 
<span class="token comment"># shut down connection to the MetaTrader 5 terminal</span>
mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># display data on each tick on a new line</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Display obtained ticks 'as is'&quot;</span><span class="token punctuation">)</span>
count <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">for</span> tick <span class="token keyword">in</span> ticks<span class="token punctuation">:</span>
    count<span class="token operator">+=</span><span class="token number">1</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>tick<span class="token punctuation">)</span>
    <span class="token keyword">if</span> count <span class="token operator">&gt;=</span> <span class="token number">10</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>
 
<span class="token comment"># create DataFrame out of the obtained data</span>
ticks_frame <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>ticks<span class="token punctuation">)</span>
<span class="token comment"># 将时间（以秒为单位）转换为日期时间格式</span>
ticks_frame<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span><span class="token operator">=</span>pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>ticks_frame<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> unit<span class="token operator">=</span><span class="token string">'s'</span><span class="token punctuation">)</span>
 
<span class="token comment"># display data</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\nDisplay dataframe with ticks&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ticks_frame<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  
 
结果：
MetaTrader5程序包作者：MetaQuotes Software Corp<span class="token punctuation">.</span>
MetaTrader5程序包版本：<span class="token number">5.0</span><span class="token number">.29</span>
 
已接收报价：<span class="token number">100000</span>
将获得的报价显示为“保持原来状态”
<span class="token punctuation">(</span><span class="token number">1578614400</span><span class="token punctuation">,</span> <span class="token number">1.11051</span><span class="token punctuation">,</span> <span class="token number">1.11069</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1578614400987</span><span class="token punctuation">,</span> <span class="token number">134</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1578614402</span><span class="token punctuation">,</span> <span class="token number">1.11049</span><span class="token punctuation">,</span> <span class="token number">1.11067</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1578614402025</span><span class="token punctuation">,</span> <span class="token number">134</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1578614404</span><span class="token punctuation">,</span> <span class="token number">1.1105</span><span class="token punctuation">,</span> <span class="token number">1.11066</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1578614404057</span><span class="token punctuation">,</span> <span class="token number">134</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1578614404</span><span class="token punctuation">,</span> <span class="token number">1.11049</span><span class="token punctuation">,</span> <span class="token number">1.11067</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1578614404344</span><span class="token punctuation">,</span> <span class="token number">134</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1578614412</span><span class="token punctuation">,</span> <span class="token number">1.11052</span><span class="token punctuation">,</span> <span class="token number">1.11064</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1578614412106</span><span class="token punctuation">,</span> <span class="token number">134</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1578614418</span><span class="token punctuation">,</span> <span class="token number">1.11039</span><span class="token punctuation">,</span> <span class="token number">1.11051</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1578614418265</span><span class="token punctuation">,</span> <span class="token number">134</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1578614418</span><span class="token punctuation">,</span> <span class="token number">1.1104</span><span class="token punctuation">,</span> <span class="token number">1.1105</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1578614418905</span><span class="token punctuation">,</span> <span class="token number">134</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1578614419</span><span class="token punctuation">,</span> <span class="token number">1.11039</span><span class="token punctuation">,</span> <span class="token number">1.11051</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1578614419519</span><span class="token punctuation">,</span> <span class="token number">134</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1578614456</span><span class="token punctuation">,</span> <span class="token number">1.11037</span><span class="token punctuation">,</span> <span class="token number">1.11065</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1578614456011</span><span class="token punctuation">,</span> <span class="token number">134</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1578614456</span><span class="token punctuation">,</span> <span class="token number">1.11039</span><span class="token punctuation">,</span> <span class="token number">1.11051</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1578614456015</span><span class="token punctuation">,</span> <span class="token number">134</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">)</span>
 
显示带有报价的数据框
                 time      bid      ask  last  volume       time_msc  flags  volume_real
<span class="token number">0</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">10</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span>  <span class="token number">1.11051</span>  <span class="token number">1.11069</span>   <span class="token number">0.0</span>       <span class="token number">0</span>  <span class="token number">1578614400987</span>    <span class="token number">134</span>          <span class="token number">0.0</span>
<span class="token number">1</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">10</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">02</span>  <span class="token number">1.11049</span>  <span class="token number">1.11067</span>   <span class="token number">0.0</span>       <span class="token number">0</span>  <span class="token number">1578614402025</span>    <span class="token number">134</span>          <span class="token number">0.0</span>
<span class="token number">2</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">10</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">04</span>  <span class="token number">1.11050</span>  <span class="token number">1.11066</span>   <span class="token number">0.0</span>       <span class="token number">0</span>  <span class="token number">1578614404057</span>    <span class="token number">134</span>          <span class="token number">0.0</span>
<span class="token number">3</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">10</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">04</span>  <span class="token number">1.11049</span>  <span class="token number">1.11067</span>   <span class="token number">0.0</span>       <span class="token number">0</span>  <span class="token number">1578614404344</span>    <span class="token number">134</span>          <span class="token number">0.0</span>
<span class="token number">4</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">10</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">12</span>  <span class="token number">1.11052</span>  <span class="token number">1.11064</span>   <span class="token number">0.0</span>       <span class="token number">0</span>  <span class="token number">1578614412106</span>    <span class="token number">134</span>          <span class="token number">0.0</span>
<span class="token number">5</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">10</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">18</span>  <span class="token number">1.11039</span>  <span class="token number">1.11051</span>   <span class="token number">0.0</span>       <span class="token number">0</span>  <span class="token number">1578614418265</span>    <span class="token number">134</span>          <span class="token number">0.0</span>
<span class="token number">6</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">10</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">18</span>  <span class="token number">1.11040</span>  <span class="token number">1.11050</span>   <span class="token number">0.0</span>       <span class="token number">0</span>  <span class="token number">1578614418905</span>    <span class="token number">134</span>          <span class="token number">0.0</span>
<span class="token number">7</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">10</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">19</span>  <span class="token number">1.11039</span>  <span class="token number">1.11051</span>   <span class="token number">0.0</span>       <span class="token number">0</span>  <span class="token number">1578614419519</span>    <span class="token number">134</span>          <span class="token number">0.0</span>
<span class="token number">8</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">10</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">56</span>  <span class="token number">1.11037</span>  <span class="token number">1.11065</span>   <span class="token number">0.0</span>       <span class="token number">0</span>  <span class="token number">1578614456011</span>    <span class="token number">134</span>          <span class="token number">0.0</span>
<span class="token number">9</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">10</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">56</span>  <span class="token number">1.11039</span>  <span class="token number">1.11051</span>   <span class="token number">0.0</span>       <span class="token number">0</span>  <span class="token number">1578614456015</span>    <span class="token number">134</span>          <span class="token number">0.0</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br></div></div><p>另见</p> <p>CopyRates、copy_rates_from_pos、 copy_rates_range、copy_ticks_from、 copy_ticks_range</p> <h3 id="_32-1-20-copy-ticks-range"><a href="#_32-1-20-copy-ticks-range" class="header-anchor">#</a> 32.1.20  copy_ticks_range</h3> <p>从MetaTrader 5程序端获取指定日期范围内的报价。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>copy_ticks_range(
   symbol,       // 交易品种名称
   date_from,    // 请求报价的日期
   date_to,      // 请求报价的结束日期
   flags         // 定义请求报价类型的标识组合
   )
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>参数</p> <p>symbol</p> <p>[in]  交易品种名称，例如&quot;EURUSD&quot;。所需的未命名参数。</p> <p>date_from</p> <p>[in]  请求报价的开始日期。通过'datetime'对象或根据1970.01.01以来过去的秒数设置。所需的未命名参数。</p> <p>date_to</p> <p>[in]  请求报价的结束日期。通过'datetime'对象或根据1970.01.01以来过去的秒数设置。所需的未命名参数。</p> <p>flags</p> <p>[in]  确定请求报价类型的标记。COPY_TICKS_INFO – 卖价和/或买价变化的报价， COPY_TICKS_TRADE – 最后价和交易量变化的报价， COPY_TICKS_ALL – 全部报价。标识值在COPY_TICKS枚举中描述。所需的未命名参数。</p> <p>返回值</p> <p>返回numpy数据报价（包含以下指定列：时间、卖价、买价、最后价、标识）。'flags'值可以是TICK_FLAG枚举中的标识组合。错误情况下返回None。可使用last_error()获取错误信息。</p> <p>注意</p> <p>参见CopyTicks函数获取更多信息。</p> <p>当创建'datetime'对象时，Python使用本地时区，而MetaTrader 5以UTC时区保存报价和柱形图开盘时间（没有时移）。 因此，'datetime'应在UTC时间内创建，用于执行使用时间的函数。从MetaTrader 5获得的数据有UTC时间，但Python在尝试打印时再次应用本地时移。 因此，所获得的数据也应进行校正，以便直观表示。</p> <p>例如：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
<span class="token keyword">import</span> MetaTrader5 <span class="token keyword">as</span> mt5
<span class="token comment"># 显示有关MetaTrader 5程序包的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package author: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__author__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package version: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
 
<span class="token comment"># import the 'pandas' module for displaying data obtained in the tabular form</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'display.max_columns'</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span> <span class="token comment"># number of columns to be displayed</span>
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'display.width'</span><span class="token punctuation">,</span> <span class="token number">1500</span><span class="token punctuation">)</span>      <span class="token comment"># max table width to display</span>
<span class="token comment"># import pytz module for working with time zone</span>
<span class="token keyword">import</span> pytz
 
<span class="token comment"># establish connection to MetaTrader 5 terminal</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> mt5<span class="token punctuation">.</span>initialize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;initialize() failed, error code =&quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># set time zone to UTC</span>
timezone <span class="token operator">=</span> pytz<span class="token punctuation">.</span>timezone<span class="token punctuation">(</span><span class="token string">&quot;Etc/UTC&quot;</span><span class="token punctuation">)</span>
<span class="token comment"># create 'datetime' objects in UTC time zone to avoid the implementation of a local time zone offset</span>
utc_from <span class="token operator">=</span> datetime<span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> tzinfo<span class="token operator">=</span>timezone<span class="token punctuation">)</span>
utc_to <span class="token operator">=</span> datetime<span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> tzinfo<span class="token operator">=</span>timezone<span class="token punctuation">)</span>
<span class="token comment"># request AUDUSD ticks within 11.01.2020 - 11.01.2020</span>
ticks <span class="token operator">=</span> mt5<span class="token punctuation">.</span>copy_ticks_range<span class="token punctuation">(</span><span class="token string">&quot;AUDUSD&quot;</span><span class="token punctuation">,</span> utc_from<span class="token punctuation">,</span> utc_to<span class="token punctuation">,</span> mt5<span class="token punctuation">.</span>COPY_TICKS_ALL<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Ticks received:&quot;</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>ticks<span class="token punctuation">)</span><span class="token punctuation">)</span>
 
<span class="token comment"># shut down connection to the MetaTrader 5 terminal</span>
mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># display data on each tick on a new line</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Display obtained ticks 'as is'&quot;</span><span class="token punctuation">)</span>
count <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">for</span> tick <span class="token keyword">in</span> ticks<span class="token punctuation">:</span>
    count<span class="token operator">+=</span><span class="token number">1</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>tick<span class="token punctuation">)</span>
    <span class="token keyword">if</span> count <span class="token operator">&gt;=</span> <span class="token number">10</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>
 
<span class="token comment"># create DataFrame out of the obtained data</span>
ticks_frame <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>ticks<span class="token punctuation">)</span>
<span class="token comment"># convert time in seconds into the datetime format</span>
ticks_frame<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span><span class="token operator">=</span>pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>ticks_frame<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> unit<span class="token operator">=</span><span class="token string">'s'</span><span class="token punctuation">)</span>
 
<span class="token comment"># display data</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\nDisplay dataframe with ticks&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ticks_frame<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
 
结果：
MetaTrader5程序包作者：MetaQuotes Software Corp<span class="token punctuation">.</span>
MetaTrader5程序包版本：<span class="token number">5.0</span><span class="token number">.29</span>
 
已接收报价：<span class="token number">37008</span>
将获得的报价显示为“保持原来状态”
<span class="token punctuation">(</span><span class="token number">1578614400</span><span class="token punctuation">,</span> <span class="token number">0.68577</span><span class="token punctuation">,</span> <span class="token number">0.68594</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1578614400820</span><span class="token punctuation">,</span> <span class="token number">134</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1578614401</span><span class="token punctuation">,</span> <span class="token number">0.68578</span><span class="token punctuation">,</span> <span class="token number">0.68594</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1578614401128</span><span class="token punctuation">,</span> <span class="token number">130</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1578614401</span><span class="token punctuation">,</span> <span class="token number">0.68575</span><span class="token punctuation">,</span> <span class="token number">0.68594</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1578614401128</span><span class="token punctuation">,</span> <span class="token number">130</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1578614411</span><span class="token punctuation">,</span> <span class="token number">0.68576</span><span class="token punctuation">,</span> <span class="token number">0.68594</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1578614411388</span><span class="token punctuation">,</span> <span class="token number">130</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1578614411</span><span class="token punctuation">,</span> <span class="token number">0.68575</span><span class="token punctuation">,</span> <span class="token number">0.68594</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1578614411560</span><span class="token punctuation">,</span> <span class="token number">130</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1578614414</span><span class="token punctuation">,</span> <span class="token number">0.68576</span><span class="token punctuation">,</span> <span class="token number">0.68595</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1578614414973</span><span class="token punctuation">,</span> <span class="token number">134</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1578614430</span><span class="token punctuation">,</span> <span class="token number">0.68576</span><span class="token punctuation">,</span> <span class="token number">0.68594</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1578614430188</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1578614450</span><span class="token punctuation">,</span> <span class="token number">0.68576</span><span class="token punctuation">,</span> <span class="token number">0.68595</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1578614450408</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1578614450</span><span class="token punctuation">,</span> <span class="token number">0.68576</span><span class="token punctuation">,</span> <span class="token number">0.68594</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1578614450519</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1578614456</span><span class="token punctuation">,</span> <span class="token number">0.68575</span><span class="token punctuation">,</span> <span class="token number">0.68594</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1578614456363</span><span class="token punctuation">,</span> <span class="token number">130</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">)</span>
 
显示带有报价的数据框
                 time      bid      ask  last  volume       time_msc  flags  volume_real
<span class="token number">0</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">10</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span>  <span class="token number">0.68577</span>  <span class="token number">0.68594</span>   <span class="token number">0.0</span>       <span class="token number">0</span>  <span class="token number">1578614400820</span>    <span class="token number">134</span>          <span class="token number">0.0</span>
<span class="token number">1</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">10</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">01</span>  <span class="token number">0.68578</span>  <span class="token number">0.68594</span>   <span class="token number">0.0</span>       <span class="token number">0</span>  <span class="token number">1578614401128</span>    <span class="token number">130</span>          <span class="token number">0.0</span>
<span class="token number">2</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">10</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">01</span>  <span class="token number">0.68575</span>  <span class="token number">0.68594</span>   <span class="token number">0.0</span>       <span class="token number">0</span>  <span class="token number">1578614401128</span>    <span class="token number">130</span>          <span class="token number">0.0</span>
<span class="token number">3</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">10</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">11</span>  <span class="token number">0.68576</span>  <span class="token number">0.68594</span>   <span class="token number">0.0</span>       <span class="token number">0</span>  <span class="token number">1578614411388</span>    <span class="token number">130</span>          <span class="token number">0.0</span>
<span class="token number">4</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">10</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">11</span>  <span class="token number">0.68575</span>  <span class="token number">0.68594</span>   <span class="token number">0.0</span>       <span class="token number">0</span>  <span class="token number">1578614411560</span>    <span class="token number">130</span>          <span class="token number">0.0</span>
<span class="token number">5</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">10</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">14</span>  <span class="token number">0.68576</span>  <span class="token number">0.68595</span>   <span class="token number">0.0</span>       <span class="token number">0</span>  <span class="token number">1578614414973</span>    <span class="token number">134</span>          <span class="token number">0.0</span>
<span class="token number">6</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">10</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">30</span>  <span class="token number">0.68576</span>  <span class="token number">0.68594</span>   <span class="token number">0.0</span>       <span class="token number">0</span>  <span class="token number">1578614430188</span>      <span class="token number">4</span>          <span class="token number">0.0</span>
<span class="token number">7</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">10</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">50</span>  <span class="token number">0.68576</span>  <span class="token number">0.68595</span>   <span class="token number">0.0</span>       <span class="token number">0</span>  <span class="token number">1578614450408</span>      <span class="token number">4</span>          <span class="token number">0.0</span>
<span class="token number">8</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">10</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">50</span>  <span class="token number">0.68576</span>  <span class="token number">0.68594</span>   <span class="token number">0.0</span>       <span class="token number">0</span>  <span class="token number">1578614450519</span>      <span class="token number">4</span>          <span class="token number">0.0</span>
<span class="token number">9</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">10</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">56</span>  <span class="token number">0.68575</span>  <span class="token number">0.68594</span>   <span class="token number">0.0</span>       <span class="token number">0</span>  <span class="token number">1578614456363</span>    <span class="token number">130</span>          <span class="token number">0.0</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br></div></div><p>另见</p> <p>CopyRates、copy_rates_from_pos、 copy_rates_range、copy_ticks_from、 copy_ticks_range</p> <h3 id="_32-1-21-orders-total"><a href="#_32-1-21-orders-total" class="header-anchor">#</a> 32.1.21  orders_total</h3> <p>获取活动订单的数量。</p> <p><code>orders_total()</code></p> <p>返回值</p> <p>整数值。</p> <p>注意</p> <p>该函数类似于OrdersTotal。</p> <p>例如：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> MetaTrader5 <span class="token keyword">as</span> mt5
<span class="token comment"># 显示有关MetaTrader 5程序包的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package author: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__author__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package version: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
 
<span class="token comment"># 建立与MetaTrader 5程序端的连接</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> mt5<span class="token punctuation">.</span>initialize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;initialize() failed, error code =&quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 检查是否存在活动订单</span>
orders<span class="token operator">=</span>mt5<span class="token punctuation">.</span>orders_total<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> orders<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Total orders=&quot;</span><span class="token punctuation">,</span>orders<span class="token punctuation">)</span>
其他：
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Orders not found&quot;</span><span class="token punctuation">)</span>
 
<span class="token comment"># 断开与MetaTrader 5程序端的连接</span>
mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>另见</p> <p>orders_get、positions_total</p> <h3 id="_32-1-22-orders-get"><a href="#_32-1-22-orders-get" class="header-anchor">#</a> 32.1.22  orders_get</h3> <p>获取可通过交易品种或单号筛选的活动订单。共有三个调用选项。</p> <p>无参数调用。返回所有交易品种的活动订单。</p> <p><code>orders_get()</code></p> <p>调用指定应接收的交易品种活动订单。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>orders_get(
   symbol=&quot;SYMBOL&quot;      //交易品种名称
)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>调用指定应接收的交易品种组活动订单。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>orders_get(
   group=&quot;GROUP&quot;        // 用于选择交易品种订单的过滤器
)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>调用指定订单单号。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>orders_get(
   ticket=TICKET        // 单号
)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>symbol=&quot;SYMBOL&quot;</p> <p>[in]  交易品种名称。可选的命名参数。如果指定交易品种，则忽略ticket参数。</p> <p>group=&quot;GROUP&quot;</p> <p>[in]  用于跑了一组必要交易品种的过滤器。可选的命名参数。如果指定了组，则函数只返回满足交易品种名称指定条件的活动订单。</p> <p>ticket=TICKET</p> <p>[in]  订单单号(ORDER_TICKET)。可选的命名参数。</p> <p>返回值</p> <p>以指定元组结构(namedtuple)的形式返回信息。错误情况下返回None。可使用last_error()获取错误信息。</p> <p>注意</p> <p>该函数允许在一个类似于OrdersTotal和OrderSelect的串联调用中接收所有活动订单。</p> <p>group参数可以根据交易品种对订单进行分类。'*'可以用在字符串的开头和结尾。</p> <p>group参数可以包含多个逗号分隔条件。条件可以使用'*'设置为掩码。逻辑否定字符'!'可以用来表示排除条件。所有条件依序应用，这意味着应该先指定包含到组中的条件，然后再指定排除条件。例如，group=&quot;*, !EUR&quot;意味着应该先选择所有交易品种的订单，然后排除交易品种名称中包含&quot;EUR&quot;的订单。</p> <p>例如：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> MetaTrader5 <span class="token keyword">as</span> mt5
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'display.max_columns'</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span> <span class="token comment"># number of columns to be displayed</span>
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'display.width'</span><span class="token punctuation">,</span> <span class="token number">1500</span><span class="token punctuation">)</span>      <span class="token comment"># max table width to display</span>
<span class="token comment"># 显示有关MetaTrader 5程序包的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package author: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__author__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package version: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 建立与MetaTrader 5程序端的连接</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> mt5<span class="token punctuation">.</span>initialize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;initialize() failed, error code =&quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 显示GBPUSD活动订单的数据</span>
orders<span class="token operator">=</span>mt5<span class="token punctuation">.</span>orders_get<span class="token punctuation">(</span>symbol<span class="token operator">=</span><span class="token string">&quot;GBPUSD&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> orders <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;No orders on GBPUSD, error code={}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Total orders on GBPUSD:&quot;</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>orders<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># display all active orders</span>
    <span class="token keyword">for</span> order <span class="token keyword">in</span> orders<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 获取名称包含&quot;*GBP*&quot;的交易品种的订单列表</span>
gbp_orders<span class="token operator">=</span>mt5<span class="token punctuation">.</span>orders_get<span class="token punctuation">(</span>group<span class="token operator">=</span><span class="token string">&quot;*GBP*&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> gbp_orders <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;No orders with group=\&quot;*GBP*\&quot;, error code={}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;orders_get(group=\&quot;*GBP*\&quot;)={}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>gbp_orders<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># display these orders as a table using pandas.DataFrame</span>
    df<span class="token operator">=</span>pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>gbp_orders<span class="token punctuation">)</span><span class="token punctuation">,</span>columns<span class="token operator">=</span>gbp_orders<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>_asdict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    df<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'time_done'</span><span class="token punctuation">,</span> <span class="token string">'time_done_msc'</span><span class="token punctuation">,</span> <span class="token string">'position_id'</span><span class="token punctuation">,</span> <span class="token string">'position_by_id'</span><span class="token punctuation">,</span> <span class="token string">'reason'</span><span class="token punctuation">,</span> <span class="token string">'volume_initial'</span><span class="token punctuation">,</span> <span class="token string">'price_stoplimit'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    df<span class="token punctuation">[</span><span class="token string">'time_setup'</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'time_setup'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> unit<span class="token operator">=</span><span class="token string">'s'</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
 
<span class="token comment"># 断开与MetaTrader 5程序端的连接</span>
mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
结果：
MetaTrader5程序包作者：MetaQuotes Software Corp<span class="token punctuation">.</span>
MetaTrader5程序包版本：<span class="token number">5.0</span><span class="token number">.29</span>
 
Total orders on GBPUSD<span class="token punctuation">:</span> <span class="token number">2</span>
TradeOrder<span class="token punctuation">(</span>ticket<span class="token operator">=</span><span class="token number">554733548</span><span class="token punctuation">,</span> time_setup<span class="token operator">=</span><span class="token number">1585153667</span><span class="token punctuation">,</span> time_setup_msc<span class="token operator">=</span><span class="token number">1585153667718</span><span class="token punctuation">,</span> time_done<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> time_done_msc<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> time_expiration<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> type_time<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
TradeOrder<span class="token punctuation">(</span>ticket<span class="token operator">=</span><span class="token number">554733621</span><span class="token punctuation">,</span> time_setup<span class="token operator">=</span><span class="token number">1585153671</span><span class="token punctuation">,</span> time_setup_msc<span class="token operator">=</span><span class="token number">1585153671419</span><span class="token punctuation">,</span> time_done<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> time_done_msc<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> time_expiration<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> type_time<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
 
orders_get<span class="token punctuation">(</span>group<span class="token operator">=</span><span class="token string">&quot;*GBP*&quot;</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">4</span>
      ticket          time_setup  time_setup_msc  time_expiration  <span class="token builtin">type</span>  type_time  type_filling  state  magic  volume_current  price_open   sl   tp  price_current  symbol comment external_id
<span class="token number">0</span>  <span class="token number">554733548</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">25</span> <span class="token number">16</span><span class="token punctuation">:</span><span class="token number">27</span><span class="token punctuation">:</span><span class="token number">47</span>   <span class="token number">1585153667718</span>                <span class="token number">0</span>     <span class="token number">3</span>          <span class="token number">0</span>             <span class="token number">2</span>      <span class="token number">1</span>      <span class="token number">0</span>             <span class="token number">0.2</span>     <span class="token number">1.25379</span>  <span class="token number">0.0</span>  <span class="token number">0.0</span>        <span class="token number">1.16803</span>  GBPUSD                    
<span class="token number">1</span>  <span class="token number">554733621</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">25</span> <span class="token number">16</span><span class="token punctuation">:</span><span class="token number">27</span><span class="token punctuation">:</span><span class="token number">51</span>   <span class="token number">1585153671419</span>                <span class="token number">0</span>     <span class="token number">2</span>          <span class="token number">0</span>             <span class="token number">2</span>      <span class="token number">1</span>      <span class="token number">0</span>             <span class="token number">0.2</span>     <span class="token number">1.14370</span>  <span class="token number">0.0</span>  <span class="token number">0.0</span>        <span class="token number">1.16815</span>  GBPUSD                    
<span class="token number">2</span>  <span class="token number">554746664</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">25</span> <span class="token number">16</span><span class="token punctuation">:</span><span class="token number">38</span><span class="token punctuation">:</span><span class="token number">14</span>   <span class="token number">1585154294401</span>                <span class="token number">0</span>     <span class="token number">3</span>          <span class="token number">0</span>             <span class="token number">2</span>      <span class="token number">1</span>      <span class="token number">0</span>             <span class="token number">0.2</span>     <span class="token number">0.93851</span>  <span class="token number">0.0</span>  <span class="token number">0.0</span>        <span class="token number">0.92428</span>  EURGBP                    
<span class="token number">3</span>  <span class="token number">554746710</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">25</span> <span class="token number">16</span><span class="token punctuation">:</span><span class="token number">38</span><span class="token punctuation">:</span><span class="token number">17</span>   <span class="token number">1585154297022</span>                <span class="token number">0</span>     <span class="token number">2</span>          <span class="token number">0</span>             <span class="token number">2</span>      <span class="token number">1</span>      <span class="token number">0</span>             <span class="token number">0.2</span>     <span class="token number">0.90527</span>  <span class="token number">0.0</span>  <span class="token number">0.0</span>        <span class="token number">0.92449</span>  EURGBP    
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br></div></div><p>另见</p> <p>orders_total、positions_get</p> <h3 id="_32-1-23-order-calc-margin"><a href="#_32-1-23-order-calc-margin" class="header-anchor">#</a> 32.1.23  order_calc_margin</h3> <p>返回预付款（用账户货币表示）来执行指定的交易操作。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>order_calc_margin(
   action,      // 订单类型 (ORDER_TYPE_BUY or ORDER_TYPE_SELL)
   symbol,      // 交易品种名称
   volume,      // 交易量
   price        // 开盘价
   )
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>参数</p> <p>action</p> <p>[in]  从ORDER_TYPE枚举中获取值的订单类型。所需的未命名参数。</p> <p>symbol</p> <p>[in]  交易品种名称。所需的未命名参数。</p> <p>volume</p> <p>[in]  交易操作的交易量。所需的未命名参数。</p> <p>price</p> <p>[in]  开盘价。所需的未命名参数。</p> <p>返回值</p> <p>如果成功返回真实值，否则返回None。可以使用last_error()获取错误信息。</p> <p>注意</p> <p>该功能允许评估当前账户和当前市场环境中指定订单类型所需的预付款，而无需考虑当前挂单和未结持仓。该函数类似于OrderCalcMargin。</p> <p>ORDER_TYPE</p> <table><thead><tr><th>ID</th> <th>描述</th></tr></thead> <tbody><tr><td>ORDER_TYPE_BUY</td> <td>市价买单</td></tr> <tr><td>ORDER_TYPE_SELL</td> <td>市价卖单</td></tr> <tr><td>ORDER_TYPE_BUY_LIMIT</td> <td>Buy Limit挂单</td></tr> <tr><td>ORDER_TYPE_SELL_LIMIT</td> <td>Sell Limit挂单</td></tr> <tr><td>ORDER_TYPE_BUY_STOP</td> <td>Buy Stop挂单</td></tr> <tr><td>ORDER_TYPE_SELL_STOP</td> <td>Sell Stop挂单</td></tr> <tr><td>ORDER_TYPE_BUY_STOP_LIMIT</td> <td>在达到订单价格时，以StopLimit价格下单Buy Limit挂单</td></tr> <tr><td>ORDER_TYPE_SELL_STOP_LIMIT</td> <td>在达到订单价格时，以StopLimit价格下单Sell Limit挂单</td></tr> <tr><td>ORDER_TYPE_CLOSE_BY</td> <td>用于反向平仓的订单</td></tr></tbody></table> <p>例如：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> MetaTrader5 <span class="token keyword">as</span> mt5
<span class="token comment"># display data on the MetaTrader 5 package</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package author: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__author__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package version: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
 
<span class="token comment"># establish connection to MetaTrader 5 terminal</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> mt5<span class="token punctuation">.</span>initialize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;initialize() failed, error code =&quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># get account currency</span>
account_currency<span class="token operator">=</span>mt5<span class="token punctuation">.</span>account_info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>currency
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Account сurrency:&quot;</span><span class="token punctuation">,</span>account_currency<span class="token punctuation">)</span>
 
<span class="token comment"># arrange the symbol list</span>
symbols<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">&quot;EURUSD&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;GBPUSD&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;USDJPY&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;USDCHF&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;EURJPY&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;GBPJPY&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Symbols to check margin:&quot;</span><span class="token punctuation">,</span> symbols<span class="token punctuation">)</span>
action<span class="token operator">=</span>mt5<span class="token punctuation">.</span>ORDER_TYPE_BUY
lot<span class="token operator">=</span><span class="token number">0.1</span>
<span class="token keyword">for</span> symbol <span class="token keyword">in</span> symbols<span class="token punctuation">:</span>
    symbol_info<span class="token operator">=</span>mt5<span class="token punctuation">.</span>symbol_info<span class="token punctuation">(</span>symbol<span class="token punctuation">)</span>
    <span class="token keyword">if</span> symbol_info <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>symbol<span class="token punctuation">,</span><span class="token string">&quot;not found, skipped&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">continue</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> symbol_info<span class="token punctuation">.</span>visible<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>symbol<span class="token punctuation">,</span> <span class="token string">&quot;is not visible, trying to switch on&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> mt5<span class="token punctuation">.</span>symbol_select<span class="token punctuation">(</span>symbol<span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;symbol_select({}}) failed, skipped&quot;</span><span class="token punctuation">,</span>symbol<span class="token punctuation">)</span>
            <span class="token keyword">continue</span>
    ask<span class="token operator">=</span>mt5<span class="token punctuation">.</span>symbol_info_tick<span class="token punctuation">(</span>symbol<span class="token punctuation">)</span><span class="token punctuation">.</span>ask
    margin<span class="token operator">=</span>mt5<span class="token punctuation">.</span>order_calc_margin<span class="token punctuation">(</span>action<span class="token punctuation">,</span>symbol<span class="token punctuation">,</span>lot<span class="token punctuation">,</span>ask<span class="token punctuation">)</span>
    <span class="token keyword">if</span> margin <span class="token operator">!=</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;   {} buy {} lot margin: {} {}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>symbol<span class="token punctuation">,</span>lot<span class="token punctuation">,</span>margin<span class="token punctuation">,</span>account_currency<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;order_calc_margin failed: , error code =&quot;</span><span class="token punctuation">,</span> mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 
<span class="token comment"># 断开与MetaTrader 5程序端的连接</span>
mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
 
Result<span class="token punctuation">:</span>
MetaTrader5 package author<span class="token punctuation">:</span>  MetaQuotes Software Corp<span class="token punctuation">.</span>
MetaTrader5 package version<span class="token punctuation">:</span>  <span class="token number">5.0</span><span class="token number">.29</span>
 
Account сurrency<span class="token punctuation">:</span> USD
 
Symbols to check margin<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token string">'EURUSD'</span><span class="token punctuation">,</span> <span class="token string">'GBPUSD'</span><span class="token punctuation">,</span> <span class="token string">'USDJPY'</span><span class="token punctuation">,</span> <span class="token string">'USDCHF'</span><span class="token punctuation">,</span> <span class="token string">'EURJPY'</span><span class="token punctuation">,</span> <span class="token string">'GBPJPY'</span><span class="token punctuation">)</span>
   EURUSD buy <span class="token number">0.1</span> lot margin<span class="token punctuation">:</span> <span class="token number">109.91</span> USD
   GBPUSD buy <span class="token number">0.1</span> lot margin<span class="token punctuation">:</span> <span class="token number">122.73</span> USD
   USDJPY buy <span class="token number">0.1</span> lot margin<span class="token punctuation">:</span> <span class="token number">100.0</span> USD
   USDCHF buy <span class="token number">0.1</span> lot margin<span class="token punctuation">:</span> <span class="token number">100.0</span> USD
   EURJPY buy <span class="token number">0.1</span> lot margin<span class="token punctuation">:</span> <span class="token number">109.91</span> USD
   GBPJPY buy <span class="token number">0.1</span> lot margin<span class="token punctuation">:</span> <span class="token number">122.73</span> USD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br></div></div><p>另见</p> <p>order_calc_profit、order_check</p> <h3 id="_32-1-24-order-calc-profit"><a href="#_32-1-24-order-calc-profit" class="header-anchor">#</a> 32.1.24  order_calc_profit</h3> <p>返回指定交易操作的盈利（用账户货币表示）。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>order_calc_profit(
   action,          // 订单类型 (ORDER_TYPE_BUY or ORDER_TYPE_SELL)
   symbol,          // 交易品种名称
   volume,          // 交易量
   price_open,      // 开盘价
   price_close      // 收盘价
   );
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>参数</p> <p>action</p> <p>[in]  订单类型可以获取两个ORDER_TYPE枚举值其中一个：ORDER_TYPE_BUY或ORDER_TYPE_SELL。所需的未命名参数。</p> <p>symbol</p> <p>[in]  交易品种名称。所需的未命名参数。</p> <p>volume</p> <p>[in]  交易操作的交易量。所需的未命名参数。</p> <p>price_open</p> <p>[in]  开盘价。所需的未命名参数。</p> <p>price_close</p> <p>[in]  收盘价。所需的未命名参数。</p> <p>返回值</p> <p>如果成功返回真实值，否则返回None。可以使用last_error()获取错误信息。</p> <p>注意</p> <p>该函数允许评估当前账户和当前交易环境下的交易操作结果。该函数类似于OrderCalcProfit。</p> <p>例如：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> MetaTrader5 <span class="token keyword">as</span> mt5
<span class="token comment"># display data on the MetaTrader 5 package</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package author: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__author__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package version: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
 
<span class="token comment"># establish connection to MetaTrader 5 terminal</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> mt5<span class="token punctuation">.</span>initialize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;initialize() failed, error code =&quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># get account currency</span>
account_currency<span class="token operator">=</span>mt5<span class="token punctuation">.</span>account_info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>currency
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Account сurrency:&quot;</span><span class="token punctuation">,</span>account_currency<span class="token punctuation">)</span>
 
<span class="token comment"># arrange the symbol list</span>
symbols <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">&quot;EURUSD&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;GBPUSD&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;USDJPY&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Symbols to check margin:&quot;</span><span class="token punctuation">,</span> symbols<span class="token punctuation">)</span>
<span class="token comment"># estimate profit for buying and selling</span>
lot<span class="token operator">=</span><span class="token number">1.0</span>
distance<span class="token operator">=</span><span class="token number">300</span>
<span class="token keyword">for</span> symbol <span class="token keyword">in</span> symbols<span class="token punctuation">:</span>
    symbol_info<span class="token operator">=</span>mt5<span class="token punctuation">.</span>symbol_info<span class="token punctuation">(</span>symbol<span class="token punctuation">)</span>
    <span class="token keyword">if</span> symbol_info <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>symbol<span class="token punctuation">,</span><span class="token string">&quot;not found, skipped&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">continue</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> symbol_info<span class="token punctuation">.</span>visible<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>symbol<span class="token punctuation">,</span> <span class="token string">&quot;is not visible, trying to switch on&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> mt5<span class="token punctuation">.</span>symbol_select<span class="token punctuation">(</span>symbol<span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;symbol_select({}}) failed, skipped&quot;</span><span class="token punctuation">,</span>symbol<span class="token punctuation">)</span>
            <span class="token keyword">continue</span>
    point<span class="token operator">=</span>mt5<span class="token punctuation">.</span>symbol_info<span class="token punctuation">(</span>symbol<span class="token punctuation">)</span><span class="token punctuation">.</span>point
    symbol_tick<span class="token operator">=</span>mt5<span class="token punctuation">.</span>symbol_info_tick<span class="token punctuation">(</span>symbol<span class="token punctuation">)</span>
    ask<span class="token operator">=</span>symbol_tick<span class="token punctuation">.</span>ask
    bid<span class="token operator">=</span>symbol_tick<span class="token punctuation">.</span>bid
    buy_profit<span class="token operator">=</span>mt5<span class="token punctuation">.</span>order_calc_profit<span class="token punctuation">(</span>mt5<span class="token punctuation">.</span>ORDER_TYPE_BUY<span class="token punctuation">,</span>symbol<span class="token punctuation">,</span>lot<span class="token punctuation">,</span>ask<span class="token punctuation">,</span>ask<span class="token operator">+</span>distance<span class="token operator">*</span>point<span class="token punctuation">)</span>
    <span class="token keyword">if</span> buy_profit<span class="token operator">!=</span><span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;   buy {} {} lot: profit on {} points =&gt; {} {}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>symbol<span class="token punctuation">,</span>lot<span class="token punctuation">,</span>distance<span class="token punctuation">,</span>buy_profit<span class="token punctuation">,</span>account_currency<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;order_calc_profit(ORDER_TYPE_BUY) failed, error code =&quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    sell_profit<span class="token operator">=</span>mt5<span class="token punctuation">.</span>order_calc_profit<span class="token punctuation">(</span>mt5<span class="token punctuation">.</span>ORDER_TYPE_SELL<span class="token punctuation">,</span>symbol<span class="token punctuation">,</span>lot<span class="token punctuation">,</span>bid<span class="token punctuation">,</span>bid<span class="token operator">-</span>distance<span class="token operator">*</span>point<span class="token punctuation">)</span>
    <span class="token keyword">if</span> sell_profit<span class="token operator">!=</span><span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;   sell {} {} lots: profit on {} points =&gt; {} {}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>symbol<span class="token punctuation">,</span>lot<span class="token punctuation">,</span>distance<span class="token punctuation">,</span>sell_profit<span class="token punctuation">,</span>account_currency<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;order_calc_profit(ORDER_TYPE_SELL) failed, error code =&quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># shut down connection to the MetaTrader 5 terminal</span>
mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
 
Result<span class="token punctuation">:</span>
MetaTrader5 package author<span class="token punctuation">:</span>  MetaQuotes Software Corp<span class="token punctuation">.</span>
MetaTrader5 package version<span class="token punctuation">:</span>  <span class="token number">5.0</span><span class="token number">.29</span>
 
Account сurrency<span class="token punctuation">:</span> USD
Symbols to check margin<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token string">'EURUSD'</span><span class="token punctuation">,</span> <span class="token string">'GBPUSD'</span><span class="token punctuation">,</span> <span class="token string">'USDJPY'</span><span class="token punctuation">)</span>
   buy EURUSD <span class="token number">1.0</span> lot<span class="token punctuation">:</span> profit on <span class="token number">300</span> points <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">300.0</span> USD
   sell EURUSD <span class="token number">1.0</span> lot<span class="token punctuation">:</span> profit on <span class="token number">300</span> points <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">300.0</span> USD
 
   buy GBPUSD <span class="token number">1.0</span> lot<span class="token punctuation">:</span> profit on <span class="token number">300</span> points <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">300.0</span> USD
   sell GBPUSD <span class="token number">1.0</span> lot<span class="token punctuation">:</span> profit on <span class="token number">300</span> points <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">300.0</span> USD
 
   buy USDJPY <span class="token number">1.0</span> lot<span class="token punctuation">:</span> profit on <span class="token number">300</span> points <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">276.54</span> USD
   sell USDJPY <span class="token number">1.0</span> lot<span class="token punctuation">:</span> profit on <span class="token number">300</span> points <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">278.09</span> USD
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br></div></div><p>另见</p> <p>order_calc_margin、order_check</p> <h3 id="_32-1-25-order-check"><a href="#_32-1-25-order-check" class="header-anchor">#</a> 32.1.25  order_check</h3> <p>检查是否有足够的资金执行所需的交易操作。检查结果以MqlTradeCheckResult结构返回。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>order_check(
   request      // 请求结构
   );
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>参数</p> <p>request</p> <p>[in]  描述所需交易操作的MqlTradeRequest类型结构。所需的未命名参数。下面描述了填写请求和枚举内容的示例。</p> <p>返回值</p> <p>检查结果以MqlTradeCheckResult结构返回。回答中的request字段包含传递到order_check()的交易请求的结构。</p> <p>注意</p> <p>成功发送请求不代表所请求的交易操作就可成功执行。order_check函数类似于OrderCheck。</p> <p>TRADE_REQUEST_ACTIONS</p> <table><thead><tr><th>ID</th> <th>描述</th></tr></thead> <tbody><tr><td>TRADE_ACTION_DEAL</td> <td>以指定参数（设置市价单）下现价交易订单。</td></tr> <tr><td>TRADE_ACTION_PENDING</td> <td>在指定条件下（挂单）下执行交易订单，</td></tr> <tr><td>TRADE_ACTION_SLTP</td> <td>更改持仓止损和止盈</td></tr> <tr><td>TRADE_ACTION_MODIFY</td> <td>更改之前所下交易订单的参数</td></tr> <tr><td>TRADE_ACTION_REMOVE</td> <td>删除之前所下的挂单</td></tr> <tr><td>TRADE_ACTION_CLOSE_BY</td> <td>反向平仓</td></tr></tbody></table> <p>ORDER_TYPE_FILLING</p> <table><thead><tr><th>ID</th> <th>描述</th></tr></thead> <tbody><tr><td>ORDER_FILLING_FOK</td> <td>这个执行规则意味着一笔订单只能按照指定的交易量执行。如果金融产品的必要数额目前在市场上不能满足，则该订单将不会被执行。所需交易量可以由几个可用报价组成。</td></tr> <tr><td>ORDER_FILLING_IOC</td> <td>在订单中规定的交易量范围内，以市场最大交易量执行交易的协议。如果不能完全成交，则将执行可用交易量的订单，并取消其余交易量。</td></tr> <tr><td>ORDER_FILLING_RETURN</td> <td>这个规则只适用于市价单（ORDER_TYPE_BUY和 ORDER_TYPE_SELL）、limit和stop limit订单（ORDER_TYPE_BUY_LIMIT、ORDER_TYPE_SELL_LIMIT、 ORDER_TYPE_BUY_STOP_LIMIT和ORDER_TYPE_SELL_STOP_LIMIT）以及市价执行和交易所执行模式的交易品种。如果部分成交，则剩余交易量的订单不会被取消，等待进一步处理。<br>在激活ORDER_TYPE_BUY_STOP_LIMIT和ORDER_TYPE_SELL_STOP_LIMIT订单期间，将创建一个对应的限价单ORDER_TYPE_BUY_LIMIT/ORDER_TYPE_SELL_LIMIT，并使用ORDER_FILLING_RETURN类型。</td></tr></tbody></table> <p>ORDER_TYPE_TIME</p> <table><thead><tr><th>ID</th> <th>描述</th></tr></thead> <tbody><tr><td>ORDER_TIME_GTC</td> <td>订单将一直保留在队列中，直到手动取消</td></tr> <tr><td>ORDER_TIME_DAY</td> <td>订单仅在当前交易日有效</td></tr> <tr><td>ORDER_TIME_SPECIFIED</td> <td>订单在指定日期之前有效</td></tr> <tr><td>ORDER_TIME_SPECIFIED_DAY</td> <td>订单在指定日23:59:59之前有效。如果此时间不在交易时段内，到期将在最近的交易时间内处理。</td></tr></tbody></table> <p>例如：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> MetaTrader5 <span class="token keyword">as</span> mt5
<span class="token comment"># display data on the MetaTrader 5 package</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package author: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__author__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package version: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
 
<span class="token comment"># establish connection to MetaTrader 5 terminal</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> mt5<span class="token punctuation">.</span>initialize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;initialize() failed, error code =&quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># get account currency</span>
account_currency<span class="token operator">=</span>mt5<span class="token punctuation">.</span>account_info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>currency
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Account сurrency:&quot;</span><span class="token punctuation">,</span>account_currency<span class="token punctuation">)</span>
 
<span class="token comment"># 准备请求结构</span>
symbol<span class="token operator">=</span><span class="token string">&quot;USDJPY&quot;</span>
symbol_info <span class="token operator">=</span> mt5<span class="token punctuation">.</span>symbol_info<span class="token punctuation">(</span>symbol<span class="token punctuation">)</span>
<span class="token keyword">if</span> symbol_info <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>symbol<span class="token punctuation">,</span> <span class="token string">&quot;not found, can not call order_check()&quot;</span><span class="token punctuation">)</span>
    mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
    quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 如果市场报价中没有此交易品种，请添加</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> symbol_info<span class="token punctuation">.</span>visible<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>symbol<span class="token punctuation">,</span> <span class="token string">&quot;is not visible, trying to switch on&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> mt5<span class="token punctuation">.</span>symbol_select<span class="token punctuation">(</span>symbol<span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;symbol_select({}}) failed, exit&quot;</span><span class="token punctuation">,</span>symbol<span class="token punctuation">)</span>
        mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
        quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># prepare the request</span>
point<span class="token operator">=</span>mt5<span class="token punctuation">.</span>symbol_info<span class="token punctuation">(</span>symbol<span class="token punctuation">)</span><span class="token punctuation">.</span>point
request <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;action&quot;</span><span class="token punctuation">:</span> mt5<span class="token punctuation">.</span>TRADE_ACTION_DEAL<span class="token punctuation">,</span>
    <span class="token string">&quot;symbol&quot;</span><span class="token punctuation">:</span> symbol<span class="token punctuation">,</span>
    <span class="token string">&quot;volume&quot;</span><span class="token punctuation">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
    <span class="token string">&quot;type&quot;</span><span class="token punctuation">:</span> mt5<span class="token punctuation">.</span>ORDER_TYPE_BUY<span class="token punctuation">,</span>
    <span class="token string">&quot;price&quot;</span><span class="token punctuation">:</span> mt5<span class="token punctuation">.</span>symbol_info_tick<span class="token punctuation">(</span>symbol<span class="token punctuation">)</span><span class="token punctuation">.</span>ask<span class="token punctuation">,</span>
    <span class="token string">&quot;sl&quot;</span><span class="token punctuation">:</span> mt5<span class="token punctuation">.</span>symbol_info_tick<span class="token punctuation">(</span>symbol<span class="token punctuation">)</span><span class="token punctuation">.</span>ask<span class="token operator">-</span><span class="token number">100</span><span class="token operator">*</span>point<span class="token punctuation">,</span>
    <span class="token string">&quot;tp&quot;</span><span class="token punctuation">:</span> mt5<span class="token punctuation">.</span>symbol_info_tick<span class="token punctuation">(</span>symbol<span class="token punctuation">)</span><span class="token punctuation">.</span>ask<span class="token operator">+</span><span class="token number">100</span><span class="token operator">*</span>point<span class="token punctuation">,</span>
    <span class="token string">&quot;deviation&quot;</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
    <span class="token string">&quot;magic&quot;</span><span class="token punctuation">:</span> <span class="token number">234000</span><span class="token punctuation">,</span>
    <span class="token string">&quot;comment&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;python script&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;type_time&quot;</span><span class="token punctuation">:</span> mt5<span class="token punctuation">.</span>ORDER_TIME_GTC<span class="token punctuation">,</span>
    <span class="token string">&quot;type_filling&quot;</span><span class="token punctuation">:</span> mt5<span class="token punctuation">.</span>ORDER_FILLING_RETURN<span class="token punctuation">,</span>
<span class="token punctuation">}</span>
 
<span class="token comment"># 执行检查并显示结果'按原状'</span>
result <span class="token operator">=</span> mt5<span class="token punctuation">.</span>order_check<span class="token punctuation">(</span>request<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># request the result as a dictionary and display it element by element</span>
result_dict<span class="token operator">=</span>result<span class="token punctuation">.</span>_asdict<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> field <span class="token keyword">in</span> result_dict<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;   {}={}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>field<span class="token punctuation">,</span>result_dict<span class="token punctuation">[</span>field<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># if this is a trading request structure, display it element by element as well</span>
    <span class="token keyword">if</span> field<span class="token operator">==</span><span class="token string">&quot;request&quot;</span><span class="token punctuation">:</span>
        traderequest_dict<span class="token operator">=</span>result_dict<span class="token punctuation">[</span>field<span class="token punctuation">]</span><span class="token punctuation">.</span>_asdict<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> tradereq_filed <span class="token keyword">in</span> traderequest_dict<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;       traderequest: {}={}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>tradereq_filed<span class="token punctuation">,</span>traderequest_dict<span class="token punctuation">[</span>tradereq_filed<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 
<span class="token comment"># shut down connection to the MetaTrader 5 terminal</span>
mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
 
Result<span class="token punctuation">:</span>
MetaTrader5 package author<span class="token punctuation">:</span>  MetaQuotes Software Corp<span class="token punctuation">.</span>
MetaTrader5 package version<span class="token punctuation">:</span>  <span class="token number">5.0</span><span class="token number">.29</span>
 
Account сurrency<span class="token punctuation">:</span> USD
   retcode<span class="token operator">=</span><span class="token number">0</span>
   balance<span class="token operator">=</span><span class="token number">101300.53</span>
   equity<span class="token operator">=</span><span class="token number">68319.53</span>
   profit<span class="token operator">=</span><span class="token operator">-</span><span class="token number">32981.0</span>
   margin<span class="token operator">=</span><span class="token number">51193.67</span>
   margin_free<span class="token operator">=</span><span class="token number">17125.86</span>
   margin_level<span class="token operator">=</span><span class="token number">133.45308121101692</span>
   comment<span class="token operator">=</span>Done
   request<span class="token operator">=</span>TradeRequest<span class="token punctuation">(</span>action<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> magic<span class="token operator">=</span><span class="token number">234000</span><span class="token punctuation">,</span> order<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> symbol<span class="token operator">=</span><span class="token string">'USDJPY'</span><span class="token punctuation">,</span> volume<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
       traderequest<span class="token punctuation">:</span> action<span class="token operator">=</span><span class="token number">1</span>
       traderequest<span class="token punctuation">:</span> magic<span class="token operator">=</span><span class="token number">234000</span>
       traderequest<span class="token punctuation">:</span> order<span class="token operator">=</span><span class="token number">0</span>
       traderequest<span class="token punctuation">:</span> symbol<span class="token operator">=</span>USDJPY
       traderequest<span class="token punctuation">:</span> volume<span class="token operator">=</span><span class="token number">1.0</span>
       traderequest<span class="token punctuation">:</span> price<span class="token operator">=</span><span class="token number">108.081</span>
       traderequest<span class="token punctuation">:</span> stoplimit<span class="token operator">=</span><span class="token number">0.0</span>
       traderequest<span class="token punctuation">:</span> sl<span class="token operator">=</span><span class="token number">107.98100000000001</span>
       traderequest<span class="token punctuation">:</span> tp<span class="token operator">=</span><span class="token number">108.181</span>
       traderequest<span class="token punctuation">:</span> deviation<span class="token operator">=</span><span class="token number">10</span>
       traderequest<span class="token punctuation">:</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token number">0</span>
       traderequest<span class="token punctuation">:</span> type_filling<span class="token operator">=</span><span class="token number">2</span>
       traderequest<span class="token punctuation">:</span> type_time<span class="token operator">=</span><span class="token number">0</span>
       traderequest<span class="token punctuation">:</span> expiration<span class="token operator">=</span><span class="token number">0</span>
       traderequest<span class="token punctuation">:</span> comment<span class="token operator">=</span>python script
       traderequest<span class="token punctuation">:</span> position<span class="token operator">=</span><span class="token number">0</span>
       traderequest<span class="token punctuation">:</span> position_by<span class="token operator">=</span><span class="token number">0</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br></div></div><p>另见</p> <p>order_send、 OrderCheck、交易操作类型、交易请求结构、 交易请求结构的检查结果、 交易请求结构的结果</p> <h3 id="_32-1-26-order-send"><a href="#_32-1-26-order-send" class="header-anchor">#</a> 32.1.26  order_send</h3> <p>从程序端向交易服务器发送请求来执行交易操作。该函数类似于OrderSend。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>order_send(
   request      // 请求结构
   );
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>参数</p> <p>request</p> <p>[in]  描述所需交易操作的MqlTradeRequest类型结构。所需的未命名参数。下面描述了填写请求和枚举内容的示例。</p> <p>返回值</p> <p>执行结果以MqlTradeResult结构返回。回答中的request字段包含传递到order_send()的交易请求的结构。</p> <p>MqlTradeRequest交易请求结构</p> <table><thead><tr><th>字段</th> <th>描述</th></tr></thead> <tbody><tr><td>action</td> <td>交易请求类型。该值可以是TRADE_REQUEST_ACTIONS其中一个枚举值</td></tr> <tr><td>幻数</td> <td>EA ID。可以安排交易订单的分析处理。每个EA交易都可以在发送交易请求时设置一个专有ID</td></tr> <tr><td>订单</td> <td>订单单号。更改挂单所需</td></tr> <tr><td>symbol</td> <td>要下单的交易品种名称。更改订单和平仓时不需要</td></tr> <tr><td>volume</td> <td>请求的交易量（以手数表示）交易时的真实交易量取决于订单执行类型。</td></tr> <tr><td>price</td> <td>执行订单的价格。对于具有TRADE_ACTION_DEAL类型的“市价执行”(SYMBOL_TRADE_EXECUTION_MARKET)类型的交易品种的市价单，不设置价格</td></tr> <tr><td>止损限价</td> <td>当价格达到'price'值时将设置Limit挂单（此条件是强制性的）。在此之前，挂单不会传递到交易系统中</td></tr> <tr><td>sl</td> <td>当价格向不利的方向移动时，激活止损单</td></tr> <tr><td>tp</td> <td>当价格向有利的方向移动时，激活止盈单</td></tr> <tr><td>偏差</td> <td>请求价格的最大可接受偏差，在points中指定</td></tr> <tr><td>类型</td> <td>订单类型。该值可以是ORDER_TYPE其中一个枚举值</td></tr> <tr><td>type_filling</td> <td>订单成交类型。该值可以是ORDER_TYPE_FILLING其中一个值</td></tr> <tr><td>type_time</td> <td>订单到期类型。该值可以是ORDER_TYPE_TIME其中一个值</td></tr> <tr><td>到期</td> <td>挂单到期时间（用于TIME_SPECIFIED类型订单）</td></tr> <tr><td>评论</td> <td>订单注释</td></tr> <tr><td>持仓</td> <td>持仓单号。当更改和关闭持仓时为清楚识别而填写。通常，它与持仓的订单单号相同。</td></tr> <tr><td>position_by</td> <td>反向持仓单号。它用于通过反向持仓平仓时（反向打开一个同名的交易品种）。</td></tr></tbody></table> <p>注意</p> <p>交易请求在交易服务器上通过多个验证阶段。首先，检查所有必要request字段的有效性。如果没有错误，服务器接受订单以进一步处理。有关执行交易操作的详细信息，请参阅OrderSend函数的描述。</p> <p>例如：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> time
<span class="token keyword">import</span> MetaTrader5 <span class="token keyword">as</span> mt5
 
<span class="token comment"># 显示有关MetaTrader 5程序包的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package author: &quot;</span><span class="token punctuation">,</span> mt5<span class="token punctuation">.</span>__author__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package version: &quot;</span><span class="token punctuation">,</span> mt5<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
 
<span class="token comment"># 建立与MetaTrader 5程序端的连接</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> mt5<span class="token punctuation">.</span>initialize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;initialize() failed, error code =&quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 准备买入请求结构</span>
symbol <span class="token operator">=</span> <span class="token string">&quot;USDJPY&quot;</span>
symbol_info <span class="token operator">=</span> mt5<span class="token punctuation">.</span>symbol_info<span class="token punctuation">(</span>symbol<span class="token punctuation">)</span>
<span class="token keyword">if</span> symbol_info <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>symbol<span class="token punctuation">,</span> <span class="token string">&quot;not found, can not call order_check()&quot;</span><span class="token punctuation">)</span>
    mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
    quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 如果市场报价中没有此交易品种，请添加</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> symbol_info<span class="token punctuation">.</span>visible<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>symbol<span class="token punctuation">,</span> <span class="token string">&quot;is not visible, trying to switch on&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> mt5<span class="token punctuation">.</span>symbol_select<span class="token punctuation">(</span>symbol<span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;symbol_select({}}) failed, exit&quot;</span><span class="token punctuation">,</span>symbol<span class="token punctuation">)</span>
        mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
        quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
lot <span class="token operator">=</span> <span class="token number">0.1</span>
point <span class="token operator">=</span> mt5<span class="token punctuation">.</span>symbol_info<span class="token punctuation">(</span>symbol<span class="token punctuation">)</span><span class="token punctuation">.</span>point
price <span class="token operator">=</span> mt5<span class="token punctuation">.</span>symbol_info_tick<span class="token punctuation">(</span>symbol<span class="token punctuation">)</span><span class="token punctuation">.</span>ask
deviation <span class="token operator">=</span> <span class="token number">20</span>
request <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;action&quot;</span><span class="token punctuation">:</span> mt5<span class="token punctuation">.</span>TRADE_ACTION_DEAL<span class="token punctuation">,</span>
    <span class="token string">&quot;symbol&quot;</span><span class="token punctuation">:</span> symbol<span class="token punctuation">,</span>
    <span class="token string">&quot;volume&quot;</span><span class="token punctuation">:</span> lot<span class="token punctuation">,</span>
    <span class="token string">&quot;type&quot;</span><span class="token punctuation">:</span> mt5<span class="token punctuation">.</span>ORDER_TYPE_BUY<span class="token punctuation">,</span>
    <span class="token string">&quot;price&quot;</span><span class="token punctuation">:</span> price<span class="token punctuation">,</span>
    <span class="token string">&quot;sl&quot;</span><span class="token punctuation">:</span> price <span class="token operator">-</span> <span class="token number">100</span> <span class="token operator">*</span> point<span class="token punctuation">,</span>
    <span class="token string">&quot;tp&quot;</span><span class="token punctuation">:</span> price <span class="token operator">+</span> <span class="token number">100</span> <span class="token operator">*</span> point<span class="token punctuation">,</span>
    <span class="token string">&quot;deviation&quot;</span><span class="token punctuation">:</span> deviation<span class="token punctuation">,</span>
    <span class="token string">&quot;magic&quot;</span><span class="token punctuation">:</span> <span class="token number">234000</span><span class="token punctuation">,</span>
    <span class="token string">&quot;comment&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;python script open&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;type_time&quot;</span><span class="token punctuation">:</span> mt5<span class="token punctuation">.</span>ORDER_TIME_GTC<span class="token punctuation">,</span>
    <span class="token string">&quot;type_filling&quot;</span><span class="token punctuation">:</span> mt5<span class="token punctuation">.</span>ORDER_FILLING_RETURN<span class="token punctuation">,</span>
<span class="token punctuation">}</span>
 
<span class="token comment"># 发送交易请求</span>
result <span class="token operator">=</span> mt5<span class="token punctuation">.</span>order_send<span class="token punctuation">(</span>request<span class="token punctuation">)</span>
<span class="token comment"># 检查执行结果</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;1. order_send(): by {} {} lots at {} with deviation={} points&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>symbol<span class="token punctuation">,</span>lot<span class="token punctuation">,</span>price<span class="token punctuation">,</span>deviation<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> result<span class="token punctuation">.</span>retcode <span class="token operator">!=</span> mt5<span class="token punctuation">.</span>TRADE_RETCODE_DONE<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;2. order_send failed, retcode={}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>retcode<span class="token punctuation">)</span><span class="token punctuation">)</span>
   <span class="token comment"># 请求词典结果并逐个元素显示</span>
    result_dict<span class="token operator">=</span>result<span class="token punctuation">.</span>_asdict<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> field <span class="token keyword">in</span> result_dict<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;   {}={}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>field<span class="token punctuation">,</span>result_dict<span class="token punctuation">[</span>field<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment"># if this is a trading request structure, display it element by element as well</span>
        <span class="token keyword">if</span> field<span class="token operator">==</span><span class="token string">&quot;request&quot;</span><span class="token punctuation">:</span>
            traderequest_dict<span class="token operator">=</span>result_dict<span class="token punctuation">[</span>field<span class="token punctuation">]</span><span class="token punctuation">.</span>_asdict<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> tradereq_filed <span class="token keyword">in</span> traderequest_dict<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;       traderequest: {}={}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>tradereq_filed<span class="token punctuation">,</span>traderequest_dict<span class="token punctuation">[</span>tradereq_filed<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;shutdown() and quit&quot;</span><span class="token punctuation">)</span>
    mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
    quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;2. order_send done, &quot;</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;   opened position with POSITION_TICKET={}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>order<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;   sleep 2 seconds before closing position #{}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>order<span class="token punctuation">)</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment"># 创建一个关闭请求</span>
position_id<span class="token operator">=</span>result<span class="token punctuation">.</span>order
price<span class="token operator">=</span>mt5<span class="token punctuation">.</span>symbol_info_tick<span class="token punctuation">(</span>symbol<span class="token punctuation">)</span><span class="token punctuation">.</span>bid
deviation<span class="token operator">=</span><span class="token number">20</span>
request<span class="token operator">=</span><span class="token punctuation">{</span>
    <span class="token string">&quot;action&quot;</span><span class="token punctuation">:</span> mt5<span class="token punctuation">.</span>TRADE_ACTION_DEAL<span class="token punctuation">,</span>
    <span class="token string">&quot;symbol&quot;</span><span class="token punctuation">:</span> symbol<span class="token punctuation">,</span>
    <span class="token string">&quot;volume&quot;</span><span class="token punctuation">:</span> lot<span class="token punctuation">,</span>
    <span class="token string">&quot;type&quot;</span><span class="token punctuation">:</span> mt5<span class="token punctuation">.</span>ORDER_TYPE_SELL<span class="token punctuation">,</span>
    <span class="token string">&quot;position&quot;</span><span class="token punctuation">:</span> position_id<span class="token punctuation">,</span>
    <span class="token string">&quot;price&quot;</span><span class="token punctuation">:</span> price<span class="token punctuation">,</span>
    <span class="token string">&quot;deviation&quot;</span><span class="token punctuation">:</span> deviation<span class="token punctuation">,</span>
    <span class="token string">&quot;magic&quot;</span><span class="token punctuation">:</span> <span class="token number">234000</span><span class="token punctuation">,</span>
    <span class="token string">&quot;comment&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;python script close&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;type_time&quot;</span><span class="token punctuation">:</span> mt5<span class="token punctuation">.</span>ORDER_TIME_GTC<span class="token punctuation">,</span>
    <span class="token string">&quot;type_filling&quot;</span><span class="token punctuation">:</span> mt5<span class="token punctuation">.</span>ORDER_FILLING_RETURN<span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token comment"># 发送交易请求</span>
result<span class="token operator">=</span>mt5<span class="token punctuation">.</span>order_send<span class="token punctuation">(</span>request<span class="token punctuation">)</span>
<span class="token comment"># 检查执行结果</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;3. close position #{}: sell {} {} lots at {} with deviation={} points&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>position_id<span class="token punctuation">,</span>symbol<span class="token punctuation">,</span>lot<span class="token punctuation">,</span>price<span class="token punctuation">,</span>deviation<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> result<span class="token punctuation">.</span>retcode <span class="token operator">!=</span> mt5<span class="token punctuation">.</span>TRADE_RETCODE_DONE<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;4. order_send failed, retcode={}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>retcode<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;   result&quot;</span><span class="token punctuation">,</span>result<span class="token punctuation">)</span>
其他：
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;4. position #{} closed, {}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>position_id<span class="token punctuation">,</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span>
   <span class="token comment"># 请求词典结果并逐个元素显示</span>
    result_dict<span class="token operator">=</span>result<span class="token punctuation">.</span>_asdict<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> field <span class="token keyword">in</span> result_dict<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;   {}={}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>field<span class="token punctuation">,</span>result_dict<span class="token punctuation">[</span>field<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment"># if this is a trading request structure, display it element by element as well</span>
        <span class="token keyword">if</span> field<span class="token operator">==</span><span class="token string">&quot;request&quot;</span><span class="token punctuation">:</span>
            traderequest_dict<span class="token operator">=</span>result_dict<span class="token punctuation">[</span>field<span class="token punctuation">]</span><span class="token punctuation">.</span>_asdict<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> tradereq_filed <span class="token keyword">in</span> traderequest_dict<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;       traderequest: {}={}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>tradereq_filed<span class="token punctuation">,</span>traderequest_dict<span class="token punctuation">[</span>tradereq_filed<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 
<span class="token comment"># 断开与MetaTrader 5程序端的连接</span>
mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
结果
MetaTrader5程序包作者：MetaQuotes Software Corp<span class="token punctuation">.</span>
MetaTrader5程序包版本：<span class="token number">5.0</span><span class="token number">.29</span>
<span class="token number">1.</span> order_send<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> by USDJPY <span class="token number">0.1</span> lots at <span class="token number">108.023</span> <span class="token keyword">with</span> deviation<span class="token operator">=</span><span class="token number">20</span> points
<span class="token number">2.</span> order_send done<span class="token punctuation">,</span>  OrderSendResult<span class="token punctuation">(</span>retcode<span class="token operator">=</span><span class="token number">10009</span><span class="token punctuation">,</span> deal<span class="token operator">=</span><span class="token number">535084512</span><span class="token punctuation">,</span> order<span class="token operator">=</span><span class="token number">557416535</span><span class="token punctuation">,</span> volume<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">,</span> price<span class="token operator">=</span><span class="token number">108.023</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
   opened position <span class="token keyword">with</span> POSITION_TICKET<span class="token operator">=</span><span class="token number">557416535</span>
   sleep <span class="token number">2</span> seconds before closing position <span class="token comment">#557416535</span>
<span class="token number">3.</span> close position <span class="token comment">#557416535: sell USDJPY 0.1 lots at 108.018 with deviation=20 points</span>
<span class="token number">4.</span> position <span class="token comment">#557416535 closed, OrderSendResult(retcode=10009, deal=535084631, order=557416654, volume=0.1, price=...</span>
   retcode<span class="token operator">=</span><span class="token number">10009</span>
   deal<span class="token operator">=</span><span class="token number">535084631</span>
   order<span class="token operator">=</span><span class="token number">557416654</span>
   volume<span class="token operator">=</span><span class="token number">0.1</span>
   price<span class="token operator">=</span><span class="token number">108.015</span>
   bid<span class="token operator">=</span><span class="token number">108.015</span>
   ask<span class="token operator">=</span><span class="token number">108.02</span>
   comment<span class="token operator">=</span>Request executed
   request_id<span class="token operator">=</span><span class="token number">55</span>
   retcode_external<span class="token operator">=</span><span class="token number">0</span>
   request<span class="token operator">=</span>TradeRequest<span class="token punctuation">(</span>action<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> magic<span class="token operator">=</span><span class="token number">234000</span><span class="token punctuation">,</span> order<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> symbol<span class="token operator">=</span><span class="token string">'USDJPY'</span><span class="token punctuation">,</span> volume<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">,</span> price<span class="token operator">=</span><span class="token number">108.018</span><span class="token punctuation">,</span> stoplimit<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
       traderequest<span class="token punctuation">:</span> action<span class="token operator">=</span><span class="token number">1</span>
       traderequest<span class="token punctuation">:</span> magic<span class="token operator">=</span><span class="token number">234000</span>
       traderequest<span class="token punctuation">:</span> order<span class="token operator">=</span><span class="token number">0</span>
       traderequest<span class="token punctuation">:</span> symbol<span class="token operator">=</span>USDJPY
       traderequest<span class="token punctuation">:</span> volume<span class="token operator">=</span><span class="token number">0.1</span>
       traderequest<span class="token punctuation">:</span> price<span class="token operator">=</span><span class="token number">108.018</span>
       traderequest<span class="token punctuation">:</span> stoplimit<span class="token operator">=</span><span class="token number">0.0</span>
       traderequest<span class="token punctuation">:</span> sl<span class="token operator">=</span><span class="token number">0.0</span>
       traderequest<span class="token punctuation">:</span> tp<span class="token operator">=</span><span class="token number">0.0</span>
       traderequest<span class="token punctuation">:</span> deviation<span class="token operator">=</span><span class="token number">20</span>
       traderequest<span class="token punctuation">:</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token number">1</span>
       traderequest<span class="token punctuation">:</span> type_filling<span class="token operator">=</span><span class="token number">2</span>
       traderequest<span class="token punctuation">:</span> type_time<span class="token operator">=</span><span class="token number">0</span>
       traderequest<span class="token punctuation">:</span> expiration<span class="token operator">=</span><span class="token number">0</span>
       traderequest<span class="token punctuation">:</span> comment<span class="token operator">=</span>python script close
       traderequest<span class="token punctuation">:</span> position<span class="token operator">=</span><span class="token number">557416535</span>
       traderequest<span class="token punctuation">:</span> position_by<span class="token operator">=</span><span class="token number">0</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br></div></div><p>另见</p> <p>order_check、OrderSend、交易操作类型、交易请求结构、交易请求结构的检查结果、交易请求结构的结果</p> <h3 id="_32-1-27-positions-total"><a href="#_32-1-27-positions-total" class="header-anchor">#</a> 32.1.27  positions_total</h3> <p>获取未结持仓的数量。</p> <p><code>positions_total()</code></p> <p>返回值</p> <p>整数值。</p> <p>注意</p> <p>该函数类似于PositionsTotal。</p> <p>例如：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> MetaTrader5 <span class="token keyword">as</span> mt5
<span class="token comment"># 显示有关MetaTrader 5程序包的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package author: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__author__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package version: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
 
<span class="token comment"># 建立与MetaTrader 5程序端的连接</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> mt5<span class="token punctuation">.</span>initialize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;initialize() failed, error code =&quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 检查是否存在未结持仓</span>
positions_total<span class="token operator">=</span>mt5<span class="token punctuation">.</span>positions_total<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> positions_total<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Total positions=&quot;</span><span class="token punctuation">,</span>positions_total<span class="token punctuation">)</span>
其他：
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Positions not found&quot;</span><span class="token punctuation">)</span>
 
<span class="token comment"># 断开与MetaTrader 5程序端的连接</span>
mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>另见</p> <p>positions_get、orders_total</p> <h3 id="_32-1-28-positions-get"><a href="#_32-1-28-positions-get" class="header-anchor">#</a> 32.1.28  positions_get</h3> <p>获取可通过交易品种或单号筛选的未结持仓。共有三个调用选项。</p> <p>无参数调用。返回所有交易品种的未结持仓。</p> <p>调用指定应接收的交易品种未结持仓。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>positions_get(
   symbol=&quot;SYMBOL&quot;      // 交易品种名称
)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>调用指定应接收的交易品种组未结持仓。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>positions_get(
   group=&quot;GROUP&quot;        // 根据交易品种选择持仓的过滤器
)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>调用指定持仓单号。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>positions_get(
   ticket=TICKET        // 单号
)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>参数</p> <p>symbol=&quot;SYMBOL&quot;</p> <p>[in]  交易品种名称。可选的命名参数。如果指定交易品种，则忽略ticket参数。</p> <p>group=&quot;GROUP&quot;</p> <p>[in]  用于跑了一组必要交易品种的过滤器。可选的命名参数。如果指定了组，则函数只返回满足交易品种名称指定条件的持仓。</p> <p>ticket=TICKET</p> <p>[in]  持仓单号(POSITION_TICKET)。可选的命名参数。</p> <p>返回值</p> <p>以指定元组结构(namedtuple)的形式返回信息。错误情况下返回None。可使用last_error()获取错误信息。</p> <p>注意</p> <p>该函数允许在一个类似于PositionsTotal和PositionSelect的串联调用中接收所有未结持仓。</p> <p>group参数可以包含多个逗号分隔条件。条件可以使用'*'设置为掩码。逻辑否定字符'!'可以用来表示排除条件。所有条件依序应用，这意味着应该先指定包含到组中的条件，然后再指定排除条件。例如，group=&quot;*, !EUR&quot;意味着应该先选择所有交易品种的持仓，然后排除交易品种名称中包含&quot;EUR&quot;的持仓。</p> <p>例如：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> MetaTrader5 <span class="token keyword">as</span> mt5
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'display.max_columns'</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span> <span class="token comment"># number of columns to be displayed</span>
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'display.width'</span><span class="token punctuation">,</span> <span class="token number">1500</span><span class="token punctuation">)</span>      <span class="token comment"># max table width to display</span>
<span class="token comment"># 显示有关MetaTrader 5程序包的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package author: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__author__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package version: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 建立与MetaTrader 5程序端的连接</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> mt5<span class="token punctuation">.</span>initialize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;initialize() failed, error code =&quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 获取USDCHF的未结持仓</span>
positions<span class="token operator">=</span>mt5<span class="token punctuation">.</span>positions_get<span class="token punctuation">(</span>symbol<span class="token operator">=</span><span class="token string">&quot;USDCHF&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> positions<span class="token operator">==</span><span class="token boolean">None</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;No positions on USDCHF, error code={}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">elif</span> <span class="token builtin">len</span><span class="token punctuation">(</span>positions<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Total positions on USDCHF =&quot;</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>positions<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># display all open positions</span>
    <span class="token keyword">for</span> position <span class="token keyword">in</span> positions<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>position<span class="token punctuation">)</span>
 
<span class="token comment"># 获取名称包含&quot;*USD*&quot;的交易品种的持仓列表</span>
usd_positions<span class="token operator">=</span>mt5<span class="token punctuation">.</span>positions_get<span class="token punctuation">(</span>group<span class="token operator">=</span><span class="token string">&quot;*USD*&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> usd_positions<span class="token operator">==</span><span class="token boolean">None</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;No positions with group=\&quot;*USD*\&quot;, error code={}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">elif</span> <span class="token builtin">len</span><span class="token punctuation">(</span>usd_positions<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;positions_get(group=\&quot;*USD*\&quot;)={}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>usd_positions<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># display these positions as a table using pandas.DataFrame</span>
    df<span class="token operator">=</span>pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>usd_positions<span class="token punctuation">)</span><span class="token punctuation">,</span>columns<span class="token operator">=</span>usd_positions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>_asdict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    df<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> unit<span class="token operator">=</span><span class="token string">'s'</span><span class="token punctuation">)</span>
    df<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'time_update'</span><span class="token punctuation">,</span> <span class="token string">'time_msc'</span><span class="token punctuation">,</span> <span class="token string">'time_update_msc'</span><span class="token punctuation">,</span> <span class="token string">'external_id'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
 
<span class="token comment"># 断开与MetaTrader 5程序端的连接</span>
mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
 
结果：
MetaTrader5程序包作者：MetaQuotes Software Corp<span class="token punctuation">.</span>
MetaTrader5程序包版本：<span class="token number">5.0</span><span class="token number">.29</span>
 
positions_get<span class="token punctuation">(</span>group<span class="token operator">=</span><span class="token string">&quot;*USD*&quot;</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">5</span>
      ticket                time  <span class="token builtin">type</span>  magic  identifier  reason  volume  price_open       sl       tp  price_current  swap  profit  symbol comment
<span class="token number">0</span>  <span class="token number">548297723</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">15</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">55</span>     <span class="token number">1</span>      <span class="token number">0</span>   <span class="token number">548297723</span>       <span class="token number">3</span>    <span class="token number">0.01</span>     <span class="token number">1.09301</span>  <span class="token number">1.11490</span>  <span class="token number">1.06236</span>        <span class="token number">1.10104</span> <span class="token operator">-</span><span class="token number">0.10</span>   <span class="token operator">-</span><span class="token number">8.03</span>  EURUSD        
<span class="token number">1</span>  <span class="token number">548655158</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">20</span><span class="token punctuation">:</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">26</span>     <span class="token number">0</span>      <span class="token number">0</span>   <span class="token number">548655158</span>       <span class="token number">3</span>    <span class="token number">0.01</span>     <span class="token number">1.08676</span>  <span class="token number">1.06107</span>  <span class="token number">1.12446</span>        <span class="token number">1.10099</span> <span class="token operator">-</span><span class="token number">0.08</span>   <span class="token number">14.23</span>  EURUSD        
<span class="token number">2</span>  <span class="token number">548663803</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">20</span><span class="token punctuation">:</span><span class="token number">40</span><span class="token punctuation">:</span><span class="token number">04</span>     <span class="token number">0</span>      <span class="token number">0</span>   <span class="token number">548663803</span>       <span class="token number">3</span>    <span class="token number">0.01</span>     <span class="token number">1.08640</span>  <span class="token number">1.06351</span>  <span class="token number">1.11833</span>        <span class="token number">1.10099</span> <span class="token operator">-</span><span class="token number">0.08</span>   <span class="token number">14.59</span>  EURUSD        
<span class="token number">3</span>  <span class="token number">548847168</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span> <span class="token number">01</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token number">05</span>     <span class="token number">0</span>      <span class="token number">0</span>   <span class="token number">548847168</span>       <span class="token number">3</span>    <span class="token number">0.01</span>     <span class="token number">1.09545</span>  <span class="token number">1.05524</span>  <span class="token number">1.15122</span>        <span class="token number">1.10099</span> <span class="token operator">-</span><span class="token number">0.06</span>    <span class="token number">5.54</span>  EURUSD        
<span class="token number">4</span>  <span class="token number">548847194</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span> <span class="token number">01</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token number">07</span>     <span class="token number">0</span>      <span class="token number">0</span>   <span class="token number">548847194</span>       <span class="token number">3</span>    <span class="token number">0.02</span>     <span class="token number">1.09536</span>  <span class="token number">1.04478</span>  <span class="token number">1.16587</span>        <span class="token number">1.10099</span> <span class="token operator">-</span><span class="token number">0.08</span>   <span class="token number">11.26</span>  EURUSD   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br></div></div><p>另见</p> <p>positions_total、orders_get</p> <h3 id="_32-1-29-history-deals-total"><a href="#_32-1-29-history-deals-total" class="header-anchor">#</a> 32.1.29 history_deals_total</h3> <p>获取交易历史中指定时间间隔内的交易数量。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>history_deals_total(
   date_from,    // 请求交易的开始日期
   date_to       // 请求交易的结束日期
   )
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>参数</p> <p>date_from</p> <p>[in]  请求交易的开始日期。通过'datetime'对象或根据1970.01.01以来过去的秒数设置。所需的未命名参数。</p> <p>date_to</p> <p>[in]  请求交易的结束日期。通过'datetime'对象或根据1970.01.01以来过去的秒数设置。所需的未命名参数。</p> <p>返回值</p> <p>整数值。</p> <p>注意</p> <p>该函数类似于HistoryDealsTotal。</p> <p>例如：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
<span class="token keyword">import</span> MetaTrader5 <span class="token keyword">as</span> mt5
<span class="token comment"># 显示有关MetaTrader 5程序包的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package author: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__author__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package version: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
 
<span class="token comment"># 建立与MetaTrader 5程序端的连接</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> mt5<span class="token punctuation">.</span>initialize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;initialize() failed, error code =&quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 获取历史中的交易数量</span>
from_date<span class="token operator">=</span>datetime<span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
to_date<span class="token operator">=</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
deals<span class="token operator">=</span>mt5<span class="token punctuation">.</span>history_deals_total<span class="token punctuation">(</span>from_date<span class="token punctuation">,</span> to_date<span class="token punctuation">)</span>
<span class="token keyword">if</span> deals<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Total deals=&quot;</span><span class="token punctuation">,</span>deals<span class="token punctuation">)</span>
其他：
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Deals not found in history&quot;</span><span class="token punctuation">)</span>
 
<span class="token comment"># 断开与MetaTrader 5程序端的连接</span>
mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>另见</p> <p>history_deals_get、history_orders_total</p> <h3 id="_32-1-30-history-deals-get"><a href="#_32-1-30-history-deals-get" class="header-anchor">#</a> 32.1.30  history_deals_get</h3> <p>获取可通过单号或持仓筛选的指定时间间隔内的交易历史中的交易。</p> <p>调用指定时间间隔。返回指定时间间隔内的所有交易。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>history_deals_get(
   date_from,           // 请求交易的开始日期
   date_to,             // 请求交易的结束日期
   group=&quot;GROUP&quot;        // 为交易品种选择交易的过滤器
   )
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>调用指定订单单号。返回在DEAL_ORDER属性中具有指定订单单号的所有交易。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>history_deals_get(
   ticket=TICKET        //订单单号
)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>调用指定持仓单号。返回在DEAL_POSITION_ID属性中具有指定持仓单号的所有交易。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>history_deals_get(
   position=POSITION    //持仓单号
)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>参数</p> <p>date_from</p> <p>[in]  请求订单的开始日期。通过'datetime'对象或根据1970.01.01以来过去的秒数设置。首先指定所需的未命名参数。</p> <p>date_to</p> <p>[in]  请求订单的结束日期。通过'datetime'对象或根据1970.01.01以来过去的秒数设置。其次指定所需的未命名参数。</p> <p>group=&quot;GROUP&quot;</p> <p>[in]  用于跑了一组必要交易品种的过滤器。可选的命名参数。如果指定了组，则函数只返回满足交易品种名称指定条件的交易。</p> <p>ticket=TICKET</p> <p>[in]  应接收所有交易的订单单号（存储在 DEAL_ORDER）。可选参数。如果没有指定，则不应用过滤器。</p> <p>position=POSITION</p> <p>[in]  应接收所有交易的持仓单号（存储在DEAL_POSITION_ID）。可选参数。如果没有指定，则不应用过滤器。</p> <p>返回值</p> <p>以指定元组结构(namedtuple)的形式返回信息。错误情况下返回None。可使用last_error()获取错误信息。</p> <p>注意</p> <p>该函数允许在一个类似于HistoryDealsTotal和HistoryDealSelect的串联调用中接收指定时间段内的所有历史交易。</p> <p>group参数可以根据交易品种对交易进行分类。'*'可以用在字符串的开头和结尾。</p> <p>group参数可以包含多个逗号分隔条件。条件可以使用'*'设置为掩码。逻辑否定字符'!'可以用来表示排除条件。所有条件依序应用，这意味着应该先指定包含到组中的条件，然后再指定排除条件。例如，group=&quot;*, !EUR&quot;意味着应该先选择所有交易品种的交易，然后排除交易品种名称中包含&quot;EUR&quot;的交易。</p> <p>例如：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> MetaTrader5 <span class="token keyword">as</span> mt5
<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'display.max_columns'</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span> <span class="token comment"># number of columns to be displayed</span>
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'display.width'</span><span class="token punctuation">,</span> <span class="token number">1500</span><span class="token punctuation">)</span>      <span class="token comment"># max table width to display</span>
<span class="token comment"># 显示有关MetaTrader 5程序包的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package author: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__author__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package version: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 建立与MetaTrader 5程序端的连接</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> mt5<span class="token punctuation">.</span>initialize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;initialize() failed, error code =&quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 获取历史中的交易数量</span>
from_date<span class="token operator">=</span>datetime<span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
to_date<span class="token operator">=</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 获取指定时间间隔内且名称包含&quot;GBP&quot;的交易品种的交易</span>
deals<span class="token operator">=</span>mt5<span class="token punctuation">.</span>history_deals_get<span class="token punctuation">(</span>from_date<span class="token punctuation">,</span> to_date<span class="token punctuation">,</span> group<span class="token operator">=</span><span class="token string">&quot;*GBP*&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> deals<span class="token operator">==</span><span class="token boolean">None</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;No deals with group=\&quot;*USD*\&quot;, error code={}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">elif</span> <span class="token builtin">len</span><span class="token punctuation">(</span>deals<span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;history_deals_get({}, {}, group=\&quot;*GBP*\&quot;)={}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>from_date<span class="token punctuation">,</span>to_date<span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>deals<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 
<span class="token comment"># 获取名称中既不包含&quot;EUR&quot;也不包含&quot;GBP&quot;的交易品种的交易</span>
deals <span class="token operator">=</span> mt5<span class="token punctuation">.</span>history_deals_get<span class="token punctuation">(</span>from_date<span class="token punctuation">,</span> to_date<span class="token punctuation">,</span> group<span class="token operator">=</span><span class="token string">&quot;*,!*EUR*,!*GBP*&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> deals <span class="token operator">==</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;No deals, error code={}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">elif</span> <span class="token builtin">len</span><span class="token punctuation">(</span>deals<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;history_deals_get(from_date, to_date, group=\&quot;*,!*EUR*,!*GBP*\&quot;) =&quot;</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>deals<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># display all obtained deals 'as is'</span>
    <span class="token keyword">for</span> deal <span class="token keyword">in</span> deals<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;  &quot;</span><span class="token punctuation">,</span>deal<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># display these deals as a table using pandas.DataFrame</span>
    df<span class="token operator">=</span>pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>deals<span class="token punctuation">)</span><span class="token punctuation">,</span>columns<span class="token operator">=</span>deals<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>_asdict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    df<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> unit<span class="token operator">=</span><span class="token string">'s'</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
 
<span class="token comment"># 获取#530218319持仓相关的所有交易</span>
position_id<span class="token operator">=</span><span class="token number">530218319</span>
position_deals <span class="token operator">=</span> mt5<span class="token punctuation">.</span>history_deals_get<span class="token punctuation">(</span>position<span class="token operator">=</span>position_id<span class="token punctuation">)</span>
<span class="token keyword">if</span> position_deals <span class="token operator">==</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;No deals with position #{}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>position_id<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;error code =&quot;</span><span class="token punctuation">,</span> mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">elif</span> <span class="token builtin">len</span><span class="token punctuation">(</span>position_deals<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Deals with position id #{}: {}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>position_id<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>position_deals<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># display these deals as a table using pandas.DataFrame</span>
    df<span class="token operator">=</span>pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>position_deals<span class="token punctuation">)</span><span class="token punctuation">,</span>columns<span class="token operator">=</span>position_deals<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>_asdict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    df<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> unit<span class="token operator">=</span><span class="token string">'s'</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
 
<span class="token comment"># 断开与MetaTrader 5程序端的连接</span>
mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
结果：
MetaTrader5程序包作者：MetaQuotes Software Corp<span class="token punctuation">.</span>
MetaTrader5程序包版本：<span class="token number">5.0</span><span class="token number">.29</span>
 
history_deals_get<span class="token punctuation">(</span>from_date<span class="token punctuation">,</span> to_date<span class="token punctuation">,</span> group<span class="token operator">=</span><span class="token string">&quot;*GBP*&quot;</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">14</span>
 
history_deals_get<span class="token punctuation">(</span>from_date<span class="token punctuation">,</span> to_date<span class="token punctuation">,</span> group<span class="token operator">=</span><span class="token string">&quot;*,!*EUR*,!*GBP*&quot;</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">7</span>
   TradeDeal<span class="token punctuation">(</span>ticket<span class="token operator">=</span><span class="token number">506966741</span><span class="token punctuation">,</span> order<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> time<span class="token operator">=</span><span class="token number">1582202125</span><span class="token punctuation">,</span> time_msc<span class="token operator">=</span><span class="token number">1582202125419</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> entry<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> magic<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> position_id<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> reason<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> volume<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">,</span> pri <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
   TradeDeal<span class="token punctuation">(</span>ticket<span class="token operator">=</span><span class="token number">507962919</span><span class="token punctuation">,</span> order<span class="token operator">=</span><span class="token number">530218319</span><span class="token punctuation">,</span> time<span class="token operator">=</span><span class="token number">1582303777</span><span class="token punctuation">,</span> time_msc<span class="token operator">=</span><span class="token number">1582303777582</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> entry<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> magic<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> position_id<span class="token operator">=</span><span class="token number">530218319</span><span class="token punctuation">,</span> reason<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
   TradeDeal<span class="token punctuation">(</span>ticket<span class="token operator">=</span><span class="token number">513149059</span><span class="token punctuation">,</span> order<span class="token operator">=</span><span class="token number">535548147</span><span class="token punctuation">,</span> time<span class="token operator">=</span><span class="token number">1583176242</span><span class="token punctuation">,</span> time_msc<span class="token operator">=</span><span class="token number">1583176242265</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> entry<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> magic<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> position_id<span class="token operator">=</span><span class="token number">530218319</span><span class="token punctuation">,</span> reason<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
   TradeDeal<span class="token punctuation">(</span>ticket<span class="token operator">=</span><span class="token number">516943494</span><span class="token punctuation">,</span> order<span class="token operator">=</span><span class="token number">539349382</span><span class="token punctuation">,</span> time<span class="token operator">=</span><span class="token number">1583510003</span><span class="token punctuation">,</span> time_msc<span class="token operator">=</span><span class="token number">1583510003895</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> entry<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> magic<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> position_id<span class="token operator">=</span><span class="token number">539349382</span><span class="token punctuation">,</span> reason<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
   TradeDeal<span class="token punctuation">(</span>ticket<span class="token operator">=</span><span class="token number">516943915</span><span class="token punctuation">,</span> order<span class="token operator">=</span><span class="token number">539349802</span><span class="token punctuation">,</span> time<span class="token operator">=</span><span class="token number">1583510025</span><span class="token punctuation">,</span> time_msc<span class="token operator">=</span><span class="token number">1583510025054</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> entry<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> magic<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> position_id<span class="token operator">=</span><span class="token number">539349802</span><span class="token punctuation">,</span> reason<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
   TradeDeal<span class="token punctuation">(</span>ticket<span class="token operator">=</span><span class="token number">517139682</span><span class="token punctuation">,</span> order<span class="token operator">=</span><span class="token number">539557870</span><span class="token punctuation">,</span> time<span class="token operator">=</span><span class="token number">1583520201</span><span class="token punctuation">,</span> time_msc<span class="token operator">=</span><span class="token number">1583520201227</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> entry<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> magic<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> position_id<span class="token operator">=</span><span class="token number">539349382</span><span class="token punctuation">,</span> reason<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
   TradeDeal<span class="token punctuation">(</span>ticket<span class="token operator">=</span><span class="token number">517139716</span><span class="token punctuation">,</span> order<span class="token operator">=</span><span class="token number">539557909</span><span class="token punctuation">,</span> time<span class="token operator">=</span><span class="token number">1583520202</span><span class="token punctuation">,</span> time_msc<span class="token operator">=</span><span class="token number">1583520202971</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> entry<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> magic<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> position_id<span class="token operator">=</span><span class="token number">539349802</span><span class="token punctuation">,</span> reason<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
 
      ticket      order                time       time_msc  <span class="token builtin">type</span>  entry  magic  position_id  reason  volume    price  commission  swap     profit  fee  symbol comment external_id
<span class="token number">0</span>  <span class="token number">506966741</span>          <span class="token number">0</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">20</span> <span class="token number">12</span><span class="token punctuation">:</span><span class="token number">35</span><span class="token punctuation">:</span><span class="token number">25</span>  <span class="token number">1582202125419</span>     <span class="token number">2</span>      <span class="token number">0</span>      <span class="token number">0</span>            <span class="token number">0</span>       <span class="token number">0</span>    <span class="token number">0.00</span>  <span class="token number">0.00000</span>         <span class="token number">0.0</span>   <span class="token number">0.0</span>  <span class="token number">100000.00</span>  <span class="token number">0.0</span>                            
<span class="token number">1</span>  <span class="token number">507962919</span>  <span class="token number">530218319</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">21</span> <span class="token number">16</span><span class="token punctuation">:</span><span class="token number">49</span><span class="token punctuation">:</span><span class="token number">37</span>  <span class="token number">1582303777582</span>     <span class="token number">0</span>      <span class="token number">0</span>      <span class="token number">0</span>    <span class="token number">530218319</span>       <span class="token number">0</span>    <span class="token number">0.01</span>  <span class="token number">0.97898</span>         <span class="token number">0.0</span>   <span class="token number">0.0</span>       <span class="token number">0.00</span>  <span class="token number">0.0</span>  USDCHF                    
<span class="token number">2</span>  <span class="token number">513149059</span>  <span class="token number">535548147</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">02</span> <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token number">42</span>  <span class="token number">1583176242265</span>     <span class="token number">1</span>      <span class="token number">1</span>      <span class="token number">0</span>    <span class="token number">530218319</span>       <span class="token number">0</span>    <span class="token number">0.01</span>  <span class="token number">0.95758</span>         <span class="token number">0.0</span>   <span class="token number">0.0</span>     <span class="token operator">-</span><span class="token number">22.35</span>  <span class="token number">0.0</span>  USDCHF                    
<span class="token number">3</span>  <span class="token number">516943494</span>  <span class="token number">539349382</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">06</span> <span class="token number">15</span><span class="token punctuation">:</span><span class="token number">53</span><span class="token punctuation">:</span><span class="token number">23</span>  <span class="token number">1583510003895</span>     <span class="token number">1</span>      <span class="token number">0</span>      <span class="token number">0</span>    <span class="token number">539349382</span>       <span class="token number">0</span>    <span class="token number">0.10</span>  <span class="token number">0.93475</span>         <span class="token number">0.0</span>   <span class="token number">0.0</span>       <span class="token number">0.00</span>  <span class="token number">0.0</span>  USDCHF                    
<span class="token number">4</span>  <span class="token number">516943915</span>  <span class="token number">539349802</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">06</span> <span class="token number">15</span><span class="token punctuation">:</span><span class="token number">53</span><span class="token punctuation">:</span><span class="token number">45</span>  <span class="token number">1583510025054</span>     <span class="token number">0</span>      <span class="token number">0</span>      <span class="token number">0</span>    <span class="token number">539349802</span>       <span class="token number">0</span>    <span class="token number">0.10</span>  <span class="token number">0.66336</span>         <span class="token number">0.0</span>   <span class="token number">0.0</span>       <span class="token number">0.00</span>  <span class="token number">0.0</span>  AUDUSD                    
<span class="token number">5</span>  <span class="token number">517139682</span>  <span class="token number">539557870</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">06</span> <span class="token number">18</span><span class="token punctuation">:</span><span class="token number">43</span><span class="token punctuation">:</span><span class="token number">21</span>  <span class="token number">1583520201227</span>     <span class="token number">0</span>      <span class="token number">1</span>      <span class="token number">0</span>    <span class="token number">539349382</span>       <span class="token number">0</span>    <span class="token number">0.10</span>  <span class="token number">0.93751</span>         <span class="token number">0.0</span>   <span class="token number">0.0</span>     <span class="token operator">-</span><span class="token number">29.44</span>  <span class="token number">0.0</span>  USDCHF                    
<span class="token number">6</span>  <span class="token number">517139716</span>  <span class="token number">539557909</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">06</span> <span class="token number">18</span><span class="token punctuation">:</span><span class="token number">43</span><span class="token punctuation">:</span><span class="token number">22</span>  <span class="token number">1583520202971</span>     <span class="token number">1</span>      <span class="token number">1</span>      <span class="token number">0</span>    <span class="token number">539349802</span>       <span class="token number">0</span>    <span class="token number">0.10</span>  <span class="token number">0.66327</span>         <span class="token number">0.0</span>   <span class="token number">0.0</span>      <span class="token operator">-</span><span class="token number">0.90</span>  <span class="token number">0.0</span>  AUDUSD                    
 
Deals <span class="token keyword">with</span> position <span class="token builtin">id</span> <span class="token comment">#530218319: 2</span>
      ticket      order                time       time_msc  <span class="token builtin">type</span>  entry  magic  position_id  reason  volume    price  commission  swap  profit  fee  symbol comment external_id
<span class="token number">0</span>  <span class="token number">507962919</span>  <span class="token number">530218319</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">21</span> <span class="token number">16</span><span class="token punctuation">:</span><span class="token number">49</span><span class="token punctuation">:</span><span class="token number">37</span>  <span class="token number">1582303777582</span>     <span class="token number">0</span>      <span class="token number">0</span>      <span class="token number">0</span>    <span class="token number">530218319</span>       <span class="token number">0</span>    <span class="token number">0.01</span>  <span class="token number">0.97898</span>         <span class="token number">0.0</span>   <span class="token number">0.0</span>    <span class="token number">0.00</span>  <span class="token number">0.0</span>  USDCHF                    
<span class="token number">1</span>  <span class="token number">513149059</span>  <span class="token number">535548147</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">02</span> <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token number">42</span>  <span class="token number">1583176242265</span>     <span class="token number">1</span>      <span class="token number">1</span>      <span class="token number">0</span>    <span class="token number">530218319</span>       <span class="token number">0</span>    <span class="token number">0.01</span>  <span class="token number">0.95758</span>         <span class="token number">0.0</span>   <span class="token number">0.0</span>  <span class="token operator">-</span><span class="token number">22.35</span>  <span class="token number">0.0</span>  USDCHF   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br></div></div><p>另见</p> <p>history_deals_total、history_orders_get</p> <h3 id="_32-1-31-history-orders-total"><a href="#_32-1-31-history-orders-total" class="header-anchor">#</a> 32.1.31 history_orders_total</h3> <p>获取交易历史中指定时间间隔内的订单数量。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>history_orders_total(
   date_from,    // 请求订单的开始日期
   date_to       //请求订单的结束日期
   )
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>参数</p> <p>date_from</p> <p>[in]  请求订单的开始日期。通过'datetime'对象或根据1970.01.01以来过去的秒数设置。所需的未命名参数。</p> <p>date_to</p> <p>[in]  请求订单的结束日期。通过'datetime'对象或根据1970.01.01以来过去的秒数设置。所需的未命名参数。</p> <p>返回值</p> <p>整数值。</p> <p>注意</p> <p>The function is similar to HistoryOrdersTotal.</p> <p>例如：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
<span class="token keyword">import</span> MetaTrader5 <span class="token keyword">as</span> mt5
<span class="token comment"># 显示有关MetaTrader 5程序包的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package author: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__author__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package version: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
 
<span class="token comment"># 建立与MetaTrader 5程序端的连接</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> mt5<span class="token punctuation">.</span>initialize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;initialize() failed, error code =&quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 获取历史中的订单数量</span>
from_date<span class="token operator">=</span>datetime<span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
to_date<span class="token operator">=</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
history_orders<span class="token operator">=</span>mt5<span class="token punctuation">.</span>history_orders_total<span class="token punctuation">(</span>from_date<span class="token punctuation">,</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> history_orders<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Total history orders=&quot;</span><span class="token punctuation">,</span>history_orders<span class="token punctuation">)</span>
其他：
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Orders not found in history&quot;</span><span class="token punctuation">)</span>
 
<span class="token comment"># 断开与MetaTrader 5程序端的连接</span>
mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>另见</p> <p>history_orders_get、history_deals_total</p> <h3 id="_32-1-32-history-orders-get"><a href="#_32-1-32-history-orders-get" class="header-anchor">#</a> 32.1.32  history_orders_get</h3> <p>获取可通过单号或持仓筛选的交易历史中的订单。共有三个调用选项。</p> <p>调用指定时间间隔。返回指定时间间隔内的所有订单。</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>history_orders_get<span class="token punctuation">(</span>
   date_from<span class="token punctuation">,</span>           <span class="token operator">//</span> 请求订单的开始日期
   date_to<span class="token punctuation">,</span>             <span class="token operator">//</span> 请求订单的结束日期
   group<span class="token operator">=</span><span class="token string">&quot;GROUP&quot;</span>        <span class="token operator">//</span> 根据交易品种选择订单的过滤器
   <span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>调用指定订单单号。返回带有指定单号的订单。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>positions_get(
   ticket=TICKET        //订单单号
)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>调用指定持仓单号。返回在ORDER_POSITION_ID属性中具有指定持仓单号的所有订单。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>positions_get(
   position=POSITION    //持仓单号
)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>参数</p> <p>date_from</p> <p>[in]  请求订单的开始日期。通过'datetime'对象或根据1970.01.01以来过去的秒数设置。首先指定所需的未命名参数。</p> <p>date_to</p> <p>[in]  请求订单的结束日期。通过'datetime'对象或根据1970.01.01以来过去的秒数设置。其次指定所需的未命名参数。</p> <p>group=&quot;GROUP&quot;</p> <p>[in]  用于跑了一组必要交易品种的过滤器。可选的命名参数。如果指定了组，则函数只返回满足交易品种名称指定条件的订单。</p> <p>ticket=TICKET</p> <p>[in]  应该接收的订单单号。可选参数。如果没有指定，则不应用过滤器。</p> <p>position=POSITION</p> <p>[in]  应接收所有交易的持仓单号（存储在ORDER_POSITION_ID）。可选参数。如果没有指定，则不应用过滤器。</p> <p>返回值</p> <p>以指定元组结构(namedtuple)的形式返回信息。错误情况下返回None。可使用last_error()获取错误信息。</p> <p>注意</p> <p>该函数允许在一个类似于HistoryOrdersTotal和HistoryOrderSelect的串联调用中接收指定时间段内的所有历史订单。</p> <p>group参数可以包含多个逗号分隔条件。条件可以使用'*'设置为掩码。逻辑否定字符'!'可以用来表示排除条件。所有条件依序应用，这意味着应该先指定包含到组中的条件，然后再指定排除条件。例如，group=&quot;*, !EUR&quot;意味着应该先选择所有交易品种的交易，然后排除交易品种名称中包含&quot;EUR&quot;的交易。</p> <p>例如：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
<span class="token keyword">import</span> MetaTrader5 <span class="token keyword">as</span> mt5
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'display.max_columns'</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span> <span class="token comment"># number of columns to be displayed</span>
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'display.width'</span><span class="token punctuation">,</span> <span class="token number">1500</span><span class="token punctuation">)</span>      <span class="token comment"># max table width to display</span>
<span class="token comment"># 显示有关MetaTrader 5程序包的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package author: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__author__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;MetaTrader5 package version: &quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 建立与MetaTrader 5程序端的连接</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> mt5<span class="token punctuation">.</span>initialize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;initialize() failed, error code =&quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 获取历史中的订单数量</span>
from_date<span class="token operator">=</span>datetime<span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
to_date<span class="token operator">=</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
history_orders<span class="token operator">=</span>mt5<span class="token punctuation">.</span>history_orders_get<span class="token punctuation">(</span>from_date<span class="token punctuation">,</span> to_date<span class="token punctuation">,</span> group<span class="token operator">=</span><span class="token string">&quot;*GBP*&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> history_orders<span class="token operator">==</span><span class="token boolean">None</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;No history orders with group=\&quot;*GBP*\&quot;, error code={}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">elif</span> <span class="token builtin">len</span><span class="token punctuation">(</span>history_orders<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;history_orders_get({}, {}, group=\&quot;*GBP*\&quot;)={}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>from_date<span class="token punctuation">,</span>to_date<span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>history_orders<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 根据持仓单号显示所有历史订单</span>
position_id<span class="token operator">=</span><span class="token number">530218319</span>
position_history_orders<span class="token operator">=</span>mt5<span class="token punctuation">.</span>history_orders_get<span class="token punctuation">(</span>position<span class="token operator">=</span>position_id<span class="token punctuation">)</span>
<span class="token keyword">if</span> position_history_orders<span class="token operator">==</span><span class="token boolean">None</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;No orders with position #{}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>position_id<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;error code =&quot;</span><span class="token punctuation">,</span>mt5<span class="token punctuation">.</span>last_error<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">elif</span> <span class="token builtin">len</span><span class="token punctuation">(</span>position_history_orders<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Total history orders on position #{}: {}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>position_id<span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>position_history_orders<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   <span class="token comment"># 显示带有指定持仓单号的所有历史订单</span>
    <span class="token keyword">for</span> position_order <span class="token keyword">in</span> position_history_orders<span class="token punctuation">:</span>        
        <span class="token keyword">print</span><span class="token punctuation">(</span>position_order<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># display these orders as a table using pandas.DataFrame</span>
    df<span class="token operator">=</span>pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>position_history_orders<span class="token punctuation">)</span><span class="token punctuation">,</span>columns<span class="token operator">=</span>position_history_orders<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>_asdict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    df<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'time_expiration'</span><span class="token punctuation">,</span><span class="token string">'type_time'</span><span class="token punctuation">,</span><span class="token string">'state'</span><span class="token punctuation">,</span><span class="token string">'position_by_id'</span><span class="token punctuation">,</span><span class="token string">'reason'</span><span class="token punctuation">,</span><span class="token string">'volume_current'</span><span class="token punctuation">,</span><span class="token string">'price_stoplimit'</span><span class="token punctuation">,</span><span class="token string">'sl'</span><span class="token punctuation">,</span><span class="token string">'tp'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    df<span class="token punctuation">[</span><span class="token string">'time_setup'</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'time_setup'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> unit<span class="token operator">=</span><span class="token string">'s'</span><span class="token punctuation">)</span>
    df<span class="token punctuation">[</span><span class="token string">'time_done'</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'time_done'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> unit<span class="token operator">=</span><span class="token string">'s'</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
 
<span class="token comment"># 断开与MetaTrader 5程序端的连接</span>
mt5<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
结果：
MetaTrader5程序包作者：MetaQuotes Software Corp<span class="token punctuation">.</span>
MetaTrader5程序包版本：<span class="token number">5.0</span><span class="token number">.29</span>
 
history_orders_get<span class="token punctuation">(</span><span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">,</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">25</span> <span class="token number">17</span><span class="token punctuation">:</span><span class="token number">17</span><span class="token punctuation">:</span><span class="token number">32.058795</span><span class="token punctuation">,</span> group<span class="token operator">=</span><span class="token string">&quot;*GBP*&quot;</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">14</span>
 
Total history orders on position <span class="token comment">#530218319: 2</span>
TradeOrder<span class="token punctuation">(</span>ticket<span class="token operator">=</span><span class="token number">530218319</span><span class="token punctuation">,</span> time_setup<span class="token operator">=</span><span class="token number">1582282114</span><span class="token punctuation">,</span> time_setup_msc<span class="token operator">=</span><span class="token number">1582282114681</span><span class="token punctuation">,</span> time_done<span class="token operator">=</span><span class="token number">1582303777</span><span class="token punctuation">,</span> time_done_msc<span class="token operator">=</span><span class="token number">1582303777582</span><span class="token punctuation">,</span> time_expiration<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
TradeOrder<span class="token punctuation">(</span>ticket<span class="token operator">=</span><span class="token number">535548147</span><span class="token punctuation">,</span> time_setup<span class="token operator">=</span><span class="token number">1583176242</span><span class="token punctuation">,</span> time_setup_msc<span class="token operator">=</span><span class="token number">1583176242265</span><span class="token punctuation">,</span> time_done<span class="token operator">=</span><span class="token number">1583176242</span><span class="token punctuation">,</span> time_done_msc<span class="token operator">=</span><span class="token number">1583176242265</span><span class="token punctuation">,</span> time_expiration<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
 
      ticket          time_setup  time_setup_msc           time_done  time_done_msc  <span class="token builtin">type</span>  type_filling  magic  position_id  volume_initial  price_open  price_current  symbol comment external_id
<span class="token number">0</span>  <span class="token number">530218319</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">21</span> <span class="token number">10</span><span class="token punctuation">:</span><span class="token number">48</span><span class="token punctuation">:</span><span class="token number">34</span>   <span class="token number">1582282114681</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">21</span> <span class="token number">16</span><span class="token punctuation">:</span><span class="token number">49</span><span class="token punctuation">:</span><span class="token number">37</span>  <span class="token number">1582303777582</span>     <span class="token number">2</span>             <span class="token number">2</span>      <span class="token number">0</span>    <span class="token number">530218319</span>            <span class="token number">0.01</span>     <span class="token number">0.97898</span>        <span class="token number">0.97863</span>  USDCHF                    
<span class="token number">1</span>  <span class="token number">535548147</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">02</span> <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token number">42</span>   <span class="token number">1583176242265</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">02</span> <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token number">42</span>  <span class="token number">1583176242265</span>     <span class="token number">1</span>             <span class="token number">0</span>      <span class="token number">0</span>    <span class="token number">530218319</span>            <span class="token number">0.01</span>     <span class="token number">0.95758</span>        <span class="token number">0.95758</span>  USDCHF   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br></div></div><p>另见</p> <p>history_deals_total、history_deals_get</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/mql5yao/Chapter/thirtyone.html" class="prev">
        32 第卅二章 使用DirectX
      </a></span> <span class="next"><a href="/mql5yao/Chapter/add2.html">
        34 第卅四章 ONNX模型
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/mql5yao/assets/js/app.8a48e4d1.js" defer></script><script src="/mql5yao/assets/js/2.8ccfeae3.js" defer></script><script src="/mql5yao/assets/js/1.abd3212e.js" defer></script><script src="/mql5yao/assets/js/34.35c02b74.js" defer></script>
  </body>
</html>
