<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>智能交易*姚 文档站</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/mql5yao/favicon.ico">
    <meta name="description" content="这是智能交易的文档站点。">
    <meta name="keywords" content="MQL,EA,智能交易,自动交易,量化,编程,培训">
    
    <link rel="preload" href="/mql5yao/assets/css/0.styles.c167a2d0.css" as="style"><link rel="preload" href="/mql5yao/assets/js/app.f23448f4.js" as="script"><link rel="preload" href="/mql5yao/assets/js/3.a8269cb7.js" as="script"><link rel="preload" href="/mql5yao/assets/js/26.07e08c10.js" as="script"><link rel="prefetch" href="/mql5yao/assets/js/10.a59489eb.js"><link rel="prefetch" href="/mql5yao/assets/js/11.1fde020f.js"><link rel="prefetch" href="/mql5yao/assets/js/12.a5634cbb.js"><link rel="prefetch" href="/mql5yao/assets/js/13.1e1b93d8.js"><link rel="prefetch" href="/mql5yao/assets/js/14.17d955a5.js"><link rel="prefetch" href="/mql5yao/assets/js/15.429599a3.js"><link rel="prefetch" href="/mql5yao/assets/js/16.bcf982ab.js"><link rel="prefetch" href="/mql5yao/assets/js/17.76fde0dd.js"><link rel="prefetch" href="/mql5yao/assets/js/18.49626d28.js"><link rel="prefetch" href="/mql5yao/assets/js/19.0f21f003.js"><link rel="prefetch" href="/mql5yao/assets/js/2.45a03fa6.js"><link rel="prefetch" href="/mql5yao/assets/js/20.18311061.js"><link rel="prefetch" href="/mql5yao/assets/js/21.63b34e06.js"><link rel="prefetch" href="/mql5yao/assets/js/22.a49527a7.js"><link rel="prefetch" href="/mql5yao/assets/js/23.2584759c.js"><link rel="prefetch" href="/mql5yao/assets/js/24.05b32517.js"><link rel="prefetch" href="/mql5yao/assets/js/25.991ff096.js"><link rel="prefetch" href="/mql5yao/assets/js/27.11150f9e.js"><link rel="prefetch" href="/mql5yao/assets/js/28.b5c9f3ea.js"><link rel="prefetch" href="/mql5yao/assets/js/29.a1ad142f.js"><link rel="prefetch" href="/mql5yao/assets/js/30.6da01d3d.js"><link rel="prefetch" href="/mql5yao/assets/js/31.28fa5dac.js"><link rel="prefetch" href="/mql5yao/assets/js/32.46aab1c1.js"><link rel="prefetch" href="/mql5yao/assets/js/33.f178c7a3.js"><link rel="prefetch" href="/mql5yao/assets/js/34.cd1eae3b.js"><link rel="prefetch" href="/mql5yao/assets/js/35.ee55e50b.js"><link rel="prefetch" href="/mql5yao/assets/js/36.56370362.js"><link rel="prefetch" href="/mql5yao/assets/js/37.2cc5b283.js"><link rel="prefetch" href="/mql5yao/assets/js/38.c3bba64a.js"><link rel="prefetch" href="/mql5yao/assets/js/39.86103eac.js"><link rel="prefetch" href="/mql5yao/assets/js/4.ffd96de7.js"><link rel="prefetch" href="/mql5yao/assets/js/40.0e36f079.js"><link rel="prefetch" href="/mql5yao/assets/js/41.17bccbf6.js"><link rel="prefetch" href="/mql5yao/assets/js/42.a40ca8ac.js"><link rel="prefetch" href="/mql5yao/assets/js/43.5a883397.js"><link rel="prefetch" href="/mql5yao/assets/js/44.19bdddfe.js"><link rel="prefetch" href="/mql5yao/assets/js/45.dec8257c.js"><link rel="prefetch" href="/mql5yao/assets/js/46.ed29615c.js"><link rel="prefetch" href="/mql5yao/assets/js/47.b6d07db1.js"><link rel="prefetch" href="/mql5yao/assets/js/48.d7ca24ca.js"><link rel="prefetch" href="/mql5yao/assets/js/5.47d44717.js"><link rel="prefetch" href="/mql5yao/assets/js/6.1f5c1ae1.js"><link rel="prefetch" href="/mql5yao/assets/js/7.1a679445.js"><link rel="prefetch" href="/mql5yao/assets/js/8.e80e8a9d.js"><link rel="prefetch" href="/mql5yao/assets/js/9.261aef18.js">
    <link rel="stylesheet" href="/mql5yao/assets/css/0.styles.c167a2d0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/mql5yao/" class="home-link router-link-active"><img src="/mql5yao/logo.png" alt="智能交易*姚 文档站" class="logo"> <span class="site-name can-hide">智能交易*姚 文档站</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/mql5yao/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/mql5yao/Chapter/start.html" class="nav-link">
  文档
</a></div><div class="nav-item"><a href="/mql5yao/Cutleeks/" class="nav-link">
  割韭菜XX招
</a></div><div class="nav-item"><a href="/mql5yao/support/" class="nav-link">
  支持本站
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/mql5yao/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/mql5yao/Chapter/start.html" class="nav-link">
  文档
</a></div><div class="nav-item"><a href="/mql5yao/Cutleeks/" class="nav-link">
  割韭菜XX招
</a></div><div class="nav-item"><a href="/mql5yao/support/" class="nav-link">
  支持本站
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>MQL5线上手册</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mql5yao/Chapter/start.html" class="sidebar-link">MQL5 参考</a></li><li><a href="/mql5yao/Chapter/one.html" class="sidebar-link">01 第一章 语言基础</a></li><li><a href="/mql5yao/Chapter/two.html" class="sidebar-link">02 第二章 标准常量，列举和架构</a></li><li><a href="/mql5yao/Chapter/three.html" class="sidebar-link">03 第三章 MQL5程序</a></li><li><a href="/mql5yao/Chapter/four.html" class="sidebar-link">04 第四章 预定义变量</a></li><li><a href="/mql5yao/Chapter/five.html" class="sidebar-link">05 第五章 普通函数</a></li><li><a href="/mql5yao/Chapter/six.html" class="sidebar-link">06 第六章 数组函数</a></li><li><a href="/mql5yao/Chapter/add1.html" class="sidebar-link">07 第add1章 矩阵和向量方法</a></li><li><a href="/mql5yao/Chapter/seven.html" class="sidebar-link">07 第七章 函数转换</a></li><li><a href="/mql5yao/Chapter/eight.html" class="sidebar-link">08 第八章 数学函数</a></li><li><a href="/mql5yao/Chapter/nine.html" class="sidebar-link">09 第九章 字符串函数</a></li><li><a href="/mql5yao/Chapter/ten.html" class="sidebar-link">10 第十章 日期和时间</a></li><li><a href="/mql5yao/Chapter/eleven.html" class="sidebar-link">11 第十一章 账户信息</a></li><li><a href="/mql5yao/Chapter/twelve.html" class="sidebar-link">12 第十二章 检测</a></li><li><a href="/mql5yao/Chapter/thirteen.html" class="sidebar-link">13 第十三章 事件处理</a></li><li><a href="/mql5yao/Chapter/fourteen.html" class="sidebar-link">14 第十四章 市场信息</a></li><li><a href="/mql5yao/Chapter/fifteen.html" class="sidebar-link">15 第十五章 经济日历函数</a></li><li><a href="/mql5yao/Chapter/sixteen.html" class="sidebar-link">16 第十六章 时间序列和指标访问</a></li><li><a href="/mql5yao/Chapter/seventeen.html" class="sidebar-link">17 第十七章 自定义交易品种</a></li><li><a href="/mql5yao/Chapter/eighteen.html" aria-current="page" class="active sidebar-link">18 第十八章 图表操作</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/eighteen.html#_18-1-chartapplytemplate" class="sidebar-link">18.1 ChartApplyTemplate</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/eighteen.html#_18-2-chartsavetemplate" class="sidebar-link">18.2 ChartSaveTemplate</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/eighteen.html#_18-3-chartwindowfind" class="sidebar-link">18.3 ChartWindowFind</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/eighteen.html#_18-4-charttimepricetoxy" class="sidebar-link">18.4 ChartTimePriceToXY</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/eighteen.html#_18-5-chartxytotimeprice" class="sidebar-link">18.5 ChartXYToTimePrice</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/eighteen.html#_18-6-chartopen" class="sidebar-link">18.6 ChartOpen</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/eighteen.html#_18-7-chartfirst" class="sidebar-link">18.7 ChartFirst</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/eighteen.html#_18-8-chartnext" class="sidebar-link">18.8 ChartNext</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/eighteen.html#_18-9-chartclose" class="sidebar-link">18.9 ChartClose</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/eighteen.html#_18-10-chartsymbol" class="sidebar-link">18.10 ChartSymbol</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/eighteen.html#_18-11-chartperiod" class="sidebar-link">18.11 ChartPeriod</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/eighteen.html#_18-12-chartredraw" class="sidebar-link">18.12 ChartRedraw</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/eighteen.html#_18-13-chartsetdouble" class="sidebar-link">18.13 ChartSetDouble</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/eighteen.html#_18-14-chartsetinteger" class="sidebar-link">18.14 ChartSetInteger</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/eighteen.html#_18-15-chartsetstring" class="sidebar-link">18.15 ChartSetString</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/eighteen.html#_18-16-chartgetdouble" class="sidebar-link">18.16 ChartGetDouble</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/eighteen.html#_18-17-chartgetinteger" class="sidebar-link">18.17 ChartGetInteger</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/eighteen.html#_18-18-chartgetstring" class="sidebar-link">18.18 ChartGetString</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/eighteen.html#_18-19-chartnavigate" class="sidebar-link">18.19 ChartNavigate</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/eighteen.html#_18-20-chartid" class="sidebar-link">18.20 ChartID</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/eighteen.html#_18-21-chartindicatoradd" class="sidebar-link">18.21 ChartIndicatorAdd</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/eighteen.html#_18-22-chartindicatordelete" class="sidebar-link">18.22 ChartIndicatorDelete</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/eighteen.html#_18-23-chartindicatorget" class="sidebar-link">18.23 ChartIndicatorGet</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/eighteen.html#_18-24-chartindicatorname" class="sidebar-link">18.24 ChartIndicatorName</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/eighteen.html#_18-25-chartindicatorstotal" class="sidebar-link">18.25 ChartIndicatorsTotal</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/eighteen.html#_18-26-chartwindowondropped" class="sidebar-link">18.26 ChartWindowOnDropped</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/eighteen.html#_18-27-chartpriceondropped" class="sidebar-link">18.27 ChartPriceOnDropped</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/eighteen.html#_18-28-charttimeondropped" class="sidebar-link">18.28 ChartTimeOnDropped</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/eighteen.html#_18-29-chartxondropped" class="sidebar-link">18.29 ChartXOnDropped</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/eighteen.html#_18-30-chartyondropped" class="sidebar-link">18.30 ChartYOnDropped</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/eighteen.html#_18-31-chartsetsymbolperiod" class="sidebar-link">18.31 ChartSetSymbolPeriod</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/eighteen.html#_18-32-chartscreenshot" class="sidebar-link">18.32 ChartScreenShot</a></li></ul></li><li><a href="/mql5yao/Chapter/ninteen.html" class="sidebar-link">19 第十九章 交易函数</a></li><li><a href="/mql5yao/Chapter/twenty.html" class="sidebar-link">20 第二十章 交易信号</a></li><li><a href="/mql5yao/Chapter/twentyone.html" class="sidebar-link">21 第二十一章 网络函数</a></li><li><a href="/mql5yao/Chapter/twentytwo.html" class="sidebar-link">22 第二十二章 程序端全局变量</a></li><li><a href="/mql5yao/Chapter/twentythree.html" class="sidebar-link">23 第二十三章 文件函数</a></li><li><a href="/mql5yao/Chapter/twentyfour.html" class="sidebar-link">24 第二十四章 自定义指标</a></li><li><a href="/mql5yao/Chapter/twentyfive.html" class="sidebar-link">25 第二十五章 物件函数</a></li><li><a href="/mql5yao/Chapter/twentysix.html" class="sidebar-link">26 第二十六章 技术指标</a></li><li><a href="/mql5yao/Chapter/twentyseven.html" class="sidebar-link">27 第二十七章 处理优化结果</a></li><li><a href="/mql5yao/Chapter/twentyeight.html" class="sidebar-link">28 第二十八章 工作事件</a></li><li><a href="/mql5yao/Chapter/twentynine.html" class="sidebar-link">29 第二十九章 使用OpenCL工作</a></li><li><a href="/mql5yao/Chapter/thirty.html" class="sidebar-link">30 第三十章 使用数据库</a></li><li><a href="/mql5yao/Chapter/thirtyone.html" class="sidebar-link">31 第三十一章 使用DirectX</a></li><li><a href="/mql5yao/Chapter/thirtytwo.html" class="sidebar-link">32 第三十二章 集成</a></li><li><a href="/mql5yao/Chapter/add2.html" class="sidebar-link">32 第add2章 ONNX模型</a></li><li><a href="/mql5yao/Chapter/thirtythree.html" class="sidebar-link">33 第三十三章 标准程序库</a></li><li><a href="/mql5yao/Chapter/AppendixI.html" class="sidebar-link">34 附录一 来自MQL4</a></li><li><a href="/mql5yao/Chapter/AppendixII.html" class="sidebar-link">35 附录二 MQL5 函数列表</a></li><li><a href="/mql5yao/Chapter/AppendixIII.html" class="sidebar-link">36 附录三 MQL5常量列表</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2> 第十八章  图表操作</h2> <p>这些是使用图表的函数。 所有图表操作的函数只能在EA交易程序 和 脚本中使用。</p> <p>设置图表属性的函数(ChartSetInteger，ChartSetDouble，ChartSetString)是不同步的，实际上用于向图表发送 更新 命令。如果这些函数成功执行，那么这个命令就包含在图表事件的公共队列中。在处理图表事件的队列时，相应的更改将实施到图表。</p> <p>因此，不要期望在调用这些函数后立即直观地看到图表更新。 一般情况下，客户端会在更改事件后自动更新图表 —— 新的报价到达、调整图表窗口大小等。使用ChartRedraw()函数以强制更新图表的外观和属性。</p> <table><thead><tr><th>函数</th> <th>功能</th></tr></thead> <tbody><tr><td>ChartApplyTemplate</td> <td>指定一个模板文件应用到图表</td></tr> <tr><td>ChartSaveTemplate</td> <td>保存当前图表设置到指定名称的模板中</td></tr> <tr><td>ChartWindowFind</td> <td>返回绘画指标的副图(子)窗口数字编号</td></tr> <tr><td>ChartTimePriceToXY</td> <td>将图表的坐标从 时间/价格 转换为 X和Y轴</td></tr> <tr><td>ChartXYToTimePrice</td> <td>转换图表的X和Y轴到 时间和价格 值</td></tr> <tr><td>ChartOpen</td> <td>打开一个新图表显示指定的交易品种和时间周期</td></tr> <tr><td>ChartClose</td> <td>关闭指定图表。</td></tr> <tr><td>ChartFirst</td> <td>返回客户端的第一个图表的ID</td></tr> <tr><td>ChartNext</td> <td>返回指定图表的下一个图表的ID</td></tr> <tr><td>ChartSymbol</td> <td>返回指定图表的交易品种名称</td></tr> <tr><td>ChartPeriod</td> <td>返回指定图表的时间周期</td></tr> <tr><td>ChartRedraw</td> <td>指定图表强制重画</td></tr> <tr><td>ChartSetDouble</td> <td>设置指定图表相关属性的双精度值</td></tr> <tr><td>ChartSetInteger</td> <td>设置指定图表相关属性的整数值</td></tr> <tr><td>ChartSetString</td> <td>设置指定图表相关属性的字符串值</td></tr> <tr><td>ChartGetDouble</td> <td>返回指定图表的双精度值属性</td></tr> <tr><td>ChartGetInteger</td> <td>返回指定图表的整数值属性</td></tr> <tr><td>ChartGetString</td> <td>返回指定图表的字符串属性</td></tr> <tr><td>ChartNavigate</td> <td>根据指定的图表 定位常量，跳转到指定位置</td></tr> <tr><td>ChartID</td> <td>返回当前图表的ID编号</td></tr> <tr><td>ChartIndicatorAdd</td> <td>将指定的指标(句柄)添加到图表窗口中</td></tr> <tr><td>ChartIndicatorDelete</td> <td>从指定图表窗口移除一个指定名称的指标</td></tr> <tr><td>ChartIndicatorGet</td> <td>返回图表窗口中指定短名称的指标的句柄</td></tr> <tr><td>ChartIndicatorName</td> <td>在图表窗口，通过指定的数字编号，返回指标的短名称</td></tr> <tr><td>ChartIndicatorsTotal</td> <td>返回应用到指定图表窗口中的全部指标的总数量。</td></tr> <tr><td>ChartWindowOnDropped</td> <td>当拖动一个EA程序 或 脚本到图表窗口时，在 释放(松开) 鼠标左键时，此函数返回图表窗口的索引编号数字。</td></tr> <tr><td>ChartPriceOnDropped</td> <td>当拖动一个EA程序 或 脚本到图表窗口时，在 释放(松开) 鼠标左键时，此函数返回图表窗口对应的价格坐标。</td></tr> <tr><td>ChartTimeOnDropped</td> <td>当拖动一个EA程序 或 脚本到图表窗口时，在 释放(松开) 鼠标左键时，此函数返回图表窗口对应的时间坐标。</td></tr> <tr><td>ChartXOnDropped</td> <td>当拖动一个EA程序 或 脚本到图表窗口时，在 释放(松开) 鼠标左键时，此函数返回图表窗口对应的X坐标</td></tr> <tr><td>ChartYOnDropped</td> <td>当拖动一个EA程序 或 脚本到图表窗口时，在 释放(松开) 鼠标左键时，此函数返回图表窗口对应的Y坐标</td></tr> <tr><td>ChartSetSymbolPeriod</td> <td>改变图表窗口中的交易品种 和 时间周期</td></tr> <tr><td>ChartScreenShot</td> <td>根据指定的扩展名，以GIF，PNG或BMP格式对当前图表截屏</td></tr></tbody></table> <h2 id="_18-1-chartapplytemplate"><a href="#_18-1-chartapplytemplate" class="header-anchor">#</a> 18.1 ChartApplyTemplate</h2> <p>在图表中应用指定文件中的特定模板。该命令添加到图表信息队列并且将在处理完之前所有命令后开始执行。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  <span class="token function">ChartApplyTemplate</span><span class="token punctuation">(</span> 
   <span class="token keyword">long</span>          chart_id<span class="token punctuation">,</span>     <span class="token comment">// 图表 ID </span>
   <span class="token keyword">const</span> string  filename      <span class="token comment">// 模板文件名 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>参数</p> <p>chart_id</p> <p>[in] 图表 ID编号。0 表示当前图表。</p> <p>filename</p> <p>[in] 包含模板的文件名。</p> <p>返回值</p> <p>如果该命令已添加到图表队列，则返回true，否则返回false。要获取有关错误的信息，请调用GetLastError（）函数。</p> <p>注意</p> <p>如果成功将新模板加载到图表，EA交易程序将被卸载并且无法继续操作。</p> <p>将模板应用于图表时，由于安全原因，交易权限可能会受到限制：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>实时交易权限无法通过使用<span class="token function">ChartApplyTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>函数应用模板而扩展到EA交易程序中。   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>如果调用ChartApplyTemplate()函数的mql5-程序没有交易权限，那么无论模板如何设置，通过模板启动的EA交易都将不能交易。</p> <p>如果调用ChartApplyTemplate()函数的mql5-程序有交易权限，而在模板设置中没有这种权限，那么通过模板启动的EA交易程序也将不能交易。</p> <p>使用模板</p> <p>MQL5语言资源允许使用ChartSetInteger()函数设置多个图表的属性，包括颜色值：<br>
• 图表背景色；<br>
• 坐标轴，比例和OHLC线的颜色；<br>
• 网格颜色；<br>
• 交易量和持仓水平的颜色；<br>
• 牛市蜡烛图的影线和边界的颜色；<br>
• 熊市蜡烛图的影线和边界的颜色；<br>
• 图表线和十字蜡烛图的颜色；<br>
• 牛市蜡烛图主体的颜色；<br>
• 熊市蜡烛图主体的颜色；<br>
• 卖价(Bid)线的颜色；<br>
• 买价(Ask)线的颜色；<br>
• 最后成交价线(收盘价)的颜色；<br>
• 止损订单价位的颜色(止损和获利)。</p> <p>此外，在图表上可以有多个图形对象和指标。您可以创建一个包含所有必要指标的图表，然后将其保存为模板。这样的模板可以应用于任何图表。</p> <p>ChartApplyTemplate()函数可以使用以前保存的模板，并且可以在任何mql5程序中使用。 存储模板的文件路径作为第二个参数传递给ChartApplyTemplate()。 根据以下规则搜索模板文件：</p> <p>• 如果反斜杠 &quot;&quot; 分隔符(写为&quot;\&quot;)位于路径的开头，则会搜索相对路径 _terminal_data_directory\MQL5中的模板文件， • 如果没有反斜杠，则搜索相对于可执行EX5文件的模板，在该EX5文件中调用ChartApplyTemplate(); • 如果在前两个路径中未找到模板，则在文件夹terminal_directory \ Profiles \ Templates \中执行搜索。</p> <p>这里terminal_directory是指客户端运行的文件夹，terminal_data_directory是存储可编辑文件的 数据文件夹，它的位置取决于操作系统，用户名和计算机安全设置。通常它们是不同的文件夹，但某些情况下它们可能会重合。</p> <p>文件夹 terminal_data_directory 和 terminal_directory 的位置可以使用TerminalInfoString()函数获取。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//--- 启动程序端的目录 </span>
   string terminal_path<span class="token operator">=</span><span class="token function">TerminalInfoString</span><span class="token punctuation">(</span>TERMINAL_PATH<span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Terminal directory:&quot;</span><span class="token punctuation">,</span>terminal_path<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">//--- 程序端数据目录，这里存储MQL5的EA和指标文件夹 </span>
   string terminal_data_path<span class="token operator">=</span><span class="token function">TerminalInfoString</span><span class="token punctuation">(</span>TERMINAL_DATA_PATH<span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Terminal data directory:&quot;</span><span class="token punctuation">,</span>terminal_data_path<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>例如：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//--- 在terminal_data_directory\MQL5\搜索模板 </span>
<span class="token function">ChartApplyTemplate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">&quot;\\first_template.tpl&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
<span class="token comment">//--- 在directory_of_EX5_file\搜索模板, 然后在文件夹terminal_data_directory\Profiles\Templates\ </span>
<span class="token function">ChartApplyTemplate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">&quot;second_template.tpl&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
<span class="token comment">//--- 在directory_of_EX5_file\My_templates\搜索模板，然后在文件夹terminal_directory\Profiles\Templates\My_templates\ </span>
<span class="token function">ChartApplyTemplate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">&quot;My_templates\\third_template.tpl&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>模板不是资源，它们不能被包含到可执行EX5文件。
示例：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token comment">//| 脚本程序启动函数                                                   | </span>
<span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token keyword">void</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
  <span class="token punctuation">{</span> 
<span class="token comment">//--- 应用模板示例，位于\MQL5\Files </span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">FileIsExist</span><span class="token punctuation">(</span><span class="token string">&quot;my_template.tpl&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
     <span class="token punctuation">{</span> 
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;The file my_template.tpl found in \Files'&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token comment">//--- 应用模板 </span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">ChartApplyTemplate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">&quot;\\Files\\my_template.tpl&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
        <span class="token punctuation">{</span> 
         <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;The template 'my_template.tpl' applied successfully&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
         <span class="token comment">//--- 重绘图表 </span>
         <span class="token function">ChartRedraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token punctuation">}</span> 
      <span class="token keyword">else</span> 
         <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to apply 'my_template.tpl', error code &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
     <span class="token punctuation">}</span> 
   <span class="token keyword">else</span> 
     <span class="token punctuation">{</span> 
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;File 'my_template.tpl' not found in &quot;</span> 
            <span class="token operator">+</span><span class="token function">TerminalInfoString</span><span class="token punctuation">(</span>TERMINAL_PATH<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\\MQL5\\Files&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
     <span class="token punctuation">}</span> 
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>相关参考</p> <p>资源</p> <h2 id="_18-2-chartsavetemplate"><a href="#_18-2-chartsavetemplate" class="header-anchor">#</a> 18.2 ChartSaveTemplate</h2> <p>保存当前图表设置到指定名称的模板中。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  <span class="token function">ChartSaveTemplate</span><span class="token punctuation">(</span> 
   <span class="token keyword">long</span>          chart_id<span class="token punctuation">,</span>     <span class="token comment">// 图表 ID </span>
   <span class="token keyword">const</span> string  filename      <span class="token comment">// 保存模板的文件名 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>参数</p> <p>chart_id</p> <p>[in] 图表 ID编号。0 表示当前图表。</p> <p>filename</p> <p>[in] 保存模板的文件名。 “.tpl”扩展名将自动添加到文件名中; 无需指定。该模板保存在Templates \中，并可用于在客户端中手动加载。如果具有相同名称的模板文件已经存在，则该文件的内容将会被覆盖。</p> <p>返回值</p> <p>如果成功，函数返回true，否则返回false。若要获得有关错误的信息， 请调用 GetLastError() 函数。</p> <p>注意</p> <p>使用模板时，您可以保存所有应用指标和图形对象的图表设置，然后将其应用到另一个图表。</p> <p>例如：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token comment">//|                                       Test_ChartSaveTemplate.mq5 | </span>
<span class="token comment">//|                        Copyright 2011, MetaQuotes Software Corp. | </span>
<span class="token comment">//|                                             https://www.mql5.com | </span>
<span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">copyright </span><span class="token string">&quot;Copyright 2011, MetaQuotes Software Corp.&quot;</span> </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">link      </span><span class="token string">&quot;https://www.mql5.com&quot;</span> </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">version   </span><span class="token string">&quot;1.00&quot;</span> </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">script_show_inputs </span></span>
<span class="token comment">//--- 输入参数 </span>
input string               symbol<span class="token operator">=</span><span class="token string">&quot;GBPUSD&quot;</span><span class="token punctuation">;</span>  <span class="token comment">// 新图表的交易品种 </span>
input ENUM_TIMEFRAMES      period<span class="token operator">=</span>PERIOD_H3<span class="token punctuation">;</span> <span class="token comment">// 新图表的时间帧 </span>
<span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token comment">//| 脚本程序起始函数                                                   | </span>
<span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token keyword">void</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
  <span class="token punctuation">{</span> 
<span class="token comment">//--- 首先附加指标到图表 </span>
   <span class="token keyword">int</span> handle<span class="token punctuation">;</span> 
<span class="token comment">//--- 准备使用指标 </span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">PrepareZigzag</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>handle<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span> <span class="token comment">// 失败，所以退出 </span>
<span class="token comment">//--- 附加指标到当前图表，但是在独立窗口。 </span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ChartIndicatorAdd</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>handle<span class="token punctuation">)</span><span class="token punctuation">)</span> 
     <span class="token punctuation">{</span> 
      <span class="token function">PrintFormat</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to attach to chart %s/%s an indicator with the handle=%d. Error code %d&quot;</span><span class="token punctuation">,</span> 
                  _Symbol<span class="token punctuation">,</span> 
                  <span class="token function">EnumToString</span><span class="token punctuation">(</span>_Period<span class="token punctuation">)</span><span class="token punctuation">,</span> 
                  handle<span class="token punctuation">,</span> 
                  <span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token comment">//--- 终止程序操作 </span>
      <span class="token keyword">return</span><span class="token punctuation">;</span> 
     <span class="token punctuation">}</span> 
<span class="token comment">//--- 刷新图表看指标 </span>
   <span class="token function">ChartRedraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">//--- 找出最近两个Z字形断裂 </span>
   <span class="token keyword">double</span> two_values<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
   datetime two_times<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">GetLastTwoFractures</span><span class="token punctuation">(</span>two_values<span class="token punctuation">,</span>two_times<span class="token punctuation">,</span>handle<span class="token punctuation">)</span><span class="token punctuation">)</span> 
     <span class="token punctuation">{</span> 
      <span class="token function">PrintFormat</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to find two last fractures in the Zigzag!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token comment">//--- 终止程序操作 </span>
      <span class="token keyword">return</span><span class="token punctuation">;</span> 
     <span class="token punctuation">}</span> 
<span class="token comment">//--- 现在附加标准偏差通道 </span>
   string channel<span class="token operator">=</span><span class="token string">&quot;StdDeviation Channel&quot;</span><span class="token punctuation">;</span> 
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ObjectCreate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>channel<span class="token punctuation">,</span>OBJ_STDDEVCHANNEL<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>two_times<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
     <span class="token punctuation">{</span> 
      <span class="token function">PrintFormat</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to create object %s. Error code %d&quot;</span><span class="token punctuation">,</span> 
                  <span class="token function">EnumToString</span><span class="token punctuation">(</span>OBJ_STDDEVCHANNEL<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token keyword">return</span><span class="token punctuation">;</span> 
     <span class="token punctuation">}</span> 
   <span class="token keyword">else</span> 
     <span class="token punctuation">{</span> 
      <span class="token comment">//--- 通道已经创建，定义第二点 </span>
      <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>channel<span class="token punctuation">,</span>OBJPROP_TIME<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>two_times<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token comment">//--- 为通道设置提示工具文本 </span>
      <span class="token function">ObjectSetString</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>channel<span class="token punctuation">,</span>OBJPROP_TOOLTIP<span class="token punctuation">,</span><span class="token string">&quot;Demo from MQL5 Help&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token comment">//--- 刷新图表 </span>
      <span class="token function">ChartRedraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
     <span class="token punctuation">}</span> 
<span class="token comment">//--- 在模板中保存结果 </span>
   <span class="token function">ChartSaveTemplate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">&quot;StdDevChannelOnZigzag&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">//--- 打开新图表并应用保存的模板 </span>
   <span class="token keyword">long</span> new_chart<span class="token operator">=</span><span class="token function">ChartOpen</span><span class="token punctuation">(</span>symbol<span class="token punctuation">,</span>period<span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token comment">//--- 启用图形对象的工具提示 </span>
   <span class="token function">ChartSetInteger</span><span class="token punctuation">(</span>new_chart<span class="token punctuation">,</span>CHART_SHOW_OBJECT_DESCR<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token keyword">if</span><span class="token punctuation">(</span>new_chart<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span> 
     <span class="token punctuation">{</span> 
      <span class="token comment">//--- 将保存的模板应用到图表 </span>
      <span class="token function">ChartApplyTemplate</span><span class="token punctuation">(</span>new_chart<span class="token punctuation">,</span><span class="token string">&quot;StdDevChannelOnZigzag&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
     <span class="token punctuation">}</span> 
   <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span> 
<span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token comment">//| 创建Z字形句柄并确保其数据准备就绪                                    | </span>
<span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token keyword">bool</span> <span class="token function">PrepareZigzag</span><span class="token punctuation">(</span>string sym<span class="token punctuation">,</span>ENUM_TIMEFRAMES tf<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>h<span class="token punctuation">)</span> 
  <span class="token punctuation">{</span> 
   <span class="token function">ResetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">//--- Z字形指标必须位于terminal_data_folder\MQL5\Examples </span>
   h<span class="token operator">=</span><span class="token function">iCustom</span><span class="token punctuation">(</span>sym<span class="token punctuation">,</span>tf<span class="token punctuation">,</span><span class="token string">&quot;Examples\\Zigzag&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token keyword">if</span><span class="token punctuation">(</span>h<span class="token operator">==</span>INVALID_HANDLE<span class="token punctuation">)</span> 
     <span class="token punctuation">{</span> 
      <span class="token function">PrintFormat</span><span class="token punctuation">(</span><span class="token string">&quot;%s: Failed to create the handle of the Zigzag indicator. Error code %d&quot;</span><span class="token punctuation">,</span> 
                  __FUNCTION__<span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span> 
     <span class="token punctuation">}</span> 
<span class="token comment">//--- 创建指标句柄时，它需要时间计算价值 </span>
   <span class="token keyword">int</span> k<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 等候指标计算的尝试数量 </span>
<span class="token comment">//--- 等候循环计算，如果计算还未做好准备，暂停50毫秒 </span>
   <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">BarsCalculated</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token operator">&lt;=</span><span class="token number">0</span><span class="token punctuation">)</span> 
     <span class="token punctuation">{</span> 
      k<span class="token operator">++</span><span class="token punctuation">;</span> 
      <span class="token comment">//--- 显示尝试的数量 </span>
      <span class="token function">PrintFormat</span><span class="token punctuation">(</span><span class="token string">&quot;%s: k=%d&quot;</span><span class="token punctuation">,</span>__FUNCTION__<span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token comment">//--- 等候50毫秒，直至指标被计算 </span>
      <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token comment">//--- 如果尝试超过100次，那么有些事情就是错误的 </span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>k<span class="token operator">&gt;</span><span class="token number">100</span><span class="token punctuation">)</span> 
        <span class="token punctuation">{</span> 
         <span class="token comment">//--- 报告问题 </span>
         <span class="token function">PrintFormat</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to calculate the indicator for %d attempts!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
         <span class="token comment">//--- 终止程序操作 </span>
         <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span> 
        <span class="token punctuation">}</span> 
     <span class="token punctuation">}</span> 
<span class="token comment">//--- 一切做好准备，指标被创建，价值被计算 </span>
   <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span> 
<span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token comment">//| 搜索最近的2个Z字形断裂，置于数组                                      | </span>
<span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token keyword">bool</span> <span class="token function">GetLastTwoFractures</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">&amp;</span>get_values<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>datetime <span class="token operator">&amp;</span>get_times<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">int</span> handle<span class="token punctuation">)</span> 
  <span class="token punctuation">{</span> 
   <span class="token keyword">double</span> values<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>         <span class="token comment">// Z字形价值的数组 </span>
   datetime times<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token comment">// 获得时间的数组 </span>
   <span class="token keyword">int</span> size<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">;</span>            <span class="token comment">// 数组大小 </span>
   <span class="token function">ResetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">//--- 复制指标最近的100值 </span>
   <span class="token keyword">int</span> copied<span class="token operator">=</span><span class="token function">CopyBuffer</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>size<span class="token punctuation">,</span>values<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">//--- 检查复制值的数量 </span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>copied<span class="token operator">&lt;</span><span class="token number">100</span><span class="token punctuation">)</span> 
     <span class="token punctuation">{</span> 
      <span class="token function">PrintFormat</span><span class="token punctuation">(</span><span class="token string">&quot;%s: Failed to copy %d values of the indicator with the handle=%d. Error code %d&quot;</span><span class="token punctuation">,</span> 
                  __FUNCTION__<span class="token punctuation">,</span>size<span class="token punctuation">,</span>handle<span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span> 
     <span class="token punctuation">}</span> 
<span class="token comment">//--- 按照时间序列定义访问数组的顺序 </span>
   <span class="token function">ArraySetAsSeries</span><span class="token punctuation">(</span>values<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">//--- 在这里写下断裂处的柱形数量 </span>
   <span class="token keyword">int</span> positions<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
<span class="token comment">//--- 设置数组大小 </span>
   <span class="token function">ArrayResize</span><span class="token punctuation">(</span>get_values<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">ArrayResize</span><span class="token punctuation">(</span>get_times<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">ArrayResize</span><span class="token punctuation">(</span>positions<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">//--- 计数器 </span>
   <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>k<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> 
<span class="token comment">//--- 开始搜索断裂处 </span>
   <span class="token keyword">while</span><span class="token punctuation">(</span>i<span class="token operator">&lt;</span><span class="token number">100</span><span class="token punctuation">)</span> 
     <span class="token punctuation">{</span> 
      <span class="token keyword">double</span> v<span class="token operator">=</span>values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> 
      <span class="token comment">//--- 我们对空值不感兴趣W </span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>v<span class="token operator">!=</span><span class="token number">0.0</span><span class="token punctuation">)</span> 
        <span class="token punctuation">{</span> 
         <span class="token comment">//--- 记住柱形数 </span>
         positions<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">=</span>i<span class="token punctuation">;</span> 
         <span class="token comment">//--- 记住断裂上的Z字形值 </span>
         get_values<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">=</span>values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> 
         <span class="token function">PrintFormat</span><span class="token punctuation">(</span><span class="token string">&quot;%s: Zigzag[%d]=%G&quot;</span><span class="token punctuation">,</span>__FUNCTION__<span class="token punctuation">,</span>i<span class="token punctuation">,</span>values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
         <span class="token comment">//--- 增加计数器 </span>
         k<span class="token operator">++</span><span class="token punctuation">;</span> 
         <span class="token comment">//--- 如果找到两个断裂，中断循环 </span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>k<span class="token operator">&gt;</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span> 
        <span class="token punctuation">}</span> 
      i<span class="token operator">++</span><span class="token punctuation">;</span> 
     <span class="token punctuation">}</span> 
<span class="token comment">//--- 按照时间序列定义访问数组的顺序 </span>
   <span class="token function">ArraySetAsSeries</span><span class="token punctuation">(</span>times<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token function">ArraySetAsSeries</span><span class="token punctuation">(</span>get_times<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">CopyTime</span><span class="token punctuation">(</span>_Symbol<span class="token punctuation">,</span>_Period<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>size<span class="token punctuation">,</span>times<span class="token punctuation">)</span><span class="token operator">&lt;=</span><span class="token number">0</span><span class="token punctuation">)</span> 
     <span class="token punctuation">{</span> 
      <span class="token function">PrintFormat</span><span class="token punctuation">(</span><span class="token string">&quot;%s: Failed to copy %d values from CopyTime(). Error code %d&quot;</span><span class="token punctuation">,</span> 
                  __FUNCTION__<span class="token punctuation">,</span>size<span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span> 
     <span class="token punctuation">}</span> 
<span class="token comment">//--- 打开柱形图的开盘时间，在这上面出现最近的2个断裂 </span>
   get_times<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>times<span class="token punctuation">[</span>positions<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">// 倒数第二个值将被写成第一个断裂 </span>
   get_times<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>times<span class="token punctuation">[</span>positions<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">// 倒数第三个值将是第二个断裂 </span>
   <span class="token function">PrintFormat</span><span class="token punctuation">(</span><span class="token string">&quot;%s: first=%s,  second=%s&quot;</span><span class="token punctuation">,</span>__FUNCTION__<span class="token punctuation">,</span><span class="token function">TimeToString</span><span class="token punctuation">(</span>get_times<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">TimeToString</span><span class="token punctuation">(</span>get_times<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">//--- 成功 </span>
   <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br></div></div><p>相关参考<br>
ChartApplyTemplate()， 资源</p> <h2 id="_18-3-chartwindowfind"><a href="#_18-3-chartwindowfind" class="header-anchor">#</a> 18.3 ChartWindowFind</h2> <p>返回绘画指标的副图(子)窗口数字编号。该函数有两个变体。</p> <ol><li>该函数在指定的图表中搜索具有指定指标的“短名称”的子窗口(短名称显示在子窗口的左上部分)，并在成功时返回子窗口号码。</li></ol> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">int</span>  <span class="token function">ChartWindowFind</span><span class="token punctuation">(</span> 
   <span class="token keyword">long</span>     chart_id<span class="token punctuation">,</span>                  <span class="token comment">// 图表标识符 </span>
   string   indicator_shortname        <span class="token comment">// 指标”短名称”, 见 INDICATOR_SHORTNAME</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ol start="2"><li>函数必须从自定义指标中调用。返回指标工作的子窗口数。</li></ol> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">int</span>  <span class="token function">ChartWindowFind</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>参数</p> <p>chart_id</p> <p>[in] 图表 ID编号。0 表示当前图表。</p> <p>indicator_shortname</p> <p>[in] 指标的”短名称”。</p> <p>返回值</p> <p>成功的话返回子窗口的编号数字。失败，函数返回 -1。</p> <p>注意</p> <p>如果函数第二变体(无参数)是从脚本或者EA交易调用，则返回 -1。</p> <p>不要将指标的 ”短名称” 和 文件名称 弄混， ”短名称”是使用iCustom()和IndicatorCreate()函数创建指标时指定的名称。如果指标的 ”短名称” 未明确设置，则在编译期间将指定包含该指标源代码的文件名称。</p> <p>使用IndicatorSetString()函数正确地书写指标的 短名称 是很重要的，短名称 记录在INDICATOR_SHORTNAME属性中。建议 短名称 包含指标的输入参数的值，因为用ChartIndicatorDelete()函数从图表中删除指标，是通过其 短名称 进行识别的。
示例：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">script_show_inputs </span></span>
<span class="token comment">//--- 输入参量 </span>
input string   shortname<span class="token operator">=</span><span class="token string">&quot;MACD(12,26,9)&quot;</span><span class="token punctuation">;</span> 
<span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token comment">//| 返回带有这个指标的图表窗口号                                         | </span>
<span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token keyword">int</span> <span class="token function">GetIndicatorSubWindowNumber</span><span class="token punctuation">(</span><span class="token keyword">long</span> chartID<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>string short_name<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span> 
  <span class="token punctuation">{</span> 
   <span class="token keyword">int</span> window<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> 
<span class="token comment">//---  </span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ENUM_PROGRAM_TYPE<span class="token punctuation">)</span><span class="token function">MQL5InfoInteger</span><span class="token punctuation">(</span>MQL5_PROGRAM_TYPE<span class="token punctuation">)</span><span class="token operator">==</span>PROGRAM_INDICATOR<span class="token punctuation">)</span> 
     <span class="token punctuation">{</span> 
      <span class="token comment">//--- 函数从指标调用，名称不需要 </span>
      window<span class="token operator">=</span><span class="token function">ChartWindowFind</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
     <span class="token punctuation">}</span> 
   <span class="token keyword">else</span> 
     <span class="token punctuation">{</span> 
      <span class="token comment">//--- 函数从EA交易或者脚本调用 </span>
      window<span class="token operator">=</span><span class="token function">ChartWindowFind</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>short_name<span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token keyword">if</span><span class="token punctuation">(</span>window<span class="token operator">==</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">Print</span><span class="token punctuation">(</span>__FUNCTION__<span class="token operator">+</span><span class="token string">&quot;(): Error = &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
     <span class="token punctuation">}</span> 
<span class="token comment">//--- </span>
   <span class="token keyword">return</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span> 
<span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token comment">//| 脚本程序启动函数                                                   | </span>
<span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token keyword">void</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
  <span class="token punctuation">{</span> 
<span class="token comment">//--- </span>
   <span class="token keyword">int</span> window<span class="token operator">=</span><span class="token function">GetIndicatorSubWindowNumber</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>shortname<span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token keyword">if</span><span class="token punctuation">(</span>window<span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> 
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Indicator &quot;</span><span class="token operator">+</span>shortname<span class="token operator">+</span><span class="token string">&quot; is in the window #&quot;</span><span class="token operator">+</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span>window<span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token keyword">else</span> 
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Indicator &quot;</span><span class="token operator">+</span>shortname<span class="token operator">+</span><span class="token string">&quot; is not found. window = &quot;</span><span class="token operator">+</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span>window<span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><p>相关参考</p> <p>ObjectCreate()， ObjectFind()</p> <h2 id="_18-4-charttimepricetoxy"><a href="#_18-4-charttimepricetoxy" class="header-anchor">#</a> 18.4 ChartTimePriceToXY</h2> <p>将图表的坐标从 时间/价格 转换为 X和Y轴</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  <span class="token function">ChartTimePriceToXY</span><span class="token punctuation">(</span> 
   <span class="token keyword">long</span>           chart_id<span class="token punctuation">,</span>     <span class="token comment">// 图表 ID </span>
   <span class="token keyword">int</span>            sub_window<span class="token punctuation">,</span>   <span class="token comment">// 子窗口数量 </span>
   datetime       time<span class="token punctuation">,</span>         <span class="token comment">// 图表上的时间轴 </span>
   <span class="token keyword">double</span>         price<span class="token punctuation">,</span>        <span class="token comment">// 图表上的价格轴 </span>
   <span class="token keyword">int</span><span class="token operator">&amp;</span>           x<span class="token punctuation">,</span>            <span class="token comment">// 图表上时间的X轴 </span>
   <span class="token keyword">int</span><span class="token operator">&amp;</span>           y             <span class="token comment">// 图表上价格的Y轴 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>参数</p> <p>chart_id</p> <p>[in] 图表 ID编号。0 表示当前图表。</p> <p>sub_window</p> <p>[in] 图表子窗口的数字编号。0代表主图表窗口。</p> <p>time</p> <p>[in] 图表上的时间值，其中沿着X轴的像素值将被接收。原点位于主图表窗口的左上角</p> <p>price</p> <p>[in] 图表上的价格值，其中沿着Y轴的像素值将被接收。原点位于主图表窗口的左上角</p> <p>x</p> <p>[out] 接收X轴的时间转换的变量。</p> <p>y</p> <p>[out] 接收Y轴的价格转换的变量。</p> <p>返回值</p> <p>如果成功返回true，否则返回false。若要获得的错误信息，请调用GetLastError()函数。</p> <p>相关参考</p> <p>ChartXYToTimePrice()</p> <h2 id="_18-5-chartxytotimeprice"><a href="#_18-5-chartxytotimeprice" class="header-anchor">#</a> 18.5 ChartXYToTimePrice</h2> <p>转换图表的X和Y轴到 时间和价格 值</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  <span class="token function">ChartXYToTimePrice</span><span class="token punctuation">(</span> 
   <span class="token keyword">long</span>           chart_id<span class="token punctuation">,</span>     <span class="token comment">// 图表 ID </span>
   <span class="token keyword">int</span>            x<span class="token punctuation">,</span>            <span class="token comment">// 图表的 X 轴 </span>
   <span class="token keyword">int</span>            y<span class="token punctuation">,</span>            <span class="token comment">// 图表的 Y 轴 </span>
   <span class="token keyword">int</span><span class="token operator">&amp;</span>           sub_window<span class="token punctuation">,</span>   <span class="token comment">// 子窗口的数量 </span>
   datetime<span class="token operator">&amp;</span>      time<span class="token punctuation">,</span>         <span class="token comment">// 图表上的时间 </span>
   <span class="token keyword">double</span><span class="token operator">&amp;</span>        price<span class="token punctuation">,</span>        <span class="token comment">// 图表上的价格 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>参数</p> <p>chart_id</p> <p>[in] 图表 ID编号。0 表示当前图表。</p> <p>x</p> <p>[in] X 轴。</p> <p>y</p> <p>[in] Y 轴。</p> <p>sub_window</p> <p>[out] 将写入图表的子窗口数字编号。0意味着主图表窗口。</p> <p>time</p> <p>[in] 图表上的时间值，其中沿着X轴的像素值将被接收。原点位于主图表窗口的左上角</p> <p>price</p> <p>[in] 图表上的价格值，其中沿着Y轴的像素值将被接收。原点位于主图表窗口的左上角</p> <p>返回值</p> <p>如果成功返回true，否则返回false。若要获得的错误信息，请调用 GetLastError() 函数。
例如：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| ChartEvent 函数                                                  |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">OnChartEvent</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> id<span class="token punctuation">,</span>
                  <span class="token keyword">const</span> <span class="token keyword">long</span> <span class="token operator">&amp;</span>lparam<span class="token punctuation">,</span>
                  <span class="token keyword">const</span> <span class="token keyword">double</span> <span class="token operator">&amp;</span>dparam<span class="token punctuation">,</span>
                  <span class="token keyword">const</span> string <span class="token operator">&amp;</span>sparam<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 在图表上显示事件参数</span>
   <span class="token function">Comment</span><span class="token punctuation">(</span>__FUNCTION__<span class="token punctuation">,</span><span class="token string">&quot;: id=&quot;</span><span class="token punctuation">,</span>id<span class="token punctuation">,</span><span class="token string">&quot; lparam=&quot;</span><span class="token punctuation">,</span>lparam<span class="token punctuation">,</span><span class="token string">&quot; dparam=&quot;</span><span class="token punctuation">,</span>dparam<span class="token punctuation">,</span><span class="token string">&quot; sparam=&quot;</span><span class="token punctuation">,</span>sparam<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 如果这是鼠标点击事件图表</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>id<span class="token operator">==</span>CHARTEVENT_CLICK<span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token comment">//--- 准备变量</span>
      <span class="token keyword">int</span>      x     <span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>lparam<span class="token punctuation">;</span>
      <span class="token keyword">int</span>      y     <span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>dparam<span class="token punctuation">;</span>
      datetime dt    <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">double</span>   price <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">int</span>      window<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 依据日期/时间转换X和Y坐标</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">ChartXYToTimePrice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>window<span class="token punctuation">,</span>dt<span class="token punctuation">,</span>price<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
         <span class="token function">PrintFormat</span><span class="token punctuation">(</span><span class="token string">&quot;Window=%d X=%d  Y=%d  =&gt;  Time=%s  Price=%G&quot;</span><span class="token punctuation">,</span>window<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token function">TimeToString</span><span class="token punctuation">(</span>dt<span class="token punctuation">)</span><span class="token punctuation">,</span>price<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token comment">//--- 执行反向转换：(X,Y) =&gt; (时间，价格)</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">ChartTimePriceToXY</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>window<span class="token punctuation">,</span>dt<span class="token punctuation">,</span>price<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token function">PrintFormat</span><span class="token punctuation">(</span><span class="token string">&quot;Time=%s  Price=%G  =&gt;  X=%d  Y=%d&quot;</span><span class="token punctuation">,</span><span class="token function">TimeToString</span><span class="token punctuation">(</span>dt<span class="token punctuation">)</span><span class="token punctuation">,</span>price<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">else</span>
            <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;ChartTimePriceToXY return error code: &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token comment">//--- 删除线 </span>
         <span class="token function">ObjectDelete</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">&quot;V Line&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
         <span class="token function">ObjectDelete</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">&quot;H Line&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
         <span class="token comment">//--- 创建十字光标的水平线和垂直线 </span>
         <span class="token function">ObjectCreate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">&quot;H Line&quot;</span><span class="token punctuation">,</span>OBJ_HLINE<span class="token punctuation">,</span>window<span class="token punctuation">,</span>dt<span class="token punctuation">,</span>price<span class="token punctuation">)</span><span class="token punctuation">;</span> 
         <span class="token function">ObjectCreate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">&quot;V Line&quot;</span><span class="token punctuation">,</span>OBJ_VLINE<span class="token punctuation">,</span>window<span class="token punctuation">,</span>dt<span class="token punctuation">,</span>price<span class="token punctuation">)</span><span class="token punctuation">;</span> 
         <span class="token function">ChartRedraw</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token keyword">else</span>
         <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;ChartXYToTimePrice return error code: &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;+--------------------------------------------------------------+&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><p>相关参考</p> <p>ChartTimePriceToXY()</p> <h2 id="_18-6-chartopen"><a href="#_18-6-chartopen" class="header-anchor">#</a> 18.6 ChartOpen</h2> <p>打开一个新图表，用于显示指定的交易品种和时间周期。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">long</span>  <span class="token function">ChartOpen</span><span class="token punctuation">(</span> 
   string           symbol<span class="token punctuation">,</span>     <span class="token comment">// 交易品种名称 </span>
   ENUM_TIMEFRAMES  period      <span class="token comment">// 周期 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>参数</p> <p>symbol</p> <p>[in] 交易品种， NULL 意味着当前图表上的交易品种(附上EA交易的图表)。</p> <p>period</p> <p>[in] 图表周期(时间框架)。取值范围是ENUM_TIMEFRAMES枚举值之一。0代表当前图表的时间周期。</p> <p>返回值</p> <p>若成功，返回打开图表ID，否则返回0。</p> <p>注意</p> <p>客户端同时打开的图表数量，最大值不能超过CHARTS_MAX值。</p> <h2 id="_18-7-chartfirst"><a href="#_18-7-chartfirst" class="header-anchor">#</a> 18.7 ChartFirst</h2> <p>返回客户端的第一个图表的ID</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">long</span>  <span class="token function">ChartFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>返回值</p> <p>图表 ID。</p> <h2 id="_18-8-chartnext"><a href="#_18-8-chartnext" class="header-anchor">#</a> 18.8 ChartNext</h2> <p>返回指定图表的下一个图表的ID</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">long</span>  <span class="token function">ChartNext</span><span class="token punctuation">(</span> 
   <span class="token keyword">long</span>  chart_id      <span class="token comment">// 图表 ID </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>参数</p> <p>chart_id</p> <p>[in] 图表 ID. 0 不表示当前图表。0表示“返回第一图表”。</p> <p>返回值</p> <p>图表 ID。如果已经是最后一个图表，则返回 -1 。
示例：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//--- 用于图表 ID的变量 </span>
   <span class="token keyword">long</span> currChart<span class="token punctuation">,</span>prevChart<span class="token operator">=</span><span class="token function">ChartFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>limit<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">;</span> 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;ChartFirst =&quot;</span><span class="token punctuation">,</span><span class="token function">ChartSymbol</span><span class="token punctuation">(</span>prevChart<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&quot; ID =&quot;</span><span class="token punctuation">,</span>prevChart<span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token keyword">while</span><span class="token punctuation">(</span>i<span class="token operator">&lt;</span>limit<span class="token punctuation">)</span><span class="token comment">// 不允许超过100个打开的窗口 </span>
     <span class="token punctuation">{</span> 
      currChart<span class="token operator">=</span><span class="token function">ChartNext</span><span class="token punctuation">(</span>prevChart<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 通过使用之前图表ID获得新图表ID </span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>currChart<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>          <span class="token comment">// 到达了图表列表末端 </span>
      <span class="token function">Print</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token function">ChartSymbol</span><span class="token punctuation">(</span>currChart<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&quot; ID =&quot;</span><span class="token punctuation">,</span>currChart<span class="token punctuation">)</span><span class="token punctuation">;</span> 
      prevChart<span class="token operator">=</span>currChart<span class="token punctuation">;</span><span class="token comment">// 为ChartNext()保存当前图表ID </span>
      i<span class="token operator">++</span><span class="token punctuation">;</span><span class="token comment">// 不要忘记增加计数器 </span>
     <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="_18-9-chartclose"><a href="#_18-9-chartclose" class="header-anchor">#</a> 18.9 ChartClose</h2> <p>关闭指定图表。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  <span class="token function">ChartClose</span><span class="token punctuation">(</span> 
   <span class="token keyword">long</span>  chart_id<span class="token operator">=</span><span class="token number">0</span>      <span class="token comment">// 图表 ID </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>参数</p> <p>chart_id=0</p> <p>[in] 图表 ID编号。0 表示当前图表。</p> <p>返回值</p> <p>若成功，返回true，否则false。</p> <h2 id="_18-10-chartsymbol"><a href="#_18-10-chartsymbol" class="header-anchor">#</a> 18.10 ChartSymbol</h2> <p>返回指定图表的交易品种名称。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>string  <span class="token function">ChartSymbol</span><span class="token punctuation">(</span> 
   <span class="token keyword">long</span>  chart_id<span class="token operator">=</span><span class="token number">0</span>      <span class="token comment">// 图表 ID </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>参数</p> <p>chart_id=0</p> <p>[in] 图表 ID编号。0 表示当前图表。</p> <p>返回值</p> <p>如果图表不存在，结果是空字符串。</p> <p>相关参考</p> <p>ChartSetSymbolPeriod</p> <h2 id="_18-11-chartperiod"><a href="#_18-11-chartperiod" class="header-anchor">#</a> 18.11 ChartPeriod</h2> <p>返回指定图表的时间周期。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>ENUM_TIMEFRAMES  <span class="token function">ChartPeriod</span><span class="token punctuation">(</span> 
   <span class="token keyword">long</span>  chart_id<span class="token operator">=</span><span class="token number">0</span>      <span class="token comment">// Chart ID </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>参数</p> <p>chart_id=0</p> <p>[in] 图表 ID编号。0 表示当前图表。</p> <p>返回值</p> <p>函数返回ENUM_TIMEFRAMES枚举值之一，如果图表不存在，返回0。</p> <h2 id="_18-12-chartredraw"><a href="#_18-12-chartredraw" class="header-anchor">#</a> 18.12 ChartRedraw</h2> <p>指定图表强制重画一次。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">void</span>  <span class="token function">ChartRedraw</span><span class="token punctuation">(</span> 
   <span class="token keyword">long</span>  chart_id<span class="token operator">=</span><span class="token number">0</span>      <span class="token comment">// 图表 ID </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>参数</p> <p>chart_id=0</p> <p>[in] 图表 ID编号。0 表示当前图表。</p> <p>注意</p> <p>通常更改 对象属性 之后使用该函数。</p> <p>相关参考</p> <p>对象函数</p> <h2 id="_18-13-chartsetdouble"><a href="#_18-13-chartsetdouble" class="header-anchor">#</a> 18.13 ChartSetDouble</h2> <p>设置指定图表相关属性的双精度值。该命令被添加到图表消息队列中，并将在处理完所有以前的命令后执行。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  <span class="token function">ChartSetDouble</span><span class="token punctuation">(</span> 
   <span class="token keyword">long</span>    chart_id<span class="token punctuation">,</span>     <span class="token comment">// 图表 ID </span>
   <span class="token keyword">int</span>     prop_id<span class="token punctuation">,</span>      <span class="token comment">// 属性 ID </span>
   <span class="token keyword">double</span>  value         <span class="token comment">// 值 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>参数</p> <p>chart_id</p> <p>[in] 图表 ID编号。0 表示当前图表。</p> <p>prop_id</p> <p>[in] 图表属性 ID。 取值范围是 ENUM_CHART_PROPERTY_DOUBLE枚举值之一(除了只读属性)。</p> <p>value</p> <p>[in] 属性值。</p> <p>返回值</p> <p>如果该命令已成功添加到图表队列则返回true，否则返回false。若想获得额外错误信息，需要调用函数GetLastError()。</p> <p>注意</p> <p>该函数为异步函数，这意味着该函数不会等待执行已成功添加到指定图表队列的命令。相反，而是立即返回控制。该属性将只会在处理图表队列的对应命令之后更改。若要立即执行来自图表队列的命令，请调用ChartRedraw函数。</p> <p>如果您想立即改变多个图表属性，那么应该在一个代码框中执行对应的函数(ChartSetString， ChartSetDouble，ChartSetString)，在此之后您应该马上调用ChartRedraw函数。</p> <p>若要检查命令执行的结果，您可以使用一个函数，请求指定的图表属性(ChartGetInteger，ChartGetDouble， ChartSetString)。然而，请注意，这些都是同步函数，会等待执行结果。</p> <h2 id="_18-14-chartsetinteger"><a href="#_18-14-chartsetinteger" class="header-anchor">#</a> 18.14 ChartSetInteger</h2> <p>设置指定图表相关属性的整数值。图表属性必须是日期时间、整数、颜色、布尔型或者字符型。该命令被添加到图表消息队列中，并将在处理完所有以前的命令后执行。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  <span class="token function">ChartSetInteger</span><span class="token punctuation">(</span> 
   <span class="token keyword">long</span>   chart_id<span class="token punctuation">,</span>     <span class="token comment">// 图表 ID </span>
   <span class="token keyword">int</span>    prop_id<span class="token punctuation">,</span>      <span class="token comment">// 属性 ID </span>
   <span class="token keyword">long</span>   value         <span class="token comment">// 值 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  <span class="token function">ChartSetInteger</span><span class="token punctuation">(</span> 
   <span class="token keyword">long</span>   chart_id<span class="token punctuation">,</span>     <span class="token comment">// 图表 ID </span>
   <span class="token keyword">int</span>    prop_id<span class="token punctuation">,</span>      <span class="token comment">// 属性 ID </span>
   <span class="token keyword">int</span>    sub_window<span class="token punctuation">,</span>   <span class="token comment">// 子窗口号 </span>
   <span class="token keyword">long</span>   value         <span class="token comment">// 值 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>参数</p> <p>chart_id</p> <p>[in] 图表 ID编号。0 表示当前图表。</p> <p>prop_id</p> <p>[in] 图表属性ID. 取值范围是ENUM_CHART_PROPERTY_INTEGER枚举值之一(除了只读属性)。</p> <p>sub_window</p> <p>[in] 图表子窗口编号数字。对于第一种情况，默认值为0(图表主窗口)。属性大部分情况不需要子窗口编号数字。</p> <p>值</p> <p>[in] 属性值。</p> <p>返回值</p> <p>如果该命令已成功添加到图表队列则返回true，否则返回false。若想获得额外错误信息，需要调用函数GetLastError()。</p> <p>注意</p> <p>该函数为异步函数，这意味着该函数不会等待执行已成功添加到指定图表队列的命令。相反，而是立即返回控制。该属性将只会在处理图表队列的对应命令之后更改。若要立即执行来自图表队列的命令，请调用ChartRedraw函数。</p> <p>如果您想立即改变多个图表属性，那么应该在一个代码框中执行对应的函数(ChartSetString， ChartSetDouble，ChartSetString)，在此之后您应该马上调用ChartRedraw函数。</p> <p>若要检查命令执行的结果，您可以使用一个函数，请求指定的图表属性(ChartGetInteger，ChartGetDouble， ChartSetString)。然而，请注意，这些都是同步函数，会等待执行结果。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token comment">//| EA交易初始化函数                                                   | </span>
<span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token keyword">void</span> <span class="token function">OnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
  <span class="token punctuation">{</span> 
<span class="token comment">//--- 在图表窗口中启用鼠标移动的事件 </span>
   <span class="token function">ChartSetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_EVENT_MOUSE_MOVE<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">//--- 强制更新图表属性确保做好事件处理的准备 </span>
   <span class="token function">ChartRedraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span> 
<span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token comment">//| 鼠标点选位置                                                       | </span>
<span class="token comment">//+------------------------------------------------------------------+ </span>
string <span class="token function">MouseState</span><span class="token punctuation">(</span>uint state<span class="token punctuation">)</span> 
  <span class="token punctuation">{</span> 
   string res<span class="token punctuation">;</span> 
   res<span class="token operator">+=</span><span class="token string">&quot;\nML: &quot;</span>   <span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token string">&quot;DN&quot;</span><span class="token operator">:</span><span class="token string">&quot;UP&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 鼠标左移 </span>
   res<span class="token operator">+=</span><span class="token string">&quot;\nMR: &quot;</span>   <span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token operator">&amp;</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token string">&quot;DN&quot;</span><span class="token operator">:</span><span class="token string">&quot;UP&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 鼠标右移  </span>
   res<span class="token operator">+=</span><span class="token string">&quot;\nMM: &quot;</span>   <span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token operator">&amp;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token string">&quot;DN&quot;</span><span class="token operator">:</span><span class="token string">&quot;UP&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 鼠标居中 </span>
   res<span class="token operator">+=</span><span class="token string">&quot;\nMX: &quot;</span>   <span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token operator">&amp;</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token string">&quot;DN&quot;</span><span class="token operator">:</span><span class="token string">&quot;UP&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 鼠标点选第一个X键 </span>
   res<span class="token operator">+=</span><span class="token string">&quot;\nMY: &quot;</span>   <span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token operator">&amp;</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token string">&quot;DN&quot;</span><span class="token operator">:</span><span class="token string">&quot;UP&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 鼠标点选第二个 X 键 </span>
   res<span class="token operator">+=</span><span class="token string">&quot;\nSHIFT: &quot;</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token operator">&amp;</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token string">&quot;DN&quot;</span><span class="token operator">:</span><span class="token string">&quot;UP&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 移位键 </span>
   res<span class="token operator">+=</span><span class="token string">&quot;\nCTRL: &quot;</span> <span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token operator">&amp;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">==</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token string">&quot;DN&quot;</span><span class="token operator">:</span><span class="token string">&quot;UP&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 控制键 </span>
   <span class="token keyword">return</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span> 
<span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token comment">//| ChartEvent 函数                                                   | </span>
<span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token keyword">void</span> <span class="token function">OnChartEvent</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> id<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">long</span> <span class="token operator">&amp;</span>lparam<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">double</span> <span class="token operator">&amp;</span>dparam<span class="token punctuation">,</span><span class="token keyword">const</span> string <span class="token operator">&amp;</span>sparam<span class="token punctuation">)</span> 
  <span class="token punctuation">{</span> 
   <span class="token keyword">if</span><span class="token punctuation">(</span>id<span class="token operator">==</span>CHARTEVENT_MOUSE_MOVE<span class="token punctuation">)</span> 
      <span class="token function">Comment</span><span class="token punctuation">(</span><span class="token string">&quot;POINT: &quot;</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>lparam<span class="token punctuation">,</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>dparam<span class="token punctuation">,</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">,</span><span class="token function">MouseState</span><span class="token punctuation">(</span><span class="token punctuation">(</span>uint<span class="token punctuation">)</span>sparam<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><h2 id="_18-15-chartsetstring"><a href="#_18-15-chartsetstring" class="header-anchor">#</a> 18.15 ChartSetString</h2> <p>设置指定图表相关属性的字符串值。该命令添加到图表信息队列并且将在处理完之前所有命令后开始执行。该命令被添加到图表消息队列中，并将在处理完所有以前的命令后执行。</p> <p>参量</p> <p>chart_id</p> <p>[in] 图表 ID编号。0 表示当前图表。</p> <p>prop_id</p> <p>[in] 图表属性 ID. 取值范围是ENUM_CHART_PROPERTY_STRING枚举值之一(除了只读属性)。</p> <p>str_value</p> <p>[in] 属性值字符串。字符串长度不能超过 2045 个字符(多出的字符会被删除)。</p> <p>返回值</p> <p>如果该命令已成功添加到图表队列则返回true，否则返回false。若想获得额外错误信息，需要调用函数GetLastError()。</p> <p>注意</p> <p>该函数为异步函数，这意味着该函数不会等待执行已成功添加到指定图表队列的命令。相反，而是立即返回控制。该属性将只会在处理图表队列的对应命令之后更改。若要立即执行来自图表队列的命令，请调用ChartRedraw函数。</p> <p>如果您想立即改变多个图表属性，那么应该在一个代码框中执行对应的函数(ChartSetString， ChartSetDouble，ChartSetString)，在此之后您应该马上调用ChartRedraw函数。</p> <p>若要检查命令执行的结果，您可以使用一个函数，请求指定的图表属性(ChartGetInteger，ChartGetDouble， ChartSetString)。然而，请注意，这些都是同步函数，会等待执行结果。</p> <p>示例：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token function">OnTick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
  <span class="token punctuation">{</span> 
<span class="token comment">//--- </span>
   <span class="token keyword">double</span> Ask<span class="token punctuation">,</span>Bid<span class="token punctuation">;</span> 
   <span class="token keyword">int</span> Spread<span class="token punctuation">;</span> 
   Ask<span class="token operator">=</span><span class="token function">SymbolInfoDouble</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>SYMBOL_ASK<span class="token punctuation">)</span><span class="token punctuation">;</span> 
   Bid<span class="token operator">=</span><span class="token function">SymbolInfoDouble</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>SYMBOL_BID<span class="token punctuation">)</span><span class="token punctuation">;</span> 
   Spread<span class="token operator">=</span><span class="token function">SymbolInfoInteger</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>SYMBOL_SPREAD<span class="token punctuation">)</span><span class="token punctuation">;</span> 
   string comment<span class="token operator">=</span><span class="token function">StringFormat</span><span class="token punctuation">(</span><span class="token string">&quot;Printing prices:\nAsk = %G\nBid = %G\nSpread = %d&quot;</span><span class="token punctuation">,</span> 
                               Ask<span class="token punctuation">,</span>Bid<span class="token punctuation">,</span>Spread<span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token function">ChartSetString</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_COMMENT<span class="token punctuation">,</span>comment<span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>相关参考</p> <p>Comment ， ChartGetString</p> <h2 id="_18-16-chartgetdouble"><a href="#_18-16-chartgetdouble" class="header-anchor">#</a> 18.16 ChartGetDouble</h2> <p>返回指定图表的双精度值属性。此函数有两个调用变体。</p> <ol><li>直接返回属性值。</li></ol> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">double</span>  <span class="token function">ChartGetDouble</span><span class="token punctuation">(</span> 
   <span class="token keyword">long</span>  chart_id<span class="token punctuation">,</span>          <span class="token comment">// 图表 ID </span>
   <span class="token keyword">int</span>   prop_id<span class="token punctuation">,</span>           <span class="token comment">// 属性 ID </span>
   <span class="token keyword">int</span>   sub_window<span class="token operator">=</span><span class="token number">0</span>       <span class="token comment">// 子窗口号，如果需要的话 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ol start="2"><li>根据函数执行结果的成功与否，返回 true 或 false。如果成功，属性值保存于 形式参数的目标变量double_var。</li></ol> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  <span class="token function">ChartGetDouble</span><span class="token punctuation">(</span> 
   <span class="token keyword">long</span>    chart_id<span class="token punctuation">,</span>        <span class="token comment">// 图表 ID </span>
   <span class="token keyword">int</span>     prop_id<span class="token punctuation">,</span>         <span class="token comment">// 属性 ID </span>
   <span class="token keyword">int</span>     sub_window<span class="token punctuation">,</span>      <span class="token comment">// 子窗口号 </span>
   <span class="token keyword">double</span><span class="token operator">&amp;</span> double_var       <span class="token comment">// 用于保存图表属性的目标变量 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>参数</p> <p>chart_id</p> <p>[in] 图表 ID编号。0 表示当前图表。</p> <p>prop_id</p> <p>[in] 图表属性 ID. 取值范围是ENUM_CHART_PROPERTY_DOUBLE枚举值之一。</p> <p>sub_window</p> <p>[in] 图表子窗口编号数字。对于第一种情况，默认值为0(图表主窗口)。属性大部分情况不需要子窗口编号数字。</p> <p>double_var</p> <p>[out] 用于保存双精度类型属性值的目标变量。</p> <p>返回值</p> <p>双精度值。</p> <p>对于第二种调用情况，如果指定属性有效且其值已保存于double_var变量中，函数返回true，否则返回 false。若想获得额外错误信息，需要调用函数GetLastError()。</p> <p>注意</p> <p>该函数为同步函数，这意味着它会一直等待，在执行其调用之前已添加到图表队列的所有命令之后，再执行。</p> <p>示例：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
  <span class="token punctuation">{</span> 
   <span class="token keyword">double</span> priceMin<span class="token operator">=</span><span class="token function">ChartGetDouble</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_PRICE_MIN<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token keyword">double</span> priceMax<span class="token operator">=</span><span class="token function">ChartGetDouble</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_PRICE_MAX<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;CHART_PRICE_MIN =&quot;</span><span class="token punctuation">,</span>priceMin<span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;CHART_PRICE_MAX =&quot;</span><span class="token punctuation">,</span>priceMax<span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="_18-17-chartgetinteger"><a href="#_18-17-chartgetinteger" class="header-anchor">#</a> 18.17 ChartGetInteger</h2> <p>返回指定图表的整数值属性。图表属性必须是日期时间，整数，布尔型。此函数有两种调用变体。</p> <ol><li>直接返回属性值。</li></ol> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">long</span>  <span class="token function">ChartGetInteger</span><span class="token punctuation">(</span> 
   <span class="token keyword">long</span>  chart_id<span class="token punctuation">,</span>          <span class="token comment">// 图表 ID </span>
   <span class="token keyword">int</span>   prop_id<span class="token punctuation">,</span>           <span class="token comment">// 属性 ID </span>
   <span class="token keyword">int</span>   sub_window<span class="token operator">=</span><span class="token number">0</span>       <span class="token comment">// 子窗口号，如果需要的话 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ol start="2"><li>根据函数执行结果的成功与否，返回 true 或 false。如果成功，属性值保存于 形式参数的目标变量long_var。</li></ol> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  <span class="token function">ChartGetInteger</span><span class="token punctuation">(</span> 
   <span class="token keyword">long</span>    chart_id<span class="token punctuation">,</span>        <span class="token comment">// 图表 ID </span>
   <span class="token keyword">int</span>     prop_id<span class="token punctuation">,</span>         <span class="token comment">// 属性 ID </span>
   <span class="token keyword">int</span>     sub_window<span class="token punctuation">,</span>      <span class="token comment">// 子窗口号 </span>
   <span class="token keyword">long</span><span class="token operator">&amp;</span>   long_var         <span class="token comment">// 属性目标值 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>参数</p> <p>chart_id</p> <p>[in] 图表 ID编号。0 表示当前图表。。</p> <p>prop_id</p> <p>[in] 图表属性 ID. 取值范围是 ENUM_CHART_PROPERTY_INTEGER 枚举值之一。</p> <p>sub_window</p> <p>[in] 图表子窗口编号数字。对于第一种情况，默认值为0(图表主窗口)。属性大部分情况都不需要子窗口编号数字。</p> <p>long_var</p> <p>[out] 用于保存长整型属性值的目标变量。</p> <p>返回值</p> <p>长整型值。</p> <p>对于第二种调用情况，如果指定属性有效且其值已保存于long_var变量中，函数返回true，否则返回 false。若想获得额外错误信息，需要调用函数GetLastError()。</p> <p>注意</p> <p>该函数为同步函数，这意味着它会一直等待，在执行其调用之前已添加到图表队列的所有命令之后，再执行。</p> <p>示例：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
  <span class="token punctuation">{</span> 
   <span class="token keyword">int</span> height<span class="token operator">=</span><span class="token function">ChartGetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_HEIGHT_IN_PIXELS<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token keyword">int</span> width<span class="token operator">=</span><span class="token function">ChartGetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_WIDTH_IN_PIXELS<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;CHART_HEIGHT_IN_PIXELS =&quot;</span><span class="token punctuation">,</span>height<span class="token punctuation">,</span><span class="token string">&quot;pixels&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 当前图表高度,单位像素</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;CHART_WIDTH_IN_PIXELS =&quot;</span><span class="token punctuation">,</span>width<span class="token punctuation">,</span><span class="token string">&quot;pixels&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 当前图表宽度,单位像素</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="_18-18-chartgetstring"><a href="#_18-18-chartgetstring" class="header-anchor">#</a> 18.18 ChartGetString</h2> <p>返回指定图表的相关属性值。图表属性必须是字符串型。有两个函数调用变体。</p> <ol><li>直接返回属性值。</li></ol> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>string  <span class="token function">ChartGetString</span><span class="token punctuation">(</span> 
   <span class="token keyword">long</span>  chart_id<span class="token punctuation">,</span>          <span class="token comment">// 图表 ID </span>
   <span class="token keyword">int</span>   prop_id            <span class="token comment">// 属性 ID </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ol start="2"><li>根据函数执行结果的成功与否，返回 true 或 false。如果成功，属性值保存于 形式参数的目标变量string_var。</li></ol> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  <span class="token function">ChartGetString</span><span class="token punctuation">(</span> 
   <span class="token keyword">long</span>    chart_id<span class="token punctuation">,</span>        <span class="token comment">// 图表 ID </span>
   <span class="token keyword">int</span>     prop_id<span class="token punctuation">,</span>         <span class="token comment">// 属性 ID </span>
   string<span class="token operator">&amp;</span> string_var       <span class="token comment">// 属性目标值 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>参数 chart_id [in] 图表 ID编号。0 表示当前图表。。 prop_id [in] 图表属性 ID。取值范围是 ENUM_CHART_PROPERTY_STRING 枚举值之一。 string_var [out] 用于保存字符串类型属性值的目标变量 返回值 字符串类型值。 对于第二种调用情况，如果指定属性有效且其值已保存于string_var变量中，函数返回true，否则返回 false。若想获得额外错误信息，需要调用函数GetLastError()。 注意 ChartGetString可用于读取使用Comment或ChartSetString函数绘制在图表上的评论。 该函数为同步函数，这意味着它会一直等待，在执行其调用之前已添加到图表队列的所有命令之后，再执行。 示例：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
  <span class="token punctuation">{</span> 
   <span class="token function">ChartSetString</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_COMMENT<span class="token punctuation">,</span><span class="token string">&quot;Test comment.\nSecond line.\nThird!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token function">ChartRedraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
   string comm<span class="token operator">=</span><span class="token function">ChartGetString</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_COMMENT<span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token function">Print</span><span class="token punctuation">(</span>comm<span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>相关参考</p> <p>Comment ，ChartSetString</p> <h2 id="_18-19-chartnavigate"><a href="#_18-19-chartnavigate" class="header-anchor">#</a> 18.19 ChartNavigate</h2> <p>根据指定的图表 定位常量 和 移动偏移值，跳转到图表中指定的位置。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  <span class="token function">ChartNavigate</span><span class="token punctuation">(</span> 
   <span class="token keyword">long</span>                  chart_id<span class="token punctuation">,</span>     <span class="token comment">// 图表 ID </span>
   ENUM_CHART_POSITION   position<span class="token punctuation">,</span>     <span class="token comment">// 位置 </span>
   <span class="token keyword">int</span>                   shift<span class="token operator">=</span><span class="token number">0</span>       <span class="token comment">// 移动值 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>参数</p> <p>chart_id</p> <p>[in] 图表 ID编号。0 表示当前图表。</p> <p>position</p> <p>[in] 图表定位常量。取值范围是ENUM_CHART_POSITION枚举值之一。</p> <p>shift=0</p> <p>[in] 移动偏移值，即K线柱的数量。正值意味着向右移动(图表末端)，负值意味着左移(到图表起点)。0值用于跳转到图表的开始或结束。</p> <p>返回值</p> <p>若成功，返回true，否则返回false。</p> <p>示例：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token comment">//| 脚本程序起始函数                                                   | </span>
<span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token keyword">void</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
  <span class="token punctuation">{</span> 
<span class="token comment">//--- 获得当前图表的句柄 </span>
   <span class="token keyword">long</span> handle<span class="token operator">=</span><span class="token function">ChartID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
   string comm<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">;</span> 
   <span class="token keyword">if</span><span class="token punctuation">(</span>handle<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// 如果成功，另外设置图表 </span>
     <span class="token punctuation">{</span> 
      <span class="token comment">//--- 禁止自动滚动 </span>
      <span class="token function">ChartSetInteger</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span>CHART_AUTOSCROLL<span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token comment">//--- 设置从右图表边界转移 </span>
      <span class="token function">ChartSetInteger</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span>CHART_SHIFT<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token comment">//--- 绘制蜡烛图 </span>
      <span class="token function">ChartSetInteger</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span>CHART_MODE<span class="token punctuation">,</span>CHART_CANDLES<span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token comment">//--- 设置跳动量的显示模式 </span>
      <span class="token function">ChartSetInteger</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span>CHART_SHOW_VOLUMES<span class="token punctuation">,</span>CHART_VOLUME_TICK<span class="token punctuation">)</span><span class="token punctuation">;</span> 
  
      <span class="token comment">//--- 在Comment()准备输出文本  </span>
      comm<span class="token operator">=</span><span class="token string">&quot;Scroll 10 bars to the right of the history start&quot;</span><span class="token punctuation">;</span> 
      <span class="token comment">//--- 显示注释 </span>
      <span class="token function">Comment</span><span class="token punctuation">(</span>comm<span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token comment">//--- 滚动10柱到历史记录开始的右侧 </span>
      <span class="token function">ChartNavigate</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span>CHART_BEGIN<span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token comment">//--- 设置图表上第一柱显示的数量（类似时间帧的编号） </span>
      <span class="token keyword">long</span> first_bar<span class="token operator">=</span><span class="token function">ChartGetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_FIRST_VISIBLE_BAR<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token comment">//--- 添加换行符 </span>
      comm<span class="token operator">=</span>comm<span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span> 
      <span class="token comment">//--- 添加到注释 </span>
      comm<span class="token operator">=</span>comm<span class="token operator">+</span><span class="token string">&quot;The first bar on the chart is number &quot;</span><span class="token operator">+</span><span class="token function">IntegerToString</span><span class="token punctuation">(</span>first_bar<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span> 
      <span class="token comment">//--- 显示注释 </span>
      <span class="token function">Comment</span><span class="token punctuation">(</span>comm<span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token comment">//--- 等待5秒查看图表如何移动 </span>
      <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  
      <span class="token comment">//--- 添加到注释文本 </span>
      comm<span class="token operator">=</span>comm<span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token operator">+</span><span class="token string">&quot;Scroll 10 bars to the left of the right chart border&quot;</span><span class="token punctuation">;</span> 
      <span class="token function">Comment</span><span class="token punctuation">(</span>comm<span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token comment">//--- 滚动10柱到右图表边界的左侧 </span>
      <span class="token function">ChartNavigate</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span>CHART_END<span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token comment">//--- 获得图表上第一注显示的数量（类似时间帧的编号） </span>
      first_bar<span class="token operator">=</span><span class="token function">ChartGetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_FIRST_VISIBLE_BAR<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      comm<span class="token operator">=</span>comm<span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span> 
      comm<span class="token operator">=</span>comm<span class="token operator">+</span><span class="token string">&quot;The first bar on the chart is number &quot;</span><span class="token operator">+</span><span class="token function">IntegerToString</span><span class="token punctuation">(</span>first_bar<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span> 
      <span class="token function">Comment</span><span class="token punctuation">(</span>comm<span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token comment">//--- 等待5秒查看图表如何移动 </span>
      <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  
      <span class="token comment">//--- 图表滚动的新模块 </span>
      comm<span class="token operator">=</span>comm<span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token operator">+</span><span class="token string">&quot;Scroll 300 bars to the right of the history start&quot;</span><span class="token punctuation">;</span> 
      <span class="token function">Comment</span><span class="token punctuation">(</span>comm<span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token comment">//--- 滚动300柱到历史记录开始的右侧 </span>
      <span class="token function">ChartNavigate</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span>CHART_BEGIN<span class="token punctuation">,</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      first_bar<span class="token operator">=</span><span class="token function">ChartGetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_FIRST_VISIBLE_BAR<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      comm<span class="token operator">=</span>comm<span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span> 
      comm<span class="token operator">=</span>comm<span class="token operator">+</span><span class="token string">&quot;The first bar on the chart is number &quot;</span><span class="token operator">+</span><span class="token function">IntegerToString</span><span class="token punctuation">(</span>first_bar<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span> 
      <span class="token function">Comment</span><span class="token punctuation">(</span>comm<span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token comment">//--- 等待5秒查看图表如何移动 </span>
      <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  
      <span class="token comment">//--- 图表滚动的新模块 </span>
      comm<span class="token operator">=</span>comm<span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token operator">+</span><span class="token string">&quot;Scroll 300 bars to the left of the right chart border&quot;</span><span class="token punctuation">;</span> 
      <span class="token function">Comment</span><span class="token punctuation">(</span>comm<span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token comment">//--- 滚动300柱到右图表边界的左侧 </span>
      <span class="token function">ChartNavigate</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span>CHART_END<span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      first_bar<span class="token operator">=</span><span class="token function">ChartGetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_FIRST_VISIBLE_BAR<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      comm<span class="token operator">=</span>comm<span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span> 
      comm<span class="token operator">=</span>comm<span class="token operator">+</span><span class="token string">&quot;The first bar on the chart is number &quot;</span><span class="token operator">+</span><span class="token function">IntegerToString</span><span class="token punctuation">(</span>first_bar<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span> 
      <span class="token function">Comment</span><span class="token punctuation">(</span>comm<span class="token punctuation">)</span><span class="token punctuation">;</span> 
     <span class="token punctuation">}</span> 
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br></div></div><h2 id="_18-20-chartid"><a href="#_18-20-chartid" class="header-anchor">#</a> 18.20 ChartID</h2> <p>返回当前图表的ID。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">long</span>  <span class="token function">ChartID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>返回值</p> <p>长整型 值。</p> <h2 id="_18-21-chartindicatoradd"><a href="#_18-21-chartindicatoradd" class="header-anchor">#</a> 18.21 ChartIndicatorAdd</h2> <p>将指定的指标(句柄)添加到图表窗口中。指标和图表应该在相同的交易品种和时间框架上生成。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  <span class="token function">ChartIndicatorAdd</span><span class="token punctuation">(</span> 
   <span class="token keyword">long</span>  chart_id<span class="token punctuation">,</span>                 <span class="token comment">// 图表 ID </span>
   <span class="token keyword">int</span>   sub_window                <span class="token comment">// 子窗口号 </span>
   <span class="token keyword">int</span>   indicator_handle          <span class="token comment">// 指标处理 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>参数</p> <p>chart_id</p> <p>[in] 图表 ID编号。0 表示当前图表。。</p> <p>sub_window</p> <p>[in] 图表子窗口编号数字。0代表图表主窗口。若要在新窗口添加指标，此参数必须比现有最近窗口的索引编号 +1，例如，等于CHART_WINDOWS_TOTAL。如果参数值大于CHART_WINDOWS_TOTAL，将不会创建新窗口，指标也不会添加。</p> <p>indicator_handle</p> <p>[in] 指标的句柄。</p> <p>返回值</p> <p>若成功函数返回true，否则返回false。若要获得额外错误信息，需要调用GetLastError()函数。Error 4114 means that a chart and an added indicator differ by their symbol or time frame.</p> <p>该函数在成功的情况下返回true，否则返回false。为了获取有关错误的信息，请调用GetLastError()函数。错误4114意味着图表和添加的指标因交易品种或时间框架不同。</p> <p>注意</p> <p>如果把一个 副图指标(应在单独的子窗口中绘制的指标，例如，内置的iMACD或具有指定#property indicator_separate_window属性的自定义指标)应用于主图表窗口，那么虽然它仍然会显示在 指标列表 清单中，却在图表上是看不见的。这意味着指标的比例尺与价格图表的比例不同，并且应用指标的值不符合价格图的显示范围。在这种情况下，GetLastError()返回 0 代码，指示没有错误。这种“隐形”指标的值可以在数据窗口中看到并从其它MQL5应用程序中收到。</p> <p>示例:</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">description </span><span class="token string">&quot;Expert Advisor demonstrating the work with ChartIndicatorAdd() function.&quot;</span> </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">description </span><span class="token string">&quot;After launching on the chart (and receiving the error in Journal), open&quot;</span> </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">description </span><span class="token string">&quot;the Expert Advisor's properties and specify correct &lt;symbol&gt; and &lt;period&gt; parameters.&quot;</span> </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">description </span><span class="token string">&quot;MACD indicator will be added on the chart.&quot;</span></span>
 
<span class="token comment">//--- input parameters </span>
input string          symbol<span class="token operator">=</span><span class="token string">&quot;AUDUSD&quot;</span><span class="token punctuation">;</span>    <span class="token comment">// symbol name </span>
input ENUM_TIMEFRAMES period<span class="token operator">=</span>PERIOD_M12<span class="token punctuation">;</span>  <span class="token comment">// time frame </span>
input <span class="token keyword">int</span>    fast_ema_period<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">;</span>          <span class="token comment">// fast MACD period </span>
input <span class="token keyword">int</span>    slow_ema_period<span class="token operator">=</span><span class="token number">26</span><span class="token punctuation">;</span>          <span class="token comment">// slow MACD period </span>
input <span class="token keyword">int</span>      signal_period<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">;</span>           <span class="token comment">// signal period </span>
input ENUM_APPLIED_PRICE apr<span class="token operator">=</span>PRICE_CLOSE<span class="token punctuation">;</span> <span class="token comment">// price type for MACD calculation</span>
 
<span class="token keyword">int</span> indicator_handle<span class="token operator">=</span>INVALID_HANDLE<span class="token punctuation">;</span> 
<span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token comment">//| Expert initialization function                                   | </span>
<span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token keyword">int</span> <span class="token function">OnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
  <span class="token punctuation">{</span> 
<span class="token comment">//--- </span>
   indicator_handle<span class="token operator">=</span><span class="token function">iMACD</span><span class="token punctuation">(</span>symbol<span class="token punctuation">,</span>period<span class="token punctuation">,</span>fast_ema_period<span class="token punctuation">,</span>slow_ema_period<span class="token punctuation">,</span>signal_period<span class="token punctuation">,</span>apr<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">//--- try to add the indicator on the chart </span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">AddIndicator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
     <span class="token punctuation">{</span> 
      <span class="token comment">//--- AddIndicator() function refused to add the indicator on the chart </span>
      <span class="token keyword">int</span> answer<span class="token operator">=</span><span class="token function">MessageBox</span><span class="token punctuation">(</span><span class="token string">&quot;Do you want to add MACD on the chart anyway?&quot;</span><span class="token punctuation">,</span> 
                            <span class="token string">&quot;Incorrect symbol and/or time frame for adding the indicator&quot;</span><span class="token punctuation">,</span> 
                            MB_YESNO <span class="token comment">// &quot;Yes&quot; and &quot;No&quot; selection buttons will be shown </span>
                            <span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token comment">//--- if a user still insists on incorrect usage of ChartIndicatorAdd() </span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>answer<span class="token operator">==</span>IDYES<span class="token punctuation">)</span> 
        <span class="token punctuation">{</span> 
         <span class="token comment">//--- first of all, a Journal entry will be made about that </span>
         <span class="token function">PrintFormat</span><span class="token punctuation">(</span><span class="token string">&quot;Attention! %s: Trying to add MACD(%s/%s) indicator on %s/%s chart. Receiving error 4114&quot;</span><span class="token punctuation">,</span> 
                     __FUNCTION__<span class="token punctuation">,</span>symbol<span class="token punctuation">,</span><span class="token function">EnumToString</span><span class="token punctuation">(</span>period<span class="token punctuation">)</span><span class="token punctuation">,</span>_Symbol<span class="token punctuation">,</span><span class="token function">EnumToString</span><span class="token punctuation">(</span>_Period<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
         <span class="token comment">//--- receive the number of a new subwindow, to which we will try to add the indicator </span>
         <span class="token keyword">int</span> subwindow<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token function">ChartGetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_WINDOWS_TOTAL<span class="token punctuation">)</span><span class="token punctuation">;</span> 
         <span class="token comment">//--- now make an attempt resulting in error </span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ChartIndicatorAdd</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>subwindow<span class="token punctuation">,</span>indicator_handle<span class="token punctuation">)</span><span class="token punctuation">)</span> 
            <span class="token function">PrintFormat</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to add MACD indicator on %d chart window. Error code  %d&quot;</span><span class="token punctuation">,</span> 
                        subwindow<span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token punctuation">}</span> 
     <span class="token punctuation">}</span> 
<span class="token comment">//--- </span>
   <span class="token keyword">return</span><span class="token punctuation">(</span>INIT_SUCCEEDED<span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span> 
<span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token comment">//| Expert tick function                                             | </span>
<span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token keyword">void</span> <span class="token function">OnTick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
  <span class="token punctuation">{</span> 
<span class="token comment">// Expert Advisor performs nothing </span>
  <span class="token punctuation">}</span> 
<span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token comment">//| Function for checking and adding the indicator on the chart      | </span>
<span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token keyword">bool</span> <span class="token function">AddIndicator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
  <span class="token punctuation">{</span> 
<span class="token comment">//--- displayed message </span>
   string message<span class="token punctuation">;</span> 
<span class="token comment">//--- check if the indicator symbol and chart symbol match each other </span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>symbol<span class="token operator">!=</span>_Symbol<span class="token punctuation">)</span> 
     <span class="token punctuation">{</span> 
      message<span class="token operator">=</span><span class="token string">&quot;Displaying the use of Demo_ChartIndicatorAdd() function:&quot;</span><span class="token punctuation">;</span> 
      message<span class="token operator">=</span>message<span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span> 
      message<span class="token operator">=</span>message<span class="token operator">+</span><span class="token string">&quot;Unable to add the indicator calculated on another symbol on the chart.&quot;</span><span class="token punctuation">;</span> 
      message<span class="token operator">=</span>message<span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span> 
      message<span class="token operator">=</span>message<span class="token operator">+</span><span class="token string">&quot;Specify the chart symbol in Expert Advisor's property - &quot;</span><span class="token operator">+</span>_Symbol<span class="token operator">+</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">;</span> 
      <span class="token function">Alert</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token comment">//--- premature exit, the indicator will not be added on the chart </span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span> 
     <span class="token punctuation">}</span> 
<span class="token comment">//--- check if the indicator's and chart's time frames match each other </span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>period<span class="token operator">!=</span>_Period<span class="token punctuation">)</span> 
     <span class="token punctuation">{</span> 
      message<span class="token operator">=</span><span class="token string">&quot;Unable to add the indicator calculated on another time frame on the chart.&quot;</span><span class="token punctuation">;</span> 
      message<span class="token operator">=</span>message<span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span> 
      message<span class="token operator">=</span>message<span class="token operator">+</span><span class="token string">&quot;Specify the chart time frame in Expert Advisor properties - &quot;</span><span class="token operator">+</span><span class="token function">EnumToString</span><span class="token punctuation">(</span>_Period<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">;</span> 
      <span class="token function">Alert</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token comment">//--- premature exit, the indicator will not be added on the chart </span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span> 
     <span class="token punctuation">}</span> 
<span class="token comment">//--- all checks completed, symbol and indicator time frame match the chart </span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>indicator_handle<span class="token operator">==</span>INVALID_HANDLE<span class="token punctuation">)</span> 
     <span class="token punctuation">{</span> 
      <span class="token function">Print</span><span class="token punctuation">(</span>__FUNCTION__<span class="token punctuation">,</span><span class="token string">&quot;  Creating MACD indicator&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      indicator_handle<span class="token operator">=</span><span class="token function">iMACD</span><span class="token punctuation">(</span>symbol<span class="token punctuation">,</span>period<span class="token punctuation">,</span>fast_ema_period<span class="token punctuation">,</span>slow_ema_period<span class="token punctuation">,</span>signal_period<span class="token punctuation">,</span>apr<span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token keyword">if</span><span class="token punctuation">(</span>indicator_handle<span class="token operator">==</span>INVALID_HANDLE<span class="token punctuation">)</span> 
        <span class="token punctuation">{</span> 
         <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to create MACD indicator. Error code &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token punctuation">}</span> 
     <span class="token punctuation">}</span> 
<span class="token comment">//--- reset the error code </span>
   <span class="token function">ResetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">//--- apply the indicator to the chart  </span>
   <span class="token function">Print</span><span class="token punctuation">(</span>__FUNCTION__<span class="token punctuation">,</span><span class="token string">&quot;  Adding MACD indicator on the chart&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;MACD is generated on &quot;</span><span class="token punctuation">,</span>symbol<span class="token punctuation">,</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span><span class="token function">EnumToString</span><span class="token punctuation">(</span>period<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">//--- receive the number of a new subwindow, to which MACD indicator is added </span>
   <span class="token keyword">int</span> subwindow<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token function">ChartGetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_WINDOWS_TOTAL<span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token function">PrintFormat</span><span class="token punctuation">(</span><span class="token string">&quot;Adding MACD indicator on %d chart window&quot;</span><span class="token punctuation">,</span>subwindow<span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ChartIndicatorAdd</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>subwindow<span class="token punctuation">,</span>indicator_handle<span class="token punctuation">)</span><span class="token punctuation">)</span> 
     <span class="token punctuation">{</span> 
      <span class="token function">PrintFormat</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to add MACD indicator on %d chart window. Error code  %d&quot;</span><span class="token punctuation">,</span> 
                  subwindow<span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
     <span class="token punctuation">}</span> 
<span class="token comment">//--- Indicator added successfully </span>
   <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br></div></div><p>相关参考</p> <p>ChartIndicatorDelete(), ChartIndicatorName(), ChartIndicatorsTotal(), iCustom(), IndicatorCreate()</p> <h2 id="_18-22-chartindicatordelete"><a href="#_18-22-chartindicatordelete" class="header-anchor">#</a> 18.22 ChartIndicatorDelete</h2> <p>从指定图表窗口移除一个指定名称的指标。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  <span class="token function">ChartIndicatorDelete</span><span class="token punctuation">(</span> 
   <span class="token keyword">long</span>           chart_id<span class="token punctuation">,</span>              <span class="token comment">// 图表 id </span>
   <span class="token keyword">int</span>            sub_window             <span class="token comment">// 子窗口数量 </span>
   <span class="token keyword">const</span> string   indicator_shortname    <span class="token comment">// 指标的缩略名 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>参数</p> <p>chart_id</p> <p>[in] 图表 ID编号。0 表示当前图表。</p> <p>sub_window</p> <p>[in] 图表子窗口的数字编号。0代表主图表的子窗口。</p> <p>const indicator_shortname</p> <p>[in] 通过IndicatorSetString()函数在INDICATOR_SHORTNAME属性中设置的指标的“短名称”。若要获得指标的“短名称”，请使用ChartIndicatorName()函数。</p> <p>返回值</p> <p>如果指标成功删除，返回true。否则返回false。若想要获得错误信息，请使用GetLastError()函数。</p> <p>注意</p> <p>如果在图表子窗口有两个相同“短名称”的指标，那么第一行的指标将被删除。</p> <p>如果该图表上的另一个指标基于正被删除的指标值，那么这种指标也将被删除。</p> <p>不要将指标的 ”短名称” 和 文件名称 弄混， ”短名称”是使用iCustom()和IndicatorCreate()函数创建指标时指定的名称。如果指标的 ”短名称” 未明确设置，则在编译期间将指定包含该指标源代码的文件名称。</p> <p>从图表中删除指标并不意味着其计算部分将从客户端内存中删除。要释放指标句柄，请使用IndicatorRelease()函数。</p> <p>使用IndicatorSetString()函数正确地书写指标的 短名称 是很重要的，短名称 记录在INDICATOR_SHORTNAME属性中。建议 短名称 包含指标的输入参数的值，因为用ChartIndicatorDelete()函数从图表中删除指标，是通过其 短名称 进行识别的。</p> <p>初始化失败后删除指标的示例：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//|                                    Demo_ChartIndicatorDelete.mq5 |</span>
<span class="token comment">//|                        Copyright 2011, MetaQuotes Software Corp. |</span>
<span class="token comment">//|                                             https://www.mql5.com |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">copyright </span><span class="token string">&quot;Copyright 2011, MetaQuotes Software Corp.&quot;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">link      </span><span class="token string">&quot;https://www.mql5.com&quot;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">version   </span><span class="token string">&quot;1.00&quot;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">indicator_separate_window</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">indicator_buffers <span class="token number">1</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">indicator_plots   <span class="token number">1</span></span></span>
<span class="token comment">//--- 绘制柱状图</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">indicator_label1  </span><span class="token string">&quot;Histogram&quot;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">indicator_type1   DRAW_HISTOGRAM</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">indicator_color1  clrRed</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">indicator_style1  STYLE_SOLID</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">indicator_width1  <span class="token number">1</span></span></span>
<span class="token comment">//--- 输入参数</span>
input <span class="token keyword">int</span>      first_param<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
input <span class="token keyword">int</span>      second_param<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>
input <span class="token keyword">int</span>      third_param<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span>
input <span class="token keyword">bool</span>     wrong_init<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token comment">//--- 指标缓冲区</span>
<span class="token keyword">double</span>         HistogramBuffer<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
string         shortname<span class="token punctuation">;</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 自定义指标初始化函数                                                |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">int</span> <span class="token function">OnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   <span class="token keyword">int</span> res<span class="token operator">=</span>INIT_SUCCEEDED<span class="token punctuation">;</span>
<span class="token comment">//--- 连接柱状图缓冲区数组到指标缓冲区</span>
   <span class="token function">SetIndexBuffer</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>HistogramBuffer<span class="token punctuation">,</span>INDICATOR_DATA<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 基于输入参数设置指标缩略名</span>
   shortname<span class="token operator">=</span><span class="token function">StringFormat</span><span class="token punctuation">(</span><span class="token string">&quot;Demo_ChartIndicatorDelete(%d,%d,%d)&quot;</span><span class="token punctuation">,</span>
                          first_param<span class="token punctuation">,</span>second_param<span class="token punctuation">,</span>third_param<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">IndicatorSetString</span><span class="token punctuation">(</span>INDICATOR_SHORTNAME<span class="token punctuation">,</span>shortname<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 如果设置指标强制完成，返回非零值</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>wrong_init<span class="token punctuation">)</span> res<span class="token operator">=</span>INIT_FAILED<span class="token punctuation">;</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 自定义指标迭代函数                                                 |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">int</span> <span class="token function">OnCalculate</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> rates_total<span class="token punctuation">,</span>
                <span class="token keyword">const</span> <span class="token keyword">int</span> prev_calculated<span class="token punctuation">,</span>
                <span class="token keyword">const</span> datetime <span class="token operator">&amp;</span>time<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token keyword">const</span> <span class="token keyword">double</span> <span class="token operator">&amp;</span>open<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token keyword">const</span> <span class="token keyword">double</span> <span class="token operator">&amp;</span>high<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token keyword">const</span> <span class="token keyword">double</span> <span class="token operator">&amp;</span>low<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token keyword">const</span> <span class="token keyword">double</span> <span class="token operator">&amp;</span>close<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token keyword">const</span> <span class="token keyword">long</span> <span class="token operator">&amp;</span>tick_volume<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token keyword">const</span> <span class="token keyword">long</span> <span class="token operator">&amp;</span>volume<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token keyword">const</span> <span class="token keyword">int</span> <span class="token operator">&amp;</span>spread<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 工作循环的起始位置</span>
   <span class="token keyword">int</span> start<span class="token operator">=</span>prev_calculated<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>start<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span> start<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token comment">//--- 填写指标缓冲区的值</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span>start<span class="token punctuation">;</span>i<span class="token operator">&lt;</span>rates_total<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      HistogramBuffer<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>close<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 返回prev_calculated值为了下次调用</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span>rates_total<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| Deinit 事件的处理程序                                              |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">OnDeinit</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> reason<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   <span class="token function">PrintFormat</span><span class="token punctuation">(</span><span class="token string">&quot;%s: Deinitialization reason code=%d&quot;</span><span class="token punctuation">,</span>__FUNCTION__<span class="token punctuation">,</span>reason<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>reason<span class="token operator">==</span>REASON_INITFAILED<span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">PrintFormat</span><span class="token punctuation">(</span><span class="token string">&quot;An indicator with a short name %s (file %s) deletes itself from the chart&quot;</span><span class="token punctuation">,</span>shortname<span class="token punctuation">,</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">int</span> window<span class="token operator">=</span><span class="token function">ChartWindowFind</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">bool</span> res<span class="token operator">=</span><span class="token function">ChartIndicatorDelete</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>window<span class="token punctuation">,</span>shortname<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 分析调用ChartIndicatorDelete()的结果</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>res<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
         <span class="token function">PrintFormat</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to delete indicator %s from window #%d. Error code %d&quot;</span><span class="token punctuation">,</span>
                     shortname<span class="token punctuation">,</span>window<span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br></div></div><p>相关参考</p> <p>ChartIndicatorAdd()， ChartIndicatorName()， ChartIndicatorsTotal()， iCustom()， IndicatorCreate(), IndicatorSetString()</p> <h2 id="_18-23-chartindicatorget"><a href="#_18-23-chartindicatorget" class="header-anchor">#</a> 18.23 ChartIndicatorGet</h2> <p>返回图表窗口中指定短名称的指标的句柄。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">int</span>  <span class="token function">ChartIndicatorGet</span><span class="token punctuation">(</span> 
   <span class="token keyword">long</span>           chart_id<span class="token punctuation">,</span>              <span class="token comment">// 图表 ID </span>
   <span class="token keyword">int</span>            sub_window             <span class="token comment">// 子窗口数量 </span>
   <span class="token keyword">const</span> string   indicator_shortname    <span class="token comment">// 指标的缩略名 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>参数</p> <p>chart_id</p> <p>[in] 图表 ID编号。0 表示当前图表。</p> <p>sub_window</p> <p>[in] 图表子窗口的数字编号。0代表主图表的子窗口。</p> <p>const indicator_shortname</p> <p>[in] 通过IndicatorSetString()函数在INDICATOR_SHORTNAME属性中设置的指标的“短名称”。若要获得指标的“短名称”，请使用ChartIndicatorName()函数。</p> <p>返回值</p> <p>如果成功返回指标句柄，否则返回 INVALID_HANDLE。若想要获得错误信息，请使用GetLastError()函数。</p> <p>注意</p> <p>使用IndicatorSetString()函数正确地书写指标的 短名称 是很重要的，短名称 记录在INDICATOR_SHORTNAME属性中。建议 短名称 包含指标的输入参数的值，因为用ChartIndicatorDelete()函数从图表中删除指标，是通过其 短名称 进行识别的。</p> <p>识别指标的另一种方式就是使用IndicatorParameters()函数获取给定句柄的参数列表，然后分析获得的值。</p> <p>例如：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 脚本程序起始函数                                                   |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   <span class="token comment">//--- 图表上的窗口数量(至少一个主窗口始终存在)</span>
   <span class="token keyword">int</span> windows<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token function">ChartGetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_WINDOWS_TOTAL<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment">//--- 检查所有窗口</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> w<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>w<span class="token operator">&lt;</span>windows<span class="token punctuation">;</span>w<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token comment">//--- 该窗口/子窗口的指标数量</span>
      <span class="token keyword">int</span> total<span class="token operator">=</span><span class="token function">ChartIndicatorsTotal</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>w<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 检查窗口中的所有指标</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>total<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
         <span class="token comment">//--- 获得指标的缩略名</span>
         string name<span class="token operator">=</span><span class="token function">ChartIndicatorName</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>w<span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token comment">//--- 获得指标的句柄</span>
         <span class="token keyword">int</span> handle<span class="token operator">=</span><span class="token function">ChartIndicatorGet</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>w<span class="token punctuation">,</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token comment">//--- 添加到日志</span>
         <span class="token function">PrintFormat</span><span class="token punctuation">(</span><span class="token string">&quot;Window=%d,  index=%d,  Name=%s,  handle=%d&quot;</span><span class="token punctuation">,</span>w<span class="token punctuation">,</span>i<span class="token punctuation">,</span>name<span class="token punctuation">,</span>handle<span class="token punctuation">)</span><span class="token punctuation">;</span> 
         <span class="token comment">//--- 当不再需要时您应该强制释放指标句柄 </span>
         <span class="token function">IndicatorRelease</span><span class="token punctuation">(</span>handle<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>相关参考</p> <p>ChartIndicatorAdd(), ChartIndicatorName(), ChartIndicatorsTotal(), IndicatorParameters()</p> <h2 id="_18-24-chartindicatorname"><a href="#_18-24-chartindicatorname" class="header-anchor">#</a> 18.24 ChartIndicatorName</h2> <p>在图表窗口，通过指定的数字编号，返回指标的短名称。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>string  <span class="token function">ChartIndicatorName</span><span class="token punctuation">(</span> 
   <span class="token keyword">long</span>  chart_id<span class="token punctuation">,</span>      <span class="token comment">// 图表 id </span>
   <span class="token keyword">int</span>   sub_window     <span class="token comment">// 子窗口数量 </span>
   <span class="token keyword">int</span>   index          <span class="token comment">// 添加到图表子窗口的指标列表中的指标标引 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>参数</p> <p>chart_id</p> <p>[in] 图表 ID编号。0 表示当前图表。</p> <p>sub_window</p> <p>[in] 图表子窗口的数字编号。0代表主图表的子窗口。</p> <p>index</p> <p>[in] 指标列表中的索引编号。指标索引编号从0开始，例如列表中的第一个指标编号为0。若要获得列表中的指标总数量，请使用ChartIndicatorsTotal()函数。</p> <p>返回值</p> <p>通过IndicatorSetString()函数在INDICATOR_SHORTNAME属性中设置的指标的“短名称”。若要获得指标的“短名称”，请使用ChartIndicatorName()函数。</p> <p>注意</p> <p>不要将指标的 ”短名称” 和 文件名称 弄混， ”短名称”是使用iCustom()和IndicatorCreate()函数创建指标时指定的名称。如果指标的 ”短名称” 未明确设置，则在编译期间将指定包含该指标源代码的文件名称。</p> <p>使用IndicatorSetString()函数正确地书写指标的 短名称 是很重要的，短名称 记录在INDICATOR_SHORTNAME属性中。建议 短名称 包含指标的输入参数的值，因为用ChartIndicatorDelete()函数从图表中删除指标，是通过其 短名称 进行识别的。</p> <p>相关参考</p> <p>ChartIndicatorAdd()， ChartIndicatorDelete()， ChartIndicatorsTotal()， iCustom()， IndicatorCreate()， IndicatorSetString()</p> <h2 id="_18-25-chartindicatorstotal"><a href="#_18-25-chartindicatorstotal" class="header-anchor">#</a> 18.25 ChartIndicatorsTotal</h2> <p>返回应用到指定图表窗口的指标总数量。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">int</span>  <span class="token function">ChartIndicatorsTotal</span><span class="token punctuation">(</span> 
   <span class="token keyword">long</span>  chart_id<span class="token punctuation">,</span>      <span class="token comment">// 图表 id </span>
   <span class="token keyword">int</span>   sub_window     <span class="token comment">// 子窗口数量 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>参数</p> <p>chart_id</p> <p>[in] 图表 ID编号。0 表示当前图表。</p> <p>sub_window</p> <p>[in] 图表子窗口的数字编号。0代表主图表的子窗口。</p> <p>返回值</p> <p>指定图表窗口中的指标总数量。若要获得错误信息，请使用 GetLastError() 函数。</p> <p>注意</p> <p>该函数被允许搜寻附加在图表中的所有指标。图表窗口的总数可以使用ChartGetInteger()函数从CHART_WINDOWS_TOTAL属性获得。</p> <p>相关参考</p> <p>ChartIndicatorAdd()， ChartIndicatorDelete()， iCustom()， IndicatorCreate()， IndicatorSetString()</p> <h2 id="_18-26-chartwindowondropped"><a href="#_18-26-chartwindowondropped" class="header-anchor">#</a> 18.26 ChartWindowOnDropped</h2> <p>当拖动一个EA程序 或 脚本到图表窗口时，在 释放(松开) 鼠标左键时，此函数返回图表窗口的索引编号数字。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">int</span>  <span class="token function">ChartWindowOnDropped</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>返回值</p> <p>整型 值。</p> <p>示例：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   <span class="token keyword">int</span> myWindow<span class="token operator">=</span><span class="token function">ChartWindowOnDropped</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token keyword">int</span> windowsTotal<span class="token operator">=</span><span class="token function">ChartGetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_WINDOWS_TOTAL<span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Script is running on the window #&quot;</span><span class="token operator">+</span>myWindow<span class="token operator">+</span> <span class="token comment">// 脚本运行的窗口编号是</span>
         <span class="token string">&quot;. Total windows on the chart &quot;</span><span class="token operator">+</span><span class="token function">ChartSymbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;:&quot;</span><span class="token punctuation">,</span>windowsTotal<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//窗口中图表总数为</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>相关参考</p> <p>ChartPriceOnDropped， ChartTimeOnDropped， ChartXOnDropped， ChartYOnDropped</p> <h2 id="_18-27-chartpriceondropped"><a href="#_18-27-chartpriceondropped" class="header-anchor">#</a> 18.27 ChartPriceOnDropped</h2> <p>当拖动一个EA程序 或 脚本到图表窗口时，在 释放(松开) 鼠标左键时，此函数返回图表窗口对应的价格坐标。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">double</span>  <span class="token function">ChartPriceOnDropped</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>返回值</p> <p>双精度值</p> <p>示例：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   <span class="token keyword">double</span> p<span class="token operator">=</span><span class="token function">ChartPriceOnDropped</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;ChartPriceOnDropped() = &quot;</span><span class="token punctuation">,</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>相关参考</p> <p>ChartXOnDropped， ChartYOnDropped</p> <h2 id="_18-28-charttimeondropped"><a href="#_18-28-charttimeondropped" class="header-anchor">#</a> 18.28 ChartTimeOnDropped</h2> <p>当拖动一个EA程序 或 脚本到图表窗口时，在 释放(松开) 鼠标左键时，此函数返回图表窗口对应的时间坐标。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>datetime  <span class="token function">ChartTimeOnDropped</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>返回值</p> <p>日期时间 类型值。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   datetime t<span class="token operator">=</span><span class="token function">ChartTimeOnDropped</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Script was dropped on the &quot;</span><span class="token operator">+</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>相关参考</p> <p>ChartXOnDropped, ChartYOnDropped</p> <h2 id="_18-29-chartxondropped"><a href="#_18-29-chartxondropped" class="header-anchor">#</a> 18.29 ChartXOnDropped</h2> <p>当拖动一个EA程序 或 脚本到图表窗口时，在 释放(松开) 鼠标左键时，此函数返回图表窗口对应的X坐标。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">int</span>  <span class="token function">ChartXOnDropped</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>返回值</p> <p>X 坐标值</p> <p>注意</p> <p>X 轴的方向是自左向右的。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   <span class="token keyword">int</span> X<span class="token operator">=</span><span class="token function">ChartXOnDropped</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token keyword">int</span> Y<span class="token operator">=</span><span class="token function">ChartYOnDropped</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;(X,Y) = (&quot;</span><span class="token operator">+</span>X<span class="token operator">+</span><span class="token string">&quot;,&quot;</span><span class="token operator">+</span>Y<span class="token operator">+</span><span class="token string">&quot;)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>相关参考</p> <p>ChartWindowOnDropped, ChartPriceOnDropped, ChartTimeOnDropped</p> <h2 id="_18-30-chartyondropped"><a href="#_18-30-chartyondropped" class="header-anchor">#</a> 18.30 ChartYOnDropped</h2> <p>当拖动一个EA程序 或 脚本到图表窗口时，在 释放(松开) 鼠标左键时，此函数返回图表窗口对应的Y坐标。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">int</span>  <span class="token function">ChartYOnDropped</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>返回值</p> <p>Y 坐标值。</p> <p>注意</p> <p>Y 轴的方向是自上向下的。</p> <p>相关参考</p> <p>ChartWindowOnDropped, ChartPriceOnDropped, ChartTimeOnDropped</p> <h2 id="_18-31-chartsetsymbolperiod"><a href="#_18-31-chartsetsymbolperiod" class="header-anchor">#</a> 18.31 ChartSetSymbolPeriod</h2> <p>更改指定图表的交易品种和周期。该函数是异步的，即它发送命令并且不会等待它执行完成。 该命令被添加到图表消息队列中，并将在处理完所有以前的命令后执行。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  <span class="token function">ChartSetSymbolPeriod</span><span class="token punctuation">(</span> 
   <span class="token keyword">long</span>             chart_id<span class="token punctuation">,</span>     <span class="token comment">// 图表 ID </span>
   string           symbol<span class="token punctuation">,</span>       <span class="token comment">// 交易品种名称 </span>
   ENUM_TIMEFRAMES  period        <span class="token comment">// 周期 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>参数</p> <p>chart_id</p> <p>[in] 图表 ID编号。0 表示当前图表。</p> <p>symbol</p> <p>[in] 图表上交易品种。 NULL 值意味着当前图表上的交易品种(即附上EA交易程序的图表)。</p> <p>period</p> <p>[in] 图表周期(时间框架)。取值范围是ENUM_TIMEFRAMES枚举值之一。0意味着当前图表时间周期。</p> <p>返回值</p> <p>如果该命令已添加到图表队列则返回true，否则false。若想获得额外错误信息，需要调用函数GetLastError()。</p> <p>注意</p> <p>更改 交易品种/周期 将会导致图表中EA交易程序重新初始化。</p> <p>调用ChartSetSymbolPerid()函数时，指定相同的 交易品种 和 时间周期 作为形式参数，可以用来更新图表(类似于客户端的刷新命令)。反过来，图表的更新还会重新计算所有附加应用在图表上的指标。因此，即使没有报价您仍然可以通过这个方式来重新计算图表中的指标(例如：周末)。</p> <p>相关参考</p> <p>ChartSymbol, ChartPeriod</p> <h2 id="_18-32-chartscreenshot"><a href="#_18-32-chartscreenshot" class="header-anchor">#</a> 18.32 ChartScreenShot</h2> <p>根据指定的扩展名，以GIF，PNG或BMP格式对当前图表截屏。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  <span class="token function">ChartScreenShot</span><span class="token punctuation">(</span> 
   <span class="token keyword">long</span>             chart_id<span class="token punctuation">,</span>                   <span class="token comment">// 图表 ID </span>
   string           filename<span class="token punctuation">,</span>                   <span class="token comment">// 交易品种名称 </span>
   <span class="token keyword">int</span>              width<span class="token punctuation">,</span>                      <span class="token comment">// 宽度 </span>
   <span class="token keyword">int</span>              height<span class="token punctuation">,</span>                     <span class="token comment">// 高度 </span>
   ENUM_ALIGN_MODE  align_mode<span class="token operator">=</span>ALIGN_RIGHT      <span class="token comment">// 对齐类型 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>参数</p> <p>chart_id</p> <p>[in] 图表 ID编号。0 表示当前图表。</p> <p>filename</p> <p>[in] 屏幕截图文件名。不能超过63个字符。屏幕截图文件位于directory \ Files。</p> <p>width</p> <p>[in] 屏幕截图宽度，单位：像素。</p> <p>height</p> <p>[in] 屏幕截图高度，单位：像素。</p> <p>align_mode=ALIGN_RIGHT</p> <p>[in] 屏幕截图的有限输出模式。取值范围是ENUM_ALIGN_MODE枚举值之一。ALIGN_RIGHT 表示右边距对齐(从图表的末端输出)。ALIGN_LEFT 表示左对齐。</p> <p>返回值</p> <p>若成功返回true，否则false。</p> <p>注意</p> <p>如果需要从图表中的某一点截图，应首先用ChartNavigate()函数定位图表。如果截图的水平尺寸小于图表窗口，则会根据align_mode设置，选择输出图表窗口的右侧部分或其左侧部分。</p> <p>例如：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">description </span><span class="token string">&quot;The Expert Advisor demonstrates how to create a series of screenshots of the current&quot;</span> </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">description </span><span class="token string">&quot;chart using the ChartScreenShot() function. For convenience, the file name is&quot;</span> </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">description </span><span class="token string">&quot;shown on the chart. The height and width of images is defined through macros.&quot;</span> </span>
  
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span>        <span class="token macro-name">WIDTH</span>  <span class="token expression"><span class="token number">800</span>     </span><span class="token comment">// 图像宽度，调用ChartScreenShot() </span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span>        <span class="token macro-name">HEIGHT</span> <span class="token expression"><span class="token number">600</span>     </span><span class="token comment">// 图像高度，调用ChartScreenShot() </span></span>
  
<span class="token comment">//--- 输入参数 </span>
input <span class="token keyword">int</span>      pictures<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span>    <span class="token comment">// 序列中的图像数量 </span>
<span class="token keyword">int</span>            mode<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>       <span class="token comment">// -1 表示移到图表右边界，1 - 移到左边 </span>
<span class="token keyword">int</span>            bars_shift<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">;</span><span class="token comment">// 使用ChartNavigate()滚动图表时的柱形数量 </span>
<span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token comment">//| 专家初始化函数                                                     | </span>
<span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token keyword">void</span> <span class="token function">OnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
  <span class="token punctuation">{</span> 
<span class="token comment">//--- 禁止图表自动滚动 </span>
   <span class="token function">ChartSetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_AUTOSCROLL<span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">//--- 设置图表右边界转移 </span>
   <span class="token function">ChartSetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_SHIFT<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">//--- 显示蜡烛图图表 </span>
   <span class="token function">ChartSetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_MODE<span class="token punctuation">,</span>CHART_CANDLES<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">//--- </span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Preparation of the Expert Advisor is completed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span> 
<span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token comment">//| 专家订单号函数                                                     | </span>
<span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token keyword">void</span> <span class="token function">OnTick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
  <span class="token punctuation">{</span> 
<span class="token comment">//--- </span>
  
  <span class="token punctuation">}</span> 
<span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token comment">//| ChartEvent 函数                                                  | </span>
<span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token keyword">void</span> <span class="token function">OnChartEvent</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> id<span class="token punctuation">,</span> 
                  <span class="token keyword">const</span> <span class="token keyword">long</span> <span class="token operator">&amp;</span>lparam<span class="token punctuation">,</span> 
                  <span class="token keyword">const</span> <span class="token keyword">double</span> <span class="token operator">&amp;</span>dparam<span class="token punctuation">,</span> 
                  <span class="token keyword">const</span> string <span class="token operator">&amp;</span>sparam<span class="token punctuation">)</span> 
  <span class="token punctuation">{</span> 
<span class="token comment">//--- 显示函数名称，调用时间和事件标识符 </span>
   <span class="token function">Print</span><span class="token punctuation">(</span>__FUNCTION__<span class="token punctuation">,</span><span class="token function">TimeCurrent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&quot;   id=&quot;</span><span class="token punctuation">,</span>id<span class="token punctuation">,</span><span class="token string">&quot;   mode=&quot;</span><span class="token punctuation">,</span>mode<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">//--- 处理 CHARTEVENT_CLICK 事件 (&quot;鼠标点击图表&quot;) </span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>id<span class="token operator">==</span>CHARTEVENT_CLICK<span class="token punctuation">)</span> 
     <span class="token punctuation">{</span> 
      <span class="token comment">//--- 从图表边界初始移动 </span>
      <span class="token keyword">int</span> pos<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> 
      <span class="token comment">//--- 左侧图表边界操作 </span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>mode<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span> 
        <span class="token punctuation">{</span> 
         <span class="token comment">//--- 滚动图表至左侧边界 </span>
         <span class="token function">ChartNavigate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_BEGIN<span class="token punctuation">,</span>pos<span class="token punctuation">)</span><span class="token punctuation">;</span> 
         <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>pictures<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> 
           <span class="token punctuation">{</span> 
            <span class="token comment">//--- 准备在图表上显示的文本和文件名 </span>
            string name<span class="token operator">=</span><span class="token string">&quot;ChartScreenShot&quot;</span><span class="token operator">+</span><span class="token string">&quot;CHART_BEGIN&quot;</span><span class="token operator">+</span><span class="token function">string</span><span class="token punctuation">(</span>pos<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;.gif&quot;</span><span class="token punctuation">;</span> 
            <span class="token comment">//--- 在图表上显示名称作为注释 </span>
            <span class="token function">Comment</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> 
            <span class="token comment">//--- 在terminal_directory\MQL5\Files\文件中保存图表截图 </span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">ChartScreenShot</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>name<span class="token punctuation">,</span>WIDTH<span class="token punctuation">,</span>HEIGHT<span class="token punctuation">,</span>ALIGN_LEFT<span class="token punctuation">)</span><span class="token punctuation">)</span> 
               <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;We've saved the screenshot &quot;</span><span class="token punctuation">,</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> 
            <span class="token comment">//--- </span>
            pos<span class="token operator">+=</span>bars_shift<span class="token punctuation">;</span> 
            <span class="token comment">//--- 给予用户时间查看新的图表部分 </span>
            <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
            <span class="token comment">//--- 从当前位置bars_shift柱滚动图表到右侧 </span>
            <span class="token function">ChartNavigate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_CURRENT_POS<span class="token punctuation">,</span>bars_shift<span class="token punctuation">)</span><span class="token punctuation">;</span> 
           <span class="token punctuation">}</span> 
         <span class="token comment">//--- 改变模式到相反方向 </span>
         mode<span class="token operator">*=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> 
        <span class="token punctuation">}</span> 
      <span class="token keyword">else</span> <span class="token comment">// 图表右侧边界的操作 </span>
        <span class="token punctuation">{</span> 
         <span class="token comment">//--- 滚动图表至右侧边界 </span>
         <span class="token function">ChartNavigate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_END<span class="token punctuation">,</span>pos<span class="token punctuation">)</span><span class="token punctuation">;</span> 
         <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>pictures<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> 
           <span class="token punctuation">{</span> 
            <span class="token comment">//--- 准备在图表上显示的文本和文件名 </span>
            string name<span class="token operator">=</span><span class="token string">&quot;ChartScreenShot&quot;</span><span class="token operator">+</span><span class="token string">&quot;CHART_END&quot;</span><span class="token operator">+</span><span class="token function">string</span><span class="token punctuation">(</span>pos<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;.gif&quot;</span><span class="token punctuation">;</span> 
            <span class="token comment">//--- 在图表上显示名称作为注释 </span>
            <span class="token function">Comment</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> 
            <span class="token comment">//--- 在terminal_directory\MQL5\Files\文件中保存图表截图 </span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">ChartScreenShot</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>name<span class="token punctuation">,</span>WIDTH<span class="token punctuation">,</span>HEIGHT<span class="token punctuation">,</span>ALIGN_RIGHT<span class="token punctuation">)</span><span class="token punctuation">)</span> 
               <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;We've saved the screenshot &quot;</span><span class="token punctuation">,</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> 
            <span class="token comment">//--- </span>
            pos<span class="token operator">+=</span>bars_shift<span class="token punctuation">;</span> 
            <span class="token comment">//--- 给予用户时间查看新的图表部分 </span>
            <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
            <span class="token comment">//--- 从当前位置bars_shift柱滚动图表到右侧 </span>
            <span class="token function">ChartNavigate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_CURRENT_POS<span class="token punctuation">,</span><span class="token operator">-</span>bars_shift<span class="token punctuation">)</span><span class="token punctuation">;</span> 
           <span class="token punctuation">}</span> 
         <span class="token comment">//--- 改变模式到相反方向 </span>
         mode<span class="token operator">*=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> 
        <span class="token punctuation">}</span> 
     <span class="token punctuation">}</span>  <span class="token comment">// CHARTEVENT_CLICK 事件处理结束 </span>
<span class="token comment">//--- OnChartEvent()句柄末端   </span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br></div></div><p>相关参考</p> <p>ChartNavigate()， 资源</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/mql5yao/Chapter/seventeen.html" class="prev">
        17 第十七章 自定义交易品种
      </a></span> <span class="next"><a href="/mql5yao/Chapter/ninteen.html">
        19 第十九章 交易函数
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/mql5yao/assets/js/app.f23448f4.js" defer></script><script src="/mql5yao/assets/js/3.a8269cb7.js" defer></script><script src="/mql5yao/assets/js/26.07e08c10.js" defer></script>
  </body>
</html>
