<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>智能交易*姚 文档站</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/mql5yao/favicon.ico">
    <meta name="description" content="这是智能交易的文档站点。">
    <meta name="keywords" content="MQL,EA,智能交易,自动交易,量化,编程,培训">
    
    <link rel="preload" href="/mql5yao/assets/css/0.styles.7f3ae2a1.css" as="style"><link rel="preload" href="/mql5yao/assets/js/app.8a48e4d1.js" as="script"><link rel="preload" href="/mql5yao/assets/js/2.8ccfeae3.js" as="script"><link rel="preload" href="/mql5yao/assets/js/1.abd3212e.js" as="script"><link rel="preload" href="/mql5yao/assets/js/25.31655e4d.js" as="script"><link rel="prefetch" href="/mql5yao/assets/js/10.f43632ba.js"><link rel="prefetch" href="/mql5yao/assets/js/11.1d038644.js"><link rel="prefetch" href="/mql5yao/assets/js/12.e50722f3.js"><link rel="prefetch" href="/mql5yao/assets/js/13.bc6e6556.js"><link rel="prefetch" href="/mql5yao/assets/js/14.5cb8131f.js"><link rel="prefetch" href="/mql5yao/assets/js/15.bc368dfb.js"><link rel="prefetch" href="/mql5yao/assets/js/16.60e872ed.js"><link rel="prefetch" href="/mql5yao/assets/js/17.15a8a4c2.js"><link rel="prefetch" href="/mql5yao/assets/js/18.a3079194.js"><link rel="prefetch" href="/mql5yao/assets/js/19.2e53fae9.js"><link rel="prefetch" href="/mql5yao/assets/js/20.ff88a6ab.js"><link rel="prefetch" href="/mql5yao/assets/js/21.24994246.js"><link rel="prefetch" href="/mql5yao/assets/js/22.5048fb10.js"><link rel="prefetch" href="/mql5yao/assets/js/23.b0f62895.js"><link rel="prefetch" href="/mql5yao/assets/js/24.47212fdf.js"><link rel="prefetch" href="/mql5yao/assets/js/26.eaeeac1b.js"><link rel="prefetch" href="/mql5yao/assets/js/27.62ad36df.js"><link rel="prefetch" href="/mql5yao/assets/js/28.69609490.js"><link rel="prefetch" href="/mql5yao/assets/js/29.bd4055a1.js"><link rel="prefetch" href="/mql5yao/assets/js/3.0ebc6d24.js"><link rel="prefetch" href="/mql5yao/assets/js/30.f43e33e8.js"><link rel="prefetch" href="/mql5yao/assets/js/31.08aac79a.js"><link rel="prefetch" href="/mql5yao/assets/js/32.e40034cb.js"><link rel="prefetch" href="/mql5yao/assets/js/33.f14c86ef.js"><link rel="prefetch" href="/mql5yao/assets/js/34.35c02b74.js"><link rel="prefetch" href="/mql5yao/assets/js/35.048a5906.js"><link rel="prefetch" href="/mql5yao/assets/js/36.7be7df03.js"><link rel="prefetch" href="/mql5yao/assets/js/37.caf30399.js"><link rel="prefetch" href="/mql5yao/assets/js/38.7081ef66.js"><link rel="prefetch" href="/mql5yao/assets/js/39.8b16de3c.js"><link rel="prefetch" href="/mql5yao/assets/js/4.64cdca5a.js"><link rel="prefetch" href="/mql5yao/assets/js/40.c4bcc68d.js"><link rel="prefetch" href="/mql5yao/assets/js/41.9e814ceb.js"><link rel="prefetch" href="/mql5yao/assets/js/42.626ed300.js"><link rel="prefetch" href="/mql5yao/assets/js/43.9e56dbd2.js"><link rel="prefetch" href="/mql5yao/assets/js/44.b0aa6080.js"><link rel="prefetch" href="/mql5yao/assets/js/45.1ee1c2de.js"><link rel="prefetch" href="/mql5yao/assets/js/46.c7e60312.js"><link rel="prefetch" href="/mql5yao/assets/js/47.294d2506.js"><link rel="prefetch" href="/mql5yao/assets/js/48.9896cb6c.js"><link rel="prefetch" href="/mql5yao/assets/js/49.0b669611.js"><link rel="prefetch" href="/mql5yao/assets/js/5.6e0bc11f.js"><link rel="prefetch" href="/mql5yao/assets/js/50.d4317362.js"><link rel="prefetch" href="/mql5yao/assets/js/51.7cde1a30.js"><link rel="prefetch" href="/mql5yao/assets/js/52.593fbf2b.js"><link rel="prefetch" href="/mql5yao/assets/js/53.47314628.js"><link rel="prefetch" href="/mql5yao/assets/js/54.9177a36c.js"><link rel="prefetch" href="/mql5yao/assets/js/55.890a40de.js"><link rel="prefetch" href="/mql5yao/assets/js/56.950e221a.js"><link rel="prefetch" href="/mql5yao/assets/js/57.42541ac8.js"><link rel="prefetch" href="/mql5yao/assets/js/58.b782ed1e.js"><link rel="prefetch" href="/mql5yao/assets/js/59.0f7a8fa5.js"><link rel="prefetch" href="/mql5yao/assets/js/6.30ab1089.js"><link rel="prefetch" href="/mql5yao/assets/js/60.bb949f49.js"><link rel="prefetch" href="/mql5yao/assets/js/61.fb831bab.js"><link rel="prefetch" href="/mql5yao/assets/js/62.1d11fcd0.js"><link rel="prefetch" href="/mql5yao/assets/js/63.5e21940a.js"><link rel="prefetch" href="/mql5yao/assets/js/7.7481afc6.js"><link rel="prefetch" href="/mql5yao/assets/js/vendors~docsearch.b8e67d2d.js">
    <link rel="stylesheet" href="/mql5yao/assets/css/0.styles.7f3ae2a1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/mql5yao/" class="home-link router-link-active"><img src="/mql5yao/logo.png" alt="智能交易*姚 文档站" class="logo"> <span class="site-name can-hide">智能交易*姚 文档站</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/mql5yao/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/mql5yao/Chapter/start.html" class="nav-link">
  文档
</a></div><div class="nav-item"><a href="/mql5yao/Cutleeks/" class="nav-link">
  割韭菜XX招
</a></div><div class="nav-item"><a href="/mql5yao/support/" class="nav-link">
  支持本站
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/mql5yao/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/mql5yao/Chapter/start.html" class="nav-link">
  文档
</a></div><div class="nav-item"><a href="/mql5yao/Cutleeks/" class="nav-link">
  割韭菜XX招
</a></div><div class="nav-item"><a href="/mql5yao/support/" class="nav-link">
  支持本站
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>MQL5线上手册</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mql5yao/Chapter/start.html" class="sidebar-link">MQL5 参考</a></li><li><a href="/mql5yao/Chapter/one.html" class="sidebar-link">01 第一章 语言基础</a></li><li><a href="/mql5yao/Chapter/two.html" class="sidebar-link">02 第二章 标准常量，列举和架构</a></li><li><a href="/mql5yao/Chapter/three.html" class="sidebar-link">03 第三章 MQL5程序</a></li><li><a href="/mql5yao/Chapter/four.html" class="sidebar-link">04 第四章 预定义变量</a></li><li><a href="/mql5yao/Chapter/five.html" class="sidebar-link">05 第五章 普通函数</a></li><li><a href="/mql5yao/Chapter/six.html" class="sidebar-link">06 第六章 数组函数</a></li><li><a href="/mql5yao/Chapter/add1.html" aria-current="page" class="active sidebar-link">07 第七章 矩阵和向量方法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-1-矩阵和向量类型" class="sidebar-link">7.1  矩阵和向量类型</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-2-初始化" class="sidebar-link">7.2  初始化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-2-1-assign" class="sidebar-link">7.2.1  Assign</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-2-2-copyindicatorbuffer" class="sidebar-link">7.2.2  CopyIndicatorBuffer</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-2-3-copyrates" class="sidebar-link">7.2.3  CopyRates</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-2-4-copyticks" class="sidebar-link">7.2.4  CopyTicks</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-2-5-copyticksrange" class="sidebar-link">7.2.5  CopyTicksRange</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-2-6-eye" class="sidebar-link">7.2.6  Eye</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-2-7-identity" class="sidebar-link">7.2.7  Identity</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-2-8-ones" class="sidebar-link">7.2.8  Ones</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-2-9-zeros" class="sidebar-link">7.2.9  Zeros</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-2-10-full" class="sidebar-link">7.2.10  Full</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-2-11-tri" class="sidebar-link">7.2.11  Tri</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-2-12-init" class="sidebar-link">7.2.12  Init</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-2-13-fill" class="sidebar-link">7.2.13  Fill</a></li></ul></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-3-矩阵和向量操纵" class="sidebar-link">7.3  矩阵和向量操纵</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-3-1-hasnan" class="sidebar-link">7.3.1  HasNan</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-3-2-transpose" class="sidebar-link">7.3.2  Transpose</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-3-3-tril" class="sidebar-link">7.3.3  TriL</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-3-4-triu" class="sidebar-link">7.3.4  TriU</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-3-5-diag" class="sidebar-link">7.3.5  Diag</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-3-6-row" class="sidebar-link">7.3.6  Row</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-3-7-col" class="sidebar-link">7.3.7  Col</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-3-8-copy" class="sidebar-link">7.3.8  Copy</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-3-9-compare" class="sidebar-link">7.3.9  Compare</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-3-10-comparebydigits" class="sidebar-link">7.3.10  CompareByDigits</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-3-11-flat" class="sidebar-link">7.3.11  Flat</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-3-12-clip" class="sidebar-link">7.3.12  Clip</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-3-13-reshape" class="sidebar-link">7.3.13  Reshape</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-3-14-resize" class="sidebar-link">7.3.14  Resize</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-3-15-set" class="sidebar-link">7.3.15 Set</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-3-16-swaprows" class="sidebar-link">7.3.16  SwapRows</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-3-17-swapcols" class="sidebar-link">7.3.17  SwapCols</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-3-18-split" class="sidebar-link">7.3.18  Split</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-3-18-hsplit" class="sidebar-link">7.3.18 Hsplit</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-3-19-vsplit" class="sidebar-link">7.3.19 Vsplit</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-3-20-splitted" class="sidebar-link">7.3.20 splitted</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-3-21-argsort" class="sidebar-link">7.3.21 ArgSort</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-3-22-sort" class="sidebar-link">7.3.22  Sort</a></li></ul></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-4-矩阵和向量的数学运算" class="sidebar-link">7.4 矩阵和向量的数学运算</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-4-1-数学运算" class="sidebar-link">7.4.1  数学运算</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-4-2-数学函数" class="sidebar-link">7.4.2  数学函数</a></li></ul></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-5-乘积" class="sidebar-link">7.5  乘积</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-5-1-matmul" class="sidebar-link">7.5.1 MatMul</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-5-2-gemm" class="sidebar-link">7.5.2 GeMM</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-5-3-power" class="sidebar-link">7.5.3  Power</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-5-4-dot" class="sidebar-link">7.5.4  Dot</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-5-5-kron" class="sidebar-link">7.5.5  Kron</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-5-6-inner" class="sidebar-link">7.5.6  Inner</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-5-7-outer" class="sidebar-link">7.5.7  Outer</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-5-8-corrcoef" class="sidebar-link">7.5.8  CorrCoef</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-5-9-cov" class="sidebar-link">7.5.9  Cov</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-5-10-correlate" class="sidebar-link">7.5.10  Correlate</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-5-11-convolve" class="sidebar-link">7.5.11  Convolve</a></li></ul></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-6-矩阵变换" class="sidebar-link">7.6  矩阵变换</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-6-1-cholesky" class="sidebar-link">7.6.1  Cholesky</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-6-2-eig" class="sidebar-link">7.6.2  Eig</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-6-3-eigvals" class="sidebar-link">7.6.3  EigVals</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-6-4-lu" class="sidebar-link">7.6.4  LU</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-6-5-lup" class="sidebar-link">7.6.5  LUP</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-6-6-qr" class="sidebar-link">7.6.6  QR</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-6-7-svd" class="sidebar-link">7.6.7  SVD</a></li></ul></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-7-统计方法" class="sidebar-link">7.7  统计方法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-7-1-argmax" class="sidebar-link">7.7.1  ArgMax</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-7-2-argmin" class="sidebar-link">7.7.2 ArgMin</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-7-3-max" class="sidebar-link">7.7.3  Max</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-7-4-min" class="sidebar-link">7.7.4  Min</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-7-5-ptp" class="sidebar-link">7.7.5  Ptp</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-7-6-sum" class="sidebar-link">7.7.6    Sum</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-7-7-prod" class="sidebar-link">7.7.7  Prod</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-7-8-cumsum" class="sidebar-link">7.7.8  CumSum</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-7-9-cumprod" class="sidebar-link">7.7.9  CumProd</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-7-10-percentile" class="sidebar-link">7.7.10  Percentile</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-7-11-quantile" class="sidebar-link">7.7.11  Quantile</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-7-12-median" class="sidebar-link">7.7.12  Median</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-7-13-mean" class="sidebar-link">7.7.13  Mean</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-7-14-average" class="sidebar-link">7.7.14  Average</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-7-15-std" class="sidebar-link">7.7.15  Std</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-7-16-var" class="sidebar-link">7.7.16  Var</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-7-17-linearregression" class="sidebar-link">7.7.17  LinearRegression</a></li></ul></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-8-特征方法" class="sidebar-link">7.8  特征方法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-8-1-rows" class="sidebar-link">7.8.1  Rows</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-8-2-cols" class="sidebar-link">7.8.2  Cols</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-8-3-size" class="sidebar-link">7.8.3  Size</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-8-4-norm" class="sidebar-link">7.8.4  Norm</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-8-5-cond" class="sidebar-link">7.8.5 Cond</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-8-6-det" class="sidebar-link">7.8.6  Det</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-8-7-slogdet" class="sidebar-link">7.8.7 SLogDet</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-8-8-rank" class="sidebar-link">7.8.8  Rank</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-8-9-trace" class="sidebar-link">7.8.9  Trace</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-8-10-spectrum" class="sidebar-link">7.8.10  Spectrum</a></li></ul></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-9-求解线性方程组的矩阵方法" class="sidebar-link">7.9 求解线性方程组的矩阵方法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-9-1-solve" class="sidebar-link">7.9.1  Solve</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-9-2-lstsq" class="sidebar-link">7.9.2  LstSq</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-9-3-inv" class="sidebar-link">7.9.3  Inv</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-9-4-pinv" class="sidebar-link">7.9.4  PInv</a></li></ul></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-10-机器学习" class="sidebar-link">7.10  机器学习</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-10-1-activation" class="sidebar-link">7.10.1   Activation</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-10-2-derivative" class="sidebar-link">7.10.2 Derivative</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-10-3-loss" class="sidebar-link">7.10.3  Loss</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-10-4-lossgradient" class="sidebar-link">7.10.4  LossGradient</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-10-5-regressionmetric" class="sidebar-link">7.10.5  RegressionMetric</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-10-6-confusionmatrix" class="sidebar-link">7.10.6  ConfusionMatrix</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-10-7-confusionmatrixmultilabel" class="sidebar-link">7.10.7  ConfusionMatrixMultilabel</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-10-8-classificationmetric" class="sidebar-link">7.10.8  ClassificationMetric</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-10-9-classificationscore" class="sidebar-link">7.10.9 ClassificationScore</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-10-10-precisionrecall" class="sidebar-link">7.10.10  PrecisionRecall</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/add1.html#_7-10-11-receiveroperatingcharacteristic" class="sidebar-link">7.10.11  ReceiverOperatingCharacteristic</a></li></ul></li></ul></li><li><a href="/mql5yao/Chapter/seven.html" class="sidebar-link">08 第八章 函数转换</a></li><li><a href="/mql5yao/Chapter/eight.html" class="sidebar-link">09 第九章 数学函数</a></li><li><a href="/mql5yao/Chapter/nine.html" class="sidebar-link">10 第十章 字符串函数</a></li><li><a href="/mql5yao/Chapter/ten.html" class="sidebar-link">11 第十一章 日期和时间</a></li><li><a href="/mql5yao/Chapter/eleven.html" class="sidebar-link">12 第十二章 账户信息</a></li><li><a href="/mql5yao/Chapter/twelve.html" class="sidebar-link">13 第十三章 检测</a></li><li><a href="/mql5yao/Chapter/thirteen.html" class="sidebar-link">14 第十四章 事件处理</a></li><li><a href="/mql5yao/Chapter/fourteen.html" class="sidebar-link">15 第十五章 市场信息</a></li><li><a href="/mql5yao/Chapter/fifteen.html" class="sidebar-link">16 第十六章 经济日历函数</a></li><li><a href="/mql5yao/Chapter/sixteen.html" class="sidebar-link">17 第十七章 时间序列和指标访问</a></li><li><a href="/mql5yao/Chapter/seventeen.html" class="sidebar-link">18 第十八章 自定义交易品种</a></li><li><a href="/mql5yao/Chapter/eighteen.html" class="sidebar-link">19 第十九章 图表操作</a></li><li><a href="/mql5yao/Chapter/ninteen.html" class="sidebar-link">20 第二十章 交易函数</a></li><li><a href="/mql5yao/Chapter/twenty.html" class="sidebar-link">21 第廿一章 交易信号</a></li><li><a href="/mql5yao/Chapter/twentyone.html" class="sidebar-link">22 第廿二章 网络函数</a></li><li><a href="/mql5yao/Chapter/twentytwo.html" class="sidebar-link">23 第廿三章 程序端全局变量</a></li><li><a href="/mql5yao/Chapter/twentythree.html" class="sidebar-link">24 第廿四章 文件函数</a></li><li><a href="/mql5yao/Chapter/twentyfour.html" class="sidebar-link">25 第廿五章 自定义指标</a></li><li><a href="/mql5yao/Chapter/twentyfive.html" class="sidebar-link">26 第廿六章 物件函数</a></li><li><a href="/mql5yao/Chapter/twentysix.html" class="sidebar-link">27 第廿七章 技术指标</a></li><li><a href="/mql5yao/Chapter/twentyseven.html" class="sidebar-link">28 第甘八章 处理优化结果</a></li><li><a href="/mql5yao/Chapter/twentyeight.html" class="sidebar-link">29 第廿九章 工作事件</a></li><li><a href="/mql5yao/Chapter/twentynine.html" class="sidebar-link">30 第三十章 使用OpenCL工作</a></li><li><a href="/mql5yao/Chapter/thirty.html" class="sidebar-link">31 第卅一章 使用数据库</a></li><li><a href="/mql5yao/Chapter/thirtyone.html" class="sidebar-link">32 第卅二章 使用DirectX</a></li><li><a href="/mql5yao/Chapter/thirtytwo.html" class="sidebar-link">33 第卅三章 MetaTrader与Python集成的模块</a></li><li><a href="/mql5yao/Chapter/add2.html" class="sidebar-link">34 第卅四章 ONNX模型</a></li><li><a href="/mql5yao/Chapter/thirtythree.html" class="sidebar-link">35 第卅五章 标准程序库</a></li><li><a href="/mql5yao/Chapter/AppendixI.html" class="sidebar-link">36 附录一 来自MQL4</a></li><li><a href="/mql5yao/Chapter/AppendixII.html" class="sidebar-link">37 附录二 MQL5 函数列表</a></li><li><a href="/mql5yao/Chapter/AppendixIII.html" class="sidebar-link">38 附录三 MQL5常量列表</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2>第七章 矩阵和向量方法</h2> <p>矩阵是一个由双精度、浮点或复数组成的二维数组。</p> <p>向量是一个由双精度、浮点或复数组成的一维数组。 向量没有指出它是垂直的还是水平的。 它的判定应来自应用的上下文。 例如，向量运算不会假设左侧向量是水平的，右侧向量是垂直的。 如果需要类型指示，则可以采用一行或一列的矩阵。 然而，这通常没有必要。</p> <p>矩阵和向量为数据动态分配内存。 事实上，矩阵和向量是具有某些属性的对象，诸如它们包含的数据类型和维度。 矩阵和向量属性可以调用 vector_a.Size()、Matrix_b.Rows()、vector_c.Norm()、matrix_d.Cond() 等方法获取。 任何维度都可以更改。</p> <p>在创建和初始化矩阵时，采用的是所谓的静态方法（这些方法就像类的静态方法）。 例如: matrix::Eye(), matrix::Identity(), matrix::Ones(), vector::Ones(), matrix: :Zeros(), vector::Zeros(), matrix::Full(), vector::Full(), matrix::Tri()。</p> <p>此刻，矩阵和向量运算并不意味着运用复杂的数据类型，因为这一发展方向尚未完成。</p> <p>MQL5 支持将矩阵和向量传递至 DLL。 这样就能够从外部变量导入相关类型的函数。</p> <p>矩阵和向量以指向缓冲区的指针形式被传递到 DLL。 例如，若要传递浮点类型的矩阵，从 DLL 导出的函数，其相应参数必须采用浮点类型的缓冲区指针。</p> <p>MQL5</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">import</span> <span class="token string">&quot;mmlib.dll&quot;</span></span>
<span class="token keyword">bool</span> <span class="token function">sgemm</span><span class="token punctuation">(</span>uint flags<span class="token punctuation">,</span> matrix<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span> <span class="token operator">&amp;</span>C<span class="token punctuation">,</span> <span class="token keyword">const</span> matrix<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span> <span class="token operator">&amp;</span>A<span class="token punctuation">,</span> <span class="token keyword">const</span> matrix<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span> <span class="token operator">&amp;</span>B<span class="token punctuation">,</span> ulong M<span class="token punctuation">,</span> ulong N<span class="token punctuation">,</span> ulong K<span class="token punctuation">,</span> <span class="token keyword">float</span> alpha<span class="token punctuation">,</span> <span class="token keyword">float</span> beta<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">import</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>C++</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">extern</span> <span class="token string">&quot;C&quot;</span> <span class="token function">__declspec</span><span class="token punctuation">(</span>dllexport<span class="token punctuation">)</span> <span class="token keyword">bool</span> <span class="token function">sgemm</span><span class="token punctuation">(</span>UINT flags<span class="token punctuation">,</span> <span class="token keyword">float</span> <span class="token operator">*</span>C<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">float</span> <span class="token operator">*</span>A<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">float</span> <span class="token operator">*</span>B<span class="token punctuation">,</span> UINT64 M<span class="token punctuation">,</span> UINT64 N<span class="token punctuation">,</span> UINT64 K<span class="token punctuation">,</span> <span class="token keyword">float</span> alpha<span class="token punctuation">,</span> <span class="token keyword">float</span> beta<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>除了缓冲区之外，还应该传递矩阵和向量的大小，方可进行正确处理。</p> <p>下面按字母顺序列出了所有矩阵和向量方法。</p> <table><thead><tr><th>函数</th> <th>功能</th> <th>分类</th></tr></thead> <tbody><tr><td>Activation</td> <td>计算激活函数值，并将其写入传递的向量/矩阵</td> <td>机器学习</td></tr> <tr><td>ArgMax</td> <td>返回最大值的索引</td> <td>统计</td></tr> <tr><td>ArgMin</td> <td>返回最小值的索引</td> <td>统计</td></tr> <tr><td>ArgSort</td> <td>返回排序后的索引</td> <td>操纵</td></tr> <tr><td>Assign</td> <td>复制矩阵、向量或数组，并自动转换</td> <td>初始化</td></tr> <tr><td>Average</td> <td>计算矩阵/向量值的加权平均值</td> <td>统计</td></tr> <tr><td>Cholesky</td> <td>计算乔列斯基（Cholesky）分解</td> <td>变换</td></tr> <tr><td>Clip</td> <td>将矩阵/向量的元素限定到给定的有效值范围</td> <td>操纵</td></tr> <tr><td>Col</td> <td>返回列向量。 将向量写入指定的列。</td> <td>操纵</td></tr> <tr><td>Cols</td> <td>返回矩阵中的列数</td> <td>特征</td></tr> <tr><td>Compare</td> <td>以指定的精度比较两个矩阵/向量的元素</td> <td>操纵</td></tr> <tr><td>CompareByDigits</td> <td>将两个矩阵/向量的元素按有效数字精度进行比较</td> <td>操纵</td></tr> <tr><td>Cond</td> <td>计算一个矩阵的条件数</td> <td>特征</td></tr> <tr><td>Convolve</td> <td>返回两个向量的离散线性卷积</td> <td>乘积</td></tr> <tr><td>Copy</td> <td>返回给定矩阵/向量的副本</td> <td>操纵</td></tr> <tr><td>CopyIndicatorBuffer</td> <td>将指定数量中指定指标缓冲区的数据获取到向量</td> <td>初始化</td></tr> <tr><td>CopyRates</td> <td>获取指定品种、周期、数量的历史序列，格式为 MqlRates 结构，并存储到矩阵或向量</td> <td>初始化</td></tr> <tr><td>CopyTicks</td> <td>从 MqlTick 结构获取跳价，存储到矩阵或向量中</td> <td>初始化</td></tr> <tr><td>CopyTicksRange</td> <td>从 MqlTick 结构获取跳价，以指定数据范围存储到矩阵或向量中</td> <td>初始化</td></tr> <tr><td>CorrCoef</td> <td>计算皮尔逊（Pearson）相关系数（线性相关系数）</td> <td>乘积</td></tr> <tr><td>Correlate</td> <td>计算两个向量的互相关性</td> <td>乘积</td></tr> <tr><td>Cov</td> <td>计算协方差矩阵</td> <td>乘积</td></tr> <tr><td>CumProd</td> <td>返回矩阵/向量元素的累积乘积，包括沿给定轴的累积乘积</td> <td>统计</td></tr> <tr><td>CumSum</td> <td>返回矩阵/矢量元素的累积总和，包括沿给定轴的矩阵/矢量元素</td> <td>统计</td></tr> <tr><td>Derivative</td> <td>计算激活函数导数值，并将其写入所传递的向量/矩阵</td> <td>机器学习</td></tr> <tr><td>Det</td> <td>计算平方可逆矩阵的行列式</td> <td>特征</td></tr> <tr><td>Diag</td> <td>提取对角线或构造对角矩阵</td> <td>操纵</td></tr> <tr><td>Dot</td> <td>两个向量的点积</td> <td>乘积</td></tr> <tr><td>Eig</td> <td>计算方阵的本征值和右本征向量</td> <td>变换</td></tr> <tr><td>EigVals</td> <td>计算一般矩阵的本征值</td> <td>变换</td></tr> <tr><td>Eye</td> <td>返回一个矩阵，对角线上为 1，其它地方为 0</td> <td>初始化</td></tr> <tr><td>Fill</td> <td>用指定值填充现有矩阵或向量</td> <td>初始化</td></tr> <tr><td>Flat</td> <td>通过一个索引替代两个索引访问矩阵元素</td> <td>操纵</td></tr> <tr><td>Full</td> <td>创建并返回新矩阵，并以给定值填充</td> <td>初始化</td></tr> <tr><td>GeMM</td> <td>GeMM（通用矩阵乘法）方法实现了两个矩阵的一般乘法</td> <td>乘积</td></tr> <tr><td>HasNan</td> <td>返回矩阵/向量中NaN值的数量</td> <td>操纵</td></tr> <tr><td>Hsplit</td> <td>将矩阵水平拆分为多个子矩阵。 与 axis=0 的拆分相同</td> <td>操纵</td></tr> <tr><td>Identity</td> <td>创建指定大小的单位矩阵</td> <td>初始化</td></tr> <tr><td>Init</td> <td>矩阵或向量初始化</td> <td>初始化</td></tr> <tr><td>Inner</td> <td>两个矩阵的内积</td> <td>乘积</td></tr> <tr><td>Inv</td> <td>用乔丹-高斯（Jordan-Gauss）方法计算平方可逆矩阵的乘法逆</td> <td>解法</td></tr> <tr><td>Kron</td> <td>返回两个矩阵、矩阵和向量，向量和矩阵、或两个向量的克罗内克（Kronecker）乘积</td> <td>乘积</td></tr> <tr><td>LinearRegression</td> <td>计算包含计算的线性回归值的向量/矩阵</td> <td>统计</td></tr> <tr><td>Loss</td> <td>计算损失函数值，并将其写入所传递的向量/矩阵</td> <td>机器学习</td></tr> <tr><td>LstSq</td> <td>返回线性代数方程的最小二乘解（对于非二乘或退化矩阵）</td> <td>解法</td></tr> <tr><td>LU</td> <td>实现矩阵的 LU 分解：下三角矩阵和上三角矩阵的乘积</td> <td>变换</td></tr> <tr><td>LUP</td> <td>以部分排列实现 LUP 分解，这仅指具有行排列的 LU 分解：PA=LU</td> <td>变换</td></tr> <tr><td>MatMul</td> <td>两个矩阵的矩阵乘积</td> <td>乘积</td></tr> <tr><td>Max</td> <td>返回矩阵/向量中的最大值</td> <td>统计</td></tr> <tr><td>Mean</td> <td>计算元素值的算术平均值</td> <td>统计</td></tr> <tr><td>Median</td> <td>计算矩阵/向量元素的中位数</td> <td>统计</td></tr> <tr><td>Min</td> <td>返回矩阵/向量中的最小值</td> <td>统计</td></tr> <tr><td>Norm</td> <td>返回矩阵或向量范数</td> <td>特征</td></tr> <tr><td>Ones</td> <td>创建并返回一个新矩阵，其中以 1 填充</td> <td>初始化</td></tr> <tr><td>Outer</td> <td>计算两个矩阵或两个向量的外积</td> <td>乘积</td></tr> <tr><td>Percentile</td> <td>返回矩阵/向量元素，或沿指定轴的元素值的指定百分位数</td> <td>统计</td></tr> <tr><td>PInv</td> <td>遵照摩尔-彭罗斯（Moore-Penrose）方法计算矩阵的伪逆</td> <td>解法</td></tr> <tr><td>Power</td> <td>将方阵提高整数幂</td> <td>乘积</td></tr> <tr><td>Prod</td> <td>返回矩阵/向量元素的乘积，也可以针对给定轴执行</td> <td>统计</td></tr> <tr><td>Ptp</td> <td>返回矩阵/向量或给定矩阵轴的数值范围</td> <td>统计</td></tr> <tr><td>QR</td> <td>计算矩阵的 QR 分解</td> <td>变换</td></tr> <tr><td>Quantile</td> <td>返回矩阵/向量元素，或沿指定轴的元素值的指定分位数</td> <td>统计</td></tr> <tr><td>Rank</td> <td>返回利用高斯（Gaussian）方法的矩阵秩</td> <td>特征</td></tr> <tr><td>RegressionMetric</td> <td>在指定数据数组上构建回归线，并计算回归量程作为偏差误差</td> <td>统计</td></tr> <tr><td>Reshape</td> <td>在不更改矩阵数据的情况下更改矩阵的形状</td> <td>操纵</td></tr> <tr><td>Resize</td> <td>返回形状和大小均已更改的新矩阵</td> <td>操纵</td></tr> <tr><td>Row</td> <td>返回行向量。 将向量写入指定行</td> <td>操纵</td></tr> <tr><td>Rows</td> <td>返回矩阵中的行数</td> <td>特征</td></tr> <tr><td>Set</td> <td>根据指定索引设置向量元素值</td> <td>操纵</td></tr> <tr><td>Size</td> <td>返回向量的大小</td> <td>特征</td></tr> <tr><td>SLogDet</td> <td>计算矩阵行列式的符号和对数</td> <td>特征</td></tr> <tr><td>Solve</td> <td>求解线性矩阵方程或线性代数方程组</td> <td>解法</td></tr> <tr><td>Sort</td> <td>按位置排序</td> <td>操纵</td></tr> <tr><td>Spectrum</td> <td>计算矩阵的谱作为其本征值的集合，来自乘积 AT*A</td> <td>特征</td></tr> <tr><td>Split</td> <td>将矩阵拆分为多个子矩阵</td> <td>操纵</td></tr> <tr><td>Std</td> <td>返回矩阵/向量元素，或沿指定轴的元素值的标准偏差</td> <td>统计</td></tr> <tr><td>Sum</td> <td>返回矩阵/矢量元素的总和，也可以针对给定的轴（多轴）执行</td> <td>统计</td></tr> <tr><td>SVD</td> <td>奇异值分解</td> <td>变换</td></tr> <tr><td>SwapCols</td> <td>交换矩阵中的列</td> <td>操纵</td></tr> <tr><td>SwapRows</td> <td>交换矩阵中的行</td> <td>操纵</td></tr> <tr><td>Trace</td> <td>返回矩阵对角线的总和</td> <td>特征</td></tr> <tr><td>Transpose</td> <td>转置（轴交换）并返回修改后的矩阵</td> <td>操纵</td></tr> <tr><td>Tri</td> <td>构造一个矩阵，在指定的对角线上及以下为 1，在其它地方为零</td> <td>初始化</td></tr> <tr><td>TriL</td> <td>返回矩阵的副本，其中第 k 个对角线以上的元素归零。 下三角矩阵</td> <td>操纵</td></tr> <tr><td>TriU</td> <td>返回矩阵的副本，其中第 k 个对角线下方的元素归零。 上三角矩阵</td> <td>操纵</td></tr> <tr><td>Var</td> <td>计算矩阵/向量元素值的方差</td> <td>统计</td></tr> <tr><td>Vsplit</td> <td>将矩阵垂直拆分为多个子矩阵。 axis=1 的拆分相同</td> <td>操纵</td></tr> <tr><td>Zeros</td> <td>创建并返回一个新矩阵，填充零</td> <td>初始化</td></tr></tbody></table> <h2 id="_7-1-矩阵和向量类型"><a href="#_7-1-矩阵和向量类型" class="header-anchor">#</a> 7.1  矩阵和向量类型</h2> <p>矩阵和向量是 MQL5 中支持线性代数运算的特殊数据类型。 存在以下数据类型：</p> <ul><li>matrix ― 包含双精度元素的矩阵。</li> <li>matrixf ― 包含浮点元素的矩阵。</li> <li>matrixc ― 包含复数元素的矩阵。</li> <li>vector ― 包含双精度元素的向量。</li> <li>vectorf ― 包含浮点元素的向量。</li> <li>vectorc ― 包含复数元素的向量。</li></ul> <p>模板函数支持 matrix&lt;double&gt;、matrix&lt;float&gt;、vector&lt;double&gt;、vector&lt;float&gt; 等表示法，替代相应的类型。</p> <p><strong>矩阵和向量初始化方法</strong></p> <table><thead><tr><th>函数</th> <th>功能</th></tr></thead> <tbody><tr><td>Eye</td> <td>返回一个矩阵，对角线上为 1，其它地方为 0</td></tr> <tr><td>Identity</td> <td>创建指定大小的单位矩阵</td></tr> <tr><td>Ones</td> <td>创建并返回一个新矩阵，其中以 1 填充</td></tr> <tr><td>Zeros</td> <td>创建并返回一个新矩阵，填充零</td></tr> <tr><td>Full</td> <td>创建并返回新矩阵，并按给定值填充</td></tr> <tr><td>Tri</td> <td>构造一个矩阵，其中位于给定对角线为 一，而其它地方为零</td></tr> <tr><td>Init</td> <td>初始化矩阵或向量</td></tr> <tr><td>Fill</td> <td>用指定值填充现有矩阵或向量</td></tr></tbody></table> <h2 id="_7-2-初始化"><a href="#_7-2-初始化" class="header-anchor">#</a> 7.2  初始化</h2> <p>有若干种方法可以声明和初始化矩阵和向量。</p> <table><thead><tr><th>函数</th> <th>动作</th></tr></thead> <tbody><tr><td>Assign</td> <td>复制矩阵、向量或数组，并自动转换</td></tr> <tr><td>CopyIndicatorBuffer</td> <td>将指定数量中指定指标缓冲区的数据获取到向量</td></tr> <tr><td>CopyRates</td> <td>获取指定品种、周期、数量的历史序列，格式为 MqlRates 结构，并存储到矩阵或向量</td></tr> <tr><td>CopyTicks</td> <td>从 MqlTick 结构获取跳价，存储到矩阵或向量中</td></tr> <tr><td>CopyTicksRange</td> <td>从 MqlTick 结构获取跳价，以指定数据范围存储到矩阵或向量中</td></tr> <tr><td>Eye</td> <td>返回一个矩阵，对角线上为 1，其它地方为 0</td></tr> <tr><td>Identity</td> <td>创建指定大小的单位矩阵</td></tr> <tr><td>Ones</td> <td>创建并返回一个新矩阵，其中以 1 填充</td></tr> <tr><td>Zeros</td> <td>创建并返回一个新矩阵，填充零</td></tr> <tr><td>Full</td> <td>创建并返回新矩阵，并按给定值填充</td></tr> <tr><td>Tri</td> <td>构造一个矩阵，其中位于给定对角线为 一，而其它地方为零</td></tr> <tr><td>Init</td> <td>初始化矩阵或向量</td></tr> <tr><td>Fill</td> <td>用指定值填充现有矩阵或向量</td></tr></tbody></table> <p><strong>声明且未指定大小（没有为数据分配内存）：</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>  matrix         matrix_a<span class="token punctuation">;</span>   <span class="token comment">// 双精度型矩阵</span>
  matrix<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span> matrix_a1<span class="token punctuation">;</span>  <span class="token comment">// 声明双矩阵的另一种途径；可以在模板中使用</span>
  matrixf        matrix_a2<span class="token punctuation">;</span>  <span class="token comment">// 浮点型矩阵</span>
  matrix<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span>  matrix_a3<span class="token punctuation">;</span>  <span class="token comment">// 浮点型矩阵</span>
  vector         vector_a<span class="token punctuation">;</span>   <span class="token comment">// 双精度向量</span>
  vector<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span> vector_a1<span class="token punctuation">;</span>
  vectorf        vector_a2<span class="token punctuation">;</span>  <span class="token comment">// 双精度向量</span>
  vector<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span>  vector_a3<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>声明且指定大小（为数据分配内存，但未初始化）：</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>  matrix         <span class="token function">matrix_a</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">// 参数既可是常数</span>
  matrix<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span> <span class="token function">matrix_a1</span><span class="token punctuation">(</span>InpRows<span class="token punctuation">,</span>InpCols<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 亦或变量</span>
  matrixf        <span class="token function">matrix_a2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// 水平向量的模拟</span>
  matrix<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span>  <span class="token function">matrix_a3</span><span class="token punctuation">(</span>InpRows<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 垂直向量的模拟</span>
  vector         <span class="token function">vector_a</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  vector<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span> <span class="token function">vector_a1</span><span class="token punctuation">(</span>InpSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
  vectorf        <span class="token function">vector_a2</span><span class="token punctuation">(</span><span class="token function">SomeFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// 函数 SomeFunc 返回一个 ulong 型的数字，用于设置向量大小</span>
  vector<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span>  <span class="token function">vector_a3</span><span class="token punctuation">(</span>InpSize<span class="token operator">+</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// 表达式可以用作参数</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>声明且初始化（矩阵和向量大小由初始化序列确定）：</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>  matrix         matrix_a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0.1</span><span class="token punctuation">,</span><span class="token number">0.2</span><span class="token punctuation">,</span><span class="token number">0.3</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">0.4</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">,</span><span class="token number">0.6</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  matrix<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span> matrix_a1<span class="token operator">=</span>matrix_a<span class="token punctuation">;</span>                      <span class="token comment">// 必须是相同类型的矩阵</span>
  matrixf        matrix_a2<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  matrix<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span>  matrix_a3<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  vector         vector_a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  vector<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span> vector_a1<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2.4</span><span class="token punctuation">,</span><span class="token number">3.3</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  vectorf        vector_a2<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  vector<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span>  vector_a3<span class="token operator">=</span>vector_a2<span class="token punctuation">;</span>                     <span class="token comment">// 必须是相同类型的向量</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>声明且初始化：</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token function">MatrixArange</span><span class="token punctuation">(</span>matrix<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token operator">&amp;</span>mat<span class="token punctuation">,</span>T value<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">,</span>T step<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>ulong i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>mat<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span>ulong j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span>mat<span class="token punctuation">.</span><span class="token function">Cols</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">,</span>value<span class="token operator">+=</span>step<span class="token punctuation">)</span>
         mat<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>value<span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token function">VectorArange</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token operator">&amp;</span>vec<span class="token punctuation">,</span>T value<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">,</span>T step<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>ulong i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>vec<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">,</span>value<span class="token operator">+=</span>step<span class="token punctuation">)</span>
      vec<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
 
  matrix  <span class="token function">matrix_a</span><span class="token punctuation">(</span>size_m<span class="token punctuation">,</span>size_k<span class="token punctuation">,</span>MatrixArange<span class="token punctuation">,</span><span class="token operator">-</span>M_PI<span class="token punctuation">,</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 首先创建一个大小 size_m x size_k 的未初始化矩阵，然后调用带有初始化时指定参数的 MatrixArange 函数</span>
  matrixf <span class="token function">matrix_a1</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span>MatrixArange<span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token comment">// 创建矩阵后，调用带有默认参数的 MatrixArange 函数</span>
  vector  <span class="token function">vector_a</span><span class="token punctuation">(</span>size<span class="token punctuation">,</span>VectorArange<span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">10.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token comment">// 创建向量后，调用带有一个参数的 VectorArange 函数，而第二个参数采用默认值</span>
  vectorf <span class="token function">vector_a1</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span>VectorArange<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>请注意，矩阵或矢量大小可以更改，因为数据的内存始终是动态的。</p> <p>静态方法
依据指定大小创建矩阵和向量的静态方法，并以某种方式初始化：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>  matrix         matrix_a <span class="token operator">=</span>matrix<span class="token double-colon punctuation">::</span><span class="token function">Eye</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  matrix<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span> matrix_a1<span class="token operator">=</span>matrix<span class="token double-colon punctuation">::</span><span class="token function">Full</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span>M_PI<span class="token punctuation">)</span><span class="token punctuation">;</span>
  matrixf        matrix_a2<span class="token operator">=</span>matrixf<span class="token double-colon punctuation">::</span><span class="token function">Identity</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  matrixf<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span> matrix_a3<span class="token operator">=</span>matrixf<span class="token double-colon punctuation">::</span><span class="token function">Ones</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  matrix         matrix_a4<span class="token operator">=</span>matrix<span class="token double-colon punctuation">::</span><span class="token function">Tri</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  vector         vector_a <span class="token operator">=</span>vector<span class="token double-colon punctuation">::</span><span class="token function">Ones</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  vectorf        vector_a1<span class="token operator">=</span><span class="token class-name">vector</span><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span><span class="token function">Zeros</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  vector<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span>  vector_a2<span class="token operator">=</span>vectorf<span class="token double-colon punctuation">::</span><span class="token function">Full</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span>float_value<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>已创建矩阵和向量的初始化方法：</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>  matrix  matrix_a<span class="token punctuation">;</span>
  matrix_a<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span>size_m<span class="token punctuation">,</span>size_k<span class="token punctuation">,</span>MatrixArange<span class="token punctuation">,</span><span class="token operator">-</span>M_PI<span class="token punctuation">,</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  matrixf <span class="token function">matrix_a1</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  matrix_a1<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span>MatrixArange<span class="token punctuation">)</span><span class="token punctuation">;</span>
  vector  vector_a<span class="token punctuation">;</span>
  vector_a<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span>VectorArange<span class="token punctuation">)</span><span class="token punctuation">;</span>
  vectorf <span class="token function">vector_a1</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  vector_a1<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span>vector_size<span class="token punctuation">,</span>VectorArange<span class="token punctuation">,</span>start_value<span class="token punctuation">,</span>step<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  matrix_a<span class="token punctuation">.</span><span class="token function">Fill</span><span class="token punctuation">(</span>double_value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  vector_a1<span class="token punctuation">.</span><span class="token function">Fill</span><span class="token punctuation">(</span>FLT_MIN<span class="token punctuation">)</span><span class="token punctuation">;</span>
  matrix_a1<span class="token punctuation">.</span><span class="token function">Identity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="_7-2-1-assign"><a href="#_7-2-1-assign" class="header-anchor">#</a> 7.2.1  Assign</h3> <p>复制矩阵、向量或数组，且带有自动转换。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Assign</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> matrix<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span>  <span class="token operator">&amp;</span>mat     <span class="token comment">// 复制的矩阵</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">bool</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Assign</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token keyword">void</span>       <span class="token operator">&amp;</span>array<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">// 复制的数组</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">bool</span> vector<span class="token double-colon punctuation">::</span><span class="token function">Assign</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> vector<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span>  <span class="token operator">&amp;</span>vec     <span class="token comment">// 复制的向量</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">bool</span> vector<span class="token double-colon punctuation">::</span><span class="token function">Assign</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token keyword">void</span>       <span class="token operator">&amp;</span>array<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">// 复制的数组</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>参数</strong></p> <p>m, v 或 array</p> <p>[输入]  需复制的源矩阵、向量或数组。</p> <p><strong>返回值</strong></p> <p>如果成功则返回 true，否则返回 ― false。</p> <p><strong>注意</strong></p> <p>不同于 Copy，Assign 方法还允许复制数组。 在这种情况下，将进行自动转换，同时生成的矩阵或向量会根据复制数组的大小进行调整。</p> <p><strong>示例:</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//--- 复制矩阵</span>
  matrix a<span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  matrix b<span class="token operator">=</span>a<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">;</span>
  matrix c<span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix a \n&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix b \n&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
  c<span class="token punctuation">.</span><span class="token function">Assign</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix c \n&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">//--- 复制数组到矩阵</span>
  matrix double_matrix<span class="token operator">=</span>matrix<span class="token double-colon punctuation">::</span><span class="token function">Full</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">3.14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;double_matrix before Assign() \n&quot;</span><span class="token punctuation">,</span> double_matrix<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">int</span> int_arr<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;int_arr: &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">ArrayPrint</span><span class="token punctuation">(</span>int_arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
  double_matrix<span class="token punctuation">.</span><span class="token function">Assign</span><span class="token punctuation">(</span>int_arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;double_matrix after Assign(int_arr) \n&quot;</span><span class="token punctuation">,</span> double_matrix<span class="token punctuation">)</span><span class="token punctuation">;</span>  
  <span class="token comment">/*
   matrix a
   [[2,2]
    [3,3]
    [4,4]]
   matrix b
   [[4,4]
    [5,5]
    [6,6]]
   matrix c
   [[2,2]
    [3,3]
    [4,4]]
 
   double_matrix before Assign() 
   [[3.14,3.14,3.14,3.14,3.14,3.14,3.14,3.14,3.14,3.14]
    [3.14,3.14,3.14,3.14,3.14,3.14,3.14,3.14,3.14,3.14]]
    
   int_arr: 
       [,0][,1][,2][,3][,4]
   [0,]   1   2   0   0   0
   [1,]   3   4   0   0   0
   [2,]   5   6   0   0   0
   [3,]   0   0   0   0   0
   [4,]   0   0   0   0   0
   
   double_matrix after Assign(int_arr) 
   [[1,2,0,0,0]
    [3,4,0,0,0]
    [5,6,0,0,0]
    [0,0,0,0,0]
    [0,0,0,0,0]]
 
  */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br></div></div><p>相关参考</p> <p>Copy</p> <h3 id="_7-2-2-copyindicatorbuffer"><a href="#_7-2-2-copyindicatorbuffer" class="header-anchor">#</a> 7.2.2  CopyIndicatorBuffer</h3> <p>将指定数量中指定指标缓冲区的数据获取到向量。</p> <p>数据将被复制到向量中，定位到为该向量分配的物理内存开头的最早元素。共有三个函数选项。</p> <p><strong>根据初始位置和所需元素的数量进行访问</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  vector<span class="token double-colon punctuation">::</span><span class="token function">CopyIndicatorBuffer</span><span class="token punctuation">(</span>
   <span class="token keyword">long</span>      indicator_handle<span class="token punctuation">,</span>     <span class="token comment">// 指标句柄</span>
   ulong     buffer_index<span class="token punctuation">,</span>         <span class="token comment">// 指标缓冲区编号</span>
   ulong     start_pos<span class="token punctuation">,</span>            <span class="token comment">// 要复制的开始位置</span>
   ulong     count                 <span class="token comment">// 要复制的元素数量</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>根据开始日期和所需元素的数量进行访问</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  vector<span class="token double-colon punctuation">::</span><span class="token function">CopyIndicatorBuffer</span><span class="token punctuation">(</span>
   <span class="token keyword">long</span>      indicator_handle<span class="token punctuation">,</span>     <span class="token comment">// 指标句柄</span>
   ulong     buffer_index<span class="token punctuation">,</span>         <span class="token comment">// 指标缓冲区编号</span>
   datetime  start_time<span class="token punctuation">,</span>           <span class="token comment">// 复制的开始日期</span>
   ulong     count                 <span class="token comment">// 复制的元素数量</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>根据所需时间间隔的初始日期和最终日期进行访问</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  vector<span class="token double-colon punctuation">::</span><span class="token function">CopyIndicatorBuffer</span><span class="token punctuation">(</span>
   <span class="token keyword">long</span>      indicator_handle<span class="token punctuation">,</span>     <span class="token comment">// 指标句柄</span>
   ulong     buffer_index<span class="token punctuation">,</span>         <span class="token comment">// 指标缓冲区编号</span>
   datetime  start_time<span class="token punctuation">,</span>           <span class="token comment">// 复制的开始日期</span>
   datetime  stop_time             <span class="token comment">// 复制的结束日期</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>参数</strong></p> <p>indicator_handle</p> <p>[in] 由相关指标函数获得的指标句柄。</p> <p>buffer_index</p> <p>[in]  指标缓存区的编号。</p> <p>start_pos</p> <p>[in]  第一个复制元素的索引编号。</p> <p>count</p> <p>[in]  复制的元素数。</p> <p>start_time</p> <p>[in]  第一个元素对应的柱形图时间。</p> <p>stop_time</p> <p>[in]  最后一个元素对应的柱形图时间。</p> <p><strong>返回值</strong></p> <p>如果成功，函数返回'true'，如果出现错误则返回'false'。</p> <p><strong>注意</strong></p> <p>复制数据的元素（索引为buffer_index的指标缓冲区）从现在到过去进行计数，因此起始位置等于0表示当前柱形图（当前柱形图的指标值）。</p> <p>当复制未知数量的数据时，您应该声明一个不指定大小的向量（不为数据分配内存），因为CopyBuffer()函数试图将接收向量的大小分配给复制数据的大小。</p> <p>当需要部分复制指标值时，应该使用一个中间向量，将所需的数量复制到其中。从这个中间向量，您可以逐个成员地将所需数量的值复制到接收向量的所需位置</p> <p>如果要复制预定数量的数据，建议预先声明一个向量并指定其大小，以避免不必要的内存重新分配。</p> <p>从指标请求数据时，如果请求的时间序列尚未构建或需要从服务器下载，则该函数立即返回false，同时启动加载/构建。</p> <p>当从EA或脚本请求数据时，如果程序端在本地没有合适的数据，则启动从服务器下载，或者如果可以从本地历史构建数据，但所需的时间序列尚未准备好，则开始构建必要的时间序列。该函数返回在超时到期时将准备好的数量。</p> <p>另见</p> <p>CopyBuffer</p> <h3 id="_7-2-3-copyrates"><a href="#_7-2-3-copyrates" class="header-anchor">#</a> 7.2.3  CopyRates</h3> <p>获取 MqlRates 结构的历史序列，按指定品种-周期，按指定数量，并存储到矩阵或向量当中。 元素顺序倒计时，从现在到过去，这意味着起始位置等于 0 表示当前柱线。</p> <p>复制数据，以便将最久远的元素放置在矩阵/向量的开头。 有三个函数选项。</p> <p><strong>依据初始位置和所需元素的数量进行访问</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  <span class="token function">CopyRates</span><span class="token punctuation">(</span>
   string           symbol<span class="token punctuation">,</span>       <span class="token comment">// 品名</span>
   ENUM_TIMEFRAMES  period<span class="token punctuation">,</span>       <span class="token comment">// 周期</span>
   ulong            rates_mask<span class="token punctuation">,</span>   <span class="token comment">// 指定所请求序列的标志组合</span>
   ulong            start<span class="token punctuation">,</span>        <span class="token comment">// 复制初始柱线的起始索引</span>
   ulong            count         <span class="token comment">// 要复制的数量</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>按初始日期和所需元素的数量进行访问</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  <span class="token function">CopyRates</span><span class="token punctuation">(</span>
   string           symbol<span class="token punctuation">,</span>       <span class="token comment">// 品名</span>
   ENUM_TIMEFRAMES  period<span class="token punctuation">,</span>       <span class="token comment">// 周期</span>
   ulong            rates_mask<span class="token punctuation">,</span>   <span class="token comment">// 指定所请求序列的标志组合</span>
   datetime         from<span class="token punctuation">,</span>         <span class="token comment">// 起始日期</span>
   ulong            count         <span class="token comment">// 要复制的数量</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>按所需时间间隔的初始日期和最终日期进行访问</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  <span class="token function">CopyRates</span><span class="token punctuation">(</span>
   string           symbol<span class="token punctuation">,</span>       <span class="token comment">// 品名</span>
   ENUM_TIMEFRAMES  period<span class="token punctuation">,</span>       <span class="token comment">// 周期</span>
   ulong            rates_mask<span class="token punctuation">,</span>   <span class="token comment">// 指定所请求序列的标志组合</span>
   datetime         from<span class="token punctuation">,</span>         <span class="token comment">// 起始日期</span>
   datetime         to            <span class="token comment">// 结束日期</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>参数</strong></p> <p>symbol</p> <p>[输入]  品种。</p> <p>period</p> <p>[输入]  周期。</p> <p>rates_mask</p> <p>[输入]  指定所请求序列类型的标志的 ENUM_COPY_RATES 枚举组合。 当复制到向量时，只能指定来自 ENUM_COPY_RATES 枚举中的一个值，否则会发生错误。</p> <p>start</p> <p>[输入]  第一个复制的元素索引。</p> <p>count</p> <p>[输入]  复制的元素数量。</p> <p>from</p> <p>[输入]  对应于第一个元素的柱线时间。</p> <p>to</p> <p>[输入]  对应于最后一个元素的柱线时间。</p> <p><strong>返回值</strong></p> <p>如果成功则返回 true，否则返回 false（如果出现错误）。</p> <p><strong>注意</strong></p> <p>如果所请求数据的区间完全超出服务器上的可用数据，则该函数返回 false。 如果数据超出 TERMINAL_MAXBARS 之外（图表上的最大柱数），则该函数也会返回 false。</p> <p>当请求数据来自 EA 或脚本时，如果终端在本地没有相应的数据，则启动从服务器下载，或者如果可以从本地历史构建数据但尚未准备好，则开始构建必要的时间序列。 该函数按时间返回准备好的直至期满的数据量，然而历史记录下载将继续，并且在下一个类似请求期间，该函数会返回更多数据。</p> <p>按开始日期和所需项目数量请求数据时，仅返回日期小于（之前）或等于指定日期的数据。 设置间隔时要考虑多一秒。 换句话说，返回值的任何柱线的开盘日期（交易量、点差、开盘价、最高价、最低价、收盘价或时间）始终等于或小于指定的日期。</p> <p>当请求给定日期范围内的数据时，仅返回请求间隔内的数据。 设置间隔时要考虑多一秒。 换句话说，返回的任何柱线的开盘时间（交易量、点差、指标缓冲区值、开盘价、最高价、最低价、收盘价或时间）始终位于请求的区间内。</p> <p>例如，如果当日是一周中的星期六，则当尝试设置 start_time=Last_Tuesday 和 stop_time=Last_Friday 复制周线时间帧数据时，函数会返回 0，因为周线时间帧的开盘时间始终落在星期日，故没有一个周线柱线落在指定范围内。</p> <p>如果您需要获取对应于当前未完成柱线的数值，那么您可以采用第一种调用形式指示 start_pos=0 和 count=1。</p> <p><strong>ENUM_COPY_RATES</strong></p> <p>ENUM_COPY_RATES 枚举包含指定要传递给矩阵或数组的数据类型的标志。 标志组合允许在一个请求中从历史记录中获取多个序列。 矩阵中行的顺序将与 ENUM_COPY_RATES 枚举中值的顺序相对应。 换言之，含有最高价数据的行在矩阵中将始终高于含有最低价数据的行。</p> <table border="1"><tr><th>ID</th> <th>值</th> <th>说明</th></tr> <tr><td>COPY_RATES_OPEN</td> <td>1</td> <td>开盘价序列</td></tr> <tr><td>COPY_RATES_HIGH</td> <td>2</td> <td>最高价序列</td></tr> <tr><td>COPY_RATES_LOW</td> <td>4</td> <td>最低价序列</td></tr> <tr><td>COPY_RATES_CLOSE</td> <td>8</td> <td>收盘价序列</td></tr> <tr><td>COPY_RATES_TIME</td> <td>16</td> <td>时间序列（柱线开盘时间）</td></tr> <tr><td>COPY_RATES_VOLUME_TICK</td> <td>32</td> <td>跳价的成交量</td></tr> <tr><td>COPY_RATES_VOLUME_REAL</td> <td>64</td> <td>交易成交量</td></tr> <tr><td>COPY_RATES_SPREAD</td> <td>128</td> <td>点差</td></tr> <tr><th>组合</th></tr> <tr><td>COPY_RATES_OHLC</td> <td>15</td> <td>开盘价、最高价、最低价、和收盘价序列</td></tr> <tr><td>COPY_RATES_OHLCT</td> <td>31</td> <td>开盘价、最高价、最低价、收盘价、和时间序列</td></tr> <tr><th>数据排列</th></tr> <tr><td>COPY_RATES_VERTICAL</td> <td>32768</td> <td>序列沿垂直轴复制到矩阵中。接收到的序列值将在矩阵中垂直排列，即最早的数据将位于第一行，而最新的数据将位于矩阵的最后一行。</td></tr></table> <p><strong>示例:</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 脚本程序 start 函数                                                |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 <span class="token punctuation">{</span>
<span class="token comment">//--- 获取报价至矩阵</span>
  matrix matrix_rates<span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>matrix_rates<span class="token punctuation">.</span><span class="token function">CopyRates</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> PERIOD_CURRENT<span class="token punctuation">,</span> COPY_RATES_OHLCT<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix rates: \n&quot;</span><span class="token punctuation">,</span> matrix_rates<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">else</span>
    <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_rates.CopyRates failed. Error &quot;</span><span class="token punctuation">,</span> <span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 检查</span>
  MqlRates mql_rates<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">CopyRates</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> PERIOD_CURRENT<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> mql_rates<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
    <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;mql_rates array:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">ArrayPrint</span><span class="token punctuation">(</span>mql_rates<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
  <span class="token keyword">else</span>
    <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;CopyRates(Symbol(), PERIOD_CURRENT,1, 10, mql_rates). Error &quot;</span><span class="token punctuation">,</span> <span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 获取报价至向量 = 无效调用</span>
  vector vector_rates<span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>vector_rates<span class="token punctuation">.</span><span class="token function">CopyRates</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> PERIOD_CURRENT<span class="token punctuation">,</span> COPY_RATES_OHLC<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;vector_rates COPY_RATES_OHLC: \n&quot;</span><span class="token punctuation">,</span> vector_rates<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">else</span>
    <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;vector_rates.CopyRates COPY_RATES_OHLC failed. Error &quot;</span><span class="token punctuation">,</span> <span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 获取收盘价至向量</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>vector_rates<span class="token punctuation">.</span><span class="token function">CopyRates</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> PERIOD_CURRENT<span class="token punctuation">,</span> COPY_RATES_CLOSE<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;vector_rates COPY_RATES_CLOSE: \n&quot;</span><span class="token punctuation">,</span> vector_rates<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">else</span>
    <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;vector_rates.CopyRates failed. Error &quot;</span><span class="token punctuation">,</span> <span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">/*
   matrix rates:
   [[0.99686,0.99638,0.99588,0.99441,0.99464,0.99594,0.99698,0.99758,0.99581,0.9952800000000001]
    [0.99708,0.99643,0.99591,0.9955000000000001,0.99652,0.99795,0.99865,0.99764,0.99604,0.9957]
    [0.9961100000000001,0.99491,0.99426,0.99441,0.99448,0.99494,0.9964499999999999,0.99472,0.9936,0.9922]
    [0.99641,0.99588,0.99441,0.99464,0.99594,0.99697,0.99758,0.99581,0.9952800000000001,0.99259]
    [1662436800,1662440400,1662444000,1662447600,1662451200,1662454800,1662458400,1662462000,1662465600,1662469200]]
   mql_rates array:
                    [time]  [open]  [high]   [low] [close] [tick_volume] [spread] [real_volume]
   [0] 2022.09.06 04:00:00 0.99686 0.99708 0.99611 0.99641          4463        0             0
   [1] 2022.09.06 05:00:00 0.99638 0.99643 0.99491 0.99588          4519        0             0
   [2] 2022.09.06 06:00:00 0.99588 0.99591 0.99426 0.99441          3060        0             0
   [3] 2022.09.06 07:00:00 0.99441 0.99550 0.99441 0.99464          3867        0             0
   [4] 2022.09.06 08:00:00 0.99464 0.99652 0.99448 0.99594          5280        0             0
   [5] 2022.09.06 09:00:00 0.99594 0.99795 0.99494 0.99697          7227        0             0
   [6] 2022.09.06 10:00:00 0.99698 0.99865 0.99645 0.99758         10130        0             0
   [7] 2022.09.06 11:00:00 0.99758 0.99764 0.99472 0.99581          7012        0             0
   [8] 2022.09.06 12:00:00 0.99581 0.99604 0.99360 0.99528          6166        0             0
   [9] 2022.09.06 13:00:00 0.99528 0.99570 0.99220 0.99259          6950        0             0
   vector_rates.CopyRates COPY_RATES_OHLC failed. Error 4003
   vector_rates COPY_RATES_CLOSE:
   [0.9931,0.99293,0.99417,0.99504,0.9968399999999999,0.99641,0.99588,0.99441,0.99464,0.99594,0.99697,0.99758,0.99581,0.9952800000000001,0.99259]
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br></div></div><p>参见</p> <p>访问时间序列和指标，CopyRates</p> <h3 id="_7-2-4-copyticks"><a href="#_7-2-4-copyticks" class="header-anchor">#</a> 7.2.4  CopyTicks</h3> <p>从 MqlTick 结构获取跳价数据并存储到矩阵或向量当中。元素顺序从过去到现在计数，这意味着索引为 0 的刻度是最久远的。 若要分析跳价，检查 flags 字段，其显示跳价中的确切变化。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  matrix<span class="token double-colon punctuation">::</span><span class="token function">CopyTicks</span><span class="token punctuation">(</span>
   string           symbol<span class="token punctuation">,</span>                <span class="token comment">// 品名</span>
   ulong            flags<span class="token punctuation">,</span>                 <span class="token comment">// 指示欲接收跳价类型的标志</span>
   ulong            from_msc<span class="token punctuation">,</span>              <span class="token comment">// 欲请求跳价的起始时间</span>
   ulong            count                  <span class="token comment">// 欲接收跳价的数量</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>向量方法</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  vector<span class="token double-colon punctuation">::</span><span class="token function">CopyTicks</span><span class="token punctuation">(</span>
   string           symbol<span class="token punctuation">,</span>                <span class="token comment">// 品名</span>
   ulong            flags<span class="token punctuation">,</span>                 <span class="token comment">// 指示欲接收跳价类型的标志</span>
   ulong            from_msc<span class="token punctuation">,</span>              <span class="token comment">// 欲请求跳价的起始时间</span>
   ulong            count                  <span class="token comment">// 欲接收跳价的数量</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>参数</strong></p> <p>symbol</p> <p>[输入]  品种。</p> <p>flags</p> <p>[输入] ENUM_COPY_TICKS 枚举中的标志组合，指示所请求数据的内容。当复制到向量时，只能从 ENUM_COPY_TICKS 枚举中指定一个值，否则会发生错误。</p> <p>from_msc</p> <p>[输入]  请求跳价的开始时间。 自 1970 年 01 月 01 日起，时间以毫秒为单位指定。 如果 from_msc=0，则返回等于 'count' 的最后跳价数字。</p> <p>count</p> <p>[输入]  所请求跳价的数量。 如果参数 'from_msc' 和 'count' 未指定，则将写入所有可用的跳价，但不超过 2000。</p> <p><strong>返回值</strong></p> <p>成功时返回 true，如果发生错误则 false。</p> <p><strong>注意</strong></p> <p>首次调用 CopyTicks() 会启动硬盘驱动器上存储的相关品种跳价数据库的同步。 如果本地数据库没有提供全部请求的跳价，则缺失的跳价将自动从交易服务器下载。 跳价的同步自 CopyTicks() 中指定的 from_msc 到当前时刻。 之后，该品种所有到达的跳价都将添加到跳价数据库之中，从而使其保持同步状态。</p> <p>如果 from_msc 和 count 参数未指定，则把全部可用跳价，但不超过 2000 个，写入矩阵/向量之中。</p> <p>在指标中，CopyTicks() 方法立即返回结果：当从指标调用时，CopyTick() 会立即返回品种的所有可用跳价，如果可用数据不足，则启动跳价数据库的同步。 同一品种上的所有指标都在一个公用线程中运行，因此指标不能等待同步完成。 同步后，CopyTicks() 将在下一次调用期间返回所有请求的跳价。 在指标中，OnCalculate() 函数在每次跳价到达后调用。</p> <p>在智能系统和脚本中，CopyTicks() 可以等待结果 45 秒：与指标不同，每个智能系统或脚本都在单独的线程中运行，因此为完成同步最多可以等待 45 秒。 如果在此期间无法同步所需数量的跳价，CopyTicks() 将在超时后返回可用的跳价，并继续同步。 智能系统里的 OnTick() 并非每次跳价都会处理，它只通知智能系统行情有所变化。 这可能是一批变化：终端可以同时接收多次跳价，而 OnTick() 只会调用一次，通知智能系统最新的行情状态。</p> <p>数据返回率：终端在高速访问缓存中为每个金融产品存储了 4096 个最后的跳价（市场深度为运营品种存储 65536 个跳价）。 有关此数据的请求执行速度最快。 如果当前交易时段请求的跳价超出缓存，CopyTicks() 将调用存储在终端内存中的跳价。 这些请求需要更多时间才能完成。 最慢的请并非那些请求其它日期的跳价，因为在这种情况下，数据是从驱动器读取的。</p> <p><strong>ENUM_COPY_TICKS</strong></p> <p>ENUM_COPY_TICKS 枚举包含指定要传递给矩阵或数组的数据类型的标志。 标志组合允许在一个请求中从历史记录中获取多个序列。 矩阵中行的顺序将与 ENUM_COPY_TICKS 枚举中数值的顺序相对应。 换言之，含有最高价数据的行在矩阵中将始终高于含有最低价数据的行。</p> <table border="1"><tr><th>ID</th> <th>值</th> <th>说明</th></tr> <tr><td>COPY_TICKS_INFO</td> <td>1</td> <td>包含卖价（Bid）和/或买价（Ask）价格变化的报价</td></tr> <tr><td>COPY_TICKS_TRADE</td> <td>2</td> <td>包含最后价（Last）和/或交易量（Volume）价格变化的报价</td></tr> <tr><td>COPY_TICKS_ALL</td> <td>3</td> <td>所有报价</td></tr> <tr><td>COPY_TICKS_TIME_MS</td> <td>1&lt;&lt;8</td> <td>跳价时间（以毫秒为单位）</td></tr> <tr><td>COPY_TICKS_BID</td> <td>1&lt;&lt;9</td> <td>出价（Bid）</td></tr> <tr><td>COPY_TICKS_ASK</td> <td>1&lt;&lt;10</td> <td>要价（Ask）</td></tr> <tr><td>COPY_TICKS_LAST</td> <td>1&lt;&lt;11</td> <td>最后价（最后成交价）</td></tr> <tr><td>COPY_TICKS_VOLUME</td> <td>1&lt;&lt;12</td> <td>最后价交易量</td></tr> <tr><td>COPY_TICKS_FLAGS</td> <td>1&lt;&lt;13</td> <td>跳价标志</td></tr> <tr><th>数据排列</th></tr> <tr><td>COPY_TICKS_VERTICAL</td> <td>32768</td> <td>报价沿垂直轴复制到矩阵中。接收到的报价将在矩阵中垂直排列，即最早的报价将位于第一行，而最新的报价将位于矩阵的最后一行。<br>
使用默认复制时，报价会沿水平轴添加到矩阵中。<br>
该标识仅在复制到矩阵时适用。</td></tr></table> <p>分析跳价标志以便找出哪些数据已变化：</p> <ul><li>TICK_FLAG_BID ― 跳价改变了出价</li> <li>TICK_FLAG_ASK ― 跳价改变了要价</li> <li>TICK_FLAG_LAST ― 跳价改变了最后成交价</li> <li>TICK_FLAG_VOLUME ― 跳价改变了交易量</li> <li>TICK_FLAG_BUY ― 跳价是买入成交的结果</li> <li>TICK_FLAG_SELL ― 跳价是卖出成交的结果</li></ul> <p><strong>参见</strong></p> <p>访问时间序列和指标，CopyTicks</p> <h3 id="_7-2-5-copyticksrange"><a href="#_7-2-5-copyticksrange" class="header-anchor">#</a> 7.2.5  CopyTicksRange</h3> <p>按指定日期范围，获取 MqlTick 结构的跳价，并存储到矩阵或向量之中。 元素顺序从过去到现在计数，这意味着索引为 0 的跳价是最久远的。 若要分析跳价，检查 flags 字段，其显示跳价中的确切变化。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  matrix<span class="token double-colon punctuation">::</span><span class="token function">CopyTicksRange</span><span class="token punctuation">(</span>
   string           symbol<span class="token punctuation">,</span>                <span class="token comment">// 品名</span>
   ulong            flags<span class="token punctuation">,</span>                 <span class="token comment">// 指示欲接收跳价类型的标志</span>
   ulong            from_msc<span class="token punctuation">,</span>              <span class="token comment">// 欲请求跳价的起始时间</span>
   ulong            to_msc                 <span class="token comment">// 欲请求跳价的截止时间</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>向量方法</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  vector<span class="token double-colon punctuation">::</span><span class="token function">CopyTicksRange</span><span class="token punctuation">(</span>
   string           symbol<span class="token punctuation">,</span>                <span class="token comment">// 品名</span>
   ulong            flags<span class="token punctuation">,</span>                 <span class="token comment">// 指示欲接收跳价类型的标志</span>
   ulong            from_msc<span class="token punctuation">,</span>              <span class="token comment">// 欲请求跳价的起始时间</span>
   ulong            to_msc                 <span class="token comment">// 欲请求跳价的截止时间</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>参数</strong></p> <p>symbol</p> <p>[输入]  品种。</p> <p>flags</p> <p>[输入] ENUM_COPY_TICKS 枚举中的标志组合，指示所请求数据的内容。当复制到向量时，只能从 ENUM_COPY_TICKS 枚举中指定一个值，否则会发生错误。</p> <p>from_msc</p> <p>[输入]  请求跳价的开始时间。 自 1970 年 01 月 01 日起，时间以毫秒为单位指定。 如果未指定 “from_msc” 参数，则跳价从头开始返回历史记录。 即返回时间 &gt;= from_msc 的跳价。</p> <p>to_msc</p> <p>[输入]  请求截止的跳价时间。 自 1970 年 01 月 01 日起，时间以毫秒为单位指定。 返回时间 &lt;= to_msc 的跳价。 如果未指定 to_msc 参数，则返回截至历史记录结束之前的所有跳价。</p> <p><strong>返回值</strong></p> <p>成功时返回 true，如果发生错误则返回 false。 GetLastError() 能返回以下错误:</p> <ul><li>ERR_HISTORY_TIMEOUT ― 跳价同步的超时已过期，函数返回它已拥有的一切。</li> <li>ERR_HISTORY_SMALL_BUFFER ― 静态缓存区太小。 仅返回数组可以存储的数量。</li> <li>ERR_NOT_ENOUGH_MEMORY ― 内存不足，无法将指定范围的历史数据接收到动态跳价数组之中。为跳价数组分配足够内存失败。</li></ul> <p>分析跳价标志以便找出哪些数据已变化：</p> <ul><li>TICK_FLAG_BID ― 跳价改变了出价</li> <li>TICK_FLAG_ASK ― 跳价改变了要价</li> <li>TICK_FLAG_LAST ― 跳价改变了最后成交价</li> <li>TICK_FLAG_VOLUME ― 跳价改变了交易量</li> <li>TICK_FLAG_BUY ― 跳价是买入成交的结果</li> <li>TICK_FLAG_SELL ― 跳价是卖出成交的结果</li></ul> <p><strong>注意</strong></p> <p>CopyTicksRange() 方法请求的跳价精确到指定范围。 例如，历史记录中指定日期的跳价。 CopyTicks() 只允许指定开始日期，例如，接收从月初到现在的所有跳价。</p> <p><strong>参见</strong></p> <p>访问时间序列和指标，CopyTicksRange</p> <h3 id="_7-2-6-eye"><a href="#_7-2-6-eye" class="header-anchor">#</a> 7.2.6  Eye</h3> <p>统计函数。 构造具有指定大小的矩阵，主对角线上为 1，其它之处则为 0。 返回一个矩阵，对角线上为 1，其它之处为零。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">static</span> matrix matrix<span class="token double-colon punctuation">::</span><span class="token function">Eye</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> ulong  rows<span class="token punctuation">,</span>        <span class="token comment">// 行数</span>
  <span class="token keyword">const</span> ulong  cols<span class="token punctuation">,</span>        <span class="token comment">// 列数</span>
  <span class="token keyword">const</span> <span class="token keyword">int</span>    ndiag<span class="token operator">=</span><span class="token number">0</span>      <span class="token comment">// 对角线索引</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>参数</strong></p> <p>rows</p> <p>[输入]  输出中的行数。</p> <p>cols</p> <p>[输入]  输出中的列数。</p> <p>ndiag=0</p> <p>[输入]  对角线索引：0（默认值）表示主对角线，正值表示上对角线，负值表示下对角线。</p> <p><strong>返回值</strong></p> <p>所有元素都等于零的矩阵，但第 k 对角线除外，其值等于 1。</p> <p><strong>MQL5 示例:</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>  matrix eye<span class="token operator">=</span>matrix<span class="token double-colon punctuation">::</span><span class="token function">Eye</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;eye = \n&quot;</span><span class="token punctuation">,</span> eye<span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  eye<span class="token operator">=</span>matrix<span class="token double-colon punctuation">::</span><span class="token function">Eye</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;eye = \n&quot;</span><span class="token punctuation">,</span> eye<span class="token punctuation">)</span><span class="token punctuation">;</span>  
  <span class="token comment">/*
   eye = 
   [[1,0,0]
    [0,1,0]
    [0,0,1]]
   eye = 
   [[0,1,0,0]
    [0,0,1,0]
    [0,0,0,1]
    [0,0,0,0]]   
  */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p><strong>Python 示例:</strong></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>np<span class="token punctuation">.</span>eye<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">)</span>
array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
 
np<span class="token punctuation">.</span>eye<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.</span><span class="token punctuation">,</span> <span class="token number">1.</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token number">0.</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">,</span> <span class="token number">1.</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token number">0.</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">,</span> <span class="token number">1.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token number">0.</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="_7-2-7-identity"><a href="#_7-2-7-identity" class="header-anchor">#</a> 7.2.7  Identity</h3> <p>它是一个静态函数，可创建指定大小（不一定是正方形）的单位矩阵。 一个单位矩阵在主对角线上包含 0，在其它所在包含零。 主对角线由行索引和列索引相等的矩阵元素组成，譬如 [0,0]、[1,1]、[2,2]，等等。 创建一个新的单位矩阵。</p> <p>还有一个 Identity 方法能将已经存在的矩阵转换为单位矩阵。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">static</span> matrix matrix<span class="token double-colon punctuation">::</span><span class="token function">Identity</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> ulong  rows<span class="token punctuation">,</span>        <span class="token comment">// 行数</span>
  <span class="token keyword">const</span> ulong  cols<span class="token punctuation">,</span>        <span class="token comment">// 列数</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">void</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Identity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>参数</strong></p> <p>rows</p> <p>[输入]  n x n 矩阵中的行数（和列数）。</p> <p><strong>返回值</strong></p> <p>返回单位矩阵。 单位矩阵是一个方阵，主对角线上为 1。</p> <p><strong>MQL5 示例:</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>  matrix identity<span class="token operator">=</span>matrix<span class="token double-colon punctuation">::</span><span class="token function">Identity</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;identity = \n&quot;</span><span class="token punctuation">,</span> identity<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token comment">/* 
   identity = 
   [[1,0,0]
    [0,1,0]
    [0,0,1]]
*/</span>
  matrix <span class="token function">identity2</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  identity2<span class="token punctuation">.</span><span class="token function">Identity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;identity2 = \n&quot;</span><span class="token punctuation">,</span> identity2<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token comment">/* 
   identity2 = 
   [[1,0,0,0,0]
    [0,1,0,0,0]
    [0,0,1,0,0]]
*/</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p><strong>Python 示例:</strong></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>np<span class="token punctuation">.</span>identity<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">1.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">1.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_7-2-8-ones"><a href="#_7-2-8-ones" class="header-anchor">#</a> 7.2.8  Ones</h3> <p>这是一个静态函数，创建并返回一个新矩阵，且以 1 填充。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">static</span> matrix matrix<span class="token double-colon punctuation">::</span><span class="token function">Ones</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> ulong  rows<span class="token punctuation">,</span>     <span class="token comment">// 行数</span>
  <span class="token keyword">const</span> ulong  cols      <span class="token comment">// 列数</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">static</span> vector vector<span class="token double-colon punctuation">::</span><span class="token function">Ones</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> ulong  size<span class="token punctuation">,</span>     <span class="token comment">// 向量大小</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>参数</strong></p> <p>rows</p> <p>[输入]  行数。</p> <p>cols</p> <p>[输入]  列数。</p> <p><strong>返回值</strong></p> <p>给定行数和列数的新矩阵，且填充了 1。</p> <p><strong>MQL5 示例:</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>  matrix ones<span class="token operator">=</span>matrix<span class="token double-colon punctuation">::</span><span class="token function">Ones</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;ones = \n&quot;</span><span class="token punctuation">,</span> ones<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
ones = 
   [[1,1,1,1]
    [1,1,1,1]
    [1,1,1,1]
    [1,1,1,1]]
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>Python 示例:</strong></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>np<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token number">1.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_7-2-9-zeros"><a href="#_7-2-9-zeros" class="header-anchor">#</a> 7.2.9  Zeros</h3> <p>这是一个静态函数，创建并返回一个填充零值的新矩阵。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">static</span> matrix matrix<span class="token double-colon punctuation">::</span><span class="token function">Zeros</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> ulong  rows<span class="token punctuation">,</span>     <span class="token comment">// 行数</span>
  <span class="token keyword">const</span> ulong  cols      <span class="token comment">// 列数</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">static</span> vector vector<span class="token double-colon punctuation">::</span><span class="token function">Zeros</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> ulong  size<span class="token punctuation">,</span>     <span class="token comment">// 向量大小</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>参数</strong></p> <p>rows</p> <p>[输入]  行数。</p> <p>cols</p> <p>[输入]  列数。</p> <p><strong>返回值</strong></p> <p>给定行数和列数的新矩阵，并以零填充。</p> <p><strong>MQL5 示例:</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>  matrix zeros<span class="token operator">=</span>matrix<span class="token double-colon punctuation">::</span><span class="token function">Zeros</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;zeros = \n&quot;</span><span class="token punctuation">,</span> zeros<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
zeros = 
   [[0,0,0,0]
    [0,0,0,0]
    [0,0,0,0]]
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>Python 示例:</strong></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span> <span class="token number">0.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_7-2-10-full"><a href="#_7-2-10-full" class="header-anchor">#</a> 7.2.10  Full</h3> <p>静态函数创建并返回一个新矩阵，并按给定值填充。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">static</span> matrix matrix<span class="token double-colon punctuation">::</span><span class="token function">Full</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> ulong   rows<span class="token punctuation">,</span>      <span class="token comment">// number or rows</span>
  <span class="token keyword">const</span> ulong   cols<span class="token punctuation">,</span>      <span class="token comment">// number of columns</span>
  <span class="token keyword">const</span> <span class="token keyword">double</span>  value      <span class="token comment">// 填充值</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">static</span> vector vector<span class="token double-colon punctuation">::</span><span class="token function">Full</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> ulong   size<span class="token punctuation">,</span>      <span class="token comment">// vector size</span>
  <span class="token keyword">const</span> <span class="token keyword">double</span>  value      <span class="token comment">// 填充值</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>参数</strong></p> <p>rows</p> <p>[输入]  行数。</p> <p>cols</p> <p>[输入]  列数。</p> <p>value</p> <p>[输入]  填充所有矩阵元素的数值。</p> <p><strong>返回值</strong></p> <p>返回给定行和列的新矩阵，并用指定值填充。</p> <p><strong>MQL5 示例:</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>  matrix full<span class="token operator">=</span>matrix<span class="token double-colon punctuation">::</span><span class="token function">Full</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;full = \n&quot;</span><span class="token punctuation">,</span> full<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
full = 
   [[10,10,10,10]
    [10,10,10,10]
    [10,10,10,10]]
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>np<span class="token punctuation">.</span><span class="token function">full</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
<span class="token function">array</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_7-2-11-tri"><a href="#_7-2-11-tri" class="header-anchor">#</a> 7.2.11  Tri</h3> <p>这是一个构造矩阵的静态函数，其中给定对角线为 1，，且其它地方为 0。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">static</span> matrix matrix<span class="token double-colon punctuation">::</span><span class="token function">Tri</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> ulong rows<span class="token punctuation">,</span>        <span class="token comment">// 行数</span>
  <span class="token keyword">const</span> ulong cols<span class="token punctuation">,</span>        <span class="token comment">// 列数</span>
  <span class="token keyword">const</span> <span class="token keyword">int</span>   ndiag<span class="token operator">=</span><span class="token number">0</span>      <span class="token comment">// 对角线数</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>参数</strong></p> <p>rows</p> <p>[输入]  数组中的行数。</p> <p>cols</p> <p>[输入]  数组中的列数。</p> <p>ndiag=0</p> <p>[输入]  子对角线及其下方数组被填充。 k = 0 是主对角线，而 k &lt; 0 在其下方，k &gt; 0 在上方。 默认填充值为 0。</p> <p><strong>返回值</strong></p> <p>数组，其下三角以 1 填充，在其它所在则填充 0。</p> <p><strong>MQL5 示例:</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrix matrix_a<span class="token operator">=</span>matrix<span class="token double-colon punctuation">::</span><span class="token function">Tri</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Tri(3,4,1)\n&quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix_a<span class="token operator">=</span>matrix<span class="token double-colon punctuation">::</span><span class="token function">Tri</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Tri(4,3,-1)\n&quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">/*
   Tri(3,4,1)
   [[1,1,0,0]
    [1,1,1,0]
    [1,1,1,1]]
   Tri(4,3,-1)
   [[0,0,0]
    [1,0,0]
    [1,1,0]
    [1,1,1]]
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p><strong>举例</strong></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>
np<span class="token punctuation">.</span>tri<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">)</span>
array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_7-2-12-init"><a href="#_7-2-12-init" class="header-anchor">#</a> 7.2.12  Init</h3> <p>初始化矩阵或向量。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">void</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Init</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> ulong  rows<span class="token punctuation">,</span>            <span class="token comment">// 行数</span>
  <span class="token keyword">const</span> ulong  cols<span class="token punctuation">,</span>            <span class="token comment">// 列数</span>
  func_name    init_func<span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">,</span>  <span class="token comment">// 置于类的某个作用域或静态方法中的 init 函数</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>         parameters
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">void</span> vector<span class="token double-colon punctuation">::</span><span class="token function">Init</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> ulong  size<span class="token punctuation">,</span>            <span class="token comment">// 向量大小</span>
  func_name    init_func<span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">,</span>  <span class="token comment">// 置于类的某个作用域或静态方法中的 init 函数</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>         parameters
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>参数</strong></p> <p>rows</p> <p>[输入]  行数。</p> <p>cols</p> <p>[输入]  列数。</p> <p>func_name</p> <p>[输入] 初始化函数。</p> <p>...</p> <p>[输入] 初始化函数的参数。</p> <p><strong>返回值</strong></p> <p>无返回值。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token function">MatrixArange</span><span class="token punctuation">(</span>matrix<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token operator">&amp;</span>mat<span class="token punctuation">,</span>T value<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">,</span>T step<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>ulong i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>mat<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span>ulong j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span>mat<span class="token punctuation">.</span><span class="token function">Cols</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">,</span>value<span class="token operator">+=</span>step<span class="token punctuation">)</span>
         mat<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>value<span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token function">VectorArange</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token operator">&amp;</span>vec<span class="token punctuation">,</span>T value<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">,</span>T step<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>ulong i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>vec<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">,</span>value<span class="token operator">+=</span>step<span class="token punctuation">)</span>
      vec<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 脚本程序 start 函数                                                |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//---</span>
  <span class="token keyword">int</span> size_m<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> size_k<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">;</span>
  matrix  <span class="token function">m</span><span class="token punctuation">(</span>size_m<span class="token punctuation">,</span>size_k<span class="token punctuation">,</span>MatrixArange<span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">2.</span><span class="token punctuation">,</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 首先创建一个大小为 size_ m x size_k 的未初始化矩阵，</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix m \n&quot;</span><span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token comment">// 然后调用初始化清单列出的带参数的 MatrixArange 函数</span>
  matrixf <span class="token function">m_float</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span>MatrixArange<span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">2.f</span><span class="token punctuation">,</span><span class="token number">0.1f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 创建浮点型矩阵后，调用 MatrixArange 函数</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix m_float \n&quot;</span><span class="token punctuation">,</span>m_float<span class="token punctuation">)</span><span class="token punctuation">;</span>
  vector  <span class="token function">v</span><span class="token punctuation">(</span>size_k<span class="token punctuation">,</span>VectorArange<span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">10.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// 创建一个向量后，会调用带有一个参数的 VectorArange；其第二个参数采用默认值</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;vector v \n&quot;</span><span class="token punctuation">,</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>  
  <span class="token comment">/*
   matrix m 
   [[-2,-1.9,-1.8,-1.7]
    [-1.6,-1.5,-1.399999999999999,-1.299999999999999]
    [-1.199999999999999,-1.099999999999999,-0.9999999999999992,-0.8999999999999992]]
   matrix m_float 
   [[-2,-1.9,-1.8,-1.6999999,-1.5999999]
    [-1.4999999,-1.3999999,-1.2999998,-1.1999998,-1.0999998]
    [-0.99999976,-0.89999974,-0.79999971,-0.69999969,-0.59999967]
    [-0.49999967,-0.39999968,-0.29999968,-0.19999969,-0.099999689]
    [3.1292439e-07,0.10000031,0.20000032,0.30000031,0.4000003]]
   vector v 
   [-10,-9,-8,-7]
  */</span> 
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><h3 id="_7-2-13-fill"><a href="#_7-2-13-fill" class="header-anchor">#</a> 7.2.13  Fill</h3> <p>用指定的数值填充存在的矩阵或向量。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">void</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Fill</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token keyword">double</span>  value      <span class="token comment">// 填充值</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">void</span> vector<span class="token double-colon punctuation">::</span><span class="token function">Fill</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token keyword">double</span>  value      <span class="token comment">// 填充值</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>参数</strong></p> <p>value</p> <p>[输入]  填充所有矩阵元素的数值。</p> <p><strong>返回值</strong></p> <p>无返回值。 矩阵将用指定的值填充。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrix <span class="token function">matrix_a</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix_a<span class="token punctuation">.</span><span class="token function">Fill</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_a\n&quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">/*
  matrix_a
  [[10,10]
   [10,10]]
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="_7-3-矩阵和向量操纵"><a href="#_7-3-矩阵和向量操纵" class="header-anchor">#</a> 7.3  矩阵和向量操纵</h2> <p>这些是基本矩阵操作的方法：填充、复制、获取矩阵的一部分、转置、拆分和排序。</p> <p>还有若干种方法可针对矩阵的行和列进行操纵。</p> <table><thead><tr><th>函数</th> <th>动作</th></tr></thead> <tbody><tr><td>HasNan</td> <td>返回矩阵/向量中NaN值的数量</td></tr> <tr><td>Transpose</td> <td>反转或置换矩阵的轴；返回修改后的矩阵</td></tr> <tr><td>TriL</td> <td>返回矩阵的副本，其中第 k 个对角线以上的元素归零。 下三角矩阵</td></tr> <tr><td>TriU</td> <td>返回矩阵的副本，其中第 k 对角线以下的元素归零。 上三角矩阵</td></tr> <tr><td>Diag</td> <td>提取对角线或构造对角矩阵</td></tr> <tr><td>Row</td> <td>返回行向量。 写入向量指定行</td></tr> <tr><td>Col</td> <td>返回列向量。 写入向量指定列。</td></tr> <tr><td>Copy</td> <td>返回给定矩阵/向量的副本</td></tr> <tr><td>Compare</td> <td>以指定的精度比较两个矩阵/向量的元素</td></tr> <tr><td>CompareByDigits</td> <td>比较两个矩阵/向量的元素，直至有效位数</td></tr> <tr><td>Flat</td> <td>允许依据一个索引替代两个索引定位矩阵元素</td></tr> <tr><td>Clip</td> <td>将矩阵/向量的元素限制为指定范围内的有效值</td></tr> <tr><td>Reshape</td> <td>在不更改矩阵数据的情况下更改矩阵的形状</td></tr> <tr><td>Resize</td> <td>返回形状和大小均已更改的新矩阵</td></tr> <tr><td>SwapRows</td> <td>交换矩阵中的行</td></tr> <tr><td>SwapCols</td> <td>交换矩阵中的列</td></tr> <tr><td>Split</td> <td>将矩阵拆分为多个子矩阵</td></tr> <tr><td>Hsplit</td> <td>将矩阵水平拆分为多个子矩阵。 与 轴=0 的 Split 相同</td></tr> <tr><td>Vsplit</td> <td>将矩阵垂直拆分为多个子矩阵。 与 axis=1 的拆分相同</td></tr> <tr><td>ArgSort</td> <td>间接针对矩阵或向量进行排序。</td></tr> <tr><td>Sort</td> <td>就地针对矩阵或向量进行排序。</td></tr></tbody></table> <h3 id="_7-3-1-hasnan"><a href="#_7-3-1-hasnan" class="header-anchor">#</a> 7.3.1  HasNan</h3> <p>返回矩阵/向量中NaN值的数量。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>ulong vector<span class="token double-colon punctuation">::</span><span class="token function">HasNan</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
ulong matrix<span class="token double-colon punctuation">::</span><span class="token function">HasNan</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>返回值</strong></p> <p>包含NaN值的矩阵/向量元素数。</p> <p><strong>注意</strong></p> <p>当比较具有NaN值的相应元素对时，Compare和CompareByDigits方法认为这些元素相等，而在通常比较浮点数NaN != NaN的情况下。</p> <p><strong>例如：</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   <span class="token keyword">double</span> x<span class="token operator">=</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;single: &quot;</span><span class="token punctuation">,</span>x<span class="token operator">==</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   vector<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span> v1<span class="token operator">=</span><span class="token punctuation">{</span>x<span class="token punctuation">}</span><span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span> v2<span class="token operator">=</span><span class="token punctuation">{</span>x<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;vector: &quot;</span><span class="token punctuation">,</span> v1<span class="token punctuation">.</span><span class="token function">Compare</span><span class="token punctuation">(</span>v2<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
 
<span class="token comment">/* Result:
 
 single: false
 vector: true
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>另见</p> <p>MathClassify，Compare， CompareByDigits</p> <h3 id="_7-3-2-transpose"><a href="#_7-3-2-transpose" class="header-anchor">#</a> 7.3.2  Transpose</h3> <p>矩阵转置。 反转或排列矩阵的轴；返回修改后的矩阵。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>matrix matrix<span class="token double-colon punctuation">::</span><span class="token function">Transpose</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>返回值</strong></p> <p>转置后的矩阵。</p> <p><strong>以 MQL5 实现的简单矩阵转置算法：</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>matrix <span class="token function">MatrixTranspose</span><span class="token punctuation">(</span><span class="token keyword">const</span> matrix<span class="token operator">&amp;</span> matrix_a<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   matrix <span class="token function">matrix_c</span><span class="token punctuation">(</span>matrix_a<span class="token punctuation">.</span><span class="token function">Cols</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token keyword">for</span><span class="token punctuation">(</span>ulong i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>matrix_c<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span>ulong j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span>matrix_c<span class="token punctuation">.</span><span class="token function">Cols</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
         matrix_c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>matrix_a<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
 
   <span class="token keyword">return</span><span class="token punctuation">(</span>matrix_c<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>MQL5 示例:</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>  matrix a<span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix a \n&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;a.Transpose() \n&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span><span class="token function">Transpose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">/*
  matrix a
  [[0,1,2]
   [3,4,5]]
  a.Transpose()
  [[0,3]
   [1,4]
   [2,5]]
  */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><strong>Python 示例:</strong></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
 
a <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;a \n&quot;</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;np.transpose(a) \n&quot;</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>transpose<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>
 
a 
 <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">1</span> <span class="token number">2</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
np<span class="token punctuation">.</span>transpose<span class="token punctuation">(</span>a<span class="token punctuation">)</span> 
 <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">3</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">1</span> <span class="token number">4</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">2</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="_7-3-3-tril"><a href="#_7-3-3-tril" class="header-anchor">#</a> 7.3.3  TriL</h3> <p>返回矩阵的副本，其中第 k 个对角线以上的元素归零。 下三角矩阵。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>matrix matrix<span class="token double-colon punctuation">::</span><span class="token function">Tril</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token keyword">int</span>     ndiag<span class="token operator">=</span><span class="token number">0</span>      <span class="token comment">// 对角线的索引</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>参数</strong></p> <p>ndiag=0</p> <p>[输入]  对角线，高于该对角线的元素为零。 ndiag = 0（默认值）是主对角线，ndiag &lt; 0 在其下方，ndiag &gt; 0 位于其上方。</p> <p><strong>返回值</strong></p> <p>数组，其下三角以 1 填充，在其它所在则填充 0。</p> <p><strong>MQL5 示例:</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrix a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   matrix b<span class="token operator">=</span>a<span class="token punctuation">.</span><span class="token function">TriL</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix b \n&quot;</span><span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">/*
  matrix_c
  [[0,0,0]
  [4,0,0]
  [7,8,0]
  [10,11,12]]
  */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>Python 示例:</strong></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
 
a<span class="token operator">=</span>np<span class="token punctuation">.</span>tril<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
 
<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">4</span>  <span class="token number">0</span>  <span class="token number">0</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">7</span>  <span class="token number">8</span>  <span class="token number">0</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">10</span> <span class="token number">11</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_7-3-4-triu"><a href="#_7-3-4-triu" class="header-anchor">#</a> 7.3.4  TriU</h3> <p>返回矩阵的副本，其中第 k 个对角线下方的元素归零。 上三角形矩阵。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>matrix matrix<span class="token double-colon punctuation">::</span><span class="token function">Triu</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token keyword">int</span>     ndiag<span class="token operator">=</span><span class="token number">0</span>      <span class="token comment">// 对角线的索引</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>参数</strong></p> <p>ndiag=0</p> <p>[输入]  对角线之下的元素为零。 ndiag = 0（默认值）是主对角线，ndiag &lt; 0 在其下方，ndiag &gt; 0 位于其上方。</p> <p><strong>MQL5 示例:</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrix a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   matrix b<span class="token operator">=</span>a<span class="token punctuation">.</span><span class="token function">TriU</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix b \n&quot;</span><span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">/*
  matrix b
  [[1,2,3]
   [4,5,6]
   [0,8,9]
   [0,0,12]]
  */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>Python 示例:</strong></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
 
a<span class="token operator">=</span>np<span class="token punctuation">.</span>triu<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
 
<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">1</span>  <span class="token number">2</span>  <span class="token number">3</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">4</span>  <span class="token number">5</span>  <span class="token number">6</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">0</span>  <span class="token number">8</span>  <span class="token number">9</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">0</span>  <span class="token number">0</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="_7-3-5-diag"><a href="#_7-3-5-diag" class="header-anchor">#</a> 7.3.5  Diag</h3> <p>提取对角或构造对角矩阵。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>vector matrix<span class="token double-colon punctuation">::</span><span class="token function">Diag</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token keyword">int</span>     ndiag<span class="token operator">=</span><span class="token number">0</span>      <span class="token comment">// 对角线数</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">void</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Diag</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> vector  v<span class="token punctuation">,</span>           <span class="token comment">// 对角线向量</span>
  <span class="token keyword">const</span> <span class="token keyword">int</span>     ndiag<span class="token operator">=</span><span class="token number">0</span>      <span class="token comment">// 对角线数</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>参数</strong></p> <p>v</p> <p>[输入] 一个向量，其元素将包含在相应的对角线中（ndiag=0 是主对角线）。</p> <p>ndiag=0</p> <p>[输入]  问题中的对角。 默认填充值为 0。 对于主对角线上方的对角线使用 ndiag&gt;0，对于主对角线下方的对角线使用 ndiag&lt;0。</p> <p><strong>注意</strong></p> <p>未分配的矩阵（没有维度）亦可设置对角线。 在这种情况下，将创建一个大小为零矩阵，其大小对应于对角向量的大小，之后向量值将填充到相应的对角线中。 如果为已存在的矩阵设置对角线，则矩阵尺寸不会更改，且对角线向量外的矩阵元素值也不会更改。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   vector v1<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   matrix m1<span class="token punctuation">;</span>
   m1<span class="token punctuation">.</span><span class="token function">Diag</span><span class="token punctuation">(</span>v1<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;m1\n&quot;</span><span class="token punctuation">,</span>m1<span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix m2<span class="token punctuation">;</span>
   m2<span class="token punctuation">.</span><span class="token function">Diag</span><span class="token punctuation">(</span>v1<span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;m2\n&quot;</span><span class="token punctuation">,</span>m2<span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix m3<span class="token punctuation">;</span>
   m3<span class="token punctuation">.</span><span class="token function">Diag</span><span class="token punctuation">(</span>v1<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;m3\n&quot;</span><span class="token punctuation">,</span>m3<span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix m4<span class="token operator">=</span>matrix<span class="token double-colon punctuation">::</span><span class="token function">Full</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   m4<span class="token punctuation">.</span><span class="token function">Diag</span><span class="token punctuation">(</span>v1<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;m4\n&quot;</span><span class="token punctuation">,</span>m4<span class="token punctuation">)</span><span class="token punctuation">;</span>
   
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;diag -1 - &quot;</span><span class="token punctuation">,</span>m4<span class="token punctuation">.</span><span class="token function">Diag</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;diag 0 - &quot;</span><span class="token punctuation">,</span>m4<span class="token punctuation">.</span><span class="token function">Diag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;diag 1 - &quot;</span><span class="token punctuation">,</span>m4<span class="token punctuation">.</span><span class="token function">Diag</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">/*
 
  m1
  [[1,0,0]
  [0,2,0]
  [0,0,3]]
  m2
  [[0,0,0]
  [1,0,0]
  [0,2,0]
  [0,0,3]]
  m3
  [[0,1,0,0]
  [0,0,2,0]
  [0,0,0,3]]
  m4
  [[9,1,9,9,9]
  [9,9,2,9,9]
  [9,9,9,3,9]
  [9,9,9,9,9]]
  diag -1 - [9,9,9]
  diag 0 - [9,9,9,9]
  diag 1 - [1,2,3,9]
  */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><h3 id="_7-3-6-row"><a href="#_7-3-6-row" class="header-anchor">#</a> 7.3.6  Row</h3> <p>返回行向量。 写入向量指定行</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>vector matrix<span class="token double-colon punctuation">::</span><span class="token function">Row</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> ulong   nrow      <span class="token comment">// 行号</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">void</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Row</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> vector  v<span class="token punctuation">,</span>        <span class="token comment">// 行向量</span>
  <span class="token keyword">const</span> ulong   nrow      <span class="token comment">// 行号</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>参数</strong></p> <p>nrow</p> <p>[输入]  行号。</p> <p><strong>返回值</strong></p> <p>向量。</p> <p><strong>注意</strong></p> <p>可以为未分配的矩阵（没有维度）设置行。 在这种情况下，将创建一个零矩阵，其大小为向量大小 x 行数+1，之后向量元素的值将填充在相应的行中。 如果为已存在的矩阵设置行，则矩阵维度不会更改，行向量之外的矩阵元素的值也不会更改。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   vector v1<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   matrix m1<span class="token punctuation">;</span>
   m1<span class="token punctuation">.</span><span class="token function">Row</span><span class="token punctuation">(</span>v1<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;m1\n&quot;</span><span class="token punctuation">,</span>m1<span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix m2<span class="token operator">=</span>matrix<span class="token double-colon punctuation">::</span><span class="token function">Full</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   m2<span class="token punctuation">.</span><span class="token function">Row</span><span class="token punctuation">(</span>v1<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;m2\n&quot;</span><span class="token punctuation">,</span>m2<span class="token punctuation">)</span><span class="token punctuation">;</span>
   
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;row 1 - &quot;</span><span class="token punctuation">,</span>m2<span class="token punctuation">.</span><span class="token function">Row</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;row 2 - &quot;</span><span class="token punctuation">,</span>m2<span class="token punctuation">.</span><span class="token function">Row</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">/*
  m1
  [[0,0,0]
  [1,2,3]]
  m2
  [[7,7,7,7,7]
  [7,7,7,7,7]
  [1,2,3,7,7]
  [7,7,7,7,7]]
  row 1 - [7,7,7,7,7]
  row 2 - [1,2,3,7,7]
  */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h3 id="_7-3-7-col"><a href="#_7-3-7-col" class="header-anchor">#</a> 7.3.7  Col</h3> <p>返回列向量。 将向量写入指定的列。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>vector matrix<span class="token double-colon punctuation">::</span><span class="token function">Col</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> ulong   ncol      <span class="token comment">// 列号</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">void</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Col</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> vector  v<span class="token punctuation">,</span>        <span class="token comment">// 列向量</span>
  <span class="token keyword">const</span> ulong   ncol      <span class="token comment">// 列号</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>参数</strong></p> <p>ncol</p> <p>[输入]  列数。</p> <p><strong>返回值</strong></p> <p>向量。</p> <p><strong>注意</strong></p> <p>可以为未分配的矩阵（没有维度）设置列数。 在这种情况下，将创建一个零矩阵，其大小为向量大小 x 列数+1，之后向量元素的值将填充在相应的列中。 如果为已存在的矩阵设置列，则矩阵维度不会变化，且列向量之外的矩阵元素值亦不会变化。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   vector v1<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   matrix m1<span class="token punctuation">;</span>
   m1<span class="token punctuation">.</span><span class="token function">Col</span><span class="token punctuation">(</span>v1<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;m1\n&quot;</span><span class="token punctuation">,</span>m1<span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix m2<span class="token operator">=</span>matrix<span class="token double-colon punctuation">::</span><span class="token function">Full</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   m2<span class="token punctuation">.</span><span class="token function">Col</span><span class="token punctuation">(</span>v1<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;m2\n&quot;</span><span class="token punctuation">,</span>m2<span class="token punctuation">)</span><span class="token punctuation">;</span>
   
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;col 1 - &quot;</span><span class="token punctuation">,</span>m2<span class="token punctuation">.</span><span class="token function">Col</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;col 2 - &quot;</span><span class="token punctuation">,</span>m2<span class="token punctuation">.</span><span class="token function">Col</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">/*
  m1
  [[0,1]
  [0,2]
  [0,3]]
  m2
  [[8,8,1,8,8]
  [8,8,2,8,8]
  [8,8,3,8,8]
  [8,8,8,8,8]]
  col 1 - [8,8,8,8]
  col 2 - [1,2,3,8]
  */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h3 id="_7-3-8-copy"><a href="#_7-3-8-copy" class="header-anchor">#</a> 7.3.8  Copy</h3> <p>创建给定矩阵/向量的副本。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Copy</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> matrix<span class="token operator">&amp;</span>  a     <span class="token comment">// 复制的矩阵</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">bool</span> vector<span class="token double-colon punctuation">::</span><span class="token function">Copy</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> vector<span class="token operator">&amp;</span>  v     <span class="token comment">// 复制的向量</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>参数</strong></p> <p>v</p> <p>[输入]  欲复制的矩阵或矢量。</p> <p><strong>返回值</strong></p> <p>成功时返回 true，否则返回 false。</p> <p><strong>MQL5 示例:</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>  matrix a<span class="token operator">=</span>matrix<span class="token double-colon punctuation">::</span><span class="token function">Eye</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  matrix b<span class="token punctuation">;</span>
  b<span class="token punctuation">.</span><span class="token function">Copy</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
  matrix c<span class="token operator">=</span>a<span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix b \n&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_c \n&quot;</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">/*
  /*
  matrix b
  [[1,0,0,0]
  [0,1,0,0]
  [0,0,1,0]]
  matrix_c
  [[1,0,0,0]
  [0,1,0,0]
  [0,0,1,0]]
  */</span>
  <span class="token operator">*</span><span class="token operator">/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><strong>Python 示例:</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">import</span> <span class="token module">numpy</span> as np
 
a <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token function">eye</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token char">'a \n'</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span>
b <span class="token operator">=</span> a
<span class="token function">print</span><span class="token punctuation">(</span><span class="token char">'b \n'</span><span class="token punctuation">,</span>b<span class="token punctuation">)</span>
c <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token char">'c \n'</span><span class="token punctuation">,</span>c<span class="token punctuation">)</span>
 
a 
 <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1.</span> <span class="token number">0.</span> <span class="token number">0.</span> <span class="token number">0.</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.</span> <span class="token number">1.</span> <span class="token number">0.</span> <span class="token number">0.</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.</span> <span class="token number">0.</span> <span class="token number">1.</span> <span class="token number">0.</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
b 
 <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1.</span> <span class="token number">0.</span> <span class="token number">0.</span> <span class="token number">0.</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.</span> <span class="token number">1.</span> <span class="token number">0.</span> <span class="token number">0.</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.</span> <span class="token number">0.</span> <span class="token number">1.</span> <span class="token number">0.</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
c 
 <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1.</span> <span class="token number">0.</span> <span class="token number">0.</span> <span class="token number">0.</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.</span> <span class="token number">1.</span> <span class="token number">0.</span> <span class="token number">0.</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.</span> <span class="token number">0.</span> <span class="token number">1.</span> <span class="token number">0.</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="_7-3-9-compare"><a href="#_7-3-9-compare" class="header-anchor">#</a> 7.3.9  Compare</h3> <p>按指定的精度比较两个矩阵/向量的元素。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>ulong vector<span class="token double-colon punctuation">::</span><span class="token function">Compare</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> vector<span class="token operator">&amp;</span> vec<span class="token punctuation">,</span>         <span class="token comment">// 欲比较的向量</span>
  <span class="token keyword">const</span> <span class="token keyword">double</span>  epsilon       <span class="token comment">// 精度</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
ulong matrix<span class="token double-colon punctuation">::</span><span class="token function">Compare</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> matrix<span class="token operator">&amp;</span> mat<span class="token punctuation">,</span>          <span class="token comment">// 欲比较的矩阵</span>
  <span class="token keyword">const</span> <span class="token keyword">double</span>  epsilon       <span class="token comment">// 精度</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>参数</strong></p> <p>vector_b</p> <p>[输入]  欲比较的向量。</p> <p>epsilon</p> <p>[输入]  精度。</p> <p><strong>返回值</strong></p> <p>所比较的矩阵或向量的不匹配元素数量：如果矩阵相等，则为 0，否则大于 0。</p> <p><strong>注意</strong></p> <p>比较运算符 == 或 != 执行精确的元素级比较。 众所周知，实数的精确比较用途有限，因此增加了 epsilon 比较方法。 一个矩阵也许包含某个范围内的元素，例如从 1e-20 到 1e+20。 这些矩阵可逐元素比较来进行处理，直到有效数字。</p> <p>对于复数矩阵/向量，该比较包括估计复数之间的距离。距离的计算公式为sqrt(pow(r1-r2, 2) + pow(i1-i2, 2)，并且是一个可以与epsilon进行比较的实数。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrix matrix_a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   matrix matrix_i<span class="token operator">=</span>matrix<span class="token double-colon punctuation">::</span><span class="token function">Identity</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix matrix_c<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Inv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix matrix_check<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">MatMul</span><span class="token punctuation">(</span>matrix_c<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_check\n&quot;</span><span class="token punctuation">,</span>matrix_check<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   ulong errors<span class="token operator">=</span>matrix_check<span class="token punctuation">.</span><span class="token function">Compare</span><span class="token punctuation">(</span>matrix<span class="token double-colon punctuation">::</span><span class="token function">Identity</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1e-15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;errors=&quot;</span><span class="token punctuation">,</span>errors<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
 
  <span class="token comment">/*
  matrix_check
  [[1,0,0]
  [4.440892098500626e-16,1,8.881784197001252e-16]
  [4.440892098500626e-16,2.220446049250313e-16,0.9999999999999996]]
  errors=0
 
  */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="_7-3-10-comparebydigits"><a href="#_7-3-10-comparebydigits" class="header-anchor">#</a> 7.3.10  CompareByDigits</h3> <p>按有效位数精度比较两个矩阵/向量的元素。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>ulong vector<span class="token double-colon punctuation">::</span><span class="token function">CompareByDigits</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> vector<span class="token operator">&amp;</span> vec<span class="token punctuation">,</span>          <span class="token comment">// 欲比较的向量</span>
  <span class="token keyword">const</span> <span class="token keyword">int</span>     digits        <span class="token comment">// 有效位数</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
ulong matrix<span class="token double-colon punctuation">::</span><span class="token function">CompareByDigits</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> matrix<span class="token operator">&amp;</span> mat<span class="token punctuation">,</span>          <span class="token comment">// 欲比较的矩阵</span>
  <span class="token keyword">const</span> <span class="token keyword">int</span>     digits        <span class="token comment">// 有效位数</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>参数</strong></p> <p>vector_b</p> <p>[输入]  欲比较的向量。</p> <p>digits</p> <p>[输入] 进行比较采用的有效位数。</p> <p>epsilon</p> <p>[输入] 比较精度。 如果两个值的绝对值相差小于指定的精度，则认为它们相等。</p> <p><strong>返回值</strong></p> <p>所比较的矩阵或向量的不匹配元素数量：如果矩阵相等，则为 0，否则大于 0。</p> <p><strong>注意</strong></p> <p>比较运算符 == 或 != 执行精确的元素级比较。 众所周知，实数的精确比较用途有限，因此增加了 epsilon 比较方法。 一个矩阵也许包含某个范围内的元素，例如从 1e-20 到 1e+20。 此类矩阵可用元素级比较来处理，直至有效位数。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   <span class="token keyword">int</span>    size_m<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span>    size_k<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">;</span>
   matrix <span class="token function">matrix_a</span><span class="token punctuation">(</span>size_m<span class="token punctuation">,</span>size_k<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 填充矩阵</span>
   <span class="token keyword">double</span>  value<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>size_m<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span>size_k<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">==</span>j<span class="token punctuation">)</span>
            matrix_a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1.0</span><span class="token operator">+</span>i<span class="token punctuation">;</span>
         <span class="token keyword">else</span>
           <span class="token punctuation">{</span>
            value<span class="token operator">+=</span><span class="token number">1.0</span><span class="token punctuation">;</span>
            matrix_a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>value<span class="token operator">/</span><span class="token number">1e+20</span><span class="token punctuation">;</span>
           <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 获取其它矩阵</span>
   matrix matrix_c <span class="token operator">=</span> matrix_a <span class="token operator">*</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
 
   ulong errors_epsilon<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Compare</span><span class="token punctuation">(</span>matrix_c<span class="token punctuation">,</span><span class="token number">1e-15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   ulong errors_digits<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">CompareByDigits</span><span class="token punctuation">(</span>matrix_c<span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Compare matrix %d x %d  errors_epsilon=%I64u  errors_digits=%I64u&quot;</span><span class="token punctuation">,</span>size_m<span class="token punctuation">,</span>size_k<span class="token punctuation">,</span>errors_epsilon<span class="token punctuation">,</span>errors_digits<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
 
  <span class="token comment">/*
  比较 矩阵 128 x 256  errors_epsilon=128  errors_digits=32768
  */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h3 id="_7-3-11-flat"><a href="#_7-3-11-flat" class="header-anchor">#</a> 7.3.11  Flat</h3> <p>允许依据一个索引替代两个索引来定位对矩阵元素。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Flat</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> ulong   index<span class="token punctuation">,</span>     <span class="token comment">// </span>
  <span class="token keyword">const</span> <span class="token keyword">double</span>  value      <span class="token comment">// 设置的数值</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">double</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Flat</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> ulong   index<span class="token punctuation">,</span>     <span class="token comment">// </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>参数</strong></p> <p>index</p> <p>[输入]  寻址索引</p> <p>value</p> <p>[输入]  给定索引值。</p> <p><strong>返回值</strong></p> <p>依据给定索引得到的值。</p> <p><strong>注意</strong></p> <p>对于矩阵 mat(3,3)，访问可以写成如下：</p> <ul><li>读取: 'x=mat.Flat(4)', 其等效于 'x=mat[1][1]'</li> <li>写入: 'mat.Flat(5, 42)', 等效于 'mat[1][2]=42'</li></ul> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrix matrix_a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_a\n&quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
   ulong arg_max<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">ArgMax</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;max_value=&quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">.</span><span class="token function">Flat</span><span class="token punctuation">(</span>arg_max<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix_a<span class="token punctuation">.</span><span class="token function">Flat</span><span class="token punctuation">(</span>arg_max<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   arg_max<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">ArgMax</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;max_value=&quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">.</span><span class="token function">Flat</span><span class="token punctuation">(</span>arg_max<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
 
  <span class="token comment">/*
  matrix_a
  [[10,3,2]
   [1,8,12]
   [6,5,4]
   [7,11,9]]
  max_value=12.0
  max_value=11.0
  */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="_7-3-12-clip"><a href="#_7-3-12-clip" class="header-anchor">#</a> 7.3.12  Clip</h3> <p>将矩阵/向量的元素限制在指定的有效值范围内。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Clip</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token keyword">double</span>  min_value<span class="token punctuation">,</span>     <span class="token comment">// 最小值</span>
  <span class="token keyword">const</span> <span class="token keyword">double</span>  max_value      <span class="token comment">// 最大值</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">bool</span> vector<span class="token double-colon punctuation">::</span><span class="token function">Clip</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token keyword">double</span>  min_value<span class="token punctuation">,</span>     <span class="token comment">// 最小值</span>
  <span class="token keyword">const</span> <span class="token keyword">double</span>  max_value      <span class="token comment">// 最大值</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>参数</strong></p> <p>min_value</p> <p>[输入]  最小值。</p> <p>max_value</p> <p>[输入]  最大值。</p> <p><strong>返回值</strong></p> <p>成功时返回 true，否则返回 false。</p> <p><strong>注意</strong></p> <p>矩阵（或向量）就地处理。 不会创建任何副本。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrix matrix_a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token keyword">bool</span> res<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Clip</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_a\n&quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">/*
  matrix_a
  [[4,4,4]
   [4,5,6]
   [7,8,8]
   [8,8,8]]
  */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="_7-3-13-reshape"><a href="#_7-3-13-reshape" class="header-anchor">#</a> 7.3.13  Reshape</h3> <p>在不更改其数据的情况下更改矩阵的形状。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">void</span>  <span class="token function">Reshape</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> ulong  rows<span class="token punctuation">,</span>     <span class="token comment">// 新的行数。</span>
  <span class="token keyword">const</span> ulong  cols      <span class="token comment">// 新的列数。</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>参数</strong></p> <p>rows</p> <p>[输入]  新的行数.</p> <p>cols</p> <p>[输入]  新的列数.</p> <p><strong>注意</strong></p> <p>矩阵就地处理。 不会创建任何副本。 可以指定任何大小，即，rows_new<em>cols_new!=rows_old</em>cols_old。 当矩阵缓冲区增加时，额外数值均未定义。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrix matrix_a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_a\n&quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix_a<span class="token punctuation">.</span><span class="token function">Reshape</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Reshape(2,6)\n&quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix_a<span class="token punctuation">.</span><span class="token function">Reshape</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Reshape(3,5)\n&quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix_a<span class="token punctuation">.</span><span class="token function">Reshape</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Reshape(2,4)\n&quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">/*
  matrix_a
  [[1,2,3]
   [4,5,6]
   [7,8,9]
   [10,11,12]]
  Reshape(2,6)
  [[1,2,3,4,5,6]
   [7,8,9,10,11,12]]
  Reshape(3,5)
  [[1,2,3,4,5]
   [6,7,8,9,10]
   [11,12,0,3,0]]
  Reshape(2,4)
  [[1,2,3,4]
   [5,6,7,8]]
  */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h3 id="_7-3-14-resize"><a href="#_7-3-14-resize" class="header-anchor">#</a> 7.3.14  Resize</h3> <p>返回已更改形状和大小的新矩阵。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Resize</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> ulong  rows<span class="token punctuation">,</span>     <span class="token comment">// </span>
  <span class="token keyword">const</span> ulong  cols<span class="token punctuation">,</span>     <span class="token comment">// 新列数。</span>
  <span class="token keyword">const</span> ulong  reserve<span class="token operator">=</span><span class="token number">0</span> <span class="token comment">// 项目保留额度。</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">bool</span> vector<span class="token double-colon punctuation">::</span><span class="token function">Resize</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> ulong  size<span class="token punctuation">,</span>     <span class="token comment">// 新大小。</span>
  <span class="token keyword">const</span> ulong  reserve<span class="token operator">=</span><span class="token number">0</span> <span class="token comment">// 项目保留额度。</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>参数</strong></p> <p>rows</p> <p>[输入]  新的行数.</p> <p>cols</p> <p>[输入]  新的列数.</p> <p><strong>返回值</strong></p> <p>成功时返回 true，否则返回 false。</p> <p><strong>注意</strong></p> <p>矩阵（或向量）就地处理。 不会创建任何副本。 可以指定任何大小，即，rows_new<em>cols_new!=rows_old</em>cols_old。 与 Reshape 不同，矩阵是逐行处理的。 当增加列数时，额外列的数值均未定义。 当增加行数时，额外行的数值均未定义。 当减少列数时，矩阵的每一行都会被截断。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrix matrix_a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_a\n&quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix_a<span class="token punctuation">.</span><span class="token function">Resize</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Ressize(2,6)\n&quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix_a<span class="token punctuation">.</span><span class="token function">Resize</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Resize(3,5)\n&quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix_a<span class="token punctuation">.</span><span class="token function">Resize</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Resize(2,4)\n&quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token comment">/*
   matrix_a
   [[1,2,3]
    [4,5,6]
    [7,8,9]
    [10,11,12]]
   Ressize(2,6)
   [[1,2,3,4,5,6]
    [4,5,6,10,11,12]]
   Resize(3,5)
   [[1,2,3,4,5]
    [4,5,6,10,11]
    [11,12,3,8,8]]
   Resize(2,4)
   [[1,2,3,4]
    [4,5,6,10]]
   */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h3 id="_7-3-15-set"><a href="#_7-3-15-set" class="header-anchor">#</a> 7.3.15 Set</h3> <p>根据指定索引设置向量元素值。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span> vector<span class="token double-colon punctuation">::</span><span class="token function">Set</span><span class="token punctuation">(</span>
  ulong   index<span class="token punctuation">,</span>     <span class="token comment">// 元素索引</span>
  <span class="token keyword">double</span>  value      <span class="token comment">// 值</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>参数</strong></p> <p>index</p> <p>[in]  需要为其设置值的元素索引。</p> <p>值</p> <p>[in]  值。</p> <p><strong>返回值</strong></p> <p>如果成功返回true，否则返回false。</p> <p><strong>注意</strong></p> <p>Set方法的作用与使用方括号赋值的作用相同，即：vector[index]=value. 添加该方法是为了简化从使用此类符号的语言中传递代码的过程。下面的示例显示了按指定索引用值填充向量的两个选项。</p> <p><strong>示例：</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//---</span>
   vector <span class="token function">v1</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> VectorAssignValues<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;v1 = &quot;</span><span class="token punctuation">,</span> v1<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   vector <span class="token function">v2</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> VectorSetValues<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;v2 = &quot;</span><span class="token punctuation">,</span> v2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
 <span class="token comment">/* Result
  v1 = [1,2,4,8,16,32,64,128,256,512]
  v2 = [1,2,4,8,16,32,64,128,256,512]
  */</span>
<span class="token comment">//+-------------------------------------------------------------------------+</span>
<span class="token comment">//| 通过赋值运算用数字的幂填充向量                                              |</span>
<span class="token comment">//+-------------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">VectorAssignValues</span><span class="token punctuation">(</span>vector<span class="token operator">&amp;</span> v<span class="token punctuation">,</span> <span class="token keyword">double</span> initial<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   <span class="token keyword">double</span> value<span class="token operator">=</span>initial<span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>ulong k<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> k<span class="token operator">&lt;</span>v<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      v<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">=</span>value<span class="token punctuation">;</span>
      value<span class="token operator">*=</span><span class="token number">2</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+--------------------------------------------------------------------------+</span>
<span class="token comment">//| 使用Set方法用数字的幂填充向量                                                |</span>
<span class="token comment">//+--------------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">VectorSetValues</span><span class="token punctuation">(</span>vector<span class="token operator">&amp;</span> v<span class="token punctuation">,</span> <span class="token keyword">double</span> initial<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   <span class="token keyword">double</span> value<span class="token operator">=</span>initial<span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>ulong k<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> k<span class="token operator">&lt;</span>v<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      v<span class="token punctuation">.</span><span class="token function">Set</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
      value<span class="token operator">*=</span><span class="token number">2</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><h3 id="_7-3-16-swaprows"><a href="#_7-3-16-swaprows" class="header-anchor">#</a> 7.3.16  SwapRows</h3> <p>交换矩阵中的行。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">SwapRows</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> ulong  row1<span class="token punctuation">,</span>     <span class="token comment">// 第一行的索引</span>
  <span class="token keyword">const</span> ulong  row2      <span class="token comment">// 第二行的索引</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>参数</strong></p> <p>row1</p> <p>[输入]  第一个行的索引。</p> <p>row2</p> <p>[输入]  第二个行的索引。</p> <p><strong>返回值</strong></p> <p>成功时返回 true，否则返回 false。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrix matrix_a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   matrix matrix_i<span class="token operator">=</span>matrix<span class="token double-colon punctuation">::</span><span class="token function">Identity</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix matrix_a1<span class="token operator">=</span>matrix_a<span class="token punctuation">;</span>
   matrix_a1<span class="token punctuation">.</span><span class="token function">SwapRows</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_a1\n&quot;</span><span class="token punctuation">,</span>matrix_a1<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   matrix matrix_p<span class="token operator">=</span>matrix_i<span class="token punctuation">;</span>
   matrix_p<span class="token punctuation">.</span><span class="token function">SwapRows</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix matrix_c1<span class="token operator">=</span>matrix_p<span class="token punctuation">.</span><span class="token function">MatMul</span><span class="token punctuation">(</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_c1\n&quot;</span><span class="token punctuation">,</span>matrix_c1<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">/*
  matrix_a1
  [[13,14,15,16]
   [5,6,7,8]
   [9,10,11,12]
   [1,2,3,4]]
  matrix_c1
  [[13,14,15,16]
   [5,6,7,8]
   [9,10,11,12]
   [1,2,3,4]]
  */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h3 id="_7-3-17-swapcols"><a href="#_7-3-17-swapcols" class="header-anchor">#</a> 7.3.17  SwapCols</h3> <p>交换矩阵中的列。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">SwapCols</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> ulong  row1<span class="token punctuation">,</span>     <span class="token comment">// 第一列的索引</span>
  <span class="token keyword">const</span> ulong  row2      <span class="token comment">// 第二列的索引</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>参数</strong></p> <p>col1</p> <p>[输入]  第一个列的索引。</p> <p>col2</p> <p>[输入]  第二个列的索引。</p> <p><strong>返回值</strong></p> <p>成功时返回 true，否则返回 false。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrix matrix_a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   matrix matrix_i<span class="token operator">=</span>matrix<span class="token double-colon punctuation">::</span><span class="token function">Identity</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix matrix_a1<span class="token operator">=</span>matrix_a<span class="token punctuation">;</span>
   matrix_a1<span class="token punctuation">.</span><span class="token function">SwapCols</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_a1\n&quot;</span><span class="token punctuation">,</span>matrix_a1<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   matrix matrix_p<span class="token operator">=</span>matrix_i<span class="token punctuation">;</span>
   matrix_p<span class="token punctuation">.</span><span class="token function">SwapCols</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix matrix_c1<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">MatMul</span><span class="token punctuation">(</span>matrix_p<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_c1\n&quot;</span><span class="token punctuation">,</span>matrix_c1<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">/*
  matrix_a1
  [[4,2,3,1]
   [8,6,7,5]
   [12,10,11,9]
   [16,14,15,13]]
  matrix_c1
  [[4,2,3,1]
   [8,6,7,5]
   [12,10,11,9]
   [16,14,15,13]]
  */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h3 id="_7-3-18-split"><a href="#_7-3-18-split" class="header-anchor">#</a> 7.3.18  Split</h3> <p>将矩阵拆分为多个子矩阵。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Split</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> ulong  parts<span class="token punctuation">,</span>      <span class="token comment">// 子矩阵数</span>
  <span class="token keyword">const</span> <span class="token keyword">int</span>    axis<span class="token punctuation">,</span>       <span class="token comment">// 轴</span>
  matrix<span class="token operator">&amp;</span>      splitted<span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment">// 结果子矩阵数组</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">void</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Split</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> ulong<span class="token operator">&amp;</span> parts<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token comment">// 子矩阵大小</span>
  <span class="token keyword">const</span> <span class="token keyword">int</span>    axis<span class="token punctuation">,</span>       <span class="token comment">// 轴</span>
  matrix<span class="token operator">&amp;</span>      splitted<span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment">// 结果子矩阵数组</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>参数</strong></p> <p>parts</p> <p>[输入] 欲将矩阵划分为子矩阵的数量。</p> <p>axis</p> <p>[输入]  轴。 0 - 水平轴，1 - 垂直轴。</p> <p>splitted</p> <p>[输出] 生成的子矩阵数组。</p> <p><strong>返回值</strong></p> <p>成功时返回 true，否则返回 false。</p> <p><strong>注意</strong></p> <p>如果指定了子矩阵的数量，则得到的子矩阵相同大小。 这意味着矩阵大小（0 - 行数，1 - 列数）必须能被 “parts” 参数整除，没有余数。 也可按子矩阵尺寸数组得到 不同尺寸的子矩阵。 各尺寸数组的元素都可用，直到整个矩阵被分割。 如果数组尺寸分割结束，而矩阵尚有部分未除尽，则未分割的余数将作为最后一个子矩阵。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrix matrix_a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token number">26</span><span class="token punctuation">,</span><span class="token number">27</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">29</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   matrix splitted<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   ulong  parts<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
 
   <span class="token keyword">bool</span> res<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Split</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>splitted<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span><span class="token string">&quot;  &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">ResetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>uint i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>splitted<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;splitted &quot;</span><span class="token punctuation">,</span>i<span class="token punctuation">,</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">,</span>splitted<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   res<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Split</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>splitted<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span><span class="token string">&quot;  &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>uint i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>splitted<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;splitted &quot;</span><span class="token punctuation">,</span>i<span class="token punctuation">,</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">,</span>splitted<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   res<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Split</span><span class="token punctuation">(</span>parts<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>splitted<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span><span class="token string">&quot;  &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>uint i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>splitted<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;splitted &quot;</span><span class="token punctuation">,</span>i<span class="token punctuation">,</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">,</span>splitted<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">/*
  false  4003
  true  0
  splitted 0
  [[1,2,3]
   [7,8,9]
   [13,14,15]
   [19,20,21]
   [25,26,27]]
  splitted 1
  [[4,5,6]
   [10,11,12]
   [16,17,18]
   [22,23,24]
   [28,29,30]]
  true  0
  splitted 0
  [[1,2,3,4,5,6]
   [7,8,9,10,11,12]]
  splitted 1
  [[13,14,15,16,17,18]
   [19,20,21,22,23,24]]
  splitted 2
  [[25,26,27,28,29,30]]
  */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br></div></div><h3 id="_7-3-18-hsplit"><a href="#_7-3-18-hsplit" class="header-anchor">#</a> 7.3.18 Hsplit</h3> <p>将矩阵水平拆分为多个子矩阵。 与 axis=0 的拆分相同</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Hsplit</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> ulong  parts<span class="token punctuation">,</span>      <span class="token comment">// 子矩阵数</span>
  matrix<span class="token operator">&amp;</span>      splitted<span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment">// 结果子矩阵数组</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">void</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Hsplit</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> ulong<span class="token operator">&amp;</span> parts<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token comment">// 子矩阵大小</span>
  matrix<span class="token operator">&amp;</span>      splitted<span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment">// 结果子矩阵数组</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>参数</strong></p> <p>parts</p> <p>[输入] 欲将矩阵划分为子矩阵的数量。</p> <p>splitted</p> <p>[输出] 生成的子矩阵数组。</p> <p><strong>返回值</strong></p> <p>成功时返回 true，否则返回 false。</p> <p><strong>注意</strong></p> <p>如果指定了子矩阵的数量，则得到的子矩阵相同大小。 这意味着行数必须能被 “parts” 参数整除，没有余数。 也可按子矩阵尺寸数组得到 不同尺寸的子矩阵。 各尺寸数组的元素都可用，直到整个矩阵被分割。 如果数组尺寸分割结束，而矩阵尚有部分未除尽，则未分割的余数将作为最后一个子矩阵。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrix matrix_a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token number">26</span><span class="token punctuation">,</span><span class="token number">27</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">29</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   matrix splitted<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   ulong  parts<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
 
   <span class="token keyword">bool</span> res<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Hsplit</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>splitted<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span><span class="token string">&quot;  &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">ResetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>uint i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>splitted<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;splitted &quot;</span><span class="token punctuation">,</span>i<span class="token punctuation">,</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">,</span>splitted<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   res<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Hsplit</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span>splitted<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span><span class="token string">&quot;  &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>uint i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>splitted<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;splitted &quot;</span><span class="token punctuation">,</span>i<span class="token punctuation">,</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">,</span>splitted<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   res<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Hsplit</span><span class="token punctuation">(</span>parts<span class="token punctuation">,</span>splitted<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span><span class="token string">&quot;  &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>uint i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>splitted<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;splitted &quot;</span><span class="token punctuation">,</span>i<span class="token punctuation">,</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">,</span>splitted<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
 
  <span class="token comment">/*
  false  4003
  true  0
  splitted 0
  [[1,2,3,4,5,6]]
  splitted 1
  [[7,8,9,10,11,12]]
  splitted 2
  [[13,14,15,16,17,18]]
  splitted 3
  [[19,20,21,22,23,24]]
  splitted 4
  [[25,26,27,28,29,30]]
  true  0
  splitted 0
  [[1,2,3,4,5,6]
  [7,8,9,10,11,12]]
  splitted 1
  [[13,14,15,16,17,18]
  [19,20,21,22,23,24]
  [25,26,27,28,29,30]]
  */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br></div></div><h3 id="_7-3-19-vsplit"><a href="#_7-3-19-vsplit" class="header-anchor">#</a> 7.3.19 Vsplit</h3> <p>将矩阵垂直拆分为多个子矩阵。 axis=1 的拆分相同</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Vsplit</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> ulong  parts<span class="token punctuation">,</span>      <span class="token comment">// 子矩阵数</span>
  matrix<span class="token operator">&amp;</span>      splitted<span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment">// 结果子矩阵数组</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">void</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Vsplit</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> ulong<span class="token operator">&amp;</span> parts<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token comment">// 子矩阵大小</span>
  matrix<span class="token operator">&amp;</span>      splitted<span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment">// 结果子矩阵数组</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>参数</strong></p> <p>parts</p> <p>[输入] 欲将矩阵划分为子矩阵的数量。</p> <h3 id="_7-3-20-splitted"><a href="#_7-3-20-splitted" class="header-anchor">#</a> 7.3.20 splitted</h3> <p>[输出] 生成的子矩阵数组。</p> <p><strong>返回值</strong></p> <p>成功时返回 true，否则返回 false。</p> <p><strong>注意</strong></p> <p>如果指定了子矩阵的数量，则得到的子矩阵相同大小。 这意味着列数必须能被 “parts” 参数整除，没有余数。 也可按子矩阵尺寸数组得到 不同尺寸的子矩阵。 各尺寸数组的元素都可用，直到整个矩阵被分割。 如果数组尺寸分割结束，而矩阵尚有部分未除尽，则未分割的余数将作为最后一个子矩阵。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrix matrix_a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   matrix splitted<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   ulong  parts<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
 
   matrix_a<span class="token punctuation">.</span><span class="token function">Vsplit</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>splitted<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>uint i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>splitted<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;splitted &quot;</span><span class="token punctuation">,</span>i<span class="token punctuation">,</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">,</span>splitted<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   matrix_a<span class="token punctuation">.</span><span class="token function">Vsplit</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span>splitted<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>uint i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>splitted<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;splitted &quot;</span><span class="token punctuation">,</span>i<span class="token punctuation">,</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">,</span>splitted<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   matrix_a<span class="token punctuation">.</span><span class="token function">Vsplit</span><span class="token punctuation">(</span>parts<span class="token punctuation">,</span>splitted<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>uint i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>splitted<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;splitted &quot;</span><span class="token punctuation">,</span>i<span class="token punctuation">,</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">,</span>splitted<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
 
  <span class="token comment">/*
     splitted 0
     [[1,2,3]
      [7,8,9]
      [13,14,15]]
     splitted 1
     [[4,5,6]
      [10,11,12]
      [16,17,18]]
 
     splitted 0
     [[1,2]
      [7,8]
      [13,14]]
     splitted 1
     [[3,4]
      [9,10]
      [15,16]]
     splitted 2
     [[5,6]
      [11,12]
      [17,18]]
 
     splitted 0
     [[1,2]
      [7,8]
      [13,14]]
     splitted 1
     [[3,4,5]
      [9,10,11]
      [15,16,17]]
     splitted 2
     [[6]
      [12]
      [18]]
 
  */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br></div></div><h3 id="_7-3-21-argsort"><a href="#_7-3-21-argsort" class="header-anchor">#</a> 7.3.21 ArgSort</h3> <p>矩阵或向量的间接排序。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>vector vector<span class="token double-colon punctuation">::</span><span class="token function">Sort</span><span class="token punctuation">(</span>
  func_name  compare_func<span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">,</span>  <span class="token comment">// 比较函数</span>
  T          context             <span class="token comment">// 自定义排序函数的参数</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
matrix matrix<span class="token double-colon punctuation">::</span><span class="token function">Sort</span><span class="token punctuation">(</span>
  func_name  compare_func<span class="token operator">=</span><span class="token constant">NULL</span>   <span class="token comment">// 比较函数</span>
  T          context             <span class="token comment">// 自定义排序函数的参数</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
matrix matrix<span class="token double-colon punctuation">::</span><span class="token function">Sort</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token keyword">int</span>  axis<span class="token punctuation">,</span>               <span class="token comment">// 排序轴</span>
  func_name  compare_func<span class="token operator">=</span><span class="token constant">NULL</span>   <span class="token comment">// 比较函数</span>
  T          context             <span class="token comment">// 自定义排序函数的参数</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p><strong>参数</strong></p> <p>axis</p> <p>[输入]  要排序的轴：0 是水平，1 是垂直。</p> <p>func_name</p> <p>[输入]  比较器。 您可以指定 ENUM_SORT_MODE 枚举值之一，或您自己的比较函数。 如果未指定函数，则采用升序排序。</p> <p>自定义比较函数可以有两种类型：</p> <p>int comparator(T x1,T x2)
int comparator(T x1,T x2,TContext context)
此处 T 是矩阵或向量的类型，而传递给 Sort 方法的附加参数 TContex 则是作为“上下文关联”变量类型。</p> <p>context</p> <p>[输入] 可传递给自定义排序函数的其它可选参数。</p> <p><strong>返回值</strong></p> <p>含有已排序元素索引的向量或矩阵。 例如，结果 [4,2,0,1,3] 指示元素 4 其索引应该位于零位置，元素 2 其索引位于第一个位置，依此类推。</p> <h3 id="_7-3-22-sort"><a href="#_7-3-22-sort" class="header-anchor">#</a> 7.3.22  Sort</h3> <p>就地针对矩阵或向量进行排序。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">void</span> vector<span class="token double-colon punctuation">::</span><span class="token function">Sort</span><span class="token punctuation">(</span>
  func_name  compare_func<span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">,</span>  <span class="token comment">// 比较函数</span>
  T          context             <span class="token comment">// 自定义排序函数的参数</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">void</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Sort</span><span class="token punctuation">(</span>
  func_name  compare_func<span class="token operator">=</span><span class="token constant">NULL</span>   <span class="token comment">// 比较函数</span>
  T          context             <span class="token comment">// 自定义排序函数的参数</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">void</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Sort</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token keyword">int</span>  axis<span class="token punctuation">,</span>               <span class="token comment">// 排序轴</span>
  func_name  compare_func<span class="token operator">=</span><span class="token constant">NULL</span>   <span class="token comment">// 比较函数</span>
  T          context             <span class="token comment">// 自定义排序函数的参数</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p><strong>参数</strong></p> <p>axis</p> <p>[输入]  要排序的轴：0 是水平，1 是垂直。</p> <p>func_name</p> <p>[输入]  比较器。 您可以指定 ENUM_SORT_MODE 枚举值之一，或您自己的比较函数。 如果未指定函数，则采用升序排序。</p> <p>自定义比较函数可以有两种类型：</p> <p>int comparator(T x1,T x2)
int comparator(T x1,T x2,TContext context)
此处 T 是矩阵或向量的类型，而传递给 Sort 方法的附加参数 TContex 则是作为“上下文关联”变量类型。</p> <p>context</p> <p>[输入] 可传递给自定义排序函数的其它可选参数。</p> <p><strong>返回值</strong></p> <p>无。 排序就地执行，即它应用于调用 Sort 方法的矩阵/向量的数据。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| Sort 函数                                                         |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">int</span> <span class="token function">MyDoubleComparator</span><span class="token punctuation">(</span><span class="token keyword">double</span> x1<span class="token punctuation">,</span><span class="token keyword">double</span> x2<span class="token punctuation">,</span><span class="token keyword">int</span> sort_mode<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   <span class="token keyword">int</span> res<span class="token operator">=</span>x1<span class="token operator">&lt;</span>x2 <span class="token operator">?</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">:</span> <span class="token punctuation">(</span>x1<span class="token operator">&gt;</span>x2 <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span>sort_mode<span class="token operator">==</span><span class="token number">0</span> <span class="token operator">?</span> res <span class="token operator">:</span> <span class="token operator">-</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 脚本程序 start 函数                                                |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   <span class="token comment">//--- 填充向量</span>
   vector <span class="token function">v</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment">//--- 升序排序</span>
   v<span class="token punctuation">.</span><span class="token function">Sort</span><span class="token punctuation">(</span>MyDoubleComparator<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 此处使用了默认值为 “0” 的附加参数</span>
   <span class="token function">Print</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment">// 降序排序</span>
   v<span class="token punctuation">.</span><span class="token function">Sort</span><span class="token punctuation">(</span>MyDoubleComparator<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 此处的附加参数 “1” 是由用户显式指定的</span>
   <span class="token function">Print</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h2 id="_7-4-矩阵和向量的数学运算"><a href="#_7-4-矩阵和向量的数学运算" class="header-anchor">#</a> 7.4 矩阵和向量的数学运算</h2> <p>数学运算，包括加法、减法、乘法和除法，可以针对矩阵和向量按元素级执行。</p> <p>数学函数最初设计用于对标量值执行相关操作。 大多数函数可以应用于矩阵和向量。 其中包括 MathAbs, MathArccos, MathArcsin, MathArctan, MathCeil, MathCos, MathExp, MathFloor, MathLog, MathLog10, MathMod, MathPow, MathRound, MathSin, MathSqrt, MathTan, MathExpm1, MathLog1p, MathArccosh, MathArcsinh, MathArctanh, MathCosh, MathSinh, 和 MathTanh。 此类操作意味着矩阵和向量的元素级处理。 示例</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//---</span>
  matrix a<span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix a=\n&quot;</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
  a<span class="token operator">=</span><span class="token function">MathSqrt</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;MatrSqrt(a)=\n&quot;</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">/*
   matrix a=
   [[1,4]
    [9,16]]
   MatrSqrt(a)=
   [[1,2]
    [3,4]]
  */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>对于 MathMod 和 MathPow，第二个元素可以是标量,，或相应大小的矩阵/向量。</p> <p>下面的示例展示如何将数学函数应用于向量来计算标准偏差。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 脚本程序 start 函数                                                |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 <span class="token punctuation">{</span>
<span class="token comment">//--- 使用初始化函数填充矢量</span>
  vector <span class="token function">r</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> ArrayRandom<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 从0 到1 的随机数数组</span>
<span class="token comment">//--- 计算平均值</span>
  <span class="token keyword">double</span> avr<span class="token operator">=</span>r<span class="token punctuation">.</span><span class="token function">Mean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// 数组平均值</span>
  vector d<span class="token operator">=</span>r<span class="token operator">-</span>avr<span class="token punctuation">;</span>            <span class="token comment">// 计算与平均值的偏差数组</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;avr(r)=&quot;</span><span class="token punctuation">,</span> avr<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;r=&quot;</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;d=&quot;</span><span class="token punctuation">,</span> d<span class="token punctuation">)</span><span class="token punctuation">;</span>
  vector s2<span class="token operator">=</span><span class="token function">MathPow</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 方差平方数组</span>
  <span class="token keyword">double</span> sum<span class="token operator">=</span>s2<span class="token punctuation">.</span><span class="token function">Sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// 方差平方和</span>
<span class="token comment">//--- 以两种不同的方法计算标准偏差</span>
  <span class="token keyword">double</span> std<span class="token operator">=</span><span class="token function">MathSqrt</span><span class="token punctuation">(</span>sum<span class="token operator">/</span>r<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot; std(r)=&quot;</span><span class="token punctuation">,</span> std<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;r.Std()=&quot;</span><span class="token punctuation">,</span> r<span class="token punctuation">.</span><span class="token function">Std</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   
 <span class="token punctuation">}</span>
<span class="token comment">/*
  avr(r)=0.5300302133243813
  r=[0.8346201971495713,0.8031556138798182,0.6696676534318063,0.05386516922513505,0.5491195410016175,0.8224433118686484,...
  d=[0.30458998382519,0.2731254005554369,0.1396374401074251,-0.4761650440992462,0.01908932767723626,0.2924130985442671, ...
   std(r)=0.2838269732183663
  r.Std()=0.2838269732183663
*/</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 以随机数值填充向量                                                 |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">ArrayRandom</span><span class="token punctuation">(</span>vector<span class="token operator">&amp;</span> v<span class="token punctuation">)</span>
 <span class="token punctuation">{</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span>ulong i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>v<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token keyword">double</span><span class="token punctuation">(</span><span class="token function">MathRand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">32767.</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h3 id="_7-4-1-数学运算"><a href="#_7-4-1-数学运算" class="header-anchor">#</a> 7.4.1  数学运算</h3> <p>数学运算，包括加法、减法、乘法和除法，可以针对矩阵和向量按元素级执行。</p> <p>两个矩阵或两个向量必须属于同一类型，并且必须具有相同的维度。 矩阵的每个元素都对第二个矩阵的相应元素进行操作。</p> <p>您还可以使用相应的类型（双精度、浮点数或复数）的标量作为第二项（乘数、减法或除数）。 在这种情况下，矩阵或向量的每个成员都将在指定的标量上运行。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>  matrix matrix_a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0.1</span><span class="token punctuation">,</span><span class="token number">0.2</span><span class="token punctuation">,</span><span class="token number">0.3</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">0.4</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">,</span><span class="token number">0.6</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  matrix matrix_b<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
 
  matrix matrix_c1<span class="token operator">=</span>matrix_a<span class="token operator">+</span>matrix_b<span class="token punctuation">;</span>
  matrix matrix_c2<span class="token operator">=</span>matrix_b<span class="token operator">-</span>matrix_a<span class="token punctuation">;</span>
  matrix matrix_c3<span class="token operator">=</span>matrix_a<span class="token operator">*</span>matrix_b<span class="token punctuation">;</span>   <span class="token comment">// 哈达玛（Hadamard）乘积，不要和矩阵乘积混淆！ 对此有一个特殊的 MatMul 函数</span>
  matrix matrix_c4<span class="token operator">=</span>matrix_b<span class="token operator">/</span>matrix_a<span class="token punctuation">;</span>
 
  matrix_c1<span class="token operator">=</span>matrix_a<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
  matrix_c2<span class="token operator">=</span>matrix_b<span class="token operator">-</span>double_value<span class="token punctuation">;</span>
  matrix_c3<span class="token operator">=</span>matrix_a<span class="token operator">*</span>M_PI<span class="token punctuation">;</span>
  matrix_c4<span class="token operator">=</span>matrix_b<span class="token operator">/</span><span class="token number">0.1</span><span class="token punctuation">;</span>
 
<span class="token comment">//--- 可以就地采取行动</span>
  matrix_a<span class="token operator">+=</span>matrix_b<span class="token punctuation">;</span>
  matrix_a<span class="token operator">/=</span><span class="token number">2</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>相同的操作可用于向量。</p> <h3 id="_7-4-2-数学函数"><a href="#_7-4-2-数学函数" class="header-anchor">#</a> 7.4.2  数学函数</h3> <p>以下数学函数可以应用于矩阵和向量：MathAbs, MathArccos, MathArcsin, MathArctan, MathCeil, MathCos, MathExp, MathFloor, MathLog, MathLog10, MathMod, MathPow, MathRound, MathSin, MathSqrt, MathTan, MathExpm1, MathLog1p, MathArccosh, MathArcsinh, MathArctanh, MathCosh, MathSinh, MathTanh。 此类操作意味着矩阵和向量的元素级处理。</p> <p>对于 MathMod 和 MathPow，第二个元素既可以是标量，亦或相应大小的矩阵/向量。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrix<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token function">mat1</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token function">mat3</span><span class="token punctuation">(</span>mat1<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>mat1<span class="token punctuation">.</span><span class="token function">Cols</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   ulong     n<span class="token punctuation">,</span>size<span class="token operator">=</span>mat1<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span>mat1<span class="token punctuation">.</span><span class="token function">Cols</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
   mat2<span class="token operator">=</span><span class="token function">MathPow</span><span class="token punctuation">(</span>mat1<span class="token punctuation">,</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token number">1.9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>n<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> n<span class="token operator">&lt;</span>size<span class="token punctuation">;</span> n<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      T res<span class="token operator">=</span><span class="token function">MathPow</span><span class="token punctuation">(</span>mat1<span class="token punctuation">.</span><span class="token function">Flat</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token number">1.9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token operator">!=</span>mat2<span class="token punctuation">.</span><span class="token function">Flat</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
         errors<span class="token operator">++</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
   mat2<span class="token operator">=</span><span class="token function">MathPow</span><span class="token punctuation">(</span>mat1<span class="token punctuation">,</span>mat3<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>n<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> n<span class="token operator">&lt;</span>size<span class="token punctuation">;</span> n<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      T res<span class="token operator">=</span><span class="token function">MathPow</span><span class="token punctuation">(</span>mat1<span class="token punctuation">.</span><span class="token function">Flat</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span>mat3<span class="token punctuation">.</span><span class="token function">Flat</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token operator">!=</span>mat2<span class="token punctuation">.</span><span class="token function">Flat</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
         errors<span class="token operator">++</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
   vector<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token function">vec1</span><span class="token punctuation">(</span><span class="token number">16384</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token function">vec3</span><span class="token punctuation">(</span>vec1<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   ulong     n<span class="token punctuation">,</span>size<span class="token operator">=</span>vec1<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
   vec2<span class="token operator">=</span><span class="token function">MathPow</span><span class="token punctuation">(</span>vec1<span class="token punctuation">,</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token number">1.9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>n<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> n<span class="token operator">&lt;</span>size<span class="token punctuation">;</span> n<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      T res<span class="token operator">=</span><span class="token function">MathPow</span><span class="token punctuation">(</span>vec1<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token number">1.9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token operator">!=</span>vec2<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">)</span>
         errors<span class="token operator">++</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
   vec2<span class="token operator">=</span><span class="token function">MathPow</span><span class="token punctuation">(</span>vec1<span class="token punctuation">,</span>vec3<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>n<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> n<span class="token operator">&lt;</span>size<span class="token punctuation">;</span> n<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      T res<span class="token operator">=</span><span class="token function">MathPow</span><span class="token punctuation">(</span>vec1<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">,</span>vec3<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token operator">!=</span>vec2<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">)</span>
         errors<span class="token operator">++</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><h2 id="_7-5-乘积"><a href="#_7-5-乘积" class="header-anchor">#</a> 7.5  乘积</h2> <p>矩阵和矢量乘积
矩阵和向量乘积计算包括：</p> <ul><li>矩阵乘法</li> <li>向量乘法</li> <li>计算协方差矩阵</li> <li>计算两个向量的互相关</li> <li>计算两个向量的卷积</li> <li>计算相关系数</li></ul> <table><thead><tr><th>函数</th> <th>动作</th></tr></thead> <tbody><tr><td>MatMul</td> <td>两个矩阵的矩阵乘积</td></tr> <tr><td>GeMM</td> <td>通用矩阵乘法（GeMM）</td></tr> <tr><td>Power</td> <td>将方阵提升整数幂</td></tr> <tr><td>Dot</td> <td>两个向量的点积</td></tr> <tr><td>Kron</td> <td>返回两个矩阵、矩阵和向量，向量和矩阵、或两个向量的克罗内克（Kronecker）乘积</td></tr> <tr><td>Inner</td> <td>两个矩阵的内积</td></tr> <tr><td>Outer</td> <td>计算两个矩阵或两个向量的外积</td></tr> <tr><td>CorrCoef</td> <td>计算皮尔逊（Pearson）相关系数（线性相关系数）</td></tr> <tr><td>Cov</td> <td>计算协方差矩阵</td></tr> <tr><td>Correlate</td> <td>计算两个向量的互相关性</td></tr> <tr><td>Convolve</td> <td>返回两个向量的离散线性卷积</td></tr></tbody></table> <h3 id="_7-5-1-matmul"><a href="#_7-5-1-matmul" class="header-anchor">#</a> 7.5.1 MatMul</h3> <p>MatMul 方法支持矩阵和向量的乘法，具有若干个重载。</p> <p>矩阵乘以矩阵: <code>matrix[M][K] * matrix[K][N] = matrix[M][N]</code></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>matrix  matrix<span class="token double-colon punctuation">::</span><span class="token function">MatMul</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> matrix<span class="token operator">&amp;</span>  b      <span class="token comment">// 第二个矩阵</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>向量乘以矩阵: <code>horizontal vector[K] * matrix[K][N] = horizontal vector[N]</code></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>vector  vector<span class="token double-colon punctuation">::</span><span class="token function">MatMul</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> matrix<span class="token operator">&amp;</span>  b      <span class="token comment">// 矩阵</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>矩阵乘以向量: <code>matrix[M][K] * vertical vector[K] = vertical vector[M]</code></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>vector  matrix<span class="token double-colon punctuation">::</span><span class="token function">MatMul</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> vector<span class="token operator">&amp;</span>  b      <span class="token comment">// 向量</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>标量向量乘法: <code>horizontal vector * vertical vector = dot value</code></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>scalar  vector<span class="token double-colon punctuation">::</span><span class="token function">MatMul</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> vector<span class="token operator">&amp;</span>  b      <span class="token comment">// 第二个向量</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>参数</strong></p> <p>b</p> <p>[输入]  矩阵或向量。</p> <p><strong>返回值</strong></p> <p>矩阵、矢量或标量，具体取决于所使用的方法。</p> <p><strong>注意</strong></p> <p>矩阵应兼容乘法，即第一个矩阵中的列数应等于第二个矩阵中的行数。 矩阵乘法不支持交换律：在一般情况下，将第一个矩阵乘以第二个矩阵的结果不等于将第二个矩阵乘以第一个矩阵的结果。</p> <p>矩阵积由第一个矩阵的行向量和第二个矩阵的列向量的标量积的所有可能组合组成。</p> <p>在标量乘法中，向量必须具有相同的长度。</p> <p>当向量和矩阵相乘时，向量的长度必须与矩阵中的列数完全匹配。</p> <p><strong>以 MQL5 实现的朴素矩阵乘法算法：</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>matrix <span class="token function">MatrixProduct</span><span class="token punctuation">(</span><span class="token keyword">const</span> matrix<span class="token operator">&amp;</span> matrix_a<span class="token punctuation">,</span> <span class="token keyword">const</span> matrix<span class="token operator">&amp;</span> matrix_b<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   matrix matrix_c<span class="token punctuation">;</span>
 
   <span class="token keyword">if</span><span class="token punctuation">(</span>matrix_a<span class="token punctuation">.</span><span class="token function">Cols</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!=</span>matrix_b<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span><span class="token punctuation">(</span>matrix_c<span class="token punctuation">)</span><span class="token punctuation">;</span>
      
   ulong M<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   ulong K<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Cols</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   ulong N<span class="token operator">=</span>matrix_b<span class="token punctuation">.</span><span class="token function">Cols</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix_c<span class="token operator">=</span>matrix<span class="token double-colon punctuation">::</span><span class="token function">Zeros</span><span class="token punctuation">(</span>M<span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token keyword">for</span><span class="token punctuation">(</span>ulong m<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> m<span class="token operator">&lt;</span>M<span class="token punctuation">;</span> m<span class="token operator">++</span><span class="token punctuation">)</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span>ulong k<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> k<span class="token operator">&lt;</span>K<span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span>
         <span class="token keyword">for</span><span class="token punctuation">(</span>ulong n<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> n<span class="token operator">&lt;</span>N<span class="token punctuation">;</span> n<span class="token operator">++</span><span class="token punctuation">)</span>
            matrix_c<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token operator">+=</span>matrix_a<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">*</span>matrix_b<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>
 
   <span class="token keyword">return</span><span class="token punctuation">(</span>matrix_c<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><strong>矩阵乘法示例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrix a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
             <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   matrix b<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
             <span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
             <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   matrix c1<span class="token operator">=</span>a<span class="token punctuation">.</span><span class="token function">MatMul</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix c2<span class="token operator">=</span>b<span class="token punctuation">.</span><span class="token function">MatMul</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;c1 = \n&quot;</span><span class="token punctuation">,</span> c1<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;c2 = \n&quot;</span><span class="token punctuation">,</span> c2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
   c1 = 
   [[4,1]
    [2,2]]
   c2 = 
   [[4,1,0]
    [2,2,0]
    [1,3,0]]
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p><strong>水平向量乘以矩阵的示例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 脚本程序 start 函数                                                |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 创建一个 3x5 矩阵</span>
   matrix m35<span class="token punctuation">;</span>
   m35<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> Arange<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//---</span>
   vector v3 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Product of horizontal vector v and matrix m[3,5]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;On the left, vector v3 = &quot;</span><span class="token punctuation">,</span> v3<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;On the right, matrix m35 = \n&quot;</span><span class="token punctuation">,</span> m35<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;v3.MatMul(m35) = horizontal vector v[5] \n&quot;</span><span class="token punctuation">,</span> v3<span class="token punctuation">.</span><span class="token function">MatMul</span><span class="token punctuation">(</span>m35<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">/* 结果
    Product of horizontal vector v3 and matrix m[3,5]
    On the left, vector v3 = [1,2,3]
    On the right, matrix m35 =
    [[0,1,2,3,4]
     [5,6,7,8,9]
     [10,11,12,13,14]]
    v3.MatMul(m35) = horizontal vector v[5]
    [40,46,52,58,64]
   */</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//|  以递增数值填充矩阵                                                |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">Arange</span><span class="token punctuation">(</span>matrix <span class="token operator">&amp;</span> m<span class="token punctuation">,</span> <span class="token keyword">double</span> start <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">double</span> step <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//---</span>
   ulong cols <span class="token operator">=</span> m<span class="token punctuation">.</span><span class="token function">Cols</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   ulong rows <span class="token operator">=</span> m<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">double</span> value <span class="token operator">=</span> start<span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>ulong r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> r <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> r<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span>ulong c <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> c <span class="token operator">&lt;</span> cols<span class="token punctuation">;</span> c<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
         m<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
         value <span class="token operator">+=</span> step<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
<span class="token comment">//---</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><p><strong>矩阵如何乘以垂直向量的示例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 脚本程序 start 函数                                                |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 创建一个 3x5 矩阵</span>
   matrix m35<span class="token punctuation">;</span>
   m35<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> Arange<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//---</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Product of matrix m[3,5] and vertical vector v[5]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector v5 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;On the left, m35 = \n&quot;</span><span class="token punctuation">,</span>m35<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;On the right v5 = &quot;</span><span class="token punctuation">,</span>v5<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;m35.MatMul(v5) = vertical vector v[3] \n&quot;</span><span class="token punctuation">,</span>m35<span class="token punctuation">.</span><span class="token function">MatMul</span><span class="token punctuation">(</span>v5<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">/* 结果
   Product of matrix m[3,5] and vertical vector v[5]
   On the left, m35 = 
   [[0,1,2,3,4]
    [5,6,7,8,9]
    [10,11,12,13,14]]
   On the right, v5 = [1,2,3,4,5]
   m35.MatMul(v5) = vertical vector v[3] 
   [40,115,190]
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>参见</p> <p>Dot, GeMM</p> <h3 id="_7-5-2-gemm"><a href="#_7-5-2-gemm" class="header-anchor">#</a> 7.5.2 GeMM</h3> <p>GeMM（通用矩阵乘法）方法实现了两个矩阵的一般乘法。 运算定义为 C ← α A B + β C，其中 A 和 B 矩阵可以选择转置。 配合矩阵 AB（MatMul）的正态乘法，假定 alpha 标量等于 1，beta 等于零。</p> <p>GeMM 和 MatMul 在效率方面的主要区别在于，MatMul 总是创建一个新的矩阵/矢量对象，而 GeMM 使用现有的矩阵对象，且不会重新创建它。 因此，当您使用 GeMM 并为相应的矩阵预分配内存时，在操控相同的矩阵大小时，将不会重新分配内存。 这可能是 GeMM 在批量计算方面的一个重要优势，例如，在策略测试器中运行优化、或训练神经网络时。</p> <p>与 MatMul 类似，GeMM 也有 4 个重载。 然而，第四次重载的语义已被修改，以便能够将垂直向量与水平向量相乘。</p> <p>在现有的矩阵/矢量对象中，没有必要预先分配内存。 将在第一次调用 GeMM 时分配内存，并以零填充。</p> <p>矩阵乘以矩阵: <code>matrix C[M][N] = α * ( matrix A[M][K] * matrix B[K][N]) + β * matrix C[M][N]</code></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  matrix<span class="token double-colon punctuation">::</span><span class="token function">GeMM</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> matrix <span class="token operator">&amp;</span>A<span class="token punctuation">,</span>    <span class="token comment">// first matrix</span>
  <span class="token keyword">const</span> matrix <span class="token operator">&amp;</span>B<span class="token punctuation">,</span>    <span class="token comment">// second matrix</span>
  <span class="token keyword">double</span> alpha<span class="token punctuation">,</span>       <span class="token comment">// 乘积 AB 的 alpha 乘数</span>
  <span class="token keyword">double</span> beta<span class="token punctuation">,</span>        <span class="token comment">// beta multiplier for matrix C</span>
  uint   flags        <span class="token comment">// a combination of ENUM_GEMM values (bitwise OR), which determines whether matrices A, B and C are transposed</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>向量乘以矩阵: <code>vector C[N] = α * ( vector A[K] * matrix B[K][N]) + β * vector C[N]</code></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  vector<span class="token double-colon punctuation">::</span><span class="token function">GeMM</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> vector <span class="token operator">&amp;</span>A<span class="token punctuation">,</span>    <span class="token comment">// 水平向量</span>
  <span class="token keyword">const</span> matrix <span class="token operator">&amp;</span>B<span class="token punctuation">,</span>    <span class="token comment">// 矩阵</span>
  <span class="token keyword">double</span> alpha<span class="token punctuation">,</span>       <span class="token comment">// 乘积 AB 的 alpha 乘数</span>
  <span class="token keyword">double</span> beta<span class="token punctuation">,</span>        <span class="token comment">// 向量 C 的 beta 乘数</span>
  uint   flags        <span class="token comment">// ENUM_GEMM 枚举值，判定是否矩阵 A 是转置</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>矩阵乘以向量: <code>vector C[M] = α * ( matrix A[M][K] * vector B[K] * ) + β * vector C[M]</code></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  vector<span class="token double-colon punctuation">::</span><span class="token function">GeMM</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> matrix <span class="token operator">&amp;</span>A<span class="token punctuation">,</span>    <span class="token comment">// 矩阵</span>
  <span class="token keyword">const</span> vector <span class="token operator">&amp;</span>B<span class="token punctuation">,</span>    <span class="token comment">// 垂直向量</span>
  <span class="token keyword">double</span> alpha<span class="token punctuation">,</span>       <span class="token comment">// 乘积 AB 的 alpha 乘数</span>
  <span class="token keyword">double</span> beta<span class="token punctuation">,</span>        <span class="token comment">// 向量 C 的 beta 乘数</span>
  uint   flags        <span class="token comment">// ENUM_GEMM 枚举值，判定是否矩阵 B 是转置</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>向量乘以向量: matrix C[M][N] = α * ( vector A[M] * vector B[N] * ) + β * matrix C[M][N]. 此重载返回一个矩阵，与 MatMul 不同，它返回一个标量。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  matrix<span class="token double-colon punctuation">::</span><span class="token function">GeMM</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> vector <span class="token operator">&amp;</span>A<span class="token punctuation">,</span>    <span class="token comment">// 第一个向量</span>
  <span class="token keyword">const</span> vector <span class="token operator">&amp;</span>B<span class="token punctuation">,</span>    <span class="token comment">// 第二个向量</span>
  <span class="token keyword">double</span> alpha<span class="token punctuation">,</span>       <span class="token comment">// 乘积 AB 的 alpha 乘数</span>
  <span class="token keyword">double</span> beta<span class="token punctuation">,</span>        <span class="token comment">// 用于矩阵 C 的 beta</span>
  uint   flags        <span class="token comment">// ENUM_GEMM 枚举值，判定是否矩阵 C 是转置</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>参数</strong></p> <p>A</p> <p>[输入]  矩阵或向量。</p> <p>B</p> <p>[输入]  矩阵或向量。</p> <p>alpha</p> <p>[输入]  AB 乘积的阿尔法乘数。</p> <p>beta</p> <p>[输入]  所得 C 矩阵的贝塔乘数。</p> <p>flags</p> <p>[输入]  确定是否转置矩阵 A、B 和 C 的 ENUM_GEMM 枚举值。</p> <p><strong>返回值</strong></p> <p>成功返回 true，否则 false。</p> <p><strong>ENUM_GEMM</strong></p> <p>GeMM 方法的标志枚举。
|ID|说明|
|TRANSP_A|使用转置矩阵 A|
|TRANSP_B|使用转置矩阵 B|
|TRANSP_C|使用转置矩阵 C|</p> <p><strong>注意</strong></p> <p>浮点型、双精度型和复数类型的矩阵和向量可以用作参数 A 和 B。GeMM 方法的模板变体如下：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span> <span class="token class-name">matrix</span><span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span><span class="token function">GeMM</span><span class="token punctuation">(</span><span class="token keyword">const</span> matrix<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token operator">&amp;</span>A<span class="token punctuation">,</span><span class="token keyword">const</span> matrix<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token operator">&amp;</span>B<span class="token punctuation">,</span>T alpha<span class="token punctuation">,</span>T beta<span class="token punctuation">,</span>ulong flags<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">bool</span> <span class="token class-name">matrix</span><span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span><span class="token function">GeMM</span><span class="token punctuation">(</span><span class="token keyword">const</span> vector<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token operator">&amp;</span>A<span class="token punctuation">,</span><span class="token keyword">const</span> vector<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token operator">&amp;</span>B<span class="token punctuation">,</span>T alpha<span class="token punctuation">,</span>T beta<span class="token punctuation">,</span>ulong flags<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">bool</span> <span class="token class-name">vector</span><span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span><span class="token function">GeMM</span><span class="token punctuation">(</span><span class="token keyword">const</span> vector<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token operator">&amp;</span>A<span class="token punctuation">,</span><span class="token keyword">const</span> matrix<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token operator">&amp;</span>B<span class="token punctuation">,</span>T alpha<span class="token punctuation">,</span>T beta<span class="token punctuation">,</span>ulong flags<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">bool</span> <span class="token class-name">vector</span><span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span><span class="token function">GeMM</span><span class="token punctuation">(</span><span class="token keyword">const</span> matrix<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token operator">&amp;</span>A<span class="token punctuation">,</span><span class="token keyword">const</span> vector<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token operator">&amp;</span>B<span class="token punctuation">,</span>T alpha<span class="token punctuation">,</span>T beta<span class="token punctuation">,</span>ulong flags<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>基本上一般的矩阵乘法函数描述为：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>C[m,n] = α *Sum(A[m,k]*B[k,n]) + β*C[m,n]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>配合以下尺寸：矩阵 A 为 M x K，矩阵 B 为 K x N，矩阵 C 为 M x N。</p> <p>因此，矩阵应该与乘法兼容，即第一个矩阵中的列数应等于第二个矩阵中的行数。 矩阵乘法不支持交换律：在一般情况下，将第一个矩阵乘以第二个矩阵的结果不等于将第二个矩阵乘以第一个矩阵的结果。</p> <p><strong>示例:</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   vector vector_a<span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   vector vector_b<span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   matrix matrix_c<span class="token punctuation">;</span>
<span class="token comment">//--- 计算两个向量的 GeMM</span>
   matrix_c<span class="token punctuation">.</span><span class="token function">GeMM</span><span class="token punctuation">(</span>vector_a<span class="token punctuation">,</span> vector_b<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_c:\n &quot;</span><span class="token punctuation">,</span> matrix_c<span class="token punctuation">,</span> <span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment">/*
   matrix_c:
    [[4,3,2,1]
    [8,6,4,2]
    [12,9,6,3]
    [16,12,8,4]
    [20,15,10,5]]
   */</span>
<span class="token comment">//--- 创建矩阵作为向量</span>
   matrix <span class="token function">matrix_a</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix <span class="token function">matrix_b</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix_a<span class="token punctuation">.</span><span class="token function">Col</span><span class="token punctuation">(</span>vector_a<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix_b<span class="token punctuation">.</span><span class="token function">Row</span><span class="token punctuation">(</span>vector_b<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_a:\n &quot;</span><span class="token punctuation">,</span> matrix_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_b:\n &quot;</span><span class="token punctuation">,</span> matrix_b<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment">/*
   matrix_a:
   [[1]
   [2]
   [3]
   [4]
   [5]]
   matrix_b:
   [[4,3,2,1]]
   */</span>
<span class="token comment">//-- 计算两个矩阵的 GeMM 并获取相同的结果</span>
   matrix_c<span class="token punctuation">.</span><span class="token function">GeMM</span><span class="token punctuation">(</span>matrix_a<span class="token punctuation">,</span> matrix_b<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_c:\n &quot;</span><span class="token punctuation">,</span> matrix_c<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment">/*
   matrix_c:
    [[4,3,2,1]
    [8,6,4,2]
    [12,9,6,3]
    [16,12,8,4]
    [20,15,10,5]]
   */</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><p>参见</p> <p>MatMul</p> <h3 id="_7-5-3-power"><a href="#_7-5-3-power" class="header-anchor">#</a> 7.5.3  Power</h3> <p>将方阵提升整数幂。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>matrix matrix<span class="token double-colon punctuation">::</span><span class="token function">Power</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token keyword">int</span>  power      <span class="token comment">// 幂</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>参数</strong></p> <p>power</p> <p>[输入]  指数可以是任何整数、正数、负数或零。</p> <p><strong>返回值</strong></p> <p>矩阵。</p> <p><strong>注意</strong></p> <p>生成的矩阵与原始矩阵的大小相同。 当升幂为 0 时，返回单位矩阵。 正幂 n 表示原始矩阵自身乘以 n 次。 负幂 -n 表示原始矩阵先倒置，然后将倒置矩阵乘以自身 n 次。</p> <p><strong>以 MQL5 实现的矩阵升幂的简单算法：</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span> <span class="token function">MatrixPower</span><span class="token punctuation">(</span>matrix<span class="token operator">&amp;</span> c<span class="token punctuation">,</span> <span class="token keyword">const</span> matrix<span class="token operator">&amp;</span> a<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">int</span> power<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 矩阵必须是正阵</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!=</span>a<span class="token punctuation">.</span><span class="token function">Cols</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 结果矩阵的大小完全相同</span>
   ulong  rows<span class="token operator">=</span>a<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   ulong  cols<span class="token operator">=</span>a<span class="token punctuation">.</span><span class="token function">Cols</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix <span class="token function">result</span><span class="token punctuation">(</span>rows<span class="token punctuation">,</span>cols<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 当幂为零时，返回单位矩阵</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>power<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
      result<span class="token punctuation">.</span><span class="token function">Identity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">else</span>
     <span class="token punctuation">{</span>
      <span class="token comment">//--- 对于负值，首先反转矩阵</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>power<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
         matrix inverted<span class="token operator">=</span>a<span class="token punctuation">.</span><span class="token function">Inv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         result<span class="token operator">=</span>inverted<span class="token punctuation">;</span>
         <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">&gt;</span>power<span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span>
            result<span class="token operator">=</span>result<span class="token punctuation">.</span><span class="token function">MatMul</span><span class="token punctuation">(</span>inverted<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token keyword">else</span>
        <span class="token punctuation">{</span>
         result<span class="token operator">=</span>a<span class="token punctuation">;</span>
         <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>power<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
            result<span class="token operator">=</span>result<span class="token punctuation">.</span><span class="token function">MatMul</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
<span class="token comment">//---</span>
   c<span class="token operator">=</span>result<span class="token punctuation">;</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p><strong>MQL5 示例:</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>  matrix i<span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;i:\n&quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;i.Power(3):\n&quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">.</span><span class="token function">Power</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;i.Power(0):\n&quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">.</span><span class="token function">Power</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;i.Power(-3):\n&quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">.</span><span class="token function">Power</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">/*
  i:
  [[0,1]
   [-1,0]]
 
  i.Power(3):
  [[0,-1]
   [1,0]]
 
  i.Power(0):
  [[1,0]
   [0,1]]
 
  i.Power(-3):
  [[0, -1]
   [1,0]]
  */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p><strong>Python 示例:</strong></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> numpy<span class="token punctuation">.</span>linalg <span class="token keyword">import</span> matrix_power
 
<span class="token comment"># matrix equiv. of the imaginary unit</span>
i <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;i:\n&quot;</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span>
 
<span class="token comment"># should = -i</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_power(i, 3) :\n&quot;</span><span class="token punctuation">,</span>matrix_power<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
 
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_power(i, 0):\n&quot;</span><span class="token punctuation">,</span>matrix_power<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 
<span class="token comment"># should = 1/(-i) = i, but w/ f.p. elements</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_power(i, -3):\n&quot;</span><span class="token punctuation">,</span>matrix_power<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 
i<span class="token punctuation">:</span>
 <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0</span>  <span class="token number">1</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span>  <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
 
matrix_power<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">:</span>
 <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">1</span>  <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
 
matrix_power<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
 <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span> <span class="token number">0</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
 
matrix_power<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
 <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0.</span>  <span class="token number">1.</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1.</span>  <span class="token number">0.</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h3 id="_7-5-4-dot"><a href="#_7-5-4-dot" class="header-anchor">#</a> 7.5.4  Dot</h3> <p>两个向量的点积。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">double</span> vector<span class="token double-colon punctuation">::</span><span class="token function">Dot</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> vector<span class="token operator">&amp;</span>  b      <span class="token comment">// 第二个向量</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>参数</strong></p> <p>b</p> <p>[输入]  向量。</p> <p><strong>返回值</strong></p> <p>标量。</p> <p><strong>注意</strong></p> <p>两个矩阵的点积是矩阵乘积 matrix::MatMul()。</p> <p><strong>以 MQL5 实现的向量标量乘积的简单算法：</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">double</span> <span class="token function">VectorDot</span><span class="token punctuation">(</span><span class="token keyword">const</span> vector<span class="token operator">&amp;</span> vector_a<span class="token punctuation">,</span> <span class="token keyword">const</span> vector<span class="token operator">&amp;</span> vector_b<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   <span class="token keyword">double</span> dot<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
 
   <span class="token keyword">if</span><span class="token punctuation">(</span>vector_a<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span>vector_b<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span>ulong i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>vector_a<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
         dot<span class="token operator">+=</span>vector_a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">*</span>vector_b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
 
   <span class="token keyword">return</span><span class="token punctuation">(</span>dot<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>MQL5 示例:</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   <span class="token keyword">for</span><span class="token punctuation">(</span>ulong i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>rows<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      vector v1<span class="token operator">=</span>a<span class="token punctuation">.</span><span class="token function">Row</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span>ulong j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span>cols<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
         vector v2<span class="token operator">=</span>b<span class="token punctuation">.</span><span class="token function">Row</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
         result<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>v1<span class="token punctuation">.</span><span class="token function">Dot</span><span class="token punctuation">(</span>v2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>Python 示例:</strong></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
 
a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
b <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span>
 
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token number">6</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_7-5-5-kron"><a href="#_7-5-5-kron" class="header-anchor">#</a> 7.5.5  Kron</h3> <p>返回两个矩阵的克罗内克（Kronecker）乘积，矩阵和向量，向量和矩阵、或两个向量。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>matrix matrix<span class="token double-colon punctuation">::</span><span class="token function">Kron</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> matrix<span class="token operator">&amp;</span>  b      <span class="token comment">// 第二个矩阵</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
matrix matrix<span class="token double-colon punctuation">::</span><span class="token function">Kron</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> vector<span class="token operator">&amp;</span>  b      <span class="token comment">// 向量</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
matrix vector<span class="token double-colon punctuation">::</span><span class="token function">Kron</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> matrix<span class="token operator">&amp;</span>  b      <span class="token comment">// 矩阵</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
matrix vector<span class="token double-colon punctuation">::</span><span class="token function">Kron</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> vector<span class="token operator">&amp;</span>  b      <span class="token comment">// 第二个向量</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p><strong>参数</strong></p> <p>b</p> <p>[输入]  第二个矩阵。</p> <p><strong>返回值</strong></p> <p>矩阵。</p> <p><strong>注意</strong></p> <p>克罗内克（Kronecker）乘积也称为块矩阵乘法。</p> <p><strong>以 MQL5 实现的两个矩阵克罗内克（Kronecker）乘积的简单算法：</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>matrix <span class="token function">MatrixKronecker</span><span class="token punctuation">(</span><span class="token keyword">const</span> matrix<span class="token operator">&amp;</span> matrix_a<span class="token punctuation">,</span><span class="token keyword">const</span> matrix<span class="token operator">&amp;</span> matrix_b<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   ulong  M<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   ulong  N<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Cols</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   ulong  P<span class="token operator">=</span>matrix_b<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   ulong  Q<span class="token operator">=</span>matrix_b<span class="token punctuation">.</span><span class="token function">Cols</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix <span class="token function">matrix_c</span><span class="token punctuation">(</span>M<span class="token operator">*</span>P<span class="token punctuation">,</span>N<span class="token operator">*</span>Q<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token keyword">for</span><span class="token punctuation">(</span>ulong m<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> m<span class="token operator">&lt;</span>M<span class="token punctuation">;</span> m<span class="token operator">++</span><span class="token punctuation">)</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span>ulong n<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> n<span class="token operator">&lt;</span>N<span class="token punctuation">;</span> n<span class="token operator">++</span><span class="token punctuation">)</span>
         <span class="token keyword">for</span><span class="token punctuation">(</span>ulong p<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> p<span class="token operator">&lt;</span>P<span class="token punctuation">;</span> p<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span>ulong q<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> q<span class="token operator">&lt;</span>Q<span class="token punctuation">;</span> q<span class="token operator">++</span><span class="token punctuation">)</span>
               matrix_c<span class="token punctuation">[</span>m<span class="token operator">*</span>P<span class="token operator">+</span>p<span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token operator">*</span>Q<span class="token operator">+</span>q<span class="token punctuation">]</span><span class="token operator">=</span>matrix_a<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">*</span> matrix_b<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">[</span>q<span class="token punctuation">]</span><span class="token punctuation">;</span>
 
   <span class="token keyword">return</span><span class="token punctuation">(</span>matrix_c<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p><strong>MQL5 示例:</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrix a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   matrix b<span class="token operator">=</span>matrix<span class="token double-colon punctuation">::</span><span class="token function">Identity</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector v<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
 
   <span class="token function">Print</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span><span class="token function">Kron</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span><span class="token function">Kron</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">/*
   [[1,0,2,0,3,0]
    [0,1,0,2,0,3]
    [4,0,5,0,6,0]
    [0,4,0,5,0,6]]
 
   [[1,2,2,4,3,6]
    [4,8,5,10,6,12]]
  */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p><strong>Python 示例:</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">import</span> <span class="token module">numpy</span> as np
 
A <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token function">arange</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reshape</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
B <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token function">identity</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
V <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span>
<span class="token function">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token function">kron</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> B<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token function">kron</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> V<span class="token punctuation">)</span><span class="token punctuation">)</span>
 
<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1.</span> <span class="token number">0.</span> <span class="token number">2.</span> <span class="token number">0.</span> <span class="token number">3.</span> <span class="token number">0.</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.</span> <span class="token number">1.</span> <span class="token number">0.</span> <span class="token number">2.</span> <span class="token number">0.</span> <span class="token number">3.</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">4.</span> <span class="token number">0.</span> <span class="token number">5.</span> <span class="token number">0.</span> <span class="token number">6.</span> <span class="token number">0.</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.</span> <span class="token number">4.</span> <span class="token number">0.</span> <span class="token number">5.</span> <span class="token number">0.</span> <span class="token number">6.</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
 
<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">1</span>  <span class="token number">2</span>  <span class="token number">2</span>  <span class="token number">4</span>  <span class="token number">3</span>  <span class="token number">6</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">4</span>  <span class="token number">8</span>  <span class="token number">5</span> <span class="token number">10</span>  <span class="token number">6</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="_7-5-6-inner"><a href="#_7-5-6-inner" class="header-anchor">#</a> 7.5.6  Inner</h3> <p>两个矩阵的内积。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>matrix matrix<span class="token double-colon punctuation">::</span><span class="token function">Inner</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> matrix<span class="token operator">&amp;</span>  b      <span class="token comment">// 第二个矩阵</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>参数</strong></p> <p>b</p> <p>[输入]  矩阵。</p> <p><strong>返回值</strong></p> <p>矩阵。</p> <p><strong>注意</strong></p> <p>两个向量的内积是两个向量的点积 vector::Dot()。</p> <p><strong>以 MQL5 实现的两个矩阵内积的简单算法：</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span> <span class="token function">MatrixInner</span><span class="token punctuation">(</span>matrix<span class="token operator">&amp;</span> c<span class="token punctuation">,</span> <span class="token keyword">const</span> matrix<span class="token operator">&amp;</span> a<span class="token punctuation">,</span> <span class="token keyword">const</span> matrix<span class="token operator">&amp;</span> b<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 列数必须相等</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span><span class="token function">Cols</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!=</span>b<span class="token punctuation">.</span><span class="token function">Cols</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 所得矩阵的大小取决于每个矩阵中向量的数量</span>
   ulong  rows<span class="token operator">=</span>a<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   ulong  cols<span class="token operator">=</span>b<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix <span class="token function">result</span><span class="token punctuation">(</span>rows<span class="token punctuation">,</span>cols<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//---</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>ulong i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>rows<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      vector v1<span class="token operator">=</span>a<span class="token punctuation">.</span><span class="token function">Row</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span>ulong j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span>cols<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
         vector v2<span class="token operator">=</span>b<span class="token punctuation">.</span><span class="token function">Row</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
         result<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>v1<span class="token punctuation">.</span><span class="token function">Dot</span><span class="token punctuation">(</span>v2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
<span class="token comment">//---</span>
   c<span class="token operator">=</span>result<span class="token punctuation">;</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p><strong>MQL5 示例:</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrix a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   matrix b<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   matrix c<span class="token operator">=</span>a<span class="token punctuation">.</span><span class="token function">Inner</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix a1<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   matrix c1<span class="token operator">=</span>a1<span class="token punctuation">.</span><span class="token function">Inner</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span>c1<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">/*
  [[5,14,23]
  [14,50,86]]
  [[5,14,23]]
  */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><strong>Python 示例:</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">import</span> <span class="token module">numpy</span> as np
 
A <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token function">arange</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reshape</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
B <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token function">arange</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reshape</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
A1<span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token function">arange</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token function">inner</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> B<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token function">inner</span><span class="token punctuation">(</span>A1<span class="token punctuation">,</span> B<span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="_7-5-7-outer"><a href="#_7-5-7-outer" class="header-anchor">#</a> 7.5.7  Outer</h3> <p>计算两个矩阵或两个向量的外积。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>matrix matrix<span class="token double-colon punctuation">::</span><span class="token function">Outer</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> matrix<span class="token operator">&amp;</span>  b      <span class="token comment">// 第二个矩阵</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
matrix vector<span class="token double-colon punctuation">::</span><span class="token function">Outer</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> vector<span class="token operator">&amp;</span>  b      <span class="token comment">// 第二个向量</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>参数</strong></p> <p>b</p> <p>[输入]  矩阵。</p> <p><strong>返回值</strong></p> <p>矩阵。</p> <p><strong>注意</strong></p> <p>外积，如克罗内克（Kronecker）乘积，也是一个区块矩阵（和向量）乘法。</p> <p><strong>以 MQL5 实现的两个矩阵外积的简单算法：</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>matrix <span class="token function">MatrixOuter</span><span class="token punctuation">(</span><span class="token keyword">const</span> matrix<span class="token operator">&amp;</span> matrix_a<span class="token punctuation">,</span> <span class="token keyword">const</span> matrix<span class="token operator">&amp;</span> matrix_b<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 生成的矩阵大小取决于矩阵的大小</span>
   ulong  rows<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span>matrix_a<span class="token punctuation">.</span><span class="token function">Cols</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   ulong  cols<span class="token operator">=</span>matrix_b<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span>matrix_b<span class="token punctuation">.</span><span class="token function">Cols</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix <span class="token function">matrix_c</span><span class="token punctuation">(</span>rows<span class="token punctuation">,</span>cols<span class="token punctuation">)</span><span class="token punctuation">;</span>
   ulong  cols_a<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Cols</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   ulong  cols_b<span class="token operator">=</span>matrix_b<span class="token punctuation">.</span><span class="token function">Cols</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//---</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>ulong i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>rows<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      ulong row_a<span class="token operator">=</span>i<span class="token operator">/</span>cols_a<span class="token punctuation">;</span>
      ulong col_a<span class="token operator">=</span>i<span class="token operator">%</span>cols_a<span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span>ulong j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span>cols<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
         ulong row_b<span class="token operator">=</span>j<span class="token operator">/</span>cols_b<span class="token punctuation">;</span>
         ulong col_b<span class="token operator">=</span>j<span class="token operator">%</span>cols_b<span class="token punctuation">;</span>
         matrix_c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>matrix_a<span class="token punctuation">[</span>row_a<span class="token punctuation">]</span><span class="token punctuation">[</span>col_a<span class="token punctuation">]</span> <span class="token operator">*</span> matrix_b<span class="token punctuation">[</span>row_b<span class="token punctuation">]</span><span class="token punctuation">[</span>col_b<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
<span class="token comment">//---</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span>matrix_c<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p><strong>MQL5 示例:</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   vector vector_a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   vector vector_b<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;vector_a.Outer\n&quot;</span><span class="token punctuation">,</span>vector_a<span class="token punctuation">.</span><span class="token function">Outer</span><span class="token punctuation">(</span>vector_b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;vector_a.Kron\n&quot;</span><span class="token punctuation">,</span>vector_a<span class="token punctuation">.</span><span class="token function">Kron</span><span class="token punctuation">(</span>vector_b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   matrix matrix_a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   matrix matrix_b<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_a.Outer\n&quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">.</span><span class="token function">Outer</span><span class="token punctuation">(</span>matrix_b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_a.Kron\n&quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">.</span><span class="token function">Kron</span><span class="token punctuation">(</span>matrix_b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">/*
   vector_a.Outer
   [[0,0,0,0,0,0,0]
    [0,1,2,3,4,5,6]
    [0,2,4,6,8,10,12]
    [0,3,6,9,12,15,18]
    [0,4,8,12,16,20,24]
    [0,5,10,15,20,25,30]]
   vector_a.Kron
   [[0,0,0,0,0,0,0,0,1,2,3,4,5,6,0,2,4,6,8,10,12,0,3,6,9,12,15,18,0,4,8,12,16,20,24,0,5,10,15,20,25,30]]
   matrix_a.Outer
   [[0,0,0,0,0,0,0,0,0]
    [0,1,2,3,4,5,6,7,8]
    [0,2,4,6,8,10,12,14,16]
    [0,3,6,9,12,15,18,21,24]
    [0,4,8,12,16,20,24,28,32]
    [0,5,10,15,20,25,30,35,40]]
   matrix_a.Kron
   [[0,0,0,0,1,2,0,2,4]
    [0,0,0,3,4,5,6,8,10]
    [0,0,0,6,7,8,12,14,16]
    [0,3,6,0,4,8,0,5,10]
    [9,12,15,12,16,20,15,20,25]
    [18,21,24,24,28,32,30,35,40]]
   */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p><strong>Python 示例:</strong></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
 
A <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
B <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;np.outer&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>outer<span class="token punctuation">(</span>A<span class="token punctuation">,</span> B<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;np.kron&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>kron<span class="token punctuation">(</span>A<span class="token punctuation">,</span> B<span class="token punctuation">)</span><span class="token punctuation">)</span>
 
A <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
B <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;np.outer&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>outer<span class="token punctuation">(</span>A<span class="token punctuation">,</span> B<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;np.kron&quot;</span><span class="token punctuation">)</span>
 
np<span class="token punctuation">.</span>outer
<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">0</span>  <span class="token number">1</span>  <span class="token number">2</span>  <span class="token number">3</span>  <span class="token number">4</span>  <span class="token number">5</span>  <span class="token number">6</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">0</span>  <span class="token number">2</span>  <span class="token number">4</span>  <span class="token number">6</span>  <span class="token number">8</span> <span class="token number">10</span> <span class="token number">12</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">0</span>  <span class="token number">3</span>  <span class="token number">6</span>  <span class="token number">9</span> <span class="token number">12</span> <span class="token number">15</span> <span class="token number">18</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">0</span>  <span class="token number">4</span>  <span class="token number">8</span> <span class="token number">12</span> <span class="token number">16</span> <span class="token number">20</span> <span class="token number">24</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">0</span>  <span class="token number">5</span> <span class="token number">10</span> <span class="token number">15</span> <span class="token number">20</span> <span class="token number">25</span> <span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
np<span class="token punctuation">.</span>kron
<span class="token punctuation">[</span> <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">1</span>  <span class="token number">2</span>  <span class="token number">3</span>  <span class="token number">4</span>  <span class="token number">5</span>  <span class="token number">6</span>  <span class="token number">0</span>  <span class="token number">2</span>  <span class="token number">4</span>  <span class="token number">6</span>  <span class="token number">8</span> <span class="token number">10</span> <span class="token number">12</span>  <span class="token number">0</span>  <span class="token number">3</span>  <span class="token number">6</span>
  <span class="token number">9</span> <span class="token number">12</span> <span class="token number">15</span> <span class="token number">18</span>  <span class="token number">0</span>  <span class="token number">4</span>  <span class="token number">8</span> <span class="token number">12</span> <span class="token number">16</span> <span class="token number">20</span> <span class="token number">24</span>  <span class="token number">0</span>  <span class="token number">5</span> <span class="token number">10</span> <span class="token number">15</span> <span class="token number">20</span> <span class="token number">25</span> <span class="token number">30</span><span class="token punctuation">]</span>
np<span class="token punctuation">.</span>outer
<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">0</span>  <span class="token number">1</span>  <span class="token number">2</span>  <span class="token number">3</span>  <span class="token number">4</span>  <span class="token number">5</span>  <span class="token number">6</span>  <span class="token number">7</span>  <span class="token number">8</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">0</span>  <span class="token number">2</span>  <span class="token number">4</span>  <span class="token number">6</span>  <span class="token number">8</span> <span class="token number">10</span> <span class="token number">12</span> <span class="token number">14</span> <span class="token number">16</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">0</span>  <span class="token number">3</span>  <span class="token number">6</span>  <span class="token number">9</span> <span class="token number">12</span> <span class="token number">15</span> <span class="token number">18</span> <span class="token number">21</span> <span class="token number">24</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">0</span>  <span class="token number">4</span>  <span class="token number">8</span> <span class="token number">12</span> <span class="token number">16</span> <span class="token number">20</span> <span class="token number">24</span> <span class="token number">28</span> <span class="token number">32</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">0</span>  <span class="token number">5</span> <span class="token number">10</span> <span class="token number">15</span> <span class="token number">20</span> <span class="token number">25</span> <span class="token number">30</span> <span class="token number">35</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
np<span class="token punctuation">.</span>kron
<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">1</span>  <span class="token number">2</span>  <span class="token number">0</span>  <span class="token number">2</span>  <span class="token number">4</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">3</span>  <span class="token number">4</span>  <span class="token number">5</span>  <span class="token number">6</span>  <span class="token number">8</span> <span class="token number">10</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">6</span>  <span class="token number">7</span>  <span class="token number">8</span> <span class="token number">12</span> <span class="token number">14</span> <span class="token number">16</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">0</span>  <span class="token number">3</span>  <span class="token number">6</span>  <span class="token number">0</span>  <span class="token number">4</span>  <span class="token number">8</span>  <span class="token number">0</span>  <span class="token number">5</span> <span class="token number">10</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">9</span> <span class="token number">12</span> <span class="token number">15</span> <span class="token number">12</span> <span class="token number">16</span> <span class="token number">20</span> <span class="token number">15</span> <span class="token number">20</span> <span class="token number">25</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">18</span> <span class="token number">21</span> <span class="token number">24</span> <span class="token number">24</span> <span class="token number">28</span> <span class="token number">32</span> <span class="token number">30</span> <span class="token number">35</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><h3 id="_7-5-8-corrcoef"><a href="#_7-5-8-corrcoef" class="header-anchor">#</a> 7.5.8  CorrCoef</h3> <p>计算皮尔逊（Pearson）相关系数（线性相关系数）。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>matrix matrix<span class="token double-colon punctuation">::</span><span class="token function">CorrCoef</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token keyword">bool</span>    rowvar<span class="token operator">=</span><span class="token boolean">true</span>  <span class="token comment">// 所观测向量的行或列</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
scalar vector<span class="token double-colon punctuation">::</span><span class="token function">CorrCoef</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> vector<span class="token operator">&amp;</span>  b           <span class="token comment">// 第二个向量</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>返回值</strong></p> <p>皮尔逊（Pearson）乘积矩相关系数。</p> <p><strong>注意</strong></p> <p>相关系数在 [-1, 1] 范围内。</p> <p>由于浮点舍入，生成的数组可能不是埃尔米特（Hermitian）数组，对角元素也许不是 1，并且元素也许不满足不等式 abs(a) &lt;= 1。 实部和虚部被剪裁到区间 [-1, 1]，以便试图改善这种情况，但在复杂情况下并无多大帮助。</p> <p><strong>以 MQL5 实现的计算两个向量相关系数的简单算法：</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">double</span> <span class="token function">VectorCorrelation</span><span class="token punctuation">(</span><span class="token keyword">const</span> vector<span class="token operator">&amp;</span> vector_x<span class="token punctuation">,</span><span class="token keyword">const</span> vector<span class="token operator">&amp;</span> vector_y<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   ulong n<span class="token operator">=</span>vector_x<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;</span>vector_y<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> vector_x<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> vector_y<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>n<span class="token operator">&lt;=</span><span class="token number">1</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   ulong  i<span class="token punctuation">;</span>
   <span class="token keyword">double</span> xmean<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
   <span class="token keyword">double</span> ymean<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">MathIsValidNumber</span><span class="token punctuation">(</span>vector_x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">MathIsValidNumber</span><span class="token punctuation">(</span>vector_y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      xmean<span class="token operator">+=</span>vector_x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
      ymean<span class="token operator">+=</span>vector_y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
   xmean<span class="token operator">/=</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>n<span class="token punctuation">;</span>
   ymean<span class="token operator">/=</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>n<span class="token punctuation">;</span>
 
   <span class="token keyword">double</span> s<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
   <span class="token keyword">double</span> xv<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
   <span class="token keyword">double</span> yv<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
   <span class="token keyword">double</span> t1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
   <span class="token keyword">double</span> t2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token comment">//--- 计算</span>
   s<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      t1<span class="token operator">=</span>vector_x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span>xmean<span class="token punctuation">;</span>
      t2<span class="token operator">=</span>vector_y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span>ymean<span class="token punctuation">;</span>
      xv<span class="token operator">+=</span>t1<span class="token operator">*</span>t1<span class="token punctuation">;</span>
      yv<span class="token operator">+=</span>t2<span class="token operator">*</span>t2<span class="token punctuation">;</span>
      s<span class="token operator">+=</span>t1<span class="token operator">*</span>t2<span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 检查</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>xv<span class="token operator">==</span><span class="token number">0</span> <span class="token operator">||</span> yv<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 返回结果</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span>s<span class="token operator">/</span><span class="token punctuation">(</span><span class="token function">MathSqrt</span><span class="token punctuation">(</span>xv<span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">MathSqrt</span><span class="token punctuation">(</span>yv<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><p><strong>MQL5 示例:</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   vectorf vector_a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   vectorf vector_b<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2.5</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;vectors correlation &quot;</span><span class="token punctuation">,</span>vector_a<span class="token punctuation">.</span><span class="token function">CorrCoef</span><span class="token punctuation">(</span>vector_b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//---</span>
   matrixf matrix_a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2.5</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix rows correlation\n&quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">.</span><span class="token function">CorrCoef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrixf matrix_a2<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Transpose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;transposed matrix cols correlation\n&quot;</span><span class="token punctuation">,</span>matrix_a2<span class="token punctuation">.</span><span class="token function">CorrCoef</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrixf matrix_a3<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">1.0f</span><span class="token punctuation">,</span> <span class="token number">2.0f</span><span class="token punctuation">,</span> <span class="token number">3.0f</span><span class="token punctuation">,</span> <span class="token number">4.0f</span><span class="token punctuation">,</span> <span class="token number">5.0f</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                      <span class="token punctuation">{</span><span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">1.0f</span><span class="token punctuation">,</span> <span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token number">2.0f</span><span class="token punctuation">,</span> <span class="token number">2.5f</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                      <span class="token punctuation">{</span><span class="token number">0.1f</span><span class="token punctuation">,</span> <span class="token number">1.0f</span><span class="token punctuation">,</span> <span class="token number">2.0f</span><span class="token punctuation">,</span> <span class="token number">1.0f</span><span class="token punctuation">,</span> <span class="token number">0.3f</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;rows correlation\n&quot;</span><span class="token punctuation">,</span>matrix_a3<span class="token punctuation">.</span><span class="token function">CorrCoef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;cols correlation\n&quot;</span><span class="token punctuation">,</span>matrix_a3<span class="token punctuation">.</span><span class="token function">CorrCoef</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">/*
   vectors correlation 0.9149913787841797
   matrix rows correlation
   [[1,0.91499138]
    [0.91499138,1]]
   transposed matrix cols correlation
   [[1,0.91499138]
    [0.91499138,1]]
   rows correlation
   [[1,0.91499138,0.08474271]
    [0.91499138,1,-0.17123166]
    [0.08474271,-0.17123166,1]]
   cols correlation
   [[1,0.99587059,0.85375023,0.91129309,0.83773589]
    [0.99587059,1,0.80295509,0.94491106,0.88385159]
    [0.85375023,0.80295509,1,0.56362146,0.43088508]
    [0.91129309,0.94491106,0.56362146,1,0.98827404]
    [0.83773589,0.88385159,0.43088508,0.98827404,1]]
   */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p><strong>Python 示例:</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">import</span> <span class="token module">numpy</span> as np
va<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span>
vb<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2.5</span><span class="token punctuation">]</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;vectors correlation&quot;</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token function">corrcoef</span><span class="token punctuation">(</span>va<span class="token punctuation">,</span>vb<span class="token punctuation">)</span><span class="token punctuation">)</span>
 
ma<span class="token operator">=</span>np<span class="token punctuation">.</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
ma<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">]</span><span class="token operator">=</span>va
ma<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">]</span><span class="token operator">=</span>vb
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix rows correlation&quot;</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token function">corrcoef</span><span class="token punctuation">(</span>ma<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;transposed matrix cols correlation&quot;</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token function">corrcoef</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token function">transpose</span><span class="token punctuation">(</span>ma<span class="token punctuation">)</span><span class="token punctuation">,</span>rowvar<span class="token operator">=</span>False<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
 
ma1<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2.5</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0.1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0.2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0.3</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;rows correlation\n&quot;</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span><span class="token function">corrcoef</span><span class="token punctuation">(</span>ma1<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;cols correlation\n&quot;</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span><span class="token function">corrcoef</span><span class="token punctuation">(</span>ma1<span class="token punctuation">,</span>rowvar<span class="token operator">=</span>False<span class="token punctuation">)</span><span class="token punctuation">)</span>
 
transposed matrix cols correlation
<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1.</span>         <span class="token number">0.91499142</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.91499142</span> <span class="token number">1.</span>        <span class="token punctuation">]</span><span class="token punctuation">]</span>
 
rows correlation
 <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1.</span>         <span class="token number">0.91499142</span> <span class="token number">0.1424941</span> <span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.91499142</span> <span class="token number">1.</span>         <span class="token number">0.39657517</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.1424941</span>  <span class="token number">0.39657517</span> <span class="token number">1.</span>        <span class="token punctuation">]</span><span class="token punctuation">]</span>
cols correlation
 <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1.</span>         <span class="token number">0.99587059</span> <span class="token number">0.98226063</span> <span class="token number">0.91129318</span> <span class="token number">0.83773586</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.99587059</span> <span class="token number">1.</span>         <span class="token number">0.99522839</span> <span class="token number">0.94491118</span> <span class="token number">0.88385151</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.98226063</span> <span class="token number">0.99522839</span> <span class="token number">1.</span>         <span class="token number">0.97234063</span> <span class="token number">0.92527551</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.91129318</span> <span class="token number">0.94491118</span> <span class="token number">0.97234063</span> <span class="token number">1.</span>         <span class="token number">0.98827406</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.83773586</span> <span class="token number">0.88385151</span> <span class="token number">0.92527551</span> <span class="token number">0.98827406</span> <span class="token number">1.</span>        <span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><h3 id="_7-5-9-cov"><a href="#_7-5-9-cov" class="header-anchor">#</a> 7.5.9  Cov</h3> <p>计算协方差矩阵。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>matrix matrix<span class="token double-colon punctuation">::</span><span class="token function">Cov</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token keyword">bool</span>    rowvar<span class="token operator">=</span><span class="token boolean">true</span>  <span class="token comment">// 所观测向量的行或列</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
matrix vector<span class="token double-colon punctuation">::</span><span class="token function">Cov</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> vector<span class="token operator">&amp;</span>  b           <span class="token comment">// 第二个向量</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>参数</strong></p> <p>b</p> <p>[输入]  第二个向量。</p> <p><strong>注意</strong></p> <p>计算协方差矩阵。</p> <p><strong>以 MQL5 实现的计算两个向量的协方差矩阵的简单算法：</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span> <span class="token function">VectorCovariation</span><span class="token punctuation">(</span><span class="token keyword">const</span> vector<span class="token operator">&amp;</span> vector_a<span class="token punctuation">,</span><span class="token keyword">const</span> vector<span class="token operator">&amp;</span> vector_b<span class="token punctuation">,</span>matrix<span class="token operator">&amp;</span> matrix_c<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   <span class="token keyword">int</span> i<span class="token punctuation">,</span>j<span class="token punctuation">;</span>
   <span class="token keyword">int</span> m<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span> n<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>vector_a<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;</span>vector_b<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span>vector_a<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>vector_b<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 检查</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>n<span class="token operator">&lt;=</span><span class="token number">1</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">MathIsValidNumber</span><span class="token punctuation">(</span>vector_a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">MathIsValidNumber</span><span class="token punctuation">(</span>vector_b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//---</span>
   matrix <span class="token function">matrix_x</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix_x<span class="token punctuation">.</span><span class="token function">Row</span><span class="token punctuation">(</span>vector_a<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix_x<span class="token punctuation">.</span><span class="token function">Row</span><span class="token punctuation">(</span>vector_b<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector t<span class="token operator">=</span>vector<span class="token double-colon punctuation">::</span><span class="token function">Zeros</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 计算</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>m<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span>n<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
         t<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+=</span>matrix_x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">/</span><span class="token keyword">double</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>m<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span>n<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
         matrix_x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">-=</span>t<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">//--- syrk C=alpha*A^H*A+beta*C (beta=0 且不考虑)</span>
   matrix_c<span class="token operator">=</span>matrix<span class="token double-colon punctuation">::</span><span class="token function">Zeros</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>m<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span>n<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
         <span class="token keyword">double</span> v<span class="token operator">=</span>matrix_x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">/</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i_<span class="token operator">=</span>i<span class="token punctuation">;</span> i_<span class="token operator">&lt;</span>m<span class="token punctuation">;</span> i_<span class="token operator">++</span><span class="token punctuation">)</span>
            matrix_c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>i_<span class="token punctuation">]</span><span class="token operator">+=</span>v<span class="token operator">*</span>matrix_x<span class="token punctuation">[</span>i_<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 强制对称性</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>m<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span>m<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
         matrix_c<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>matrix_c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">//---</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><p><strong>MQL5 示例:</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrix matrix_a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">2.1</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">1.1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">0.12</span><span class="token punctuation">,</span><span class="token number">4.3</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;covariation cols\n&quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">.</span><span class="token function">Cov</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;covariation rows\n&quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">.</span><span class="token function">Cov</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   
   vector vector_a<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Col</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector vector_b<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Col</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;covariation vectors\n&quot;</span><span class="token punctuation">,</span>vector_a<span class="token punctuation">.</span><span class="token function">Cov</span><span class="token punctuation">(</span>vector_b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">/*
   covariation cols
   [[2.144133333333333,-4.286]
    [-4.286,11.71]]
   covariation rows
   [[13.005,5.355,-10.659]
    [5.355,2.205,-4.389]
    [-10.659,-4.389,8.736199999999998]]
   covariation vectors
   [[2.144133333333333,-4.286]
    [-4.286,11.71]]
  */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p><strong>Python 示例:</strong></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
matrix_a<span class="token operator">=</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">2.1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1.1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0.12</span><span class="token punctuation">,</span><span class="token number">4.3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
matrix_c<span class="token operator">=</span>np<span class="token punctuation">.</span>cov<span class="token punctuation">(</span>matrix_a<span class="token punctuation">,</span>rowvar<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;covariation cols\n&quot;</span><span class="token punctuation">,</span>matrix_c<span class="token punctuation">)</span>
matrix_c2<span class="token operator">=</span>np<span class="token punctuation">.</span>cov<span class="token punctuation">(</span>matrix_a<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;covariation rows\n&quot;</span><span class="token punctuation">,</span>matrix_c2<span class="token punctuation">)</span>
 
vector_a<span class="token operator">=</span>matrix_a<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
vector_b<span class="token operator">=</span>matrix_a<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>
matrix_c3<span class="token operator">=</span>np<span class="token punctuation">.</span>cov<span class="token punctuation">(</span>vector_a<span class="token punctuation">,</span>vector_b<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;covariation vectors\n&quot;</span><span class="token punctuation">,</span>matrix_c3<span class="token punctuation">)</span>
 
covariation cols
 <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">2.14413333</span> <span class="token operator">-</span><span class="token number">4.286</span>     <span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4.286</span>      <span class="token number">11.71</span>      <span class="token punctuation">]</span><span class="token punctuation">]</span>
covariation rows
 <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">13.005</span>    <span class="token number">5.355</span>  <span class="token operator">-</span><span class="token number">10.659</span> <span class="token punctuation">]</span>
 <span class="token punctuation">[</span>  <span class="token number">5.355</span>    <span class="token number">2.205</span>   <span class="token operator">-</span><span class="token number">4.389</span> <span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">10.659</span>   <span class="token operator">-</span><span class="token number">4.389</span>    <span class="token number">8.7362</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
covariation vectors
 <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">2.14413333</span> <span class="token operator">-</span><span class="token number">4.286</span>     <span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4.286</span>      <span class="token number">11.71</span>      <span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="_7-5-10-correlate"><a href="#_7-5-10-correlate" class="header-anchor">#</a> 7.5.10  Correlate</h3> <p>计算两个向量的互相关。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>vector vector<span class="token double-colon punctuation">::</span><span class="token function">Correlate</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> vector<span class="token operator">&amp;</span>          v<span class="token punctuation">,</span>        <span class="token comment">// 向量</span>
  ENUM_VECTOR_CONVOLVE   mode      <span class="token comment">// 模式</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>参数</strong></p> <p>v</p> <p>[输入]  第二个向量。</p> <p>mode</p> <p>[输入]  “mode” 参数判定线性卷积计算模式。 数值来自 ENUM_VECTOR_CONVOLVE 枚举。</p> <p><strong>返回值</strong></p> <p>两个向量的互相关。</p> <p><strong>注意</strong></p> <p>“mode” 参数判定线性卷积计算模式。</p> <p><strong>以 MQL5 实现的计算两个向量相关系数的简单算法：</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>vector <span class="token function">VectorCrossCorrelationFull</span><span class="token punctuation">(</span><span class="token keyword">const</span> vector<span class="token operator">&amp;</span> a<span class="token punctuation">,</span><span class="token keyword">const</span> vector<span class="token operator">&amp;</span> b<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   <span class="token keyword">int</span>    m<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>a<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span>    n<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>b<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span>    size<span class="token operator">=</span>m<span class="token operator">+</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
   vector c<span class="token operator">=</span>vector<span class="token double-colon punctuation">::</span><span class="token function">Zeros</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i_<span class="token operator">=</span>i<span class="token punctuation">;</span> i_<span class="token operator">&lt;</span>i<span class="token operator">+</span>m<span class="token punctuation">;</span> i_<span class="token operator">++</span><span class="token punctuation">)</span>
         c<span class="token punctuation">[</span>i_<span class="token punctuation">]</span><span class="token operator">+=</span>b<span class="token punctuation">[</span>n<span class="token operator">-</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>a<span class="token punctuation">[</span>i_<span class="token operator">-</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
 
   <span class="token keyword">return</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//|                                                                  |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
vector <span class="token function">VectorCrossCorrelationSame</span><span class="token punctuation">(</span><span class="token keyword">const</span> vector<span class="token operator">&amp;</span> a<span class="token punctuation">,</span><span class="token keyword">const</span> vector<span class="token operator">&amp;</span> b<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   <span class="token keyword">int</span>    m<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>a<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span>    n<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>b<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span>    size<span class="token operator">=</span><span class="token function">MathMax</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector c<span class="token operator">=</span>vector<span class="token double-colon punctuation">::</span><span class="token function">Zeros</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i_<span class="token operator">=</span>i<span class="token punctuation">;</span> i_<span class="token operator">&lt;</span>i<span class="token operator">+</span>m<span class="token punctuation">;</span> i_<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
         <span class="token keyword">int</span> k<span class="token operator">=</span>i_<span class="token operator">-</span>size<span class="token operator">/</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>k<span class="token operator">&gt;=</span><span class="token number">0</span> <span class="token operator">&amp;&amp;</span> k<span class="token operator">&lt;</span>size<span class="token punctuation">)</span>
            c<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">+=</span>b<span class="token punctuation">[</span>n<span class="token operator">-</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>a<span class="token punctuation">[</span>i_<span class="token operator">-</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
 
   <span class="token keyword">return</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//|                                                                  |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
vector <span class="token function">VectorCrossCorrelationValid</span><span class="token punctuation">(</span><span class="token keyword">const</span> vector<span class="token operator">&amp;</span> a<span class="token punctuation">,</span><span class="token keyword">const</span> vector<span class="token operator">&amp;</span> b<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   <span class="token keyword">int</span>    m<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>a<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span>    n<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>b<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span>    size<span class="token operator">=</span><span class="token function">MathMax</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">MathMin</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
   vector c<span class="token operator">=</span>vector<span class="token double-colon punctuation">::</span><span class="token function">Zeros</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i_<span class="token operator">=</span>i<span class="token punctuation">;</span> i_<span class="token operator">&lt;</span>i<span class="token operator">+</span>m<span class="token punctuation">;</span> i_<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
         <span class="token keyword">int</span> k<span class="token operator">=</span>i_<span class="token operator">-</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>k<span class="token operator">&gt;=</span><span class="token number">0</span> <span class="token operator">&amp;&amp;</span> k<span class="token operator">&lt;</span>size<span class="token punctuation">)</span>
            c<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">+=</span>b<span class="token punctuation">[</span>n<span class="token operator">-</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>a<span class="token punctuation">[</span>i_<span class="token operator">-</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
 
   <span class="token keyword">return</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br></div></div><p><strong>MQL5 示例:</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   vector a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   vector b<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;full\n&quot;</span><span class="token punctuation">,</span>a<span class="token punctuation">.</span><span class="token function">Correlate</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span>VECTOR_CONVOLVE_FULL<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;same\n&quot;</span><span class="token punctuation">,</span>a<span class="token punctuation">.</span><span class="token function">Correlate</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span>VECTOR_CONVOLVE_SAME<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;valid\n&quot;</span><span class="token punctuation">,</span>a<span class="token punctuation">.</span><span class="token function">Correlate</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span>VECTOR_CONVOLVE_VALID<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;full\n&quot;</span><span class="token punctuation">,</span>b<span class="token punctuation">.</span><span class="token function">Correlate</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>VECTOR_CONVOLVE_FULL<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">/*
   full
   [0.5,2,3.5,5,6.5,5,0]
   same
   [2,3.5,5,6.5,5]
   valid
   [3.5,5,6.5]
   full
   [0,5,6.5,5,3.5,2,0.5]
  */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p><strong>Python 示例:</strong></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
a<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span>
b<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">]</span>
 
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;full\n&quot;</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>correlate<span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span><span class="token string">'full'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;same\n&quot;</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>correlate<span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span><span class="token string">'same'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;valid\n&quot;</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>correlate<span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span><span class="token string">'valid'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;full\n&quot;</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>correlate<span class="token punctuation">(</span>b<span class="token punctuation">,</span>a<span class="token punctuation">,</span><span class="token string">'full'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 
full
 <span class="token punctuation">[</span><span class="token number">0.5</span> <span class="token number">2.</span>  <span class="token number">3.5</span> <span class="token number">5.</span>  <span class="token number">6.5</span> <span class="token number">5.</span>  <span class="token number">0.</span> <span class="token punctuation">]</span>
same
 <span class="token punctuation">[</span><span class="token number">2.</span>  <span class="token number">3.5</span> <span class="token number">5.</span>  <span class="token number">6.5</span> <span class="token number">5.</span> <span class="token punctuation">]</span>
valid
 <span class="token punctuation">[</span><span class="token number">3.5</span> <span class="token number">5.</span>  <span class="token number">6.5</span><span class="token punctuation">]</span>
full
 <span class="token punctuation">[</span><span class="token number">0.</span>  <span class="token number">5.</span>  <span class="token number">6.5</span> <span class="token number">5.</span>  <span class="token number">3.5</span> <span class="token number">2.</span>  <span class="token number">0.5</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="_7-5-11-convolve"><a href="#_7-5-11-convolve" class="header-anchor">#</a> 7.5.11  Convolve</h3> <p>返回两个向量的离散线性卷积</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>vector vector<span class="token double-colon punctuation">::</span><span class="token function">Convolve</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> vector<span class="token operator">&amp;</span>           v<span class="token punctuation">,</span>        <span class="token comment">// 向量</span>
  ENUM_VECTOR_CONVOLVE    mode      <span class="token comment">// 模式</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>参数</strong></p> <p>v</p> <p>[输出]  第二个向量。</p> <p>mode</p> <p>[输入]  “mode” 参数判定线性卷积计算模式 ENUM_VECTOR_CONVOLVE。</p> <p><strong>返回值</strong></p> <p>两个向量的离散，线性卷积。</p> <p><strong>以 MQL5 实现的计算两个向量卷积的简单算法：</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>vector <span class="token function">VectorConvolutionFull</span><span class="token punctuation">(</span><span class="token keyword">const</span> vector<span class="token operator">&amp;</span> a<span class="token punctuation">,</span><span class="token keyword">const</span> vector<span class="token operator">&amp;</span> b<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;</span>b<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token function">VectorConvolutionFull</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token keyword">int</span>    m<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>a<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span>    n<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>b<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span>    size<span class="token operator">=</span>m<span class="token operator">+</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
   vector c<span class="token operator">=</span>vector<span class="token double-colon punctuation">::</span><span class="token function">Zeros</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i_<span class="token operator">=</span>i<span class="token punctuation">;</span> i_<span class="token operator">&lt;</span>i<span class="token operator">+</span>m<span class="token punctuation">;</span> i_<span class="token operator">++</span><span class="token punctuation">)</span>
         c<span class="token punctuation">[</span>i_<span class="token punctuation">]</span><span class="token operator">+=</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">*</span>a<span class="token punctuation">[</span>i_<span class="token operator">-</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
 
   <span class="token keyword">return</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//|                                                                  |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
vector <span class="token function">VectorConvolutionSame</span><span class="token punctuation">(</span><span class="token keyword">const</span> vector<span class="token operator">&amp;</span> a<span class="token punctuation">,</span><span class="token keyword">const</span> vector<span class="token operator">&amp;</span> b<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;</span>b<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token function">VectorConvolutionSame</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token keyword">int</span>    m<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>a<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span>    n<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>b<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span>    size<span class="token operator">=</span><span class="token function">MathMax</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector c<span class="token operator">=</span>vector<span class="token double-colon punctuation">::</span><span class="token function">Zeros</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i_<span class="token operator">=</span>i<span class="token punctuation">;</span> i_<span class="token operator">&lt;</span>i<span class="token operator">+</span>m<span class="token punctuation">;</span> i_<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
         <span class="token keyword">int</span> k<span class="token operator">=</span>i_<span class="token operator">-</span>size<span class="token operator">/</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>k<span class="token operator">&gt;=</span><span class="token number">0</span> <span class="token operator">&amp;&amp;</span> k<span class="token operator">&lt;</span>size<span class="token punctuation">)</span>
            c<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">+=</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">*</span>a<span class="token punctuation">[</span>i_<span class="token operator">-</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
 
   <span class="token keyword">return</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//|                                                                  |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
vector <span class="token function">VectorConvolutionValid</span><span class="token punctuation">(</span><span class="token keyword">const</span> vector<span class="token operator">&amp;</span> a<span class="token punctuation">,</span><span class="token keyword">const</span> vector<span class="token operator">&amp;</span> b<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;</span>b<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token function">VectorConvolutionValid</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token keyword">int</span>    m<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>a<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span>    n<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>b<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span>    size<span class="token operator">=</span><span class="token function">MathMax</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">MathMin</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
   vector c<span class="token operator">=</span>vector<span class="token double-colon punctuation">::</span><span class="token function">Zeros</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i_<span class="token operator">=</span>i<span class="token punctuation">;</span> i_<span class="token operator">&lt;</span>i<span class="token operator">+</span>m<span class="token punctuation">;</span> i_<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
         <span class="token keyword">int</span> k<span class="token operator">=</span>i_<span class="token operator">-</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>k<span class="token operator">&gt;=</span><span class="token number">0</span> <span class="token operator">&amp;&amp;</span> k<span class="token operator">&lt;</span>size<span class="token punctuation">)</span>
            c<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">+=</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">*</span>a<span class="token punctuation">[</span>i_<span class="token operator">-</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
 
   <span class="token keyword">return</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br></div></div><p><strong>MQL5 示例:</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>  vector a<span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  vector b<span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
 
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;full\n&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span><span class="token function">Convolve</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> VECTOR_CONVOLVE_FULL<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;same\n&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span><span class="token function">Convolve</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> VECTOR_CONVOLVE_SAME<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;valid\n&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span><span class="token function">Convolve</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> VECTOR_CONVOLVE_VALID<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">/*
   full
   [0,1,2.5,4,5.5,7,2.5]
   same
   [1,2.5,4,5.5,7]
   valid
   [2.5,4,5.5]
  */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p><strong>Python 示例:</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">import</span> <span class="token module">numpy</span> as np
a<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span>
b<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">]</span>
 
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;full\n&quot;</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span><span class="token function">convolve</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span><span class="token char">'full'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;same\n&quot;</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span><span class="token function">convolve</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span><span class="token char">'same'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;valid\n&quot;</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span><span class="token function">convolve</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span><span class="token char">'valid'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
 
full
 <span class="token punctuation">[</span><span class="token number">0.</span>  <span class="token number">1.</span>  <span class="token number">2.5</span> <span class="token number">4.</span>  <span class="token number">5.5</span> <span class="token number">7.</span>  <span class="token number">2.5</span><span class="token punctuation">]</span>
same
 <span class="token punctuation">[</span><span class="token number">1.</span>  <span class="token number">2.5</span> <span class="token number">4.</span>  <span class="token number">5.5</span> <span class="token number">7.</span> <span class="token punctuation">]</span>
valid
 <span class="token punctuation">[</span><span class="token number">2.5</span> <span class="token number">4.</span>  <span class="token number">5.5</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="_7-6-矩阵变换"><a href="#_7-6-矩阵变换" class="header-anchor">#</a> 7.6  矩阵变换</h2> <p>矩阵分解可用于以下情况：</p> <ul><li>作为求解线性方程组的中间步骤</li> <li>用于矩阵反演</li> <li>计算行列式时</li> <li>查找矩阵的本征值和本征向量时</li> <li>计算矩阵的解析函数时</li> <li>使用最小二乘法时</li> <li>在微分方程的数值解中</li></ul> <p>根据问题采用不同的矩阵分解类型。</p> <table><thead><tr><th>函数</th> <th>动作</th></tr></thead> <tbody><tr><td>Cholesky</td> <td>计算乔列斯基分解</td></tr> <tr><td>Eig</td> <td>计算方阵的本征值和右本征向量</td></tr> <tr><td>EigVals</td> <td>计算一般矩阵的本征值</td></tr> <tr><td>LU</td> <td>矩阵的 LU 因数分解为下三角矩阵和上三角矩阵的乘积</td></tr> <tr><td>LUP</td> <td>具有部分枢轴的 LUP 因数分解，仅指具有行排列的 LU 分解：PA=LU</td></tr> <tr><td>QR</td> <td>计算矩阵的 QR 分解</td></tr> <tr><td>SVD</td> <td>奇异值分解</td></tr></tbody></table> <h3 id="_7-6-1-cholesky"><a href="#_7-6-1-cholesky" class="header-anchor">#</a> 7.6.1  Cholesky</h3> <p>计算乔列斯基（Cholesky）分解。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Cholesky</span><span class="token punctuation">(</span>
  matrix<span class="token operator">&amp;</span>  L      <span class="token comment">// 矩阵</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>参数</strong></p> <p>L 键</p> <p>[输出]  下三角矩阵。</p> <p><strong>返回值</strong></p> <p>成功时返回 true，否则返回 false。</p> <p><strong>注意</strong></p> <p>返回方阵 a 的乔列斯基分解，L * L.H，其中 L 是下三角形和，且 H 是共轭转置运算符（如果 a 是实值，则为普通转置）。 a 必须是埃尔米特（Hermitian，如果实值是对称的），且正定。 不执行任何检查来验证 a 是否是埃尔米特（Hermitian）。 此外，仅用到 a 的下三角形和对角线元素。 仅有 L 实际返回。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>  matrix matrix_a<span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">5.7998084</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.1825367</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token operator">-</span><span class="token number">2.1825367</span><span class="token punctuation">,</span> <span class="token number">9.85910595</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  matrix matrix_l<span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_a\n&quot;</span><span class="token punctuation">,</span> matrix_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  matrix_a<span class="token punctuation">.</span><span class="token function">Cholesky</span><span class="token punctuation">(</span>matrix_l<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_l\n&quot;</span><span class="token punctuation">,</span> matrix_l<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;check\n&quot;</span><span class="token punctuation">,</span> matrix_l<span class="token punctuation">.</span><span class="token function">MatMul</span><span class="token punctuation">(</span>matrix_l<span class="token punctuation">.</span><span class="token function">Transpose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token comment">/*
  matrix_a
  [[5.7998084,-2.1825367]
   [-2.1825367,9.85910595]]
  matrix_l
  [[2.408279136645086,0]
   [-0.9062640068544704,3.006291985133859]]
  check
  [[5.7998084,-2.1825367]
   [-2.1825367,9.85910595]]
  */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="_7-6-2-eig"><a href="#_7-6-2-eig" class="header-anchor">#</a> 7.6.2  Eig</h3> <p>计算方阵的本征值和右本征向量。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Eig</span><span class="token punctuation">(</span>
  matrix<span class="token operator">&amp;</span>  eigen_vectors<span class="token punctuation">,</span>         <span class="token comment">// 本征向量矩阵</span>
  vector<span class="token operator">&amp;</span>  eigen_values           <span class="token comment">// 本征向量向量</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>特征值和特征向量的复解</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Eig</span><span class="token punctuation">(</span>
  matrix<span class="token operator">&lt;</span>complex<span class="token operator">&gt;</span><span class="token operator">&amp;</span> eigen_vectors<span class="token punctuation">,</span> <span class="token comment">// 特征向量矩阵</span>
  vector<span class="token operator">&lt;</span>complex<span class="token operator">&gt;</span><span class="token operator">&amp;</span> eigen_values   <span class="token comment">// 特征值向量</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>参数</strong></p> <p>eigen_vectors</p> <p>[输出]  垂直本征向量矩阵。</p> <p>eigen_values</p> <p>[输出]  本征值向量。</p> <p><strong>返回值</strong></p> <p>成功时返回 true，否则返回 false。</p> <p><strong>注意</strong></p> <p>如果计算特征值时遇到复解，则停止计算，并将错误代码设置为4019 (ERR_MATH_OVERFLOW)。使用Eig方法的复数重载在复数空间中获得完整的解决方案</p> <p>如果一个复特征值的虚部等于零，那么它就是一个实特征值。这可以在下面的示例中看到。</p> <p><strong>示例：</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   matrix matrix_a <span class="token operator">=</span>
     <span class="token punctuation">{</span>
        <span class="token punctuation">{</span><span class="token operator">-</span><span class="token number">3.474589</span><span class="token punctuation">,</span> <span class="token number">1.106384</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">9.091977</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">3.925227</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span><span class="token operator">-</span><span class="token number">5.522139</span><span class="token punctuation">,</span> <span class="token number">2.366887</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">15.162351</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">6.357512</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> <span class="token number">8.394926</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">2.960067</span><span class="token punctuation">,</span> <span class="token number">22.292115</span><span class="token punctuation">,</span> <span class="token number">9.524129</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> <span class="token number">7.803242</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">2.080287</span><span class="token punctuation">,</span> <span class="token number">19.217706</span><span class="token punctuation">,</span> <span class="token number">8.186645</span> <span class="token punctuation">}</span>
     <span class="token punctuation">}</span><span class="token punctuation">;</span>
 
   matrix eigen_vectors<span class="token punctuation">;</span>
   vector eigen_values<span class="token punctuation">;</span>
 
   <span class="token keyword">bool</span> res<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Eig</span><span class="token punctuation">(</span>eigen_vectors<span class="token punctuation">,</span> eigen_values<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;res=&quot;</span><span class="token punctuation">,</span>res<span class="token punctuation">,</span><span class="token string">&quot;  error=&quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Eigen vectors:\n&quot;</span><span class="token punctuation">,</span>eigen_vectors<span class="token punctuation">,</span> <span class="token string">&quot;\nEigen Values:\n&quot;</span><span class="token punctuation">,</span>eigen_values<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">//--- 检查正确性 A * v = lambda * v</span>
   <span class="token keyword">int</span> vectors<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>ulong n<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> n<span class="token operator">&lt;</span>eigen_values<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> n<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      vector eigen_vector<span class="token operator">=</span>eigen_vectors<span class="token punctuation">.</span><span class="token function">Col</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
      vector vector_d1   <span class="token operator">=</span>eigen_vector<span class="token operator">*</span>eigen_values<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>
      vector vector_d2   <span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">MatMul</span><span class="token punctuation">(</span>eigen_vector<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
      ulong errors<span class="token operator">=</span>vector_d1<span class="token punctuation">.</span><span class="token function">Compare</span><span class="token punctuation">(</span>vector_d2<span class="token punctuation">,</span><span class="token number">1e-13</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>errors<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
         vectors<span class="token operator">++</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;vectors=&quot;</span><span class="token punctuation">,</span>vectors<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">//--- 复解</span>
   matrix<span class="token operator">&lt;</span>complex<span class="token operator">&gt;</span> eigen_vectors_c<span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>complex<span class="token operator">&gt;</span> eigen_values_c<span class="token punctuation">;</span>
   <span class="token function">ResetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   res<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Eig</span><span class="token punctuation">(</span>eigen_vectors_c<span class="token punctuation">,</span>eigen_values_c<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;res=&quot;</span><span class="token punctuation">,</span>res<span class="token punctuation">,</span><span class="token string">&quot;  error=&quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Eigen vectors:\n&quot;</span><span class="token punctuation">,</span>eigen_vectors_c<span class="token punctuation">,</span> <span class="token string">&quot;\nEigen Values:\n&quot;</span><span class="token punctuation">,</span>eigen_values_c<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">//--- 检查正确性 A * v = lambda * v</span>
   matrixc matrix_c<span class="token punctuation">;</span>
   matrix_c<span class="token punctuation">.</span><span class="token function">Assign</span><span class="token punctuation">(</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
   vectors<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>ulong n<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> n<span class="token operator">&lt;</span>eigen_values_c<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> n<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      vectorc eigen_vector_c<span class="token operator">=</span>eigen_vectors_c<span class="token punctuation">.</span><span class="token function">Col</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
      vectorc vector_c1     <span class="token operator">=</span>eigen_vector_c<span class="token operator">*</span>eigen_values_c<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>
      vectorc vector_c2     <span class="token operator">=</span>matrix_c<span class="token punctuation">.</span><span class="token function">MatMul</span><span class="token punctuation">(</span>eigen_vector_c<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
      ulong errors<span class="token operator">=</span>vector_c1<span class="token punctuation">.</span><span class="token function">Compare</span><span class="token punctuation">(</span>vector_c2<span class="token punctuation">,</span><span class="token number">1e-13</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>errors<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
         vectors<span class="token operator">++</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;vectors=&quot;</span><span class="token punctuation">,</span>vectors<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">/* Result
   res=true  error=4019
   Eigen vectors:
   [[0.2649667608713664]
    [0.4488818803991876]
    [-0.6527335897527492]
    [-0.5497604331807768]]
   Eigen Values:
   [28.94158645962942]
   vectors=1
   res=true  error=0
   Eigen vectors:
   [[(0.2649667608713664,0),(0.2227392219204762,0.3745470492013296),(0.403285439089771,-0.1345146135716524),(-0.2050778513598178,0)]
    [(0.4488818803991876,0),(-0.2613452530342438,-0.3685707727819327),(-0.3968506126372395,0.5257002255533059),(0.8014703373356256,0)]
    [(-0.6527335897527492,0),(-0.3418479634708521,-0.3299830378162041),(-0.3553021031180292,-0.03685418759727989),(-0.05618703726964112,0)]
    [(-0.5497604331807768,0),(0.523227993452828,0.3262508584080381),(0.3512835596143666,0.3666300350184092),(0.558955624442244,0)]]
   Eigen Values:
   [(28.94158645962942,0),(0.01022501104810897,0.02954980822331488),(0.01022501104810897,-0.02954980822331488),(0.4090215182743634,0)]
   vectors=3
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br></div></div><h3 id="_7-6-3-eigvals"><a href="#_7-6-3-eigvals" class="header-anchor">#</a> 7.6.3  EigVals</h3> <p>计算一般矩阵的本征值。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">EigVals</span><span class="token punctuation">(</span>
  vector<span class="token operator">&amp;</span>  eigen_values      <span class="token comment">// 本征向量</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>参数</strong></p> <p>eigen_values</p> <p>[输出]  右本征值的向量。</p> <p><strong>返回值</strong></p> <p>成功时返回 true，否则返回 false。</p> <p><strong>注意</strong></p> <p>EigVals 和 Eig 之间的唯一区别是 EigVals 不计算本征向量，它只计算本征值。</p> <h3 id="_7-6-4-lu"><a href="#_7-6-4-lu" class="header-anchor">#</a> 7.6.4  LU</h3> <p>矩阵的 LU 因数分解为下三角矩阵和上三角矩阵的乘积。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">LU</span><span class="token punctuation">(</span>
  matrix<span class="token operator">&amp;</span>  L<span class="token punctuation">,</span>     <span class="token comment">// 下三角矩阵</span>
  matrix<span class="token operator">&amp;</span>  U      <span class="token comment">// 上三角矩阵</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>参数</strong></p> <p>L 键</p> <p>[输出]  下三角矩阵。</p> <p>U</p> <p>[输出]  上三角矩阵。</p> <p><strong>返回值</strong></p> <p>成功时返回 true，否则返回 false。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrix matrix_a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   matrix matrix_l<span class="token punctuation">,</span>matrix_u<span class="token punctuation">;</span>
<span class="token comment">//--- LU 分解</span>
   matrix_a<span class="token punctuation">.</span><span class="token function">LU</span><span class="token punctuation">(</span>matrix_l<span class="token punctuation">,</span>matrix_u<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_l\n&quot;</span><span class="token punctuation">,</span>matrix_l<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_u\n&quot;</span><span class="token punctuation">,</span>matrix_u<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 验算是否 A = L * U</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;check\n&quot;</span><span class="token punctuation">,</span>matrix_l<span class="token punctuation">.</span><span class="token function">MatMul</span><span class="token punctuation">(</span>matrix_u<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token comment">/*
   matrix_l
   [[1,0,0,0]
    [5,1,0,0]
    [8,0.875,1,0]
    [11,1.25,0.5904761904761905,1]]
   matrix_u
   [[1,2,3,4]
    [0,-8,-9,-13]
    [0,0,-13.125,-10.625]
    [0,0,0,-17.47619047619047]]
   check
   [[1,2,3,4]
    [5,2,6,7]
    [8,9,3,10]
    [11,12,14,4]]
   */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h3 id="_7-6-5-lup"><a href="#_7-6-5-lup" class="header-anchor">#</a> 7.6.5  LUP</h3> <p>具有部分轴的 LUP 因数分解，仅指具有行排列的 LU 分解：PA=LU。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  <span class="token function">LUP</span><span class="token punctuation">(</span>
  matrix<span class="token operator">&amp;</span>  L<span class="token punctuation">,</span>     <span class="token comment">// 下三角矩阵</span>
  matrix<span class="token operator">&amp;</span>  U<span class="token punctuation">,</span>     <span class="token comment">// 上三角矩阵</span>
  matrix<span class="token operator">&amp;</span>  P      <span class="token comment">// 排列矩阵</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>参数</strong></p> <p>L 键</p> <p>[输出]  下三角矩阵。</p> <p>U</p> <p>[输出]  上三角矩阵。</p> <p>P</p> <p>[out]  Permutations matrix</p> <p><strong>返回值</strong></p> <p>成功时返回 true，否则返回 false。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrix matrix_a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   matrix matrix_l<span class="token punctuation">,</span>matrix_u<span class="token punctuation">,</span>matrix_p<span class="token punctuation">;</span>
<span class="token comment">//--- LUP 分解</span>
   matrix_a<span class="token punctuation">.</span><span class="token function">LUP</span><span class="token punctuation">(</span>matrix_l<span class="token punctuation">,</span>matrix_u<span class="token punctuation">,</span>matrix_p<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_l\n&quot;</span><span class="token punctuation">,</span>matrix_l<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_u\n&quot;</span><span class="token punctuation">,</span>matrix_u<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_p\n&quot;</span><span class="token punctuation">,</span>matrix_p<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 验算是否 P * A = L * U</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;P * A\n&quot;</span><span class="token punctuation">,</span>matrix_p<span class="token punctuation">.</span><span class="token function">MatMul</span><span class="token punctuation">(</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;L * U\n&quot;</span><span class="token punctuation">,</span>matrix_l<span class="token punctuation">.</span><span class="token function">MatMul</span><span class="token punctuation">(</span>matrix_u<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token comment">/*
   matrix_l
   [[1,0,0,0]
    [0.4545454545454545,1,0,0]
    [0.7272727272727273,-0.07894736842105282,1,0]
    [0.09090909090909091,-0.2631578947368421,-0.2262773722627738,1]]
   matrix_u
   [[11,12,14,4]
    [0,-3.454545454545454,-0.3636363636363633,5.181818181818182]
    [0,0,-7.210526315789473,7.500000000000001]
    [0,0,0,6.697080291970803]]
   matrix_p
   [[0,0,0,1]
    [0,1,0,0]
    [0,0,1,0]
    [1,0,0,0]]
   P * A
   [[11,12,14,4]
    [5,2,6,7]
    [8,9,3,10]
    [1,2,3,4]]
   L * U
   [[11,12,14,4]
    [5,2,6,7]
    [8,9,3.000000000000001,10]
    [1,2,3,4]]
   */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><h3 id="_7-6-6-qr"><a href="#_7-6-6-qr" class="header-anchor">#</a> 7.6.6  QR</h3> <p>计算矩阵的 QR 分解。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  <span class="token function">QR</span><span class="token punctuation">(</span>
  matrix<span class="token operator">&amp;</span>  Q<span class="token punctuation">,</span>     <span class="token comment">// 具有正交列的矩阵</span>
  matrix<span class="token operator">&amp;</span>  R      <span class="token comment">// 上三角矩阵</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>参数</strong></p> <p>Q</p> <p>[输出]  具有正交列的矩阵。 当模式=“完成”时，结果是一个正交/酉矩阵，这取决于 a 是否是实数/复数。 在这种情况下，行列式可以是 +/- 1。 如果输入数组中的维数大于 2，则返回拥有上述属性的矩阵堆栈。</p> <p>R 键</p> <p>[输出]  上三角矩阵。</p> <p><strong>返回值</strong></p> <p>成功时返回 true，否则返回 false。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//---  A*x = b</span>
  matrix A <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;A \n&quot;</span><span class="token punctuation">,</span> A<span class="token punctuation">)</span><span class="token punctuation">;</span>
  vector b <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;b \n&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- A = Q*R</span>
  matrix q<span class="token punctuation">,</span> r<span class="token punctuation">;</span>
  A<span class="token punctuation">.</span><span class="token function">QR</span><span class="token punctuation">(</span>q<span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;q \n&quot;</span><span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;r \n&quot;</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>
  matrix qr<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">MatMul</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;qr \n&quot;</span><span class="token punctuation">,</span> qr<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">/* 
  A
  [[0,1]
  [1,1]
  [1,1]
  [2,1]]
  b
  [1,2,2,3]
  q
  [[0.4082482904638631,-0.8164965809277259,-1.110223024625157e-16,-0.4082482904638631]
  [0.4625425214347352,-0.03745747856526496,0.7041241452319315,0.5374574785652647]
  [-0.5374574785652648,-0.03745747856526496,0.7041241452319316,-0.4625425214347352]
  [-0.5749149571305296,-0.5749149571305299,-0.09175170953613698,0.5749149571305296]]
  r
  [[-1.224744871391589,-0.2415816237971962]
  [-1.22474487139159,-1.466326495188786]
  [1.224744871391589,1.316496580927726]
  [1.224744871391589,0.2415816237971961]]
  qr
  [[-1.110223024625157e-16,1]
  [1,0.9999999999999999]
  [1,1]
  [2,1]]
  */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><h3 id="_7-6-7-svd"><a href="#_7-6-7-svd" class="header-anchor">#</a> 7.6.7  SVD</h3> <p>奇异值分解。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">SVD</span><span class="token punctuation">(</span>
  matrix<span class="token operator">&amp;</span>  U<span class="token punctuation">,</span>                   <span class="token comment">// 酉矩阵</span>
  matrix<span class="token operator">&amp;</span>  V<span class="token punctuation">,</span>                   <span class="token comment">// 酉矩阵</span>
  vector<span class="token operator">&amp;</span>  singular_values      <span class="token comment">// 奇异值向量</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>参数</strong></p> <p>U</p> <p>[输出] m 阶酉矩阵，由左奇异向量组成。</p> <p>V</p> <p>[输出] n 阶酉矩阵，由右奇异向量组成。</p> <p>singular_values</p> <p>[输出] 奇异值</p> <p><strong>返回值</strong></p> <p>成功时返回 true，否则返回 false。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>  matrix a<span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  a<span class="token operator">=</span>a<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix a \n&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>
  a<span class="token punctuation">.</span><span class="token function">Reshape</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  matrix b<span class="token operator">=</span>a<span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix b \n&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 执行 SVD 分解</span>
  matrix U<span class="token punctuation">,</span> V<span class="token punctuation">;</span>
  vector singular_values<span class="token punctuation">;</span>
  b<span class="token punctuation">.</span><span class="token function">SVD</span><span class="token punctuation">(</span>U<span class="token punctuation">,</span> V<span class="token punctuation">,</span> singular_values<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;U \n&quot;</span><span class="token punctuation">,</span> U<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;V \n&quot;</span><span class="token punctuation">,</span> V<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;singular_values = &quot;</span><span class="token punctuation">,</span> singular_values<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">// 检查模块</span>
<span class="token comment">//--- U * 奇异值对角线 * V = A</span>
  matrix matrix_s<span class="token punctuation">;</span>
  matrix_s<span class="token punctuation">.</span><span class="token function">Diag</span><span class="token punctuation">(</span>singular_values<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_s \n&quot;</span><span class="token punctuation">,</span> matrix_s<span class="token punctuation">)</span><span class="token punctuation">;</span>
  matrix matrix_vt<span class="token operator">=</span>V<span class="token punctuation">.</span><span class="token function">Transpose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_vt \n&quot;</span><span class="token punctuation">,</span> matrix_vt<span class="token punctuation">)</span><span class="token punctuation">;</span>
  matrix matrix_usvt<span class="token operator">=</span><span class="token punctuation">(</span>U<span class="token punctuation">.</span><span class="token function">MatMul</span><span class="token punctuation">(</span>matrix_s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">MatMul</span><span class="token punctuation">(</span>matrix_vt<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_usvt \n&quot;</span><span class="token punctuation">,</span> matrix_usvt<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  ulong errors<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>b<span class="token punctuation">.</span><span class="token function">Compare</span><span class="token punctuation">(</span>matrix_usvt<span class="token punctuation">,</span> <span class="token number">1e-9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">double</span> res<span class="token operator">=</span><span class="token punctuation">(</span>errors<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;errors=&quot;</span><span class="token punctuation">,</span> errors<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">//---- 其它检查</span>
  matrix U_Ut<span class="token operator">=</span>U<span class="token punctuation">.</span><span class="token function">MatMul</span><span class="token punctuation">(</span>U<span class="token punctuation">.</span><span class="token function">Transpose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;U_Ut \n&quot;</span><span class="token punctuation">,</span> U_Ut<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Ut_U \n&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>U<span class="token punctuation">.</span><span class="token function">Transpose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">MatMul</span><span class="token punctuation">(</span>U<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  matrix vt_V<span class="token operator">=</span>matrix_vt<span class="token punctuation">.</span><span class="token function">MatMul</span><span class="token punctuation">(</span>V<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;vt_V \n&quot;</span><span class="token punctuation">,</span> vt_V<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;V_vt \n&quot;</span><span class="token punctuation">,</span> V<span class="token punctuation">.</span><span class="token function">MatMul</span><span class="token punctuation">(</span>matrix_vt<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">/*
  matrix a
  [[-4,-3,-2,-1,0,1,2,3,4]]
  matrix b
  [[-4,-3,-2]
   [-1,0,1]
   [2,3,4]]
  U
  [[-0.7071067811865474,0.5773502691896254,0.408248290463863]
   [-6.827109697437648e-17,0.5773502691896253,-0.8164965809277256]
   [0.7071067811865472,0.5773502691896255,0.4082482904638627]]
  V
  [[0.5773502691896258,-0.7071067811865474,-0.408248290463863]
   [0.5773502691896258,1.779939029415334e-16,0.8164965809277258]
   [0.5773502691896256,0.7071067811865474,-0.408248290463863]]
  singular_values = [7.348469228349533,2.449489742783175,3.277709923350408e-17]
 
  matrix_s
  [[7.348469228349533,0,0]
   [0,2.449489742783175,0]
   [0,0,3.277709923350408e-17]]
  matrix_vt
  [[0.5773502691896258,0.5773502691896258,0.5773502691896256]
   [-0.7071067811865474,1.779939029415334e-16,0.7071067811865474]
   [-0.408248290463863,0.8164965809277258,-0.408248290463863]]
  matrix_usvt
  [[-3.999999999999997,-2.999999999999999,-2]
   [-0.9999999999999981,-5.977974170712231e-17,0.9999999999999974]
   [2,2.999999999999999,3.999999999999996]]
  errors=0
 
  U_Ut
  [[0.9999999999999993,-1.665334536937735e-16,-1.665334536937735e-16]
   [-1.665334536937735e-16,0.9999999999999987,-5.551115123125783e-17]
   [-1.665334536937735e-16,-5.551115123125783e-17,0.999999999999999]]
  Ut_U
  [[0.9999999999999993,-5.551115123125783e-17,-1.110223024625157e-16]
   [-5.551115123125783e-17,0.9999999999999987,2.498001805406602e-16]
   [-1.110223024625157e-16,2.498001805406602e-16,0.999999999999999]]
  vt_V
  [[1,-5.551115123125783e-17,0]
   [-5.551115123125783e-17,0.9999999999999996,1.110223024625157e-16]
   [0,1.110223024625157e-16,0.9999999999999996]]
  V_vt
  [[0.9999999999999999,1.110223024625157e-16,1.942890293094024e-16]
   [1.110223024625157e-16,0.9999999999999998,1.665334536937735e-16]
   [1.942890293094024e-16,1.665334536937735e-16,0.9999999999999996]
  */</span>
 <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br></div></div><h2 id="_7-7-统计方法"><a href="#_7-7-统计方法" class="header-anchor">#</a> 7.7  统计方法</h2> <p>计算矩阵和向量的描述性统计的方法。</p> <table><thead><tr><th>函数</th> <th>动作</th></tr></thead> <tbody><tr><td>ArgMax</td> <td>返回最大值的索引</td></tr> <tr><td>ArgMin</td> <td>返回最小值的索引</td></tr> <tr><td>Max</td> <td>返回矩阵/向量中的最大值</td></tr> <tr><td>Min</td> <td>返回矩阵/向量中的最小值</td></tr> <tr><td>Ptp</td> <td>返回矩阵/向量或给定矩阵轴的数值范围</td></tr> <tr><td>Sum</td> <td>返回矩阵/矢量元素的总和，这些元素也可以针对给定轴（轴）执行</td></tr> <tr><td>Prod</td> <td>返回矩阵/矢量元素的乘积，也可以针对给定轴执行</td></tr> <tr><td>CumSum</td> <td>返回矩阵/矢量元素的累积总和，包括沿给定轴的矩阵/矢量元素</td></tr> <tr><td>CumProd</td> <td>返回矩阵/向量元素的累积乘积，包括沿给定轴的累积乘积</td></tr> <tr><td>Percentile</td> <td>返回矩阵/向量元素，或沿指定轴的元素值的指定百分位数</td></tr> <tr><td>Quantile</td> <td>返回矩阵/向量元素，或沿指定轴的元素值的指定分位数</td></tr> <tr><td>Median</td> <td>计算矩阵/向量元素的中位数</td></tr> <tr><td>Mean</td> <td>计算元素值的算术平均值</td></tr> <tr><td>Average</td> <td>计算矩阵/向量值的加权平均值</td></tr> <tr><td>Std</td> <td>返回矩阵/向量元素，或沿给定轴的元素值的标准偏差</td></tr> <tr><td>Var</td> <td>计算矩阵/向量元素值的方差</td></tr> <tr><td>LinearRegression</td> <td>计算包含计算的线性回归值的向量/矩阵</td></tr></tbody></table> <h3 id="_7-7-1-argmax"><a href="#_7-7-1-argmax" class="header-anchor">#</a> 7.7.1  ArgMax</h3> <p>返回最大值的索引。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>ulong vector<span class="token double-colon punctuation">::</span><span class="token function">ArgMax</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
ulong matrix<span class="token double-colon punctuation">::</span><span class="token function">ArgMax</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
vector matrix<span class="token double-colon punctuation">::</span><span class="token function">ArgMax</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token keyword">int</span>  axis      <span class="token comment">// axis</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>参数</strong></p> <p>axis</p> <p>[输入]  轴。 0 ― 水平轴，1 ― 垂直轴。</p> <p><strong>返回值</strong></p> <p>最大值的索引。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrix matrix_a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_a\n&quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   vector cols_max<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">ArgMax</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector rows_max<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">ArgMax</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   ulong  matrix_max<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">ArgMax</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;cols_max=&quot;</span><span class="token punctuation">,</span>cols_max<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;rows_max=&quot;</span><span class="token punctuation">,</span>rows_max<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;max index &quot;</span><span class="token punctuation">,</span>matrix_max<span class="token punctuation">,</span><span class="token string">&quot;  max value &quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">.</span><span class="token function">Flat</span><span class="token punctuation">(</span>matrix_max<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token comment">/*
   matrix_a
   [[10,3,2]
    [1,8,12]
    [6,5,4]
    [7,11,9]]
   cols_max=[0,3,1]
   rows_max=[0,2,0,1]
   max index 5  max value 12.0
   */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="_7-7-2-argmin"><a href="#_7-7-2-argmin" class="header-anchor">#</a> 7.7.2 ArgMin</h3> <p>返回最小值的索引。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>ulong vector<span class="token double-colon punctuation">::</span><span class="token function">ArgMin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
ulong matrix<span class="token double-colon punctuation">::</span><span class="token function">ArgMin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
vector matrix<span class="token double-colon punctuation">::</span><span class="token function">ArgMin</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token keyword">int</span>  axis      <span class="token comment">// axis</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>参数</strong></p> <p>axis</p> <p>[输入]  轴。 0 ― 水平轴，1 ― 垂直轴。</p> <p><strong>返回值</strong></p> <p>最小值的索引。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrix matrix_a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_a\n&quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   vector cols_min<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">ArgMin</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector rows_min<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">ArgMin</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   ulong  matrix_min<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">ArgMin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;cols_min=&quot;</span><span class="token punctuation">,</span>cols_min<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;rows_min=&quot;</span><span class="token punctuation">,</span>rows_min<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;min index &quot;</span><span class="token punctuation">,</span>matrix_min<span class="token punctuation">,</span><span class="token string">&quot;  min value &quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">.</span><span class="token function">Flat</span><span class="token punctuation">(</span>matrix_min<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token comment">/*
   matrix_a
   [[10,3,2]
    [1,8,12]
    [6,5,4]
    [7,11,9]]
   cols_min=[1,0,0]
   rows_min=[2,0,2,0]
   min index 3  min value 1.0
   */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="_7-7-3-max"><a href="#_7-7-3-max" class="header-anchor">#</a> 7.7.3  Max</h3> <p>返回矩阵/向量中的最大值。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">double</span> vector<span class="token double-colon punctuation">::</span><span class="token function">Max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">double</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
vector matrix<span class="token double-colon punctuation">::</span><span class="token function">Max</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token keyword">int</span>  axis      <span class="token comment">// axis</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>参数</strong></p> <p>axis</p> <p>[输入]  轴。 0 ― 水平轴，1 ― 垂直轴。</p> <p><strong>返回值</strong></p> <p>矩阵/向量中的最大值。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrix matrix_a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_a\n&quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   vector cols_max<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Max</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector rows_max<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Max</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">double</span> matrix_max<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;cols_max=&quot;</span><span class="token punctuation">,</span>cols_max<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;rows_max=&quot;</span><span class="token punctuation">,</span>rows_max<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;max value &quot;</span><span class="token punctuation">,</span>matrix_max<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token comment">/*
   matrix_a
   [[10,3,2]
    [1,8,12]
    [6,5,4]
    [7,11,9]]
   cols_max=[10,11,12]
   rows_max=[10,12,6,11]
   max value 12.0
   */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="_7-7-4-min"><a href="#_7-7-4-min" class="header-anchor">#</a> 7.7.4  Min</h3> <p>返回矩阵/向量中的最小值。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">double</span> vector<span class="token double-colon punctuation">::</span><span class="token function">Min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">double</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
vector matrix<span class="token double-colon punctuation">::</span><span class="token function">Min</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token keyword">int</span>  axis      <span class="token comment">// axis</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>参数</strong></p> <p>axis</p> <p>[输入]  轴。 0 ― 水平轴，1 ― 垂直轴。</p> <p><strong>返回值</strong></p> <p>矩阵/向量中的最小值。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrix matrix_a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_a\n&quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   vector cols_min<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Min</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector rows_min<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Min</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">double</span> matrix_min<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;cols_min=&quot;</span><span class="token punctuation">,</span>cols_min<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;rows_min=&quot;</span><span class="token punctuation">,</span>rows_min<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;min value &quot;</span><span class="token punctuation">,</span>matrix_min<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token comment">/*
   matrix_a
   [[10,3,2]
    [1,8,12]
    [6,5,4]
    [7,11,9]]
   cols_min=[1,3,2]
   rows_min=[2,1,4,7]
   min value 1.0
   */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="_7-7-5-ptp"><a href="#_7-7-5-ptp" class="header-anchor">#</a> 7.7.5  Ptp</h3> <p>返回矩阵/向量或给定矩阵轴的数值范围，等效于 Max() - Min()。 Ptp - 峰值到峰值。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">double</span> vector<span class="token double-colon punctuation">::</span><span class="token function">Ptp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">double</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Ptp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
vector matrix<span class="token double-colon punctuation">::</span><span class="token function">Ptp</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token keyword">int</span>  axis      <span class="token comment">// axis</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>参数</strong></p> <p>axis</p> <p>[输入]  轴。 0 ― 水平轴，1 ― 垂直轴。</p> <p><strong>返回值</strong></p> <p>向量的数值范围（最大值 - 最小值）</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrix matrix_a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_a\n&quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   vector cols_ptp<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Ptp</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector rows_ptp<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Ptp</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">double</span> matrix_ptp<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Ptp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;cols_ptp  &quot;</span><span class="token punctuation">,</span>cols_ptp<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;rows_ptp  &quot;</span><span class="token punctuation">,</span>rows_ptp<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;ptp value  &quot;</span><span class="token punctuation">,</span>matrix_ptp<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token comment">/*
   matrix_a
   [[10,3,2]
    [1,8,12]
    [6,5,4]
    [7,11,9]]
   cols_ptp [9,8,10]
   rows_ptp [8,11,2,4]
   ptp value  11.0
   */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="_7-7-6-sum"><a href="#_7-7-6-sum" class="header-anchor">#</a> 7.7.6    Sum</h3> <p>返回矩阵/矢量元素的总和，这些元素也可以针对给定轴（轴）执行。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">double</span> vector<span class="token double-colon punctuation">::</span><span class="token function">Sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">double</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
vector matrix<span class="token double-colon punctuation">::</span><span class="token function">Sum</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token keyword">int</span>  axis      <span class="token comment">// axis</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>参数</strong></p> <p>axis</p> <p>[输入]  轴。 0 ― 水平轴，1 ― 垂直轴。</p> <p><strong>返回值</strong></p> <p>矩阵/矢量元素的总和，也可以针对给定轴（轴）执行。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrix matrix_a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_a\n&quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   vector cols_sum<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Sum</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector rows_sum<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">double</span> matrix_sum<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;cols_sum=&quot;</span><span class="token punctuation">,</span>cols_sum<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;rows_sum=&quot;</span><span class="token punctuation">,</span>rows_sum<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;sum value &quot;</span><span class="token punctuation">,</span>matrix_sum<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token comment">/*
   matrix_a
   [[10,3,2]
    [1,8,12]
    [6,5,4]
    [7,11,9]]
   cols_sum=[24,27,27]
   rows_sum=[15,21,15,27]
   sum value 78.0
   */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="_7-7-7-prod"><a href="#_7-7-7-prod" class="header-anchor">#</a> 7.7.7  Prod</h3> <p>返回矩阵/矢量元素的乘积，该乘积也可以针对给定轴执行。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">double</span> vector<span class="token double-colon punctuation">::</span><span class="token function">Prod</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token keyword">double</span>  initial<span class="token operator">=</span><span class="token number">1</span>      <span class="token comment">// initial multiplier</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">double</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Prod</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token keyword">double</span>  initial<span class="token operator">=</span><span class="token number">1</span>      <span class="token comment">// initial multiplier</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
vector matrix<span class="token double-colon punctuation">::</span><span class="token function">Prod</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token keyword">int</span>     axis<span class="token punctuation">,</span>          <span class="token comment">// axis</span>
  <span class="token keyword">const</span> <span class="token keyword">double</span>  initial<span class="token operator">=</span><span class="token number">1</span>      <span class="token comment">// initial multiplier</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>参数</strong></p> <p>axis</p> <p>[输入]  轴。 0 ― 水平轴，1 ― 垂直轴。</p> <p>initial=1</p> <p>[输入]  初始乘数。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrix matrix_a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_a\n&quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   vector cols_prod<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Prod</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector rows_prod<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Prod</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">double</span> matrix_prod<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Prod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;cols_prod=&quot;</span><span class="token punctuation">,</span>cols_prod<span class="token punctuation">)</span><span class="token punctuation">;</span>
   cols_prod<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Prod</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;cols_prod=&quot;</span><span class="token punctuation">,</span>cols_prod<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;rows_prod=&quot;</span><span class="token punctuation">,</span>rows_prod<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;prod value &quot;</span><span class="token punctuation">,</span>matrix_prod<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">/*
   matrix_a
   [[10,3,2]
    [1,8,12]
    [6,5,4]
    [7,11,9]]
   cols_prod=[420,1320,864]
   cols_prod=[42,132,86.40000000000001]
   rows_prod=[60,96,120,693]
   prod value 479001600.0
  */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h3 id="_7-7-8-cumsum"><a href="#_7-7-8-cumsum" class="header-anchor">#</a> 7.7.8  CumSum</h3> <p>返回矩阵/矢量元素的累积总和，包括沿给定轴的元素。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>vector vector<span class="token double-colon punctuation">::</span><span class="token function">CumSum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
vector matrix<span class="token double-colon punctuation">::</span><span class="token function">CumSum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
matrix matrix<span class="token double-colon punctuation">::</span><span class="token function">CumSum</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token keyword">int</span>  axis      <span class="token comment">// axis</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>参数</strong></p> <p>axis</p> <p>[输入]  轴。 0 ― 水平轴，1 ― 垂直轴。</p> <p><strong>返回值</strong></p> <p>沿给定轴的元素的累积总和。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrix matrix_a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_a\n&quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   matrix cols_cumsum<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">CumSum</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix rows_cumsum<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">CumSum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector cumsum_values<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">CumSum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;cols_cumsum\n&quot;</span><span class="token punctuation">,</span>cols_cumsum<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;rows_cumsum\n&quot;</span><span class="token punctuation">,</span>rows_cumsum<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;cumsum values  &quot;</span><span class="token punctuation">,</span>cumsum_values<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token comment">/*
   matrix_a
   [[10,3,2]
    [1,8,12]
    [6,5,4]
    [7,11,9]]
   cols_cumsum
   [[10,3,2]
    [11,11,14]
    [17,16,18]
    [24,27,27]]
   rows_cumsum
   [[10,13,15]
    [1,9,21]
    [6,11,15]
    [7,18,27]]
   cumsum values  [10,13,15,16,24,36,42,47,51,58,69,78]
   */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h3 id="_7-7-9-cumprod"><a href="#_7-7-9-cumprod" class="header-anchor">#</a> 7.7.9  CumProd</h3> <p>返回矩阵/向量元素的累积乘积，包括沿给定轴的累积乘积。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>vector vector<span class="token double-colon punctuation">::</span><span class="token function">CumProd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
vector matrix<span class="token double-colon punctuation">::</span><span class="token function">CumProd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
matrix matrix<span class="token double-colon punctuation">::</span><span class="token function">CumProd</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token keyword">int</span>  axis      <span class="token comment">// axis</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>参数</strong></p> <p>axis</p> <p>[输入]  轴。 0 ― 每列的水平轴（即，整行），1 ― 每行的垂直轴（即，整列）</p> <p><strong>返回值</strong></p> <p>元素沿给定轴的累积乘积。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrix matrix_a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_a\n&quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   matrix cols_cumprod<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">CumProd</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix rows_cumprod<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">CumProd</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector cumprod_values<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">CumProd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;cols_cumprod\n&quot;</span><span class="token punctuation">,</span>cols_cumprod<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;rows_cumprod\n&quot;</span><span class="token punctuation">,</span>rows_cumprod<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;cumprod values  &quot;</span><span class="token punctuation">,</span>cumprod_values<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token comment">/*
   matrix_a
   [[10,3,2]
    [1,8,12]
    [6,5,4]
    [7,11,9]]
   cols_cumprod
   [[10,3,2]
    [10,24,24]
    [60,120,96]
    [420,1320,864]]
   rows_cumprod
   [[10,30,60]
    [1,8,96]
    [6,30,120]
    [7,77,693]]
   cumprod values  [10,30,60,60,480,5760,34560,172800,691200,4838400,53222400,479001600]
   */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h3 id="_7-7-10-percentile"><a href="#_7-7-10-percentile" class="header-anchor">#</a> 7.7.10  Percentile</h3> <p>返回矩阵/矢量元素或沿指定轴的元素值的指定百分位数。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">double</span> vector<span class="token double-colon punctuation">::</span><span class="token function">Percentile</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token keyword">int</span>  percent      <span class="token comment">// </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">double</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Percentile</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token keyword">int</span>  percent      <span class="token comment">// </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
vector matrix<span class="token double-colon punctuation">::</span><span class="token function">Percentile</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token keyword">int</span>  percent<span class="token punctuation">,</span>     <span class="token comment">// </span>
  <span class="token keyword">const</span> <span class="token keyword">int</span>  axis         <span class="token comment">// axis</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>参数</strong></p> <p>percent</p> <p>[输入]  欲计算的百分位数，必须介于 0 和 100（含）之间。</p> <p>axis</p> <p>[输入]  轴。 0 ― 水平轴，1 ― 垂直轴。</p> <p><strong>返回值</strong></p> <p>百分位数：标量或向量。</p> <p><strong>注意</strong></p> <p>“percent” 参数的有效值范围在 [0, 100] 之内。 采用线性算法计算百分位数。 正确计算中位数需要对序列进行排序。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrixf matrix_a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_a\n&quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   vectorf cols_percentile<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Percentile</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   vectorf rows_percentile<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Percentile</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">float</span> matrix_percentile<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Percentile</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;cols_percentile &quot;</span><span class="token punctuation">,</span>cols_percentile<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;rows_percentile &quot;</span><span class="token punctuation">,</span>rows_percentile<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;percentile value  &quot;</span><span class="token punctuation">,</span>matrix_percentile<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
 
   <span class="token comment">/*
   matrix_a
   [[1,2,3]
    [4,5,6]
    [7,8,9]
    [10,11,12]]
   cols_percentile [5.5,6.5,7.5]
   rows_percentile [2,5,8,11]
   percentile value  6.5
   */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="_7-7-11-quantile"><a href="#_7-7-11-quantile" class="header-anchor">#</a> 7.7.11  Quantile</h3> <p>返回矩阵/矢量元素或沿指定轴元素值的分位数。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">double</span> vector<span class="token double-colon punctuation">::</span><span class="token function">Quantile</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token keyword">double</span> quantile      <span class="token comment">// quantile</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">double</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Quantile</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token keyword">double</span> quantile      <span class="token comment">// quantile</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
vector matrix<span class="token double-colon punctuation">::</span><span class="token function">Quantile</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token keyword">double</span> quantile<span class="token punctuation">,</span>     <span class="token comment">// quantile</span>
  <span class="token keyword">const</span> <span class="token keyword">int</span>    axis          <span class="token comment">// axis</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>参数</strong></p> <p>quantile</p> <p>[输入]  欲计算的分位数，必须介于 0 和 1（含）之间。</p> <p>axis</p> <p>[输入]  轴。 0 ― 水平轴，1 ― 垂直轴。</p> <p><strong>返回值</strong></p> <p>分位数：标量或向量。</p> <p><strong>注意</strong></p> <p>'quantile' 参数取值范围 [0, 1]。 采用线性算法计算分位数。 正确计算分位数需要对序列进行排序。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrixf matrix_a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_a\n&quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   vectorf cols_quantile<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Quantile</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   vectorf rows_quantile<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Quantile</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">float</span> matrix_quantile<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Quantile</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;cols_quantile &quot;</span><span class="token punctuation">,</span>cols_quantile<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;rows_quantile &quot;</span><span class="token punctuation">,</span>rows_quantile<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;quantile value  &quot;</span><span class="token punctuation">,</span>matrix_quantile<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token comment">/*
   matrix_a
   [[1,2,3]
    [4,5,6]
    [7,8,9]
    [10,11,12]]
   cols_quantile [5.5,6.5,7.5]
   rows_quantile [2,5,8,11]
   quantile value  6.5
   */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="_7-7-12-median"><a href="#_7-7-12-median" class="header-anchor">#</a> 7.7.12  Median</h3> <p>计算矩阵/矢量元素的中位数。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">double</span> vector<span class="token double-colon punctuation">::</span><span class="token function">Median</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">double</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Median</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
vector matrix<span class="token double-colon punctuation">::</span><span class="token function">Median</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token keyword">int</span>  axis      <span class="token comment">// axis</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>参数</strong></p> <p>axis</p> <p>[输入]  轴。 0 ― 水平轴，1 ― 垂直轴。</p> <p><strong>返回值</strong></p> <p>中位数：标量或矢量。</p> <p><strong>注意</strong></p> <p>中位数是将数组/向量元素的最高一半与元素的最低一半分开的中间值。 与分位数（0.5）和百分位数（50）相同。 正确计算中位数需要对序列进行排序。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrixf matrix_a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_a\n&quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   vectorf cols_median<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Median</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   vectorf rows_median<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Median</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">float</span> matrix_median<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Median</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;cols_median &quot;</span><span class="token punctuation">,</span>cols_median<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;rows_median &quot;</span><span class="token punctuation">,</span>rows_median<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;median value  &quot;</span><span class="token punctuation">,</span>matrix_median<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
 
   <span class="token comment">/*
   matrix_a
   [[1,2,3]
    [4,5,6]
    [7,8,9]
    [10,11,12]]
   cols_median [5.5,6.5,7.5]
   rows_median [2,5,8,11]
   median value  6.5
   */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="_7-7-13-mean"><a href="#_7-7-13-mean" class="header-anchor">#</a> 7.7.13  Mean</h3> <p>计算元素值的算术平均值。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">double</span> vector<span class="token double-colon punctuation">::</span><span class="token function">Mean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">double</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Mean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
vector matrix<span class="token double-colon punctuation">::</span><span class="token function">Mean</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token keyword">int</span>  axis      <span class="token comment">// axis</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>参数</strong></p> <p>axis</p> <p>[输入]  轴。 0 ― 水平轴，1 ― 垂直轴。</p> <p><strong>返回值</strong></p> <p>元素值的算术平均值。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrixf matrix_a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_a\n&quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   vectorf cols_mean<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Mean</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   vectorf rows_mean<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Mean</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">float</span> matrix_mean<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Mean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;cols_mean &quot;</span><span class="token punctuation">,</span>cols_mean<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;rows_mean &quot;</span><span class="token punctuation">,</span>rows_mean<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;mean value  &quot;</span><span class="token punctuation">,</span>matrix_mean<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
 
   <span class="token comment">/*
   matrix_a
   [[10,3,2]
    [1,8,12]
    [6,5,4]
    [7,11,9]]
   cols_mean [6,6.75,6.75]
   rows_mean [5,7,5,9]
   mean value  6.5
   */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="_7-7-14-average"><a href="#_7-7-14-average" class="header-anchor">#</a> 7.7.14  Average</h3> <p>计算矩阵/向量值的加权平均值。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">double</span> vector<span class="token double-colon punctuation">::</span><span class="token function">Average</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> vector<span class="token operator">&amp;</span> weigts      <span class="token comment">// weights vector</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">double</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Average</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> matrix<span class="token operator">&amp;</span> weigts      <span class="token comment">// weights matrix</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
vector matrix<span class="token double-colon punctuation">::</span><span class="token function">Average</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> matrix<span class="token operator">&amp;</span> weigts<span class="token punctuation">,</span>     <span class="token comment">// weights matrix</span>
  <span class="token keyword">const</span> <span class="token keyword">int</span>     axis        <span class="token comment">// axis</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>参数</strong></p> <p>axis</p> <p>[输入]  轴。 0 ― 水平轴，1 ― 垂直轴。</p> <p><strong>返回值</strong></p> <p>算术平均值：标量或向量。</p> <p><strong>注意</strong></p> <p>权重矩阵/向量与主矩阵/向量相关联。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrixf matrix_a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   matrixf matrix_w<span class="token operator">=</span>matrixf<span class="token double-colon punctuation">::</span><span class="token function">Ones</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_a\n&quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   vectorf cols_average<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Average</span><span class="token punctuation">(</span>matrix_w<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   vectorf rows_average<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Average</span><span class="token punctuation">(</span>matrix_w<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">float</span> matrix_average<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Average</span><span class="token punctuation">(</span>matrix_w<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;cols_average &quot;</span><span class="token punctuation">,</span>cols_average<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;rows_average &quot;</span><span class="token punctuation">,</span>rows_average<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;average value  &quot;</span><span class="token punctuation">,</span>matrix_average<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
 
   <span class="token comment">/*
   matrix_a
   [[10,3,2]
    [1,8,12]
    [6,5,4]
    [7,11,9]]
   cols_average [6,6.75,6.75]
   rows_average [5,7,5,9]
   average value  6.5
   */</span> value  <span class="token number">6.5</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h3 id="_7-7-15-std"><a href="#_7-7-15-std" class="header-anchor">#</a> 7.7.15  Std</h3> <p>返回矩阵/矢量元素或沿给定轴的元素值的标准偏差。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">double</span> vector<span class="token double-colon punctuation">::</span><span class="token function">Std</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">double</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Std</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
vector matrix<span class="token double-colon punctuation">::</span><span class="token function">Std</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token keyword">int</span>  axis      <span class="token comment">// axis</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>参数</strong></p> <p>axis</p> <p>[输入]  轴。 0 ― 水平轴，1 ― 垂直轴。</p> <p><strong>返回值</strong></p> <p>Standard_deviation: 标量或矢量。</p> <p><strong>注意</strong></p> <p>标准差是与平均值的平方偏差平均值的平方根， 即，std = sqrt(mean(x))，其中 x = abs(a - a.mean())**2。</p> <p>典型的平均平方偏差计算为 x.sum() / N，其中 N = len(x)。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrixf matrix_a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_a\n&quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   vectorf cols_std<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Std</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   vectorf rows_std<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Std</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">float</span> matrix_std<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Std</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;cols_std &quot;</span><span class="token punctuation">,</span>cols_std<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;rows_std &quot;</span><span class="token punctuation">,</span>rows_std<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;std value  &quot;</span><span class="token punctuation">,</span>matrix_std<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
 
   <span class="token comment">/*
   matrix_a
   [[10,3,2]
    [1,8,12]
    [6,5,4]
    [7,11,9]]
   cols_std [3.2403703,3.0310888,3.9607449]
   rows_std [3.5590262,4.5460606,0.81649661,1.6329932]
   std value  3.452052593231201
   */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="_7-7-16-var"><a href="#_7-7-16-var" class="header-anchor">#</a> 7.7.16  Var</h3> <p>计算矩阵/向量元素值的方差。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">double</span> vector<span class="token double-colon punctuation">::</span><span class="token function">Var</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">double</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Var</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
vector matrix<span class="token double-colon punctuation">::</span><span class="token function">Var</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token keyword">int</span>  axis      <span class="token comment">// axis</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>参数</strong></p> <p>axis</p> <p>[输入]  轴。 0 ― 水平轴，1 ― 垂直轴。</p> <p><strong>返回值</strong></p> <p>方差：标量或向量。</p> <p><strong>注意</strong></p> <p>方差是与平均值的平方偏差的平均值，即，var = mean(x), where x = abs(a - a.mean())**2。</p> <p>平均值的典型计算为 x.sum() / N，其中 N = len(x)。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrixf matrix_a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_a\n&quot;</span><span class="token punctuation">,</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   vectorf cols_var<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Var</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   vectorf rows_var<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Var</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">float</span> matrix_var<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Var</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;cols_var &quot;</span><span class="token punctuation">,</span>cols_var<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;rows_var &quot;</span><span class="token punctuation">,</span>rows_var<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;var value  &quot;</span><span class="token punctuation">,</span>matrix_var<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
 
   <span class="token comment">/*
   matrix_a
   [[10,3,2]
    [1,8,12]
    [6,5,4]
    [7,11,9]]
   cols_var [10.5,9.1875,15.6875]
   rows_var [12.666667,20.666666,0.66666669,2.6666667]
   var value  11.916666984558105
   */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="_7-7-17-linearregression"><a href="#_7-7-17-linearregression" class="header-anchor">#</a> 7.7.17  LinearRegression</h3> <p>计算包含计算的线性回归值的向量/矩阵。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>vector vector<span class="token double-colon punctuation">::</span><span class="token function">LinearRegression</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
matrix matrix<span class="token double-colon punctuation">::</span><span class="token function">LinearRegression</span><span class="token punctuation">(</span>
  ENUM_MATRIX_AXIS  axis<span class="token operator">=</span>AXIS_NONE      <span class="token comment">// 沿其计算回归的轴线</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>参数</strong></p> <p>axis</p> <p>[in]  指定沿其计算回归的轴线。ENUM_MATRIX_AXIS枚举值(AXIS_HORZ ― 横轴， AXIS_VERT ― 竖轴)。</p> <p><strong>返回值</strong></p> <p>包含计算的线性回归值的向量/矩阵。</p> <p><strong>注意</strong></p> <p>使用标准回归方程计算线性回归：<code>y (x) = a * x + b</code>，其中a是直线斜率，而b是其Y轴位移。</p> <p><img src="/mql5yao/assets/img/linear_regression.3cc5edf6.png" alt="LinearRegression"></p> <p><strong>示例：</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;Graphics\Graphic.mqh&gt;</span></span>
 
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">GRAPH_WIDTH</span>  <span class="token expression"><span class="token number">750</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">GRAPH_HEIGHT</span> <span class="token expression"><span class="token number">350</span></span></span>
 
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 脚本程序起始函数                                                   |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   vector vector_a<span class="token punctuation">;</span>
   vector_a<span class="token punctuation">.</span><span class="token function">CopyRates</span><span class="token punctuation">(</span>_Symbol<span class="token punctuation">,</span>_Period<span class="token punctuation">,</span>COPY_RATES_CLOSE<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector vector_r<span class="token operator">=</span>vector_a<span class="token punctuation">.</span><span class="token function">LinearRegression</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">//--- 关闭图表显示</span>
   <span class="token function">ChartSetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_SHOW<span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">//--- 用于绘制图形的数组</span>
   <span class="token keyword">double</span> x<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token keyword">double</span> y1<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token keyword">double</span> y2<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token function">ArrayResize</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token function">uint</span><span class="token punctuation">(</span>vector_a<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">ArrayResize</span><span class="token punctuation">(</span>y1<span class="token punctuation">,</span><span class="token function">uint</span><span class="token punctuation">(</span>vector_a<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">ArrayResize</span><span class="token punctuation">(</span>y2<span class="token punctuation">,</span><span class="token function">uint</span><span class="token punctuation">(</span>vector_a<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>ulong i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>vector_a<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>i<span class="token punctuation">;</span>
      y1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>vector_a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
      y2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>vector_r<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
 
<span class="token comment">//--- 图形标题</span>
   string title<span class="token operator">=</span><span class="token string">&quot;Linear regression &quot;</span><span class="token operator">+</span>_Symbol<span class="token operator">+</span><span class="token string">&quot;,&quot;</span><span class="token operator">+</span><span class="token function">EnumToString</span><span class="token punctuation">(</span>_Period<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token keyword">long</span>   chart<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
   string name<span class="token operator">=</span><span class="token string">&quot;LinearRegression&quot;</span><span class="token punctuation">;</span>
 
<span class="token comment">//--- 创建图形</span>
   CGraphic graphic<span class="token punctuation">;</span>
   graphic<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span>chart<span class="token punctuation">,</span>name<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>GRAPH_WIDTH<span class="token punctuation">,</span>GRAPH_HEIGHT<span class="token punctuation">)</span><span class="token punctuation">;</span>
   graphic<span class="token punctuation">.</span><span class="token function">BackgroundMain</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span><span class="token punctuation">;</span>
   graphic<span class="token punctuation">.</span><span class="token function">BackgroundMainSize</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   
<span class="token comment">//--- 激活函数图</span>
   CCurve <span class="token operator">*</span>curvef<span class="token operator">=</span>graphic<span class="token punctuation">.</span><span class="token function">CurveAdd</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y1<span class="token punctuation">,</span>CURVE_POINTS_AND_LINES<span class="token punctuation">)</span><span class="token punctuation">;</span>
   curvef<span class="token punctuation">.</span><span class="token function">Name</span><span class="token punctuation">(</span><span class="token string">&quot;vector_a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   curvef<span class="token punctuation">.</span><span class="token function">LinesWidth</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   curvef<span class="token punctuation">.</span><span class="token function">LinesSmooth</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   curvef<span class="token punctuation">.</span><span class="token function">LinesSmoothTension</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   curvef<span class="token punctuation">.</span><span class="token function">LinesSmoothStep</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">//--- 激活函数的导数</span>
   CCurve <span class="token operator">*</span>curved<span class="token operator">=</span>graphic<span class="token punctuation">.</span><span class="token function">CurveAdd</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y2<span class="token punctuation">,</span>CURVE_LINES<span class="token punctuation">)</span><span class="token punctuation">;</span>
   curved<span class="token punctuation">.</span><span class="token function">Name</span><span class="token punctuation">(</span><span class="token string">&quot;vector_r&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   curved<span class="token punctuation">.</span><span class="token function">LinesWidth</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   curved<span class="token punctuation">.</span><span class="token function">LinesSmooth</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   curved<span class="token punctuation">.</span><span class="token function">LinesSmoothTension</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   curved<span class="token punctuation">.</span><span class="token function">LinesSmoothStep</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   graphic<span class="token punctuation">.</span><span class="token function">CurvePlotAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   graphic<span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">//--- 无限循环识别按下的键盘按键</span>
   <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">IsStopped</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token comment">//--- 按下escape键退出程序</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">TerminalInfoInteger</span><span class="token punctuation">(</span>TERMINAL_KEYSTATE_ESCAPE<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span>
         <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 按下PdDn保存图形图片</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">TerminalInfoInteger</span><span class="token punctuation">(</span>TERMINAL_KEYSTATE_PAGEDOWN<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
         string file_names<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">FileSelectDialog</span><span class="token punctuation">(</span><span class="token string">&quot;Save Picture&quot;</span><span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">,</span><span class="token string">&quot;All files (*.*)|*.*&quot;</span><span class="token punctuation">,</span>FSD_WRITE_FILE<span class="token punctuation">,</span>file_names<span class="token punctuation">,</span><span class="token string">&quot;LinearRegression.png&quot;</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token keyword">continue</span><span class="token punctuation">;</span>
         <span class="token function">ChartScreenShot</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>file_names<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>GRAPH_WIDTH<span class="token punctuation">,</span>GRAPH_HEIGHT<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
 
<span class="token comment">//--- 清除</span>
   graphic<span class="token punctuation">.</span><span class="token function">Destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">ObjectDelete</span><span class="token punctuation">(</span>chart<span class="token punctuation">,</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">ChartSetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_SHOW<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br></div></div><p><strong>ENUM_MATRIX_AXIS</strong></p> <p>用于在矩阵所有统计函数中指定轴线的枚举。</p> <table><thead><tr><th>ID</th> <th>描述</th></tr></thead> <tbody><tr><td>AXIS_NONE</td> <td>没有指定坐标轴。对所有矩阵元素执行计算，类似向量(请参见Flat方法)。</td></tr> <tr><td>AXIS_HORZ</td> <td>横轴</td></tr> <tr><td>AXIS_VERT</td> <td>竖轴</td></tr></tbody></table> <h2 id="_7-8-特征方法"><a href="#_7-8-特征方法" class="header-anchor">#</a> 7.8  特征方法</h2> <p>这些方法可以接收矩阵特征，诸如：</p> <ul><li>行数</li> <li>列数</li> <li>范数</li> <li>条件数字</li> <li>行列式</li> <li>矩阵的秩</li> <li>迹线</li> <li>谱</li></ul> <table><thead><tr><th>函数</th> <th>动作</th></tr></thead> <tbody><tr><td>Rows</td> <td>返回矩阵中的行数</td></tr> <tr><td>Cols</td> <td>返回矩阵中的列数</td></tr> <tr><td>Size</td> <td>返回向量的大小</td></tr> <tr><td>Norm</td> <td>返回矩阵或向量范数</td></tr> <tr><td>Cond</td> <td>计算一个矩阵的条件数</td></tr> <tr><td>Det</td> <td>计算平方可逆矩阵的行列式</td></tr> <tr><td>SLogDet</td> <td>计算矩阵行列式的符号和对数</td></tr> <tr><td>Rank</td> <td>返回利用高斯（Gaussian）方法的矩阵秩</td></tr> <tr><td>Trace</td> <td>返回矩阵对角线的总和</td></tr> <tr><td>Spectrum</td> <td>计算矩阵的谱作为其本征值的集合，来自乘积 AT*A</td></tr></tbody></table> <h3 id="_7-8-1-rows"><a href="#_7-8-1-rows" class="header-anchor">#</a> 7.8.1  Rows</h3> <p>返回矩阵中的行数。</p> <p><code>ulong matrix::Rows()</code></p> <p><strong>返回值</strong></p> <p>整数。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>  matrix m<span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  m<span class="token punctuation">.</span><span class="token function">Reshape</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix m \n&quot;</span> <span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;m.Rows()=&quot;</span><span class="token punctuation">,</span> m<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;m.Cols()=&quot;</span><span class="token punctuation">,</span> m<span class="token punctuation">.</span><span class="token function">Cols</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">/*
   matrix m 
   [[1,2,3,4]
    [5,6,7,8]
    [9,10,11,12]]
   m.Rows()=3
   m.Cols()=4
  */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="_7-8-2-cols"><a href="#_7-8-2-cols" class="header-anchor">#</a> 7.8.2  Cols</h3> <p>返回矩阵中的列数。</p> <p><code>ulong matrix::Cols()</code></p> <p><strong>返回值</strong></p> <p>整数。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>  matrix m<span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  m<span class="token punctuation">.</span><span class="token function">Reshape</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix m \n&quot;</span> <span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;m.Cols()=&quot;</span><span class="token punctuation">,</span> m<span class="token punctuation">.</span><span class="token function">Cols</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;m.Rows()=&quot;</span><span class="token punctuation">,</span> m<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">/*
   matrix m 
   [[1,2,3,4]
    [5,6,7,8]
    [9,10,11,12]]
   m.Cols()=4
   m.Rows()=3
  */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="_7-8-3-size"><a href="#_7-8-3-size" class="header-anchor">#</a> 7.8.3  Size</h3> <p>返回向量的大小。</p> <p><code>ulong vector::Size()</code></p> <p><strong>返回值</strong></p> <p>整数。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>  matrix m<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  m<span class="token punctuation">.</span><span class="token function">Reshape</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix m\n&quot;</span><span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
  vector v<span class="token operator">=</span>m<span class="token punctuation">.</span><span class="token function">Row</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;v.Size()=&quot;</span><span class="token punctuation">,</span>v<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;v=&quot;</span><span class="token punctuation">,</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
 
  <span class="token comment">/*
   matrix m
   [[1,2,3,4]
    [5,6,7,8]
    [9,10,11,12]]
   v.Size()=4
   v=[5,6,7,8]  
  */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="_7-8-4-norm"><a href="#_7-8-4-norm" class="header-anchor">#</a> 7.8.4  Norm</h3> <p>返回矩阵或向量的范数。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">double</span> vector<span class="token double-colon punctuation">::</span><span class="token function">Norm</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> ENUM_VECTOR_NORM  norm<span class="token punctuation">,</span>     <span class="token comment">// 向量范数</span>
  <span class="token keyword">const</span> <span class="token keyword">int</span>                        norm_p<span class="token operator">=</span><span class="token number">2</span>  <span class="token comment">// p-范数，如果是 VECTOR_NORM_P</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">double</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Norm</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> ENUM_MATRIX_NORM  norm      <span class="token comment">// 矩阵范数</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>参数</strong></p> <p>范数</p> <p>[输入] 范数顺序</p> <p><strong>返回值</strong></p> <p>矩阵或向量的范数。</p> <p><strong>注意</strong></p> <ul><li>VECTOR_NORM_INF 是向量元素中的最大绝对值。</li> <li>VECTOR_NORM_MINUS_INF 是向量元素中的最小绝对值。</li> <li>VECTOR_NORM_P 是向量的 P-范数。 如果 norm_p=0，那么这是非零向量元素的数量。 norm_p=1 是矢量元素绝对值的总和。 norm_p=2 是向量元素值平方和的平方根。 P-范数可以为负值。</li> <li>MATRIX_NORM_FROBENIUS 是矩阵元素值的平方和的平方根。 弗罗贝尼乌斯（Frobenius）范数和向量 P2-范数是一致的。</li> <li>MATRIX_NORM_SPECTRAL 是矩阵谱的最大值。</li> <li>MATRIX_NORM_NUCLEAR 是矩阵奇异值的总和。</li> <li>MATRIX_NORM_INF 是矩阵垂直向量中的最大向量 p1-范数。 矩阵 inf-范数和向量 inf-范数是一致的。</li> <li>MATRIX_NORM_MINUS_INF 是矩阵垂直向量中的最小向量 p1-范数。</li> <li>MATRIX_NORM_P1 是矩阵水平向量中的最大向量 p1-范数。</li> <li>MATRIX_NORM_MINUS_P1 是矩阵水平向量中的最小向量 p1-范数。</li> <li>MATRIX_NORM_P2 是矩阵的最高奇异值。</li> <li>MATRIX_NORM_MINUS_P2 是矩阵的最低奇异值。</li></ul> <p><strong>以 MQL5 实现的计算向量 P-范数的简单算法：</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">double</span> <span class="token function">VectorNormP</span><span class="token punctuation">(</span><span class="token keyword">const</span> vector<span class="token operator">&amp;</span> v<span class="token punctuation">,</span><span class="token keyword">int</span> norm_value<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   ulong  i<span class="token punctuation">;</span>
   <span class="token keyword">double</span> norm<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">;</span>
<span class="token comment">//---</span>
   <span class="token keyword">switch</span><span class="token punctuation">(</span>norm_value<span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token keyword">case</span> <span class="token number">0</span> <span class="token operator">:</span>
         <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>v<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span>
               norm<span class="token operator">+=</span><span class="token number">1.0</span><span class="token punctuation">;</span>
         <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token number">1</span> <span class="token operator">:</span>
         <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>v<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
            norm<span class="token operator">+=</span><span class="token function">MathAbs</span><span class="token punctuation">(</span>v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token number">2</span> <span class="token operator">:</span>
         <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>v<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
            norm<span class="token operator">+=</span>v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">*</span>v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
         norm<span class="token operator">=</span><span class="token function">MathSqrt</span><span class="token punctuation">(</span>norm<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">default</span> <span class="token operator">:</span>
         <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>v<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
            norm<span class="token operator">+=</span><span class="token function">MathPow</span><span class="token punctuation">(</span><span class="token function">MathAbs</span><span class="token punctuation">(</span>v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>norm_value<span class="token punctuation">)</span><span class="token punctuation">;</span>
         norm<span class="token operator">=</span><span class="token function">MathPow</span><span class="token punctuation">(</span>norm<span class="token punctuation">,</span><span class="token number">1.0</span><span class="token operator">/</span>norm_value<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//---</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span>norm<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p><strong>MQL5 示例:</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>  matrix a<span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  a<span class="token operator">=</span>a<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix a \n&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>
  a<span class="token punctuation">.</span><span class="token function">Reshape</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  matrix b<span class="token operator">=</span>a<span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix b \n&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;b.Norm(MATRIX_NORM_P2)=&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">.</span><span class="token function">Norm</span><span class="token punctuation">(</span>MATRIX_NORM_FROBENIUS<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;b.Norm(MATRIX_NORM_FROBENIUS)=&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">.</span><span class="token function">Norm</span><span class="token punctuation">(</span>MATRIX_NORM_FROBENIUS<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;b.Norm(MATRIX_NORM_INF)&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">.</span><span class="token function">Norm</span><span class="token punctuation">(</span>MATRIX_NORM_INF<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;b.Norm(MATRIX_NORM_MINUS_INF)&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">.</span><span class="token function">Norm</span><span class="token punctuation">(</span>MATRIX_NORM_MINUS_INF<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;b.Norm(MATRIX_NORM_P1)=)&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">.</span><span class="token function">Norm</span><span class="token punctuation">(</span>MATRIX_NORM_P1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;b.Norm(MATRIX_NORM_MINUS_P1)=&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">.</span><span class="token function">Norm</span><span class="token punctuation">(</span>MATRIX_NORM_MINUS_P1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;b.Norm(MATRIX_NORM_P2)=&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">.</span><span class="token function">Norm</span><span class="token punctuation">(</span>MATRIX_NORM_P2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;b.Norm(MATRIX_NORM_MINUS_P2)=&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">.</span><span class="token function">Norm</span><span class="token punctuation">(</span>MATRIX_NORM_MINUS_P2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">/*
  matrix a
  [[-4,-3,-2,-1,0,1,2,3,4]]
  matrix b
  [[-4,-3,-2]
  [-1,0,1]
  [2,3,4]]
  b.Norm(MATRIX_NORM_P2)=7.745966692414834
  b.Norm(MATRIX_NORM_FROBENIUS)=7.745966692414834
  b.Norm(MATRIX_NORM_INF)9.0
  b.Norm(MATRIX_NORM_MINUS_INF)2.0
  b.Norm(MATRIX_NORM_P1)=)7.0
  b.Norm(MATRIX_NORM_MINUS_P1)=6.0
  b.Norm(MATRIX_NORM_P2)=7.348469228349533
  b.Norm(MATRIX_NORM_MINUS_P2)=1.857033188519056e-16
  */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p><strong>Python 示例:</strong></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> linalg <span class="token keyword">as</span> LA
a <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">4</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;a \n&quot;</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span>
b <span class="token operator">=</span> a<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;b \n&quot;</span><span class="token punctuation">,</span>b<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;LA.norm(b)=&quot;</span><span class="token punctuation">,</span>LA<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;LA.norm(b, 'fro')=&quot;</span><span class="token punctuation">,</span>LA<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token string">'fro'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;LA.norm(b, np.inf)=&quot;</span><span class="token punctuation">,</span>LA<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>b<span class="token punctuation">,</span> np<span class="token punctuation">.</span>inf<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;LA.norm(b, -np.inf)=&quot;</span><span class="token punctuation">,</span>LA<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token operator">-</span>np<span class="token punctuation">.</span>inf<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;LA.norm(b, 1)=&quot;</span><span class="token punctuation">,</span>LA<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;LA.norm(b, -1)=&quot;</span><span class="token punctuation">,</span>LA<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;LA.norm(b, 2)=&quot;</span><span class="token punctuation">,</span>LA<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;LA.norm(b, -2)=&quot;</span><span class="token punctuation">,</span>LA<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 
a 
 <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span> <span class="token operator">-</span><span class="token number">3</span> <span class="token operator">-</span><span class="token number">2</span> <span class="token operator">-</span><span class="token number">1</span>  <span class="token number">0</span>  <span class="token number">1</span>  <span class="token number">2</span>  <span class="token number">3</span>  <span class="token number">4</span><span class="token punctuation">]</span>
b 
 <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span> <span class="token operator">-</span><span class="token number">3</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span>  <span class="token number">0</span>  <span class="token number">1</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">2</span>  <span class="token number">3</span>  <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
LA<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token operator">=</span> <span class="token number">7.745966692414834</span>
LA<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token string">'fro'</span><span class="token punctuation">)</span><span class="token operator">=</span> <span class="token number">7.745966692414834</span>
LA<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>b<span class="token punctuation">,</span> np<span class="token punctuation">.</span>inf<span class="token punctuation">)</span><span class="token operator">=</span> <span class="token number">9.0</span>
LA<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token operator">-</span>np<span class="token punctuation">.</span>inf<span class="token punctuation">)</span><span class="token operator">=</span> <span class="token number">2.0</span>
LA<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span> <span class="token number">7.0</span>
LA<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span> <span class="token number">6.0</span>
LA<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span> <span class="token number">7.3484692283495345</span>
LA<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span> <span class="token number">1.857033188519056e-16</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h3 id="_7-8-5-cond"><a href="#_7-8-5-cond" class="header-anchor">#</a> 7.8.5 Cond</h3> <p>计算矩阵的条件数。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">double</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Cond</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> ENUM_MATRIX_NORM  norm      <span class="token comment">// 矩阵范数</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>参数</strong></p> <p>范数</p> <p>[输入]  来自 ENUM_MATRIX_NORM 的范数顺序</p> <p><strong>返回值</strong></p> <p>矩阵的条件数字。 也许是无限的。</p> <p><strong>注意</strong></p> <p>x 的条件数定义为 x 的范数乘以 x 的逆范数 [1]。 范数可以是通常的 L2-范数（平方和的根），或许多其它矩阵范数之一。</p> <p>条件数 K 值，等于矩阵 A 的范数及其逆的乘积。 条件数太高的矩阵称为病态。 条件数较低的称为良态。 逆矩阵采用伪反演得到，不受矩阵的直点和非奇点条件的限制。</p> <p>谱条件数是一个例外。</p> <p><strong>以 MQL5 实现的计算谱条件数的简单算法：</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">double</span> <span class="token function">MatrixCondSpectral</span><span class="token punctuation">(</span>matrix<span class="token operator">&amp;</span> a<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   <span class="token keyword">double</span> norm<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">;</span>
   vector v<span class="token operator">=</span>a<span class="token punctuation">.</span><span class="token function">Spectrum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token keyword">if</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token keyword">double</span> max_norm<span class="token operator">=</span>v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">double</span> min_norm<span class="token operator">=</span>v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span>ulong i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>v<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
         <span class="token keyword">double</span> real<span class="token operator">=</span><span class="token function">MathAbs</span><span class="token punctuation">(</span>v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>max_norm<span class="token operator">&lt;</span>real<span class="token punctuation">)</span>
            max_norm<span class="token operator">=</span>real<span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>min_norm<span class="token operator">&gt;</span>real<span class="token punctuation">)</span>
            min_norm<span class="token operator">=</span>real<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      max_norm<span class="token operator">=</span><span class="token function">MathSqrt</span><span class="token punctuation">(</span>max_norm<span class="token punctuation">)</span><span class="token punctuation">;</span>
      min_norm<span class="token operator">=</span><span class="token function">MathSqrt</span><span class="token punctuation">(</span>min_norm<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>min_norm<span class="token operator">&gt;</span><span class="token number">0.0</span><span class="token punctuation">)</span>
         norm<span class="token operator">=</span>max_norm<span class="token operator">/</span>min_norm<span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
 
   <span class="token keyword">return</span><span class="token punctuation">(</span>norm<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p><strong>MQL5 示例:</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>  matrix a<span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;a.Cond(MATRIX_NORM_P2)=&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span><span class="token function">Cond</span><span class="token punctuation">(</span>MATRIX_NORM_P2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;a.Cond(MATRIX_NORM_FROBENIUS)=&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span><span class="token function">Cond</span><span class="token punctuation">(</span>MATRIX_NORM_FROBENIUS<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;a.Cond(MATRIX_NORM_INF)=&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span><span class="token function">Cond</span><span class="token punctuation">(</span>MATRIX_NORM_INF<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;a.Cond(MATRIX_NORM_MINUS_INF)=&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span><span class="token function">Cond</span><span class="token punctuation">(</span>MATRIX_NORM_MINUS_INF<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;a.Cond(MATRIX_NORM_P1)=)&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span><span class="token function">Cond</span><span class="token punctuation">(</span>MATRIX_NORM_P1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;a.Cond(MATRIX_NORM_MINUS_P1)=&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span><span class="token function">Cond</span><span class="token punctuation">(</span>MATRIX_NORM_MINUS_P1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;a.Cond(MATRIX_NORM_P2)=&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span><span class="token function">Cond</span><span class="token punctuation">(</span>MATRIX_NORM_P2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;a.Cond(MATRIX_NORM_MINUS_P2)=&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span><span class="token function">Cond</span><span class="token punctuation">(</span>MATRIX_NORM_MINUS_P2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">/*
  matrix a
  [[1,0,-1]
  [0,1,0]
  [1,0,1]]
  a.Cond(MATRIX_NORM_P2)=1.414213562373095
  a.Cond(MATRIX_NORM_FROBENIUS)=3.162277660168379
  a.Cond(MATRIX_NORM_INF)=2.0
  a.Cond(MATRIX_NORM_MINUS_INF)=0.9999999999999997
  a.Cond(MATRIX_NORM_P1)=)2.0
  a.Cond(MATRIX_NORM_MINUS_P1)=0.9999999999999998
  a.Cond(MATRIX_NORM_P2)=1.414213562373095
  a.Cond(MATRIX_NORM_MINUS_P2)=0.7071067811865472
  */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p><strong>Python 示例:</strong></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> linalg <span class="token keyword">as</span> LA
a <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;a \n&quot;</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;LA.cond(a)=&quot;</span><span class="token punctuation">,</span>LA<span class="token punctuation">.</span>cond<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;LA.cond(a, 'fro')=&quot;</span><span class="token punctuation">,</span>LA<span class="token punctuation">.</span>cond<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">'fro'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;LA.cond(a, np.inf)=&quot;</span><span class="token punctuation">,</span>LA<span class="token punctuation">.</span>cond<span class="token punctuation">(</span>a<span class="token punctuation">,</span> np<span class="token punctuation">.</span>inf<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;LA.cond(a, -np.inf)=&quot;</span><span class="token punctuation">,</span>LA<span class="token punctuation">.</span>cond<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token operator">-</span>np<span class="token punctuation">.</span>inf<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;LA.cond(a, 1)=&quot;</span><span class="token punctuation">,</span>LA<span class="token punctuation">.</span>cond<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;LA.cond(a, -1)=&quot;</span><span class="token punctuation">,</span>LA<span class="token punctuation">.</span>cond<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;LA.cond(a, 2)=&quot;</span><span class="token punctuation">,</span>LA<span class="token punctuation">.</span>cond<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;LA.cond(a, -2)=&quot;</span><span class="token punctuation">,</span>LA<span class="token punctuation">.</span>cond<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 
a 
 <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">1</span>  <span class="token number">0</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">0</span>  <span class="token number">1</span>  <span class="token number">0</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">1</span>  <span class="token number">0</span>  <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
LA<span class="token punctuation">.</span>cond<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">=</span> <span class="token number">1.4142135623730951</span>
LA<span class="token punctuation">.</span>cond<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">'fro'</span><span class="token punctuation">)</span><span class="token operator">=</span> <span class="token number">3.1622776601683795</span>
LA<span class="token punctuation">.</span>cond<span class="token punctuation">(</span>a<span class="token punctuation">,</span> np<span class="token punctuation">.</span>inf<span class="token punctuation">)</span><span class="token operator">=</span> <span class="token number">2.0</span>
LA<span class="token punctuation">.</span>cond<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token operator">-</span>np<span class="token punctuation">.</span>inf<span class="token punctuation">)</span><span class="token operator">=</span> <span class="token number">1.0</span>
LA<span class="token punctuation">.</span>cond<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span> <span class="token number">2.0</span>
LA<span class="token punctuation">.</span>cond<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span> <span class="token number">1.0</span>
LA<span class="token punctuation">.</span>cond<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span> <span class="token number">1.4142135623730951</span>
LA<span class="token punctuation">.</span>cond<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span> <span class="token number">0.7071067811865475</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h3 id="_7-8-6-det"><a href="#_7-8-6-det" class="header-anchor">#</a> 7.8.6  Det</h3> <p>计算正方形可逆矩阵的行列式。</p> <p><code>double matrix::Det()</code></p> <p><strong>返回值</strong></p> <p>矩阵的行列式。</p> <p><strong>注意</strong></p> <p>二阶和三阶矩阵行列式根据萨鲁斯（Sarrus）规则进行计算。 d2=a11<em>a22-a12</em>a21; d3=a11<em>a22</em>a33+a12<em>a23</em>a31+a13<em>a21</em>a32-a13<em>a22</em>a31-a11<em>a23</em>a32-a12<em>a21</em>a33</p> <p>行列式是利用高斯（Gaussian）方法将矩阵简化为上三角形计算出的。 上三角矩阵的行列式等于主对角线元素的乘积。</p> <p>如果至少一个矩阵的行或列为零，则行列式为零。</p> <p>如果两个或多个矩阵的行或列线性相关，则其行列式为零。</p> <p>矩阵的行列式等于其本征值的乘积。</p> <p><strong>MQL5 示例:</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrix m<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token keyword">double</span> det<span class="token operator">=</span>m<span class="token punctuation">.</span><span class="token function">Det</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix m\n&quot;</span><span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;det(m)=&quot;</span><span class="token punctuation">,</span>det<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment">/*
   matrix m
   [[1,2]
    [3,4]]
   det(m)=-2.0      
   */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>Python 示例:</strong></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
 
a <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'a \n'</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'nnp.linalg.det(a) \n'</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>det<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>
 
a 
 <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span> <span class="token number">2</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">3</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
 
np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>det<span class="token punctuation">(</span>a<span class="token punctuation">)</span> 
 <span class="token operator">-</span><span class="token number">2.0000000000000004</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="_7-8-7-slogdet"><a href="#_7-8-7-slogdet" class="header-anchor">#</a> 7.8.7 SLogDet</h3> <p>计算矩阵行列式的符号和对数。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">double</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">SLogDet</span><span class="token punctuation">(</span>
  <span class="token keyword">int</span><span class="token operator">&amp;</span>  sign      <span class="token comment">// 符号</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>参数</strong></p> <p>sign</p> <p>[输出] 行列式的符号。 如果符号为偶数，则行列式为正数。</p> <p><strong>返回值</strong></p> <p>表示行列式符号的数字。</p> <p><strong>注意</strong></p> <p>行列式是利用高斯（Gaussian）方法将矩阵简化为上三角形计算出的。 上三角矩阵的行列式等于主对角线元素的乘积。 乘积的对数等于对数之和。 因此，如果在计算行列式时出现溢出，则可以使用 SLogDet 方法。</p> <p>如果符号为偶数，则行列式为正数。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>a <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token function">array</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  
<span class="token punctuation">(</span>sign<span class="token punctuation">,</span> logdet<span class="token punctuation">)</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span><span class="token function">slogdet</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>  
<span class="token punctuation">(</span>sign<span class="token punctuation">,</span> logdet<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0.69314718055994529</span><span class="token punctuation">)</span> # may vary  sign <span class="token operator">*</span> np<span class="token punctuation">.</span><span class="token function">exp</span><span class="token punctuation">(</span>logdet<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token number">2.0</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_7-8-8-rank"><a href="#_7-8-8-rank" class="header-anchor">#</a> 7.8.8  Rank</h3> <p>利用高斯（Gaussian）方法返回矩阵的秩。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">int</span>  <span class="token function">Rank</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>返回值</strong></p> <p>矩阵的秩。</p> <p><strong>注意</strong></p> <p>具有 m 行和 n 列的矩阵 A 的行（或列）系统的秩是线性独立行（或列）的最大数目。 如果若干行（列）中无一可用其它行（列）线性表达，则称为线性独立。 行系统的秩始终等于列系统的秩。 此值称为矩阵的秩。</p> <p><strong>MQL5 示例:</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>  matrix a<span class="token operator">=</span>matrix<span class="token double-colon punctuation">::</span><span class="token function">Eye</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix a \n&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;a.Rank()=&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span><span class="token function">Rank</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  matrix I<span class="token operator">=</span>matrix<span class="token double-colon punctuation">::</span><span class="token function">Eye</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  I<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.</span><span class="token punctuation">;</span>    <span class="token comment">// 无秩矩阵</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;I \n&quot;</span><span class="token punctuation">,</span> I<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;I.Rank()=&quot;</span><span class="token punctuation">,</span> I<span class="token punctuation">.</span><span class="token function">Rank</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  matrix b<span class="token operator">=</span>matrix<span class="token double-colon punctuation">::</span><span class="token function">Ones</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;b \n&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;b.Rank()=&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">.</span><span class="token function">Rank</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token comment">// 1 维 - 秩为 1 除外所有 0</span>
 
  matrix  zeros<span class="token operator">=</span>matrix<span class="token double-colon punctuation">::</span><span class="token function">Zeros</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;zeros \n&quot;</span><span class="token punctuation">,</span> zeros<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;zeros.Rank()=&quot;</span><span class="token punctuation">,</span> zeros<span class="token punctuation">.</span><span class="token function">Rank</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">/*
  matrix a
  [[1,0,0,0]
  [0,1,0,0]
  [0,0,1,0]
  [0,0,0,1]]
  a.Rank()=4
 
  I
  [[1,0,0,0]
  [0,1,0,0]
  [0,0,1,0]
  [0,0,0,0]]
  I.Rank()=3
 
  b
  [[1,1,1,1]]
  b.Rank()=1
 
  zeros
  [[0]
  [0]
  [0]
  [0]]
  zeros.Rank()=0
  */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><p><strong>Python 示例:</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">import</span> <span class="token module">numpy</span> as np
from numpy<span class="token punctuation">.</span>linalg <span class="token keyword">import</span> <span class="token module">matrix_rank</span>
a<span class="token operator">=</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token function">eye</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> # 全 秩 矩阵
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;a \n&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_rank(a)=&quot;</span><span class="token punctuation">,</span><span class="token function">matrix_rank</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>
I<span class="token operator">=</span>np<span class="token punctuation">.</span><span class="token function">eye</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
I<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.</span> # 秩 缺乏 矩阵x
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;I \n&quot;</span><span class="token punctuation">,</span>I<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_rank(I)=&quot;</span><span class="token punctuation">,</span><span class="token function">matrix_rank</span><span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">)</span>
 
b<span class="token operator">=</span>np<span class="token punctuation">.</span><span class="token function">ones</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;b \n&quot;</span><span class="token punctuation">,</span>b<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_rank(b)=&quot;</span><span class="token punctuation">,</span><span class="token function">matrix_rank</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span> # <span class="token number">1</span> 维 <span class="token operator">-</span> 秩为 <span class="token number">1</span> 除外 全部 <span class="token number">0</span>
 
zeros<span class="token operator">=</span>np<span class="token punctuation">.</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;zeroes \n&quot;</span><span class="token punctuation">,</span>zeros<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix_rank(zeros)=&quot;</span><span class="token punctuation">,</span><span class="token function">matrix_rank</span><span class="token punctuation">(</span>zeros<span class="token punctuation">)</span><span class="token punctuation">)</span>
 
a 
 <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1.</span> <span class="token number">0.</span> <span class="token number">0.</span> <span class="token number">0.</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.</span> <span class="token number">1.</span> <span class="token number">0.</span> <span class="token number">0.</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.</span> <span class="token number">0.</span> <span class="token number">1.</span> <span class="token number">0.</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.</span> <span class="token number">0.</span> <span class="token number">0.</span> <span class="token number">1.</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token function">matrix_rank</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">=</span> <span class="token number">4</span>
 
I 
 <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1.</span> <span class="token number">0.</span> <span class="token number">0.</span> <span class="token number">0.</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.</span> <span class="token number">1.</span> <span class="token number">0.</span> <span class="token number">0.</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.</span> <span class="token number">0.</span> <span class="token number">1.</span> <span class="token number">0.</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.</span> <span class="token number">0.</span> <span class="token number">0.</span> <span class="token number">0.</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token function">matrix_rank</span><span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token operator">=</span> <span class="token number">3</span>
 
b 
 <span class="token punctuation">[</span><span class="token number">1.</span> <span class="token number">1.</span> <span class="token number">1.</span> <span class="token number">1.</span><span class="token punctuation">]</span>
<span class="token function">matrix_rank</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token operator">=</span> <span class="token number">1</span>
 
zeroes 
 <span class="token punctuation">[</span><span class="token number">0.</span> <span class="token number">0.</span> <span class="token number">0.</span> <span class="token number">0.</span><span class="token punctuation">]</span>
<span class="token function">matrix_rank</span><span class="token punctuation">(</span>zeros<span class="token punctuation">)</span><span class="token operator">=</span> <span class="token number">0</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><h3 id="_7-8-9-trace"><a href="#_7-8-9-trace" class="header-anchor">#</a> 7.8.9  Trace</h3> <p>返回沿矩阵对角线的总和。
<code>double matrix::Trace()</code></p> <p><strong>返回值</strong></p> <p>沿对角线的总和。</p> <p><strong>注意</strong></p> <p>矩阵的迹线等于其本征值的总和。</p> <p><strong>MQL5 示例:</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>  matrix a<span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  a<span class="token punctuation">.</span><span class="token function">Reshape</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;matrix a \n&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;a.Trace() \n&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span><span class="token function">Trace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">/*
  matrix a
  [[0,1,2]
  [3,4,5]
  [6,7,8]]
  a.Trace()
  12.0
  */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><strong>Python 示例:</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>a <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token function">arange</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reshape</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token char">'a \n'</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token char">'np.trace(a) \n'</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span><span class="token function">trace</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>
 
a 
 <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">1</span> <span class="token number">2</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">6</span> <span class="token number">7</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
 
np<span class="token punctuation">.</span><span class="token function">trace</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> 
 <span class="token number">12</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="_7-8-10-spectrum"><a href="#_7-8-10-spectrum" class="header-anchor">#</a> 7.8.10  Spectrum</h3> <p>计算矩阵的谱，作为来自乘积 AT*A 的本征值集合。</p> <p><code>vector matrix::Spectrum()</code></p> <p><strong>返回值</strong></p> <p>矩阵的谱作为矩阵本征值的向量。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">double</span> <span class="token function">MatrixCondSpectral</span><span class="token punctuation">(</span>matrix<span class="token operator">&amp;</span> a<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   <span class="token keyword">double</span> norm<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">;</span>
   vector v<span class="token operator">=</span>a<span class="token punctuation">.</span><span class="token function">Spectrum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token keyword">if</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token keyword">double</span> max_norm<span class="token operator">=</span>v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">double</span> min_norm<span class="token operator">=</span>v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span>ulong i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>v<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
         <span class="token keyword">double</span> real<span class="token operator">=</span><span class="token function">MathAbs</span><span class="token punctuation">(</span>v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>max_norm<span class="token operator">&lt;</span>real<span class="token punctuation">)</span>
            max_norm<span class="token operator">=</span>real<span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>min_norm<span class="token operator">&gt;</span>real<span class="token punctuation">)</span>
            min_norm<span class="token operator">=</span>real<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      max_norm<span class="token operator">=</span><span class="token function">MathSqrt</span><span class="token punctuation">(</span>max_norm<span class="token punctuation">)</span><span class="token punctuation">;</span>
      min_norm<span class="token operator">=</span><span class="token function">MathSqrt</span><span class="token punctuation">(</span>min_norm<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>min_norm<span class="token operator">&gt;</span><span class="token number">0.0</span><span class="token punctuation">)</span>
         norm<span class="token operator">=</span>max_norm<span class="token operator">/</span>min_norm<span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
 
   <span class="token keyword">return</span><span class="token punctuation">(</span>norm<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h2 id="_7-9-求解线性方程组的矩阵方法"><a href="#_7-9-求解线性方程组的矩阵方法" class="header-anchor">#</a> 7.9 求解线性方程组的矩阵方法</h2> <p>求解线性方程组和计算逆矩阵的方法。</p> <table><thead><tr><th>函数</th> <th>动作</th></tr></thead> <tbody><tr><td>Solve</td> <td>求解线性矩阵方程或线性代数方程组</td></tr> <tr><td>LstSq</td> <td>返回线性代数方程的最小二乘解（对于非二乘或退化矩阵）</td></tr> <tr><td>Inv</td> <td>通过乔丹-高斯（Jordan-Gauss）方法计算平方非退化矩阵的（乘法）逆</td></tr> <tr><td>PInv</td> <td>遵照摩尔-彭罗斯（Moore-Penrose）方法计算矩阵的伪逆</td></tr></tbody></table> <h3 id="_7-9-1-solve"><a href="#_7-9-1-solve" class="header-anchor">#</a> 7.9.1  Solve</h3> <p>求解线性矩阵方程或线性代数方程组。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>vector matrix<span class="token double-colon punctuation">::</span><span class="token function">Solve</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> vector  b      <span class="token comment">// 纵坐标或“因变量”值</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>参数</strong></p> <p>b</p> <p>[输入]  纵坐标或“因变量”值。 （自由项的向量）。</p> <p><strong>返回值</strong></p> <p>含有系统 a * x = b 之解的向量。</p> <p><strong>注意</strong></p> <p>如果至少一个矩阵行或列为零，则系统无解。</p> <p>如果两个或多个矩阵行或列线性依赖，则系统无解。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//--- SLAE 解法</span>
   vector_x<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Solve</span><span class="token punctuation">(</span>vector_b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 检查是否 a * x = b</span>
   result_vector<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">MatMul</span><span class="token punctuation">(</span>vector_x<span class="token punctuation">)</span><span class="token punctuation">;</span>
   errors<span class="token operator">=</span>vector_b<span class="token punctuation">.</span><span class="token function">Compare</span><span class="token punctuation">(</span>result_vector<span class="token punctuation">,</span><span class="token number">1e-12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_7-9-2-lstsq"><a href="#_7-9-2-lstsq" class="header-anchor">#</a> 7.9.2  LstSq</h3> <p>返回线性代数方程的最小二乘解（对于非二乘或退化矩阵）。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>vector matrix<span class="token double-colon punctuation">::</span><span class="token function">LstSq</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> vector  b      <span class="token comment">// 纵坐标或“因变量”值</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>参数</strong></p> <p>b</p> <p>[输入]  纵坐标或“因变量”值。 （自由项的向量）</p> <p><strong>返回值</strong></p> <p>含有系统 a * x = b 之解的向量。 这仅适用于具有精准解的系统。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrix a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
             <span class="token punctuation">{</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
             <span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   vector b<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//---</span>
   vector x<span class="token operator">=</span>a<span class="token punctuation">.</span><span class="token function">LstSq</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 检查，必须是 [5, -4]</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;x=&quot;</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 检查，必须是 [7, 40, 3]</span>
   vector b1<span class="token operator">=</span>a<span class="token punctuation">.</span><span class="token function">MatMul</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;b1=&quot;</span><span class="token punctuation">,</span>b1<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">/*
  x=[5.000000000000002,-4]
  b1=[7.000000000000005,40.00000000000001,3.000000000000005]
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="_7-9-3-inv"><a href="#_7-9-3-inv" class="header-anchor">#</a> 7.9.3  Inv</h3> <p>通过乔丹-高斯（Jordan-Gauss）方法计算平方可逆矩阵的乘法逆。</p> <p><code>matrix matrix::Inv()</code></p> <p><strong>返回值</strong></p> <p>矩阵的乘法逆。</p> <p><strong>注意</strong></p> <p>原始矩阵和逆矩阵的乘积就是单位矩阵。</p> <p>如果至少一个矩阵行或列为零，则无法获得逆矩阵。</p> <p>如果两个或多个矩阵行或列线性依赖，则无法获得逆矩阵。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">int</span> <span class="token function">TestInverse</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> size_m<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   <span class="token keyword">int</span>    i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>errors<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
   matrix <span class="token function">matrix_a</span><span class="token punctuation">(</span>size_m<span class="token punctuation">,</span>size_m<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 填充平方矩阵</span>
   <span class="token function">MatrixTestFirst</span><span class="token punctuation">(</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 将测量单位微秒</span>
   ulong t1<span class="token operator">=</span><span class="token function">GetMicrosecondCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 求逆矩阵</span>
   matrix inverse<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">Inv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 测量</span>
   ulong t2<span class="token operator">=</span><span class="token function">GetMicrosecondCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 检查正确性</span>
   matrix identity<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">MatMul</span><span class="token punctuation">(</span>inverse<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//---</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>size_m<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span>size_m<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
         <span class="token keyword">double</span> value<span class="token punctuation">;</span>
         <span class="token comment">//--- 必须沿着对角线填充一</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">==</span>j<span class="token punctuation">)</span>
            value<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">;</span>
         <span class="token keyword">else</span>
            value<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">MathClassify</span><span class="token punctuation">(</span>identity<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&gt;</span>FP_ZERO<span class="token punctuation">)</span>
            errors<span class="token operator">++</span><span class="token punctuation">;</span>
         <span class="token keyword">else</span>
           <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>identity<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">!=</span>value<span class="token punctuation">)</span>
              <span class="token punctuation">{</span>
               <span class="token keyword">double</span> diff<span class="token operator">=</span><span class="token function">MathAbs</span><span class="token punctuation">(</span>identity<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">-</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token comment">//--- 乘法和偏差过多，因此降低了检查精度</span>
               <span class="token keyword">if</span><span class="token punctuation">(</span>diff<span class="token operator">&gt;</span><span class="token number">1e-9</span><span class="token punctuation">)</span>
                  errors<span class="token operator">++</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span>
           <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
<span class="token comment">//---</span>
   <span class="token keyword">double</span> elapsed_time<span class="token operator">=</span><span class="token keyword">double</span><span class="token punctuation">(</span>t2<span class="token operator">-</span>t1<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">1000.0</span><span class="token punctuation">;</span>
   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Inversion of matrix %d x %d  %s  errors=%d  time=%.3f ms&quot;</span><span class="token punctuation">,</span>size_m<span class="token punctuation">,</span>size_m<span class="token punctuation">,</span>errors<span class="token operator">==</span><span class="token number">0</span><span class="token operator">?</span><span class="token string">&quot;passed&quot;</span><span class="token operator">:</span><span class="token string">&quot;failed&quot;</span><span class="token punctuation">,</span>errors<span class="token punctuation">,</span>elapsed_time<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span>errors<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><h3 id="_7-9-4-pinv"><a href="#_7-9-4-pinv" class="header-anchor">#</a> 7.9.4  PInv</h3> <p>通过摩尔-彭罗斯（Moore-Penrose）方法计算矩阵的伪逆。</p> <p><code>matrix matrix::PInv()</code></p> <p><strong>返回值</strong></p> <p>矩阵的伪逆。</p> <p><strong>举例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">int</span> <span class="token function">TestPseudoInverse</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> size_m<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">int</span> size_k<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   matrix <span class="token function">matrix_a</span><span class="token punctuation">(</span>size_m<span class="token punctuation">,</span>size_k<span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix <span class="token function">matrix_inverted</span><span class="token punctuation">(</span>size_k<span class="token punctuation">,</span>size_m<span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix matrix_temp<span class="token punctuation">;</span>
   matrix matrix_a2<span class="token punctuation">;</span>
<span class="token comment">//--- 填充矩阵</span>
   <span class="token function">MatrixTestFirst</span><span class="token punctuation">(</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- invert</span>
   matrix_inverted<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">PInv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 检查正确性</span>
   <span class="token keyword">int</span> errors<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token comment">//--- A * A+ * A = A   (A+ is a pseudo-inverse of A)</span>
   matrix_temp<span class="token operator">=</span>matrix_a<span class="token punctuation">.</span><span class="token function">MatMul</span><span class="token punctuation">(</span>matrix_inverted<span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix_a2<span class="token operator">=</span>matrix_temp<span class="token punctuation">.</span><span class="token function">MatMul</span><span class="token punctuation">(</span>matrix_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
   errors<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>matrix_a<span class="token punctuation">.</span><span class="token function">CompareByDigits</span><span class="token punctuation">(</span>matrix_a2<span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;PseudoInversion %s matrix_size  %d x %d  errors=%d&quot;</span><span class="token punctuation">,</span>errors<span class="token operator">==</span><span class="token number">0</span><span class="token operator">?</span><span class="token string">&quot;passed&quot;</span><span class="token operator">:</span><span class="token string">&quot;failed&quot;</span><span class="token punctuation">,</span>size_m<span class="token punctuation">,</span>size_k<span class="token punctuation">,</span>errors<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//---</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span>errors<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h2 id="_7-10-机器学习"><a href="#_7-10-机器学习" class="header-anchor">#</a> 7.10  机器学习</h2> <p>这些方法用于机器学习。</p> <p>神经网络激活函数根据输入的加权累加和来判定神经元的输出值。 激活函数的选择对神经网络性能有很大影响。 模型部件（层）不同可选用不同的激活函数。</p> <p>除了所有已知的激活函数外，MQL5 还提供其衍生函数。 函数导数能够根据学习中接到的误差有效地更新模型参数。</p> <p>神经网络旨在找到一种算法，将学习误差最小化，为此选用了损失函数。 损失函数的值表示模型预测值与实际值的偏差度。 根据问题采用不同的损失函数。 例如，均方误差（MSE） 用于回归问题；二元交叉熵（BCE）用于二元分类目的。</p> <table><thead><tr><th>函数</th> <th>动作</th></tr></thead> <tbody><tr><td>Activation</td> <td>计算激活函数值，并将其写入传递的向量/矩阵</td></tr> <tr><td>Derivative</td> <td>计算激活函数导数值，并将其写入所传递的向量/矩阵</td></tr> <tr><td>Loss</td> <td>计算损失函数值，并将其写入所传递的向量/矩阵</td></tr> <tr><td>LossGradient</td> <td>计算亏损函数梯度的向量或矩阵</td></tr> <tr><td>RegressionMetric</td> <td>在指定数据数组上构建回归线，并计算回归量程作为偏差误差</td></tr> <tr><td>ConfusionMatrix</td> <td>计算混淆矩阵。该方法应用于预测值向量</td></tr> <tr><td>ConfusionMatrixMultilabel</td> <td>计算每个标签的混淆矩阵。该方法应用于预测值向量</td></tr> <tr><td>ClassificationMetric</td> <td>计算分类指标来评估预测数据相对于真实数据的质量。该方法适用于预测值的向量</td></tr> <tr><td>ClassificationScore</td> <td>计算分类指标来评估预测数据相对于真实数据的质量</td></tr> <tr><td>PrecisionRecall</td> <td>计算值以构建精确调用曲线。与ClassificationScore类似，此方法应用于真值向量</td></tr> <tr><td>ReceiverOperatingCharacteristic</td> <td>计算值以构建接收器工作特性(ROC)曲线。与ClassificationScore类似，此方法应用于真值向量</td></tr></tbody></table> <p><strong>举例</strong></p> <p>此示例演示如何选用矩阵运算训练模型。 训练的模型针对函数 (a + b + c)^2 / (a^2 + b^2 + c^2)。 我们输入初始数据矩阵，其中 a、b 和 c 包含在不同的列中。 函数结果在模型输出端获得。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>matrix weights1<span class="token punctuation">,</span> weights2<span class="token punctuation">,</span> weights3<span class="token punctuation">;</span>               <span class="token comment">// 权重矩阵</span>
matrix output1<span class="token punctuation">,</span> output2<span class="token punctuation">,</span> result<span class="token punctuation">;</span>                   <span class="token comment">// 神经层输出矩阵</span>
input <span class="token keyword">int</span> layer1 <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>                            <span class="token comment">// 第一个隐藏层的大小</span>
input <span class="token keyword">int</span> layer2 <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>                            <span class="token comment">// 第二个隐藏层的大小</span>
input <span class="token keyword">int</span> Epochs <span class="token operator">=</span> <span class="token number">20000</span><span class="token punctuation">;</span>                          <span class="token comment">// 训练世代的数量</span>
input <span class="token keyword">double</span> lr <span class="token operator">=</span> <span class="token number">3e-6</span><span class="token punctuation">;</span>                            <span class="token comment">// 学习率</span>
input ENUM_ACTIVATION_FUNCTION ac_func <span class="token operator">=</span> AF_SWISH<span class="token punctuation">;</span> <span class="token comment">// 激活函数</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 脚本程序 start 函数                                                |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//---</span>
   <span class="token keyword">int</span> train <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>    <span class="token comment">// 训练样本大小</span>
   <span class="token keyword">int</span> test <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>       <span class="token comment">// 测试样本大小</span>
   matrix m_data<span class="token punctuation">,</span> m_target<span class="token punctuation">;</span>
<span class="token comment">//--- 生成训练样本</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">CreateData</span><span class="token punctuation">(</span>m_data<span class="token punctuation">,</span> m_target<span class="token punctuation">,</span> train<span class="token punctuation">)</span><span class="token punctuation">)</span>  
      <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token comment">//--- 训练模型</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">Train</span><span class="token punctuation">(</span>m_data<span class="token punctuation">,</span> m_target<span class="token punctuation">,</span> Epochs<span class="token punctuation">)</span><span class="token punctuation">)</span>      
      <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token comment">//--- 生成测试样本</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">CreateData</span><span class="token punctuation">(</span>m_data<span class="token punctuation">,</span> m_target<span class="token punctuation">,</span> test<span class="token punctuation">)</span><span class="token punctuation">)</span>   
      <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token comment">//--- 测试模型</span>
   <span class="token function">Test</span><span class="token punctuation">(</span>m_data<span class="token punctuation">,</span> m_target<span class="token punctuation">)</span><span class="token punctuation">;</span>                   
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 样本生成方法                                                       |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">bool</span> <span class="token function">CreateData</span><span class="token punctuation">(</span>matrix <span class="token operator">&amp;</span>data<span class="token punctuation">,</span> matrix <span class="token operator">&amp;</span>target<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">int</span> count<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 初始化初始数据和结果矩阵</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>data<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span>target<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token comment">//--- 用随机值填充初始数据矩阵</span>
   data<span class="token punctuation">.</span><span class="token function">Random</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                     
<span class="token comment">//--- 计算训练样本的目标值</span>
   vector X1 <span class="token operator">=</span> <span class="token function">MathPow</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">Col</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> data<span class="token punctuation">.</span><span class="token function">Col</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> data<span class="token punctuation">.</span><span class="token function">Col</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector X2 <span class="token operator">=</span> <span class="token function">MathPow</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">Col</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">MathPow</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">Col</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">MathPow</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">Col</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>target<span class="token punctuation">.</span><span class="token function">Col</span><span class="token punctuation">(</span>X1 <span class="token operator">/</span> X2<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token comment">//--- 返回结果</span>
   <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 模型训练方法                                                       |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">bool</span> <span class="token function">Train</span><span class="token punctuation">(</span>matrix <span class="token operator">&amp;</span>data<span class="token punctuation">,</span> matrix <span class="token operator">&amp;</span>target<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">int</span> epochs <span class="token operator">=</span> <span class="token number">10000</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 创建模型</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">CreateNet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token comment">//--- 训练模型</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> ep <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> ep <span class="token operator">&lt;</span> epochs<span class="token punctuation">;</span> ep<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token comment">//--- 前向验算</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">FeedForward</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
      <span class="token function">PrintFormat</span><span class="token punctuation">(</span><span class="token string">&quot;Epoch %d, loss %.5f&quot;</span><span class="token punctuation">,</span> ep<span class="token punctuation">,</span> result<span class="token punctuation">.</span><span class="token function">Loss</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> LOSS_MSE<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 权重矩阵的反向传播与更新</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">Backprop</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> target<span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 返回结果</span>
   <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 模型创建方法                                                       |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">bool</span> <span class="token function">CreateNet</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 初始化权重矩阵</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>weights1<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> layer1<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span>weights2<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span>layer1 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> layer2<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span>weights3<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span>layer2 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token comment">//--- 用随机值填充权重矩阵</span>
   weights1<span class="token punctuation">.</span><span class="token function">Random</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   weights2<span class="token punctuation">.</span><span class="token function">Random</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   weights3<span class="token punctuation">.</span><span class="token function">Random</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 返回结果</span>
   <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 前向验算方法                                                       |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">bool</span> <span class="token function">FeedForward</span><span class="token punctuation">(</span>matrix <span class="token operator">&amp;</span>data<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 检查初始数据大小</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">Cols</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> weights1<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token comment">//--- 计算第一个神经层</span>
   matrix temp <span class="token operator">=</span> data<span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>temp<span class="token punctuation">.</span><span class="token function">Resize</span><span class="token punctuation">(</span>temp<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> weights1<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span>
      <span class="token operator">!</span>temp<span class="token punctuation">.</span><span class="token function">Col</span><span class="token punctuation">(</span>vector<span class="token double-colon punctuation">::</span><span class="token function">Ones</span><span class="token punctuation">(</span>temp<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> weights1<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
   output1 <span class="token operator">=</span> temp<span class="token punctuation">.</span><span class="token function">MatMul</span><span class="token punctuation">(</span>weights1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 计算激活函数</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>output1<span class="token punctuation">.</span><span class="token function">Activation</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> ac_func<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token comment">//--- 计算第二个神经层</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>temp<span class="token punctuation">.</span><span class="token function">Resize</span><span class="token punctuation">(</span>temp<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> weights2<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span>
      <span class="token operator">!</span>temp<span class="token punctuation">.</span><span class="token function">Col</span><span class="token punctuation">(</span>vector<span class="token double-colon punctuation">::</span><span class="token function">Ones</span><span class="token punctuation">(</span>temp<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> weights2<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
   output2 <span class="token operator">=</span> temp<span class="token punctuation">.</span><span class="token function">MatMul</span><span class="token punctuation">(</span>weights2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 计算激活函数</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>output2<span class="token punctuation">.</span><span class="token function">Activation</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> ac_func<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token comment">//--- 计算第三个神经层</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>temp<span class="token punctuation">.</span><span class="token function">Resize</span><span class="token punctuation">(</span>temp<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> weights3<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span>
      <span class="token operator">!</span>temp<span class="token punctuation">.</span><span class="token function">Col</span><span class="token punctuation">(</span>vector<span class="token double-colon punctuation">::</span><span class="token function">Ones</span><span class="token punctuation">(</span>temp<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> weights3<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
   result <span class="token operator">=</span> temp<span class="token punctuation">.</span><span class="token function">MatMul</span><span class="token punctuation">(</span>weights3<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 返回结果</span>
   <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 反向传播法                                                         |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">bool</span> <span class="token function">Backprop</span><span class="token punctuation">(</span>matrix <span class="token operator">&amp;</span>data<span class="token punctuation">,</span> matrix <span class="token operator">&amp;</span>target<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 检查目标值矩阵的大小</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> result<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span>
      target<span class="token punctuation">.</span><span class="token function">Cols</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> result<span class="token punctuation">.</span><span class="token function">Cols</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token comment">//--- 检测计算值与目标的偏差</span>
   matrix loss <span class="token operator">=</span> <span class="token punctuation">(</span>target <span class="token operator">-</span> result<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token comment">//--- 将梯度传播到上一层</span>
   matrix gradient <span class="token operator">=</span> loss<span class="token punctuation">.</span><span class="token function">MatMul</span><span class="token punctuation">(</span>weights3<span class="token punctuation">.</span><span class="token function">Transpose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 更新最后一层的权重矩阵</span>
   matrix temp<span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>output2<span class="token punctuation">.</span><span class="token function">Activation</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> ac_func<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>temp<span class="token punctuation">.</span><span class="token function">Resize</span><span class="token punctuation">(</span>temp<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> weights3<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span>
      <span class="token operator">!</span>temp<span class="token punctuation">.</span><span class="token function">Col</span><span class="token punctuation">(</span>vector<span class="token double-colon punctuation">::</span><span class="token function">Ones</span><span class="token punctuation">(</span>temp<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> weights3<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
   weights3 <span class="token operator">=</span> weights3 <span class="token operator">+</span> temp<span class="token punctuation">.</span><span class="token function">Transpose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">MatMul</span><span class="token punctuation">(</span>loss<span class="token punctuation">)</span> <span class="token operator">*</span> lr<span class="token punctuation">;</span>
<span class="token comment">//--- 依据激活函数的导数调整误差梯度</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>output2<span class="token punctuation">.</span><span class="token function">Derivative</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> ac_func<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>gradient<span class="token punctuation">.</span><span class="token function">Resize</span><span class="token punctuation">(</span>gradient<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> gradient<span class="token punctuation">.</span><span class="token function">Cols</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
   loss <span class="token operator">=</span> gradient <span class="token operator">*</span> temp<span class="token punctuation">;</span>
<span class="token comment">//--- 将梯度传播到更低一层</span>
   gradient <span class="token operator">=</span> loss<span class="token punctuation">.</span><span class="token function">MatMul</span><span class="token punctuation">(</span>weights2<span class="token punctuation">.</span><span class="token function">Transpose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 更新第二隐藏层的权重矩阵</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>output1<span class="token punctuation">.</span><span class="token function">Activation</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> ac_func<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>temp<span class="token punctuation">.</span><span class="token function">Resize</span><span class="token punctuation">(</span>temp<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> weights2<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span>
      <span class="token operator">!</span>temp<span class="token punctuation">.</span><span class="token function">Col</span><span class="token punctuation">(</span>vector<span class="token double-colon punctuation">::</span><span class="token function">Ones</span><span class="token punctuation">(</span>temp<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> weights2<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
   weights2 <span class="token operator">=</span> weights2 <span class="token operator">+</span> temp<span class="token punctuation">.</span><span class="token function">Transpose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">MatMul</span><span class="token punctuation">(</span>loss<span class="token punctuation">)</span> <span class="token operator">*</span> lr<span class="token punctuation">;</span>
<span class="token comment">//--- 依据激活函数的导数调整误差梯度</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>output1<span class="token punctuation">.</span><span class="token function">Derivative</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> ac_func<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>gradient<span class="token punctuation">.</span><span class="token function">Resize</span><span class="token punctuation">(</span>gradient<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> gradient<span class="token punctuation">.</span><span class="token function">Cols</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
   loss <span class="token operator">=</span> gradient <span class="token operator">*</span> temp<span class="token punctuation">;</span>
<span class="token comment">//--- 更新第一隐藏层的权重矩阵</span>
   temp <span class="token operator">=</span> data<span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>temp<span class="token punctuation">.</span><span class="token function">Resize</span><span class="token punctuation">(</span>temp<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> weights1<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span>
      <span class="token operator">!</span>temp<span class="token punctuation">.</span><span class="token function">Col</span><span class="token punctuation">(</span>vector<span class="token double-colon punctuation">::</span><span class="token function">Ones</span><span class="token punctuation">(</span>temp<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> weights1<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
   weights1 <span class="token operator">=</span> weights1 <span class="token operator">+</span> temp<span class="token punctuation">.</span><span class="token function">Transpose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">MatMul</span><span class="token punctuation">(</span>loss<span class="token punctuation">)</span> <span class="token operator">*</span> lr<span class="token punctuation">;</span>
<span class="token comment">//--- 返回结果</span>
   <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 模型测试方法                                                       |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">bool</span> <span class="token function">Test</span><span class="token punctuation">(</span>matrix <span class="token operator">&amp;</span>data<span class="token punctuation">,</span> matrix <span class="token operator">&amp;</span>target<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 前向测试数据</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">FeedForward</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token comment">//--- 记录模型计算结果和真实值</span>
   <span class="token function">PrintFormat</span><span class="token punctuation">(</span><span class="token string">&quot;Test loss %.5f&quot;</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span><span class="token function">Loss</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> LOSS_MSE<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   ulong total <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>ulong i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> total<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
      <span class="token function">PrintFormat</span><span class="token punctuation">(</span><span class="token string">&quot;(%.2f + %.2f + %.2f)^2 / (%.2f^2 + %.2f^2 + %.2f^2) =  Net %.2f, Target %.2f&quot;</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  data<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> result<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> target<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 返回结果</span>
   <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br></div></div><h3 id="_7-10-1-activation"><a href="#_7-10-1-activation" class="header-anchor">#</a> 7.10.1   Activation</h3> <p>计算激活函数值，并将其写入传递的向量/矩阵。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span> vector<span class="token double-colon punctuation">::</span><span class="token function">Activation</span><span class="token punctuation">(</span>
  vector<span class="token operator">&amp;</span>                   vect_out<span class="token punctuation">,</span>      <span class="token comment">// 获取函数值的向量</span>
  ENUM_ACTIVATION_FUNCTION  activation<span class="token punctuation">,</span>    <span class="token comment">// 激活函数</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>                                     <span class="token comment">// 附加参数</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
 
<span class="token keyword">bool</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Activation</span><span class="token punctuation">(</span>
  matrix<span class="token operator">&amp;</span>                   matrix_out<span class="token punctuation">,</span>    <span class="token comment">// 获取函数值的矩阵</span>
  ENUM_ACTIVATION_FUNCTION  activation     <span class="token comment">// 激活函数</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
 
<span class="token keyword">bool</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Activation</span><span class="token punctuation">(</span>
  matrix<span class="token operator">&amp;</span>                   matrix_out<span class="token punctuation">,</span>    <span class="token comment">// 获取函数值的矩阵</span>
  ENUM_ACTIVATION_FUNCTION  activation<span class="token punctuation">,</span>    <span class="token comment">// 激活函数</span>
  ENUM_MATRIX_AXIS          axis<span class="token punctuation">,</span>          <span class="token comment">// 轴线</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>                                     <span class="token comment">// 附加参数</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><strong>参数</strong></p> <p>vect_out/matrix_out</p> <p>[out]  获取激活函数计算值的向量或矩阵。</p> <p>activation</p> <p>[in] ENUM_ACTIVATION_FUNCTION枚举中的激活函数。</p> <p>axis</p> <p>[in] ENUM_MATRIX_AXIS枚举值（AXIS_HORZ ― 横轴，AXIS_VERT ― 竖轴）。</p> <p>...</p> <p>[in]  某些激活函数所需的附加参数。如果没有指定参数，则使用默认值。</p> <p><strong>返回值</strong></p> <p>如果成功返回true，否则返回false。</p> <p><strong>附加参数</strong></p> <p>某些激活函数接受附加参数。如果没有指定参数，则使用默认值</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   <span class="token function">AF_ELU</span>  <span class="token punctuation">(</span>Exponential Linear Unit<span class="token punctuation">)</span>  
     <span class="token keyword">double</span> alpha<span class="token operator">=</span><span class="token number">1.0</span>
   
   Activation function<span class="token operator">:</span> <span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">&gt;=</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=</span> x
                      <span class="token keyword">else</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=</span> alpha <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token function">exp</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
   
   
   AF_LINEAR   
     <span class="token keyword">double</span> alpha<span class="token operator">=</span><span class="token number">1.0</span>
     <span class="token keyword">double</span> beta<span class="token operator">=</span><span class="token number">0.0</span>
   
   Activation function<span class="token operator">:</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=</span> alpha<span class="token operator">*</span>x <span class="token operator">+</span> beta
   
   
   <span class="token function">AF_LRELU</span>   <span class="token punctuation">(</span>Leaky REctified Linear Unit<span class="token punctuation">)</span>   
     <span class="token keyword">double</span> alpha<span class="token operator">=</span><span class="token number">0.3</span>
   
   Activation function<span class="token operator">:</span> <span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">&gt;=</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">=</span>x
                      <span class="token keyword">else</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=</span> alpha<span class="token operator">*</span>x
   
                        
   <span class="token function">AF_RELU</span>  <span class="token punctuation">(</span>REctified Linear Unit<span class="token punctuation">)</span>   
     <span class="token keyword">double</span> alpha<span class="token operator">=</span><span class="token number">0.0</span>
     <span class="token keyword">double</span> max_value<span class="token operator">=</span><span class="token number">0.0</span>
     <span class="token keyword">double</span> treshold<span class="token operator">=</span><span class="token number">0.0</span>
   
   Activation function<span class="token operator">:</span> <span class="token keyword">if</span><span class="token punctuation">(</span>alpha<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
                      <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">&gt;</span>max_value<span class="token punctuation">)</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=</span> x
                      <span class="token keyword">else</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=</span> alpha<span class="token operator">*</span><span class="token punctuation">(</span>x <span class="token operator">-</span> treshold<span class="token punctuation">)</span>
   
   
   AF_SWISH   
     <span class="token keyword">double</span> beta<span class="token operator">=</span><span class="token number">1.0</span>
   
   Activation function<span class="token operator">:</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=</span> x <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span><span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span>x<span class="token operator">*</span>beta<span class="token punctuation">)</span><span class="token punctuation">)</span>
   
   
   <span class="token function">AF_TRELU</span>   <span class="token punctuation">(</span>Thresholded REctified Linear Unit<span class="token punctuation">)</span>   
     <span class="token keyword">double</span> theta<span class="token operator">=</span><span class="token number">1.0</span>
   
   Activation function<span class="token operator">:</span> <span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">&gt;</span>theta<span class="token punctuation">)</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=</span> x
                      <span class="token keyword">else</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span>
   
   
   <span class="token function">AF_PRELU</span>   <span class="token punctuation">(</span>Parametric REctified Linear Unit<span class="token punctuation">)</span>   
     <span class="token keyword">double</span> alpha<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">-</span> learned array of coeefficients
   
   Activation function<span class="token operator">:</span> <span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&gt;=</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
                      <span class="token keyword">else</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> alpha<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> x<span class="token punctuation">[</span>i<span class="token punctuation">]</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br></div></div><p><strong>注意</strong></p> <p>在人工神经网络中，神经元的激活函数决定输出信号，输出信号由一个输入信号或一组输入信号定义。激活函数的选择对神经网络的性能有很大的影响。不同的模型部件(层)可以使用不同的激活函数。</p> <p><strong>使用附加参数的示例：</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   vector x<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.4</span><span class="token punctuation">,</span> <span class="token number">0.9</span><span class="token punctuation">,</span> <span class="token number">2.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   vector y<span class="token punctuation">;</span>
 
   x<span class="token punctuation">.</span><span class="token function">Activation</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span>AF_ELU<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
   x<span class="token punctuation">.</span><span class="token function">Activation</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span>AF_ELU<span class="token punctuation">,</span><span class="token number">2.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   x<span class="token punctuation">.</span><span class="token function">Activation</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span>AF_LINEAR<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
   x<span class="token punctuation">.</span><span class="token function">Activation</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span>AF_LINEAR<span class="token punctuation">,</span><span class="token number">2.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
   x<span class="token punctuation">.</span><span class="token function">Activation</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span>AF_LINEAR<span class="token punctuation">,</span><span class="token number">2.0</span><span class="token punctuation">,</span><span class="token number">5.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   x<span class="token punctuation">.</span><span class="token function">Activation</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span>AF_LRELU<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
   x<span class="token punctuation">.</span><span class="token function">Activation</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span>AF_LRELU<span class="token punctuation">,</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
   x<span class="token punctuation">.</span><span class="token function">Activation</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span>AF_LRELU<span class="token punctuation">,</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
  
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   x<span class="token punctuation">.</span><span class="token function">Activation</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span>AF_RELU<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
   x<span class="token punctuation">.</span><span class="token function">Activation</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span>AF_RELU<span class="token punctuation">,</span><span class="token number">2.0</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
   x<span class="token punctuation">.</span><span class="token function">Activation</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span>AF_RELU<span class="token punctuation">,</span><span class="token number">2.0</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">,</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   x<span class="token punctuation">.</span><span class="token function">Activation</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span>AF_SWISH<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
   x<span class="token punctuation">.</span><span class="token function">Activation</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span>AF_SWISH<span class="token punctuation">,</span><span class="token number">2.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   x<span class="token punctuation">.</span><span class="token function">Activation</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span>AF_TRELU<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
   x<span class="token punctuation">.</span><span class="token function">Activation</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span>AF_TRELU<span class="token punctuation">,</span><span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector a<span class="token operator">=</span>vector<span class="token double-colon punctuation">::</span><span class="token function">Full</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   x<span class="token punctuation">.</span><span class="token function">Activation</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span>AF_PRELU<span class="token punctuation">,</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">/*  Results
   [0.1,0.4,0.9,2,-0.993262053000915,0,-0.095162581964040]
   [0.1,0.4,0.9,2,-1.986524106001829,0,-0.190325163928081]
   
   [0.1,0.4,0.9,2,-5,0,-0.1]
   [0.2,0.8,1.8,4,-10,0,-0.2]
   [5.2,5.8,6.8,9,-5,5,4.8]
   
   [0.1,0.4,0.9,2,-1.5,0,-0.03]
   [0.1,0.4,0.9,2,-5,0,-0.1]
   [0.1,0.4,0.9,2,-0.5,0,-0.01]
   
   [0.1,0.4,0.9,2,0,0,0]
   [0.2,0.8,0.9,2,-10,0,-0.2]
   [-1.8,-1.2,0.9,2,-12,-2,-2.2]
   
   [0.052497918747894,0.239475064044981,0.6398545523625035,1.761594155955765,-0.03346425462142428,0,-0.047502081252106]
   [0.054983399731247,0.275989792451045,0.7723340415895611,1.964027580075817,-0.00022698934351217,0,-0.045016600268752]
   
   [0,0,0,2,0,0,0]
   [0,0.4,0.9,2,0,0,0]
   
   [0.1,0.4,0.9,2,-10,0,-0.2]
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br></div></div><h3 id="_7-10-2-derivative"><a href="#_7-10-2-derivative" class="header-anchor">#</a> 7.10.2 Derivative</h3> <p>计算激活函数的导数值，并将其写入传递的向量/矩阵。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span> vector<span class="token double-colon punctuation">::</span><span class="token function">Derivative</span><span class="token punctuation">(</span>
  vector<span class="token operator">&amp;</span>                   vect_out<span class="token punctuation">,</span>      <span class="token comment">// 获取函数值的向量</span>
  ENUM_ACTIVATION_FUNCTION  activation<span class="token punctuation">,</span>    <span class="token comment">// 激活函数</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>                                     <span class="token comment">// 附加参数</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
 
<span class="token keyword">bool</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Derivative</span><span class="token punctuation">(</span>
  matrix<span class="token operator">&amp;</span>                   matrix_out<span class="token punctuation">,</span>    <span class="token comment">// 获取函数值的矩阵</span>
  ENUM_ACTIVATION_FUNCTION  activation<span class="token punctuation">,</span>    <span class="token comment">// 激活函数</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
 
<span class="token keyword">bool</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Derivative</span><span class="token punctuation">(</span>
  matrix<span class="token operator">&amp;</span>                   matrix_out<span class="token punctuation">,</span>    <span class="token comment">// 获取函数值的矩阵</span>
  ENUM_ACTIVATION_FUNCTION  activation<span class="token punctuation">,</span>    <span class="token comment">// 激活函数</span>
  ENUM_MATRIX_AXIS          axis<span class="token punctuation">,</span>          <span class="token comment">// 轴线</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>                                     <span class="token comment">// 附加参数</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><strong>参数</strong></p> <p>vect_out/matrix_out</p> <p>[out]  获取激活函数导数计算值的向量或矩阵。</p> <p>activation</p> <p>[in] ENUM_ACTIVATION_FUNCTION枚举中的激活函数。</p> <p>axis</p> <p>[in] ENUM_MATRIX_AXIS枚举值（AXIS_HORZ ― 横轴，AXIS_VERT ― 竖轴）。</p> <p>...</p> <p>[in]  附加参数与激活函数的参数相同。只有某些激活函数接受附加参数。如果没有指定参数，则使用默认值。</p> <p><strong>返回值</strong></p> <p>如果成功返回true，否则返回false。</p> <p><strong>注意</strong></p> <p>在误差反向传播过程中，函数导数能够基于学习过程中接收到的误差有效地更新模型参数。</p> <h3 id="_7-10-3-loss"><a href="#_7-10-3-loss" class="header-anchor">#</a> 7.10.3  Loss</h3> <p>计算损失函数的值。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">double</span> vector<span class="token double-colon punctuation">::</span><span class="token function">Loss</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> vector<span class="token operator">&amp;</span>       vect_true<span class="token punctuation">,</span>     <span class="token comment">// 真值向量</span>
  ENUM_LOSS_FUNCTION  loss<span class="token punctuation">,</span>          <span class="token comment">// 损失函数</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>                               <span class="token comment">// 附加参数</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
 
<span class="token keyword">double</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Loss</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> matrix<span class="token operator">&amp;</span>       matrix_true<span class="token punctuation">,</span>   <span class="token comment">// 真值矩阵</span>
  ENUM_LOSS_FUNCTION  loss<span class="token punctuation">,</span>          <span class="token comment">// 损失函数</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
 
<span class="token keyword">double</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">Loss</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> matrix<span class="token operator">&amp;</span>       matrix_true<span class="token punctuation">,</span>   <span class="token comment">// 真值矩阵</span>
  ENUM_LOSS_FUNCTION  loss<span class="token punctuation">,</span>          <span class="token comment">// 损失函数</span>
  ENUM_MATRIX_AXIS    axis<span class="token punctuation">,</span>          <span class="token comment">// 轴线</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>                               <span class="token comment">// 附加参数</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><strong>参数</strong></p> <p>vect_true/matrix_true</p> <p>[in] 真值的向量或矩阵。</p> <p>loss</p> <p>[in] ENUM_LOSS_FUNCTION枚举中的损失函数。</p> <p>axis</p> <p>[in] ENUM_MATRIX_AXIS枚举值（AXIS_HORZ ― 横轴，AXIS_VERT ― 竖轴）。</p> <p>...</p> <p>[in]  附加参数'delta'只能由Hubert损失函数(LOSS_HUBER)使用</p> <p><strong>返回值</strong></p> <p>双数值。</p> <p><strong>如果Hubert损失函数(LOSS_HUBER)中使用在'delta'参数</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   <span class="token keyword">double</span> delta <span class="token operator">=</span> <span class="token number">1.0</span><span class="token punctuation">;</span>
   <span class="token keyword">double</span> error <span class="token operator">=</span> <span class="token function">fabs</span><span class="token punctuation">(</span>y <span class="token operator">-</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>error<span class="token operator">&lt;</span>delta<span class="token punctuation">)</span>
      loss <span class="token operator">=</span> <span class="token number">0.5</span> <span class="token operator">*</span> error<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">;</span>
   <span class="token keyword">else</span>
      loss <span class="token operator">=</span> <span class="token number">0.5</span> <span class="token operator">*</span> delta<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">+</span> delta <span class="token operator">*</span> <span class="token punctuation">(</span>error <span class="token operator">-</span> delta<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>注意</strong></p> <p>神经网络的目标是找到最小化训练样本误差的算法，为此使用损失函数。</p> <p>损失函数的值表示模型预测值与实际值偏差的程度。</p> <p>根据不同的问题使用不同的损失函数。例如，均方误差(MSE)用于回归问题，二元交叉熵(BCE)用于二元分类。</p> <p><strong>调用Hubert损失函数的示例：</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   vector y_true <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   vector y_pred <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0.6</span><span class="token punctuation">,</span> <span class="token number">0.4</span><span class="token punctuation">,</span> <span class="token number">0.4</span><span class="token punctuation">,</span> <span class="token number">0.6</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token keyword">double</span> loss<span class="token operator">=</span>y_pred<span class="token punctuation">.</span><span class="token function">Loss</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span>LOSS_HUBER<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span>loss<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">double</span> loss2<span class="token operator">=</span>y_pred<span class="token punctuation">.</span><span class="token function">Loss</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span>LOSS_HUBER<span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span>loss2<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">/* Result
   0.155
   0.15125
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="_7-10-4-lossgradient"><a href="#_7-10-4-lossgradient" class="header-anchor">#</a> 7.10.4  LossGradient</h3> <p>计算损失函数梯度的向量或矩阵。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>vector vector<span class="token double-colon punctuation">::</span><span class="token function">LossGradient</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> vector<span class="token operator">&amp;</span>       vect_true<span class="token punctuation">,</span>     <span class="token comment">// 真值向量</span>
  ENUM_LOSS_FUNCTION  loss<span class="token punctuation">,</span>          <span class="token comment">// 损失函数类型</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>                               <span class="token comment">// 附加参数</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
 
matrix matrix<span class="token double-colon punctuation">::</span><span class="token function">LossGradient</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> matrix<span class="token operator">&amp;</span>       matrix_true<span class="token punctuation">,</span>   <span class="token comment">// 真值矩阵</span>
  ENUM_LOSS_FUNCTION  loss<span class="token punctuation">,</span>          <span class="token comment">// 损失函数</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
 
matrix matrix<span class="token double-colon punctuation">::</span><span class="token function">LossGradient</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> matrix<span class="token operator">&amp;</span>       matrix_true<span class="token punctuation">,</span>   <span class="token comment">// 真值矩阵</span>
  ENUM_LOSS_FUNCTION  loss<span class="token punctuation">,</span>          <span class="token comment">// 损失函数</span>
  ENUM_MATRIX_AXIS    axis<span class="token punctuation">,</span>          <span class="token comment">// 轴线</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>                               <span class="token comment">// 附加参数</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><strong>参数</strong></p> <p><code>vect_true/matrix_true</code></p> <p>[in] 真值的向量或矩阵。</p> <p>loss</p> <p>[in] ENUM_LOSS_FUNCTION枚举中的损失函数。</p> <p>axis</p> <p>[in] ENUM_MATRIX_AXIS枚举值（AXIS_HORZ ― 横轴，AXIS_VERT ― 竖轴）。</p> <p>...</p> <p>[in]  附加参数'delta'只能由Hubert损失函数(LOSS_HUBER)使用</p> <p><strong>返回值</strong></p> <p>损失函数梯度值的向量或矩阵。梯度是损失函数在给定点上对dx的偏导数（x是预测值）。</p> <p><strong>注意</strong></p> <p>神经网络在训练模型时，在反向传播过程中使用梯度来调整权重矩阵的权重。</p> <p>神经网络的目标是找到最小化训练样本误差的算法，为此使用损失函数。</p> <p>根据不同的问题使用不同的损失函数。例如，均方误差(MSE)用于回归问题，二元交叉熵(BCE)用于二元分类。</p> <p><strong>计算损失函数梯度的示例</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrixf y_true<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
                   <span class="token punctuation">{</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
                   <span class="token punctuation">{</span> <span class="token number">9</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">12</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   matrixf y_pred<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
                   <span class="token punctuation">{</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">8</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
                   <span class="token punctuation">{</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span><span class="token number">12</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   matrixf loss_gradient <span class="token operator">=</span>y_pred<span class="token punctuation">.</span><span class="token function">LossGradient</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span>LOSS_MAE<span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrixf loss_gradienth<span class="token operator">=</span>y_pred<span class="token punctuation">.</span><span class="token function">LossGradient</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span>LOSS_MAE<span class="token punctuation">,</span>AXIS_HORZ<span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrixf loss_gradientv<span class="token operator">=</span>y_pred<span class="token punctuation">.</span><span class="token function">LossGradient</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span>LOSS_MAE<span class="token punctuation">,</span>AXIS_VERT<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;loss gradients\n&quot;</span><span class="token punctuation">,</span>loss_gradient<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;loss gradients on horizontal axis\n&quot;</span><span class="token punctuation">,</span>loss_gradienth<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;loss gradients on vertical axis\n&quot;</span><span class="token punctuation">,</span>loss_gradientv<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">/* Result
   loss gradients
   [[0,0,0,0]
    [0.083333336,0.083333336,0.083333336,0]
    [-0.083333336,-0.083333336,-0.083333336,0]]
   loss gradients on horizontal axis
   [[0,0,0,0]
    [0.33333334,0.33333334,0.33333334,0]
    [-0.33333334,-0.33333334,-0.33333334,0]]
   loss gradients on vertical axis
   [[0,0,0,0]
    [0.25,0.25,0.25,0]
    [-0.25,-0.25,-0.25,0]]
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h3 id="_7-10-5-regressionmetric"><a href="#_7-10-5-regressionmetric" class="header-anchor">#</a> 7.10.5  RegressionMetric</h3> <p>计算回归指标来评估预测数据与真实数据相比的质量</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">double</span> vector<span class="token double-colon punctuation">::</span><span class="token function">RegressionMetric</span><span class="token punctuation">(</span>
   <span class="token keyword">const</span> vector<span class="token operator">&amp;</span>           vector_true<span class="token punctuation">,</span>   <span class="token comment">// 真值向量</span>
   ENUM_REGRESSION_METRIC  metric         <span class="token comment">// 指标类型</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">double</span> matrix<span class="token double-colon punctuation">::</span><span class="token function">RegressionMetric</span><span class="token punctuation">(</span>
   <span class="token keyword">const</span> matrix<span class="token operator">&amp;</span>           matrix_true<span class="token punctuation">,</span>   <span class="token comment">// 真值矩阵</span>
   ENUM_REGRESSION_METRIC  metric         <span class="token comment">// 指标类型</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
vector matrix<span class="token double-colon punctuation">::</span><span class="token function">RegressionMetric</span><span class="token punctuation">(</span>
   <span class="token keyword">const</span> matrix<span class="token operator">&amp;</span>           matrix_true<span class="token punctuation">,</span>   <span class="token comment">// 真值矩阵</span>
   ENUM_REGRESSION_METRIC  metric<span class="token punctuation">,</span>        <span class="token comment">// 指标类型</span>
   <span class="token keyword">int</span>                     axis           <span class="token comment">// 轴线</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p><strong>参数</strong></p> <p>vector_true/matrix_true</p> <p>[in]  真值的向量或矩阵。</p> <p>metric</p> <p>[in]  来自ENUM_REGRESSION_METRIC枚举的指标类型。</p> <p>axis</p> <p>[in]  轴线。0 ― 横轴，1 ― 竖轴。</p> <p><strong>返回值</strong></p> <p>计算用于评估预测数据与真实数据相比的质量的指标</p> <p><strong>注意</strong></p> <p>REGRESSION_MAE ― 平均绝对误差，表示预测值与相应真值之间的绝对差值
REGRESSION_MSE ― 均方误差，表示预测值与对应真值之间的平方差
REGRESSION_RMSE ― 均方根误差(RMSE)
REGRESSION_R2 - 1 ― MSE（回归）/ MSE（平均）
REGRESSION_MAPE ― 平均绝对误差(MAE)百分比
REGRESSION_MSPE ― 均方误差(MSE)百分比
REGRESSION_RMSLE ― 按对数尺计算的RMSE（均方根误差）</p> <p><strong>例如：</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   vector y_true <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   vector y_pred <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">2.5</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//---</span>
   <span class="token keyword">double</span> mse<span class="token operator">=</span>y_pred<span class="token punctuation">.</span><span class="token function">RegressionMetric</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span>REGRESSION_MSE<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;mse=&quot;</span><span class="token punctuation">,</span>mse<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//---</span>
   <span class="token keyword">double</span> mae<span class="token operator">=</span>y_pred<span class="token punctuation">.</span><span class="token function">RegressionMetric</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span>REGRESSION_MAE<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;mae=&quot;</span><span class="token punctuation">,</span>mae<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//---</span>
   <span class="token keyword">double</span> r2<span class="token operator">=</span>y_pred<span class="token punctuation">.</span><span class="token function">RegressionMetric</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span>REGRESSION_R2<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;r2=&quot;</span><span class="token punctuation">,</span>r2<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">/* Result
   mae=0.375
   mse=0.5
   r2=0.9486081370449679
   */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="_7-10-6-confusionmatrix"><a href="#_7-10-6-confusionmatrix" class="header-anchor">#</a> 7.10.6  ConfusionMatrix</h3> <p>计算混淆矩阵。该方法应用于预测值向量。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>matrix vector<span class="token double-colon punctuation">::</span><span class="token function">ConfusionMatrix</span><span class="token punctuation">(</span>
   <span class="token keyword">const</span> vector<span class="token operator">&amp;</span>       vect_true      <span class="token comment">// 真值向量</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
 
matrix vector<span class="token double-colon punctuation">::</span><span class="token function">ConfusionMatrix</span><span class="token punctuation">(</span>
   <span class="token keyword">const</span> vector<span class="token operator">&amp;</span>       vect_true<span class="token punctuation">,</span>     <span class="token comment">// 真值向量</span>
   uint                label          <span class="token comment">//选项卡值</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>参数</strong></p> <p>vect_true</p> <p>[in] 真值向量。</p> <p>label</p> <p>[in] 计算混淆矩阵的标签值。</p> <p><strong>返回值</strong></p> <p>混淆矩阵。如果未指定标签值，则返回多类混淆矩阵，其中每个标签单独与其他标签匹配。如果指定了标签值，则返回一个2 x 2矩阵，其中指定的标签被视为正数，而所有其他标签均为负数（ovr，一vs其余）。</p> <p><strong>注意</strong></p> <p>混淆矩阵C使得Cij等于已知属于组i且预测属于组j的观察值的数量。因此，在二元分类中，真阴性(TN)的计数为C00，假阴性(FN)为C10，真阳性(TP)为C11，假阳性(FP)为C01。</p> <p>换句话说，矩阵可以用图形表示如下：</p> <table><thead><tr><th>TN</th> <th>FP</th></tr></thead> <tbody><tr><td>FN</td> <td>TP</td></tr></tbody></table> <p>真实值向量和预测值向量的大小应该相同。</p> <p><strong>示例：</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   vector y_true<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   vector y_pred<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   matrix confusion<span class="token operator">=</span>y_pred<span class="token punctuation">.</span><span class="token function">ConfusionMatrix</span><span class="token punctuation">(</span>y_true<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span>confusion<span class="token punctuation">)</span><span class="token punctuation">;</span>
   confusion<span class="token operator">=</span>y_pred<span class="token punctuation">.</span><span class="token function">ConfusionMatrix</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span>confusion<span class="token punctuation">)</span><span class="token punctuation">;</span>
   confusion<span class="token operator">=</span>y_pred<span class="token punctuation">.</span><span class="token function">ConfusionMatrix</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span>confusion<span class="token punctuation">)</span><span class="token punctuation">;</span>
   confusion<span class="token operator">=</span>y_pred<span class="token punctuation">.</span><span class="token function">ConfusionMatrix</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span>confusion<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
 
<span class="token comment">/*
  [[3,0,0,0,0,0,0,0,0,0]
   [0,3,0,0,0,0,0,0,0,0]
   [0,0,1,0,1,0,0,1,0,0]
   [0,0,0,1,0,0,0,1,0,0]
   [0,0,1,0,3,0,0,0,0,1]
   [0,0,0,0,0,2,0,0,0,0]
   [1,0,0,0,0,1,1,0,0,0]
   [0,0,0,0,0,0,0,2,0,1]
   [0,0,1,0,0,0,0,0,0,1]
   [0,0,0,0,0,0,0,0,0,4]]
  [[26,1]
   [0,3]]
  [[27,0]
   [0,3]]
  [[25,2]
   [2,1]]
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h3 id="_7-10-7-confusionmatrixmultilabel"><a href="#_7-10-7-confusionmatrixmultilabel" class="header-anchor">#</a> 7.10.7  ConfusionMatrixMultilabel</h3> <p>计算每个标签的混淆矩阵。该方法应用于预测值向量。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>uint vector<span class="token double-colon punctuation">::</span><span class="token function">ConfusionMatrixMultiLabel</span><span class="token punctuation">(</span>
   <span class="token keyword">const</span> vector<span class="token operator">&amp;</span>       vect_true<span class="token punctuation">,</span>     <span class="token comment">// 真值向量</span>
   matrix<span class="token operator">&amp;</span>             confusions<span class="token punctuation">[</span><span class="token punctuation">]</span>   <span class="token comment">// 计算混淆矩阵的数组 </span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>参数</strong></p> <p>vect_true</p> <p>[in] 真值向量。</p> <p>confusions</p> <p>[out] 一个2 × 2矩阵数组，为每个标签计算混淆矩阵。</p> <p><strong>返回值</strong></p> <p>计算的混淆矩阵数组的大小。如果失败，则返回0</p> <p><strong>注意</strong></p> <p>结果数组可以是动态也可以是静态。如果是静态数组，那么其大小必须不小于类的数量。</p> <p>真实值向量和预测值向量的大小应该相同。</p> <p><strong>示例：</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   vector y_true<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   vector y_pred<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   matrix label_confusions<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
 
   uint   res<span class="token operator">=</span>y_pred<span class="token punctuation">.</span><span class="token function">ConfusionMatrixMultiLabel</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span>label_confusions<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;res=&quot;</span><span class="token punctuation">,</span>res<span class="token punctuation">,</span><span class="token string">&quot;  size=&quot;</span><span class="token punctuation">,</span>label_confusions<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>uint i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>res<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
      <span class="token function">Print</span><span class="token punctuation">(</span>label_confusions<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
 
<span class="token comment">/*
  res=10  size=12
  [[26,1]
   [0,3]]
  [[27,0]
   [0,3]]
  [[25,2]
   [2,1]]
  [[28,0]
   [1,1]]
  [[24,1]
   [2,3]]
  [[27,1]
   [0,2]]
  [[27,0]
   [2,1]]
  [[25,2]
   [1,2]]
  [[28,0]
   [2,0]]
  [[23,3]
   [0,4]]
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><h3 id="_7-10-8-classificationmetric"><a href="#_7-10-8-classificationmetric" class="header-anchor">#</a> 7.10.8  ClassificationMetric</h3> <p>计算分类指标来评估预测数据相对于真实数据的质量。该方法适用于预测值的向量。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>vector vector<span class="token double-colon punctuation">::</span><span class="token function">ClassificationMetric</span><span class="token punctuation">(</span>
   <span class="token keyword">const</span> vector<span class="token operator">&amp;</span>              vect_true<span class="token punctuation">,</span>     <span class="token comment">// 真值向量</span>
   ENUM_CLASSIFICATION_METRIC metric         <span class="token comment">// 指标类型</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
 
vector vector<span class="token double-colon punctuation">::</span><span class="token function">ClassificationMetric</span><span class="token punctuation">(</span>
   <span class="token keyword">const</span> vector<span class="token operator">&amp;</span>              vect_true<span class="token punctuation">,</span>     <span class="token comment">// 真值向量</span>
   ENUM_CLASSIFICATION_METRIC metric         <span class="token comment">// 指标类型</span>
   ENUM_AVERAGE_MODE          mode           <span class="token comment">// 平均模式</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>参数</strong></p> <p>vect_true</p> <p>[in] 真值向量。</p> <p>metric</p> <p>[in] ENUM_CLASSIFICATION_METRIC枚举的指标类型。应用CLASSIFICATION_TOP_K_ACCURACY， CLASSIFICATION_AVERAGE_PRECISION和CLASSIFICATION_ROC_AUC（在ClassificationScore方法中使用）以外的值。</p> <p>mode</p> <p>[in] ENUM_AVERAGE_MODE枚举的平均模式。用于CLASSIFICATION_F1，CLASSIFICATION_JACCARD， CLASSIFICATION_PRECISION和CLASSIFICATION_RECALL指标。</p> <p><strong>返回值</strong></p> <p>包含计算指标的向量。在AVERAGE_NONE平均模式的情况下，向量包含每个类别的指标值，而不进行平均。（例如，在二元分类的情况下，这将是分别用于'false'和'true'的两个指标）。</p> <p><strong>关于平均模式的说明</strong></p> <p>AVERAGE_BINARY只对二元分类有意义。</p> <p>AVERAGE_MICRO ― 通过计算真阳性、假阴性和假阳性总数来计算全局指标。</p> <p>AVERAGE_MACRO ― 计算每个标签的指标并找到其未加权平均值。这没有考虑标签不平衡。</p> <p>AVERAGE_WEIGHTED ― 计算每个标签的指标并找到其按支持度加权的平均值（每个标签的真实实例数）。这改变了‘macro’以解决标签不平衡的问题；它可能会导致不在精确率和召回率之间的F分数。</p> <p><strong>示例：</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   vector y_true<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   vector y_pred<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
 
   vector accuracy<span class="token operator">=</span>y_pred<span class="token punctuation">.</span><span class="token function">ClassificationMetric</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span>CLASSIFICATION_ACCURACY<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;accuracy=&quot;</span><span class="token punctuation">,</span>accuracy<span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector balanced<span class="token operator">=</span>y_pred<span class="token punctuation">.</span><span class="token function">ClassificationMetric</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span>CLASSIFICATION_BALANCED_ACCURACY<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;balanced=&quot;</span><span class="token punctuation">,</span>balanced<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   vector f1_micro<span class="token operator">=</span>y_pred<span class="token punctuation">.</span><span class="token function">ClassificationMetric</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span>CLASSIFICATION_F1<span class="token punctuation">,</span>AVERAGE_MICRO<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;f1_micro=&quot;</span><span class="token punctuation">,</span>f1_micro<span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector f1_macro<span class="token operator">=</span>y_pred<span class="token punctuation">.</span><span class="token function">ClassificationMetric</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span>CLASSIFICATION_F1<span class="token punctuation">,</span>AVERAGE_MACRO<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;f1_macro=&quot;</span><span class="token punctuation">,</span>f1_macro<span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector f1_weighted<span class="token operator">=</span>y_pred<span class="token punctuation">.</span><span class="token function">ClassificationMetric</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span>CLASSIFICATION_F1<span class="token punctuation">,</span>AVERAGE_WEIGHTED<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;f1_weighted=&quot;</span><span class="token punctuation">,</span>f1_weighted<span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector f1_none<span class="token operator">=</span>y_pred<span class="token punctuation">.</span><span class="token function">ClassificationMetric</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span>CLASSIFICATION_F1<span class="token punctuation">,</span>AVERAGE_NONE<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;f1_none=&quot;</span><span class="token punctuation">,</span>f1_none<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   vector jaccard_micro<span class="token operator">=</span>y_pred<span class="token punctuation">.</span><span class="token function">ClassificationMetric</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span>CLASSIFICATION_JACCARD<span class="token punctuation">,</span>AVERAGE_MICRO<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;jaccard_micro=&quot;</span><span class="token punctuation">,</span>jaccard_micro<span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector jaccard_macro<span class="token operator">=</span>y_pred<span class="token punctuation">.</span><span class="token function">ClassificationMetric</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span>CLASSIFICATION_JACCARD<span class="token punctuation">,</span>AVERAGE_MACRO<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;jaccard_macro=&quot;</span><span class="token punctuation">,</span>jaccard_macro<span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector jaccard_weighted<span class="token operator">=</span>y_pred<span class="token punctuation">.</span><span class="token function">ClassificationMetric</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span>CLASSIFICATION_JACCARD<span class="token punctuation">,</span>AVERAGE_WEIGHTED<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;jaccard_weighted=&quot;</span><span class="token punctuation">,</span>jaccard_weighted<span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector jaccard_none<span class="token operator">=</span>y_pred<span class="token punctuation">.</span><span class="token function">ClassificationMetric</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span>CLASSIFICATION_JACCARD<span class="token punctuation">,</span>AVERAGE_NONE<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;jaccard_none=&quot;</span><span class="token punctuation">,</span>jaccard_none<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   vector precision_micro<span class="token operator">=</span>y_pred<span class="token punctuation">.</span><span class="token function">ClassificationMetric</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span>CLASSIFICATION_PRECISION<span class="token punctuation">,</span>AVERAGE_MICRO<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;precision_micro=&quot;</span><span class="token punctuation">,</span>precision_micro<span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector precision_macro<span class="token operator">=</span>y_pred<span class="token punctuation">.</span><span class="token function">ClassificationMetric</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span>CLASSIFICATION_PRECISION<span class="token punctuation">,</span>AVERAGE_MACRO<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;precision_macro=&quot;</span><span class="token punctuation">,</span>precision_macro<span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector precision_weighted<span class="token operator">=</span>y_pred<span class="token punctuation">.</span><span class="token function">ClassificationMetric</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span>CLASSIFICATION_PRECISION<span class="token punctuation">,</span>AVERAGE_WEIGHTED<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;precision_weighted=&quot;</span><span class="token punctuation">,</span>precision_weighted<span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector precision_none<span class="token operator">=</span>y_pred<span class="token punctuation">.</span><span class="token function">ClassificationMetric</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span>CLASSIFICATION_PRECISION<span class="token punctuation">,</span>AVERAGE_NONE<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;precision_none=&quot;</span><span class="token punctuation">,</span>precision_none<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   vector recall_micro<span class="token operator">=</span>y_pred<span class="token punctuation">.</span><span class="token function">ClassificationMetric</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span>CLASSIFICATION_RECALL<span class="token punctuation">,</span>AVERAGE_MICRO<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;recall_micro=&quot;</span><span class="token punctuation">,</span>recall_micro<span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector recall_macro<span class="token operator">=</span>y_pred<span class="token punctuation">.</span><span class="token function">ClassificationMetric</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span>CLASSIFICATION_RECALL<span class="token punctuation">,</span>AVERAGE_MACRO<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;recall_macro=&quot;</span><span class="token punctuation">,</span>recall_macro<span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector recall_weighted<span class="token operator">=</span>y_pred<span class="token punctuation">.</span><span class="token function">ClassificationMetric</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span>CLASSIFICATION_RECALL<span class="token punctuation">,</span>AVERAGE_WEIGHTED<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;recall_weighted=&quot;</span><span class="token punctuation">,</span>recall_weighted<span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector recall_none<span class="token operator">=</span>y_pred<span class="token punctuation">.</span><span class="token function">ClassificationMetric</span><span class="token punctuation">(</span>y_true<span class="token punctuation">,</span>CLASSIFICATION_RECALL<span class="token punctuation">,</span>AVERAGE_NONE<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;recall_none=&quot;</span><span class="token punctuation">,</span>recall_none<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">//--- 二元分类</span>
   vector y_pred_bin<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   vector y_true_bin<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
 
   vector f1_bin<span class="token operator">=</span>y_pred_bin<span class="token punctuation">.</span><span class="token function">ClassificationMetric</span><span class="token punctuation">(</span>y_true_bin<span class="token punctuation">,</span>CLASSIFICATION_F1<span class="token punctuation">,</span>AVERAGE_BINARY<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;f1_bin=&quot;</span><span class="token punctuation">,</span>f1_bin<span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector jaccard_bin<span class="token operator">=</span>y_pred_bin<span class="token punctuation">.</span><span class="token function">ClassificationMetric</span><span class="token punctuation">(</span>y_true_bin<span class="token punctuation">,</span>CLASSIFICATION_JACCARD<span class="token punctuation">,</span>AVERAGE_BINARY<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;jaccard_bin=&quot;</span><span class="token punctuation">,</span>jaccard_bin<span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector precision_bin<span class="token operator">=</span>y_pred_bin<span class="token punctuation">.</span><span class="token function">ClassificationMetric</span><span class="token punctuation">(</span>y_true_bin<span class="token punctuation">,</span>CLASSIFICATION_PRECISION<span class="token punctuation">,</span>AVERAGE_BINARY<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;precision_bin=&quot;</span><span class="token punctuation">,</span>precision_bin<span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector recall_bin<span class="token operator">=</span>y_pred_bin<span class="token punctuation">.</span><span class="token function">ClassificationMetric</span><span class="token punctuation">(</span>y_true_bin<span class="token punctuation">,</span>CLASSIFICATION_RECALL<span class="token punctuation">,</span>AVERAGE_BINARY<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;recall_bin=&quot;</span><span class="token punctuation">,</span>recall_bin<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
 
<span class="token comment">/*
  accuracy=[0.6666666666666666]
  balanced=[0.6433333333333333]
  
  f1_micro=[0.6666666666666666]
  f1_macro=[0.6122510822510823]
  f1_weighted=[0.632049062049062]
  f1_none=[0.8571428571428571,1,0.3333333333333333,0.6666666666666666,0.6666666666666665,0.8,0.5,0.5714285714285715,0,0.7272727272727273]
  
  jaccard_micro=[0.5]
  jaccard_macro=[0.4921428571428572]
  jaccard_weighted=[0.5056349206349205]
  jaccard_none=[0.75,1,0.2,0.5,0.5,0.6666666666666666,0.3333333333333333,0.4,0,0.5714285714285714]
  
  precision_micro=[0.6666666666666666]
  precision_macro=[0.6571428571428571]
  precision_weighted=[0.6706349206349207]
  precision_none=[0.75,1,0.3333333333333333,1,0.75,0.6666666666666666,1,0.5,0,0.5714285714285714]
  
  recall_micro=[0.6666666666666666]
  recall_macro=[0.6433333333333333]
  recall_weighted=[0.6666666666666666]
  recall_none=[1,1,0.3333333333333333,0.5,0.6,1,0.3333333333333333,0.6666666666666666,0,1]
  
  f1_bin=[0.4444444444444445]
  jaccard_bin=[0.2857142857142857]
  precision_bin=[0.5]
  recall_bin=[0.4]
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br></div></div><h3 id="_7-10-9-classificationscore"><a href="#_7-10-9-classificationscore" class="header-anchor">#</a> 7.10.9 ClassificationScore</h3> <p>计算分类指标来评估预测数据相对于真实数据的质量。</p> <p>与机器学习部分中的其他方法不同，这个指标适用于真实值的向量，而不是预测值的向量。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>vector vector<span class="token double-colon punctuation">::</span><span class="token function">ClassificationScore</span><span class="token punctuation">(</span>
   <span class="token keyword">const</span> matrix<span class="token operator">&amp;</span>              pred_scores<span class="token punctuation">,</span>   <span class="token comment">// 包含每一类概率分布的矩阵 </span>
   ENUM_CLASSIFICATION_METRIC metric         <span class="token comment">// 指标类型</span>
   ENUM_AVERAGE_MODE          mode           <span class="token comment">// 平均模式</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 
 
vector vector<span class="token double-colon punctuation">::</span><span class="token function">ClassificationScore</span><span class="token punctuation">(</span>
   <span class="token keyword">const</span> matrix<span class="token operator">&amp;</span>              pred_scores<span class="token punctuation">,</span>   <span class="token comment">// 包含每一类概率分布的矩阵 </span>
   ENUM_CLASSIFICATION_METRIC metric         <span class="token comment">// 指标类型</span>
   <span class="token keyword">int</span>                        param          <span class="token comment">// 附加参数</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>参数</strong></p> <p>pred_scores</p> <p>[in] 包含一组水平向量和每一类概率的矩阵。矩阵行数应与真值向量的大小相对应。</p> <p>metric</p> <p>[in] ENUM_CLASSIFICATION_METRIC枚举的指标类型。使用CLASSIFICATION_TOP_K_ACCURACY， CLASSIFICATION_AVERAGE_PRECISION和CLASSIFICATION_ROC_AUC值。</p> <p>mode</p> <p>[in] ENUM_AVERAGE_MODE枚举的平均模式。用于CLASSIFICATION_AVERAGE_PRECISION和CLASSIFICATION_ROC_AUC指标。</p> <p>param</p> <p>[in]  对于CLASSIFICATION_TOP_K_ACCURACY指标，应指定整数K值来替代平均模式。</p> <p><strong>返回值</strong></p> <p>包含计算指标的向量。在AVERAGE_NONE平均模式的情况下，向量包含每个类别的指标值，而不进行平均。（例如，在二元分类的情况下，这将是分别用于'false'和'true'的两个指标）。</p> <p><strong>关于平均模式的说明</strong></p> <p>AVERAGE_BINARY只对二元分类有意义。</p> <p>AVERAGE_MICRO ― 通过将标签指标矩阵的每个元素视为一个标签来计算全局指标。标签指标矩阵是指一个矩阵，其中包含每个标签的一组概率。</p> <p>AVERAGE_MACRO ― 计算每个标签的指标并找到其未加权平均值。这没有考虑标签不平衡。</p> <p>AVERAGE_WEIGHTED ― 计算每个标签的指标并找到其按支持度加权的平均值（每个标签的真实实例数）。</p> <p><strong>注意</strong></p> <p>在二元分类的情况下，我们不仅可以输入一个n x 2矩阵，其中第一列包含负标签的概率，第二列包含正标签的概率，还可以输入一个由一列正概率组成的矩阵。这是因为二元分类模型可以返回正标签的两个概率或一个概率。</p> <p><strong>示例：</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   vector y_true<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token comment">//vector y_pred={7,2,1,0,4,1,4,9,5,9,0,6,9,0,1,5,9,7,3,4,2,9,4,9,5,9,2,7,7,0};</span>
 
<span class="token comment">//--- label scores          0         1         2         3         4         5         6         7         8         9    true pred</span>
   matrix y_scores<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0.000109</span><span class="token punctuation">,</span> <span class="token number">0.000186</span><span class="token punctuation">,</span> <span class="token number">0.000449</span><span class="token punctuation">,</span> <span class="token number">0.000052</span><span class="token punctuation">,</span> <span class="token number">0.000002</span><span class="token punctuation">,</span> <span class="token number">0.000022</span><span class="token punctuation">,</span> <span class="token number">0.000005</span><span class="token punctuation">,</span> <span class="token number">0.998059</span><span class="token punctuation">,</span> <span class="token number">0.000010</span><span class="token punctuation">,</span> <span class="token number">0.001104</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// 7    7</span>
                    <span class="token punctuation">{</span><span class="token number">0.000091</span><span class="token punctuation">,</span> <span class="token number">0.081956</span><span class="token punctuation">,</span> <span class="token number">0.916816</span><span class="token punctuation">,</span> <span class="token number">0.001106</span><span class="token punctuation">,</span> <span class="token number">0.000006</span><span class="token punctuation">,</span> <span class="token number">0.000002</span><span class="token punctuation">,</span> <span class="token number">0.000001</span><span class="token punctuation">,</span> <span class="token number">0.000000</span><span class="token punctuation">,</span> <span class="token number">0.000021</span><span class="token punctuation">,</span> <span class="token number">0.000000</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// 2    2</span>
                    <span class="token punctuation">{</span><span class="token number">0.000108</span><span class="token punctuation">,</span> <span class="token number">0.972863</span><span class="token punctuation">,</span> <span class="token number">0.003600</span><span class="token punctuation">,</span> <span class="token number">0.000021</span><span class="token punctuation">,</span> <span class="token number">0.010479</span><span class="token punctuation">,</span> <span class="token number">0.000015</span><span class="token punctuation">,</span> <span class="token number">0.000131</span><span class="token punctuation">,</span> <span class="token number">0.010385</span><span class="token punctuation">,</span> <span class="token number">0.002339</span><span class="token punctuation">,</span> <span class="token number">0.000060</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// 1    1</span>
                    <span class="token punctuation">{</span><span class="token number">0.925425</span><span class="token punctuation">,</span> <span class="token number">0.000080</span><span class="token punctuation">,</span> <span class="token number">0.002913</span><span class="token punctuation">,</span> <span class="token number">0.000057</span><span class="token punctuation">,</span> <span class="token number">0.000274</span><span class="token punctuation">,</span> <span class="token number">0.000638</span><span class="token punctuation">,</span> <span class="token number">0.063529</span><span class="token punctuation">,</span> <span class="token number">0.000316</span><span class="token punctuation">,</span> <span class="token number">0.000095</span><span class="token punctuation">,</span> <span class="token number">0.006673</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// 0    0</span>
                    <span class="token punctuation">{</span><span class="token number">0.000060</span><span class="token punctuation">,</span> <span class="token number">0.000126</span><span class="token punctuation">,</span> <span class="token number">0.000006</span><span class="token punctuation">,</span> <span class="token number">0.000000</span><span class="token punctuation">,</span> <span class="token number">0.993513</span><span class="token punctuation">,</span> <span class="token number">0.000000</span><span class="token punctuation">,</span> <span class="token number">0.000003</span><span class="token punctuation">,</span> <span class="token number">0.000222</span><span class="token punctuation">,</span> <span class="token number">0.000001</span><span class="token punctuation">,</span> <span class="token number">0.006069</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// 4    4</span>
                    <span class="token punctuation">{</span><span class="token number">0.000016</span><span class="token punctuation">,</span> <span class="token number">0.982124</span><span class="token punctuation">,</span> <span class="token number">0.000045</span><span class="token punctuation">,</span> <span class="token number">0.000002</span><span class="token punctuation">,</span> <span class="token number">0.008445</span><span class="token punctuation">,</span> <span class="token number">0.000001</span><span class="token punctuation">,</span> <span class="token number">0.000005</span><span class="token punctuation">,</span> <span class="token number">0.009230</span><span class="token punctuation">,</span> <span class="token number">0.000120</span><span class="token punctuation">,</span> <span class="token number">0.000013</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// 1    1</span>
                    <span class="token punctuation">{</span><span class="token number">0.000000</span><span class="token punctuation">,</span> <span class="token number">0.000040</span><span class="token punctuation">,</span> <span class="token number">0.000001</span><span class="token punctuation">,</span> <span class="token number">0.000000</span><span class="token punctuation">,</span> <span class="token number">0.989395</span><span class="token punctuation">,</span> <span class="token number">0.000167</span><span class="token punctuation">,</span> <span class="token number">0.000004</span><span class="token punctuation">,</span> <span class="token number">0.000070</span><span class="token punctuation">,</span> <span class="token number">0.000177</span><span class="token punctuation">,</span> <span class="token number">0.010146</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// 4    4</span>
                    <span class="token punctuation">{</span><span class="token number">0.000795</span><span class="token punctuation">,</span> <span class="token number">0.002938</span><span class="token punctuation">,</span> <span class="token number">0.023447</span><span class="token punctuation">,</span> <span class="token number">0.007418</span><span class="token punctuation">,</span> <span class="token number">0.021838</span><span class="token punctuation">,</span> <span class="token number">0.002476</span><span class="token punctuation">,</span> <span class="token number">0.000260</span><span class="token punctuation">,</span> <span class="token number">0.047551</span><span class="token punctuation">,</span> <span class="token number">0.000082</span><span class="token punctuation">,</span> <span class="token number">0.893194</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// 9    9</span>
                    <span class="token punctuation">{</span><span class="token number">0.000091</span><span class="token punctuation">,</span> <span class="token number">0.000226</span><span class="token punctuation">,</span> <span class="token number">0.000038</span><span class="token punctuation">,</span> <span class="token number">0.000007</span><span class="token punctuation">,</span> <span class="token number">0.000048</span><span class="token punctuation">,</span> <span class="token number">0.854910</span><span class="token punctuation">,</span> <span class="token number">0.068644</span><span class="token punctuation">,</span> <span class="token number">0.000080</span><span class="token punctuation">,</span> <span class="token number">0.001097</span><span class="token punctuation">,</span> <span class="token number">0.074860</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// 5    5</span>
                    <span class="token punctuation">{</span><span class="token number">0.000000</span><span class="token punctuation">,</span> <span class="token number">0.000000</span><span class="token punctuation">,</span> <span class="token number">0.000000</span><span class="token punctuation">,</span> <span class="token number">0.000000</span><span class="token punctuation">,</span> <span class="token number">0.003004</span><span class="token punctuation">,</span> <span class="token number">0.000000</span><span class="token punctuation">,</span> <span class="token number">0.000000</span><span class="token punctuation">,</span> <span class="token number">0.000035</span><span class="token punctuation">,</span> <span class="token number">0.000000</span><span class="token punctuation">,</span> <span class="token number">0.996960</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// 9    9</span>
                    <span class="token punctuation">{</span><span class="token number">0.998856</span><span class="token punctuation">,</span> <span class="token number">0.000009</span><span class="token punctuation">,</span> <span class="token number">0.000976</span><span class="token punctuation">,</span> <span class="token number">0.000002</span><span class="token punctuation">,</span> <span class="token number">0.000000</span><span class="token punctuation">,</span> <span class="token number">0.000013</span><span class="token punctuation">,</span> <span class="token number">0.000131</span><span class="token punctuation">,</span> <span class="token number">0.000006</span><span class="token punctuation">,</span> <span class="token number">0.000000</span><span class="token punctuation">,</span> <span class="token number">0.000007</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// 0    0</span>
                    <span class="token punctuation">{</span><span class="token number">0.000178</span><span class="token punctuation">,</span> <span class="token number">0.000446</span><span class="token punctuation">,</span> <span class="token number">0.000326</span><span class="token punctuation">,</span> <span class="token number">0.000033</span><span class="token punctuation">,</span> <span class="token number">0.000193</span><span class="token punctuation">,</span> <span class="token number">0.000071</span><span class="token punctuation">,</span> <span class="token number">0.998403</span><span class="token punctuation">,</span> <span class="token number">0.000015</span><span class="token punctuation">,</span> <span class="token number">0.000328</span><span class="token punctuation">,</span> <span class="token number">0.000007</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// 6    6</span>
                    <span class="token punctuation">{</span><span class="token number">0.000005</span><span class="token punctuation">,</span> <span class="token number">0.000016</span><span class="token punctuation">,</span> <span class="token number">0.000153</span><span class="token punctuation">,</span> <span class="token number">0.000045</span><span class="token punctuation">,</span> <span class="token number">0.004110</span><span class="token punctuation">,</span> <span class="token number">0.000012</span><span class="token punctuation">,</span> <span class="token number">0.000015</span><span class="token punctuation">,</span> <span class="token number">0.000031</span><span class="token punctuation">,</span> <span class="token number">0.000076</span><span class="token punctuation">,</span> <span class="token number">0.995537</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// 9    9</span>
                    <span class="token punctuation">{</span><span class="token number">0.994188</span><span class="token punctuation">,</span> <span class="token number">0.000003</span><span class="token punctuation">,</span> <span class="token number">0.002584</span><span class="token punctuation">,</span> <span class="token number">0.000005</span><span class="token punctuation">,</span> <span class="token number">0.000005</span><span class="token punctuation">,</span> <span class="token number">0.000100</span><span class="token punctuation">,</span> <span class="token number">0.000739</span><span class="token punctuation">,</span> <span class="token number">0.001473</span><span class="token punctuation">,</span> <span class="token number">0.000038</span><span class="token punctuation">,</span> <span class="token number">0.000864</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// 0    0</span>
                    <span class="token punctuation">{</span><span class="token number">0.000173</span><span class="token punctuation">,</span> <span class="token number">0.990569</span><span class="token punctuation">,</span> <span class="token number">0.000792</span><span class="token punctuation">,</span> <span class="token number">0.000040</span><span class="token punctuation">,</span> <span class="token number">0.001798</span><span class="token punctuation">,</span> <span class="token number">0.000035</span><span class="token punctuation">,</span> <span class="token number">0.000114</span><span class="token punctuation">,</span> <span class="token number">0.004750</span><span class="token punctuation">,</span> <span class="token number">0.001716</span><span class="token punctuation">,</span> <span class="token number">0.000013</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// 1    1</span>
                    <span class="token punctuation">{</span><span class="token number">0.000000</span><span class="token punctuation">,</span> <span class="token number">0.000537</span><span class="token punctuation">,</span> <span class="token number">0.000008</span><span class="token punctuation">,</span> <span class="token number">0.005080</span><span class="token punctuation">,</span> <span class="token number">0.000046</span><span class="token punctuation">,</span> <span class="token number">0.992910</span><span class="token punctuation">,</span> <span class="token number">0.000012</span><span class="token punctuation">,</span> <span class="token number">0.000671</span><span class="token punctuation">,</span> <span class="token number">0.000390</span><span class="token punctuation">,</span> <span class="token number">0.000347</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// 5    5</span>
                    <span class="token punctuation">{</span><span class="token number">0.000127</span><span class="token punctuation">,</span> <span class="token number">0.000003</span><span class="token punctuation">,</span> <span class="token number">0.000003</span><span class="token punctuation">,</span> <span class="token number">0.000000</span><span class="token punctuation">,</span> <span class="token number">0.001583</span><span class="token punctuation">,</span> <span class="token number">0.000000</span><span class="token punctuation">,</span> <span class="token number">0.000002</span><span class="token punctuation">,</span> <span class="token number">0.000555</span><span class="token punctuation">,</span> <span class="token number">0.000016</span><span class="token punctuation">,</span> <span class="token number">0.997712</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// 9    9</span>
                    <span class="token punctuation">{</span><span class="token number">0.000001</span><span class="token punctuation">,</span> <span class="token number">0.000012</span><span class="token punctuation">,</span> <span class="token number">0.000072</span><span class="token punctuation">,</span> <span class="token number">0.000020</span><span class="token punctuation">,</span> <span class="token number">0.000000</span><span class="token punctuation">,</span> <span class="token number">0.000000</span><span class="token punctuation">,</span> <span class="token number">0.000000</span><span class="token punctuation">,</span> <span class="token number">0.999868</span><span class="token punctuation">,</span> <span class="token number">0.000000</span><span class="token punctuation">,</span> <span class="token number">0.000026</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// 7    7</span>
                    <span class="token punctuation">{</span><span class="token number">0.000020</span><span class="token punctuation">,</span> <span class="token number">0.000105</span><span class="token punctuation">,</span> <span class="token number">0.001139</span><span class="token punctuation">,</span> <span class="token number">0.901343</span><span class="token punctuation">,</span> <span class="token number">0.002132</span><span class="token punctuation">,</span> <span class="token number">0.083873</span><span class="token punctuation">,</span> <span class="token number">0.000124</span><span class="token punctuation">,</span> <span class="token number">0.000097</span><span class="token punctuation">,</span> <span class="token number">0.010981</span><span class="token punctuation">,</span> <span class="token number">0.000186</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// 3    3</span>
                    <span class="token punctuation">{</span><span class="token number">0.000002</span><span class="token punctuation">,</span> <span class="token number">0.000048</span><span class="token punctuation">,</span> <span class="token number">0.000019</span><span class="token punctuation">,</span> <span class="token number">0.000000</span><span class="token punctuation">,</span> <span class="token number">0.999347</span><span class="token punctuation">,</span> <span class="token number">0.000002</span><span class="token punctuation">,</span> <span class="token number">0.000040</span><span class="token punctuation">,</span> <span class="token number">0.000051</span><span class="token punctuation">,</span> <span class="token number">0.000000</span><span class="token punctuation">,</span> <span class="token number">0.000489</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// 4    4</span>
                    <span class="token punctuation">{</span><span class="token number">0.000059</span><span class="token punctuation">,</span> <span class="token number">0.001344</span><span class="token punctuation">,</span> <span class="token number">0.612502</span><span class="token punctuation">,</span> <span class="token number">0.002749</span><span class="token punctuation">,</span> <span class="token number">0.000229</span><span class="token punctuation">,</span> <span class="token number">0.000678</span><span class="token punctuation">,</span> <span class="token number">0.000038</span><span class="token punctuation">,</span> <span class="token number">0.001844</span><span class="token punctuation">,</span> <span class="token number">0.379727</span><span class="token punctuation">,</span> <span class="token number">0.000831</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// 8    2</span>
                    <span class="token punctuation">{</span><span class="token number">0.000586</span><span class="token punctuation">,</span> <span class="token number">0.000740</span><span class="token punctuation">,</span> <span class="token number">0.001625</span><span class="token punctuation">,</span> <span class="token number">0.000007</span><span class="token punctuation">,</span> <span class="token number">0.269341</span><span class="token punctuation">,</span> <span class="token number">0.000076</span><span class="token punctuation">,</span> <span class="token number">0.016417</span><span class="token punctuation">,</span> <span class="token number">0.000199</span><span class="token punctuation">,</span> <span class="token number">0.000107</span><span class="token punctuation">,</span> <span class="token number">0.710902</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// 4    9</span>
                    <span class="token punctuation">{</span><span class="token number">0.009547</span><span class="token punctuation">,</span> <span class="token number">0.018055</span><span class="token punctuation">,</span> <span class="token number">0.283795</span><span class="token punctuation">,</span> <span class="token number">0.071079</span><span class="token punctuation">,</span> <span class="token number">0.426074</span><span class="token punctuation">,</span> <span class="token number">0.082335</span><span class="token punctuation">,</span> <span class="token number">0.036379</span><span class="token punctuation">,</span> <span class="token number">0.021188</span><span class="token punctuation">,</span> <span class="token number">0.003924</span><span class="token punctuation">,</span> <span class="token number">0.047623</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// 2    4</span>
                    <span class="token punctuation">{</span><span class="token number">0.002506</span><span class="token punctuation">,</span> <span class="token number">0.002545</span><span class="token punctuation">,</span> <span class="token number">0.001148</span><span class="token punctuation">,</span> <span class="token number">0.005659</span><span class="token punctuation">,</span> <span class="token number">0.020416</span><span class="token punctuation">,</span> <span class="token number">0.000112</span><span class="token punctuation">,</span> <span class="token number">0.006092</span><span class="token punctuation">,</span> <span class="token number">0.272536</span><span class="token punctuation">,</span> <span class="token number">0.003148</span><span class="token punctuation">,</span> <span class="token number">0.685839</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// 7    9</span>
                    <span class="token punctuation">{</span><span class="token number">0.001263</span><span class="token punctuation">,</span> <span class="token number">0.001769</span><span class="token punctuation">,</span> <span class="token number">0.000293</span><span class="token punctuation">,</span> <span class="token number">0.000011</span><span class="token punctuation">,</span> <span class="token number">0.000302</span><span class="token punctuation">,</span> <span class="token number">0.881768</span><span class="token punctuation">,</span> <span class="token number">0.112019</span><span class="token punctuation">,</span> <span class="token number">0.000125</span><span class="token punctuation">,</span> <span class="token number">0.002327</span><span class="token punctuation">,</span> <span class="token number">0.000123</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// 6    5</span>
                    <span class="token punctuation">{</span><span class="token number">0.002904</span><span class="token punctuation">,</span> <span class="token number">0.002909</span><span class="token punctuation">,</span> <span class="token number">0.013421</span><span class="token punctuation">,</span> <span class="token number">0.001461</span><span class="token punctuation">,</span> <span class="token number">0.007519</span><span class="token punctuation">,</span> <span class="token number">0.001251</span><span class="token punctuation">,</span> <span class="token number">0.000555</span><span class="token punctuation">,</span> <span class="token number">0.106219</span><span class="token punctuation">,</span> <span class="token number">0.107125</span><span class="token punctuation">,</span> <span class="token number">0.756637</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// 8    9</span>
                    <span class="token punctuation">{</span><span class="token number">0.000055</span><span class="token punctuation">,</span> <span class="token number">0.001080</span><span class="token punctuation">,</span> <span class="token number">0.893158</span><span class="token punctuation">,</span> <span class="token number">0.000000</span><span class="token punctuation">,</span> <span class="token number">0.104492</span><span class="token punctuation">,</span> <span class="token number">0.000159</span><span class="token punctuation">,</span> <span class="token number">0.001042</span><span class="token punctuation">,</span> <span class="token number">0.000013</span><span class="token punctuation">,</span> <span class="token number">0.000000</span><span class="token punctuation">,</span> <span class="token number">0.000000</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// 4    2</span>
                    <span class="token punctuation">{</span><span class="token number">0.000344</span><span class="token punctuation">,</span> <span class="token number">0.002693</span><span class="token punctuation">,</span> <span class="token number">0.071184</span><span class="token punctuation">,</span> <span class="token number">0.000262</span><span class="token punctuation">,</span> <span class="token number">0.000001</span><span class="token punctuation">,</span> <span class="token number">0.000003</span><span class="token punctuation">,</span> <span class="token number">0.000032</span><span class="token punctuation">,</span> <span class="token number">0.924362</span><span class="token punctuation">,</span> <span class="token number">0.000714</span><span class="token punctuation">,</span> <span class="token number">0.000404</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// 2    7</span>
                    <span class="token punctuation">{</span><span class="token number">0.001404</span><span class="token punctuation">,</span> <span class="token number">0.009375</span><span class="token punctuation">,</span> <span class="token number">0.002638</span><span class="token punctuation">,</span> <span class="token number">0.229189</span><span class="token punctuation">,</span> <span class="token number">0.000064</span><span class="token punctuation">,</span> <span class="token number">0.000896</span><span class="token punctuation">,</span> <span class="token number">0.007516</span><span class="token punctuation">,</span> <span class="token number">0.743557</span><span class="token punctuation">,</span> <span class="token number">0.004462</span><span class="token punctuation">,</span> <span class="token number">0.000897</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// 3    7</span>
                    <span class="token punctuation">{</span><span class="token number">0.491140</span><span class="token punctuation">,</span> <span class="token number">0.000125</span><span class="token punctuation">,</span> <span class="token number">0.000024</span><span class="token punctuation">,</span> <span class="token number">0.000302</span><span class="token punctuation">,</span> <span class="token number">0.000038</span><span class="token punctuation">,</span> <span class="token number">0.034947</span><span class="token punctuation">,</span> <span class="token number">0.473161</span><span class="token punctuation">,</span> <span class="token number">0.000170</span><span class="token punctuation">,</span> <span class="token number">0.000028</span><span class="token punctuation">,</span> <span class="token number">0.000066</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// 6    0</span>
 
   vector top_k<span class="token operator">=</span>y_true<span class="token punctuation">.</span><span class="token function">ClassificationScore</span><span class="token punctuation">(</span>y_scores<span class="token punctuation">,</span>CLASSIFICATION_TOP_K_ACCURACY<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;top 1 accuracy score = &quot;</span><span class="token punctuation">,</span>top_k<span class="token punctuation">)</span><span class="token punctuation">;</span>
   top_k<span class="token operator">=</span>y_true<span class="token punctuation">.</span><span class="token function">ClassificationScore</span><span class="token punctuation">(</span>y_scores<span class="token punctuation">,</span>CLASSIFICATION_TOP_K_ACCURACY<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;top 2 accuracy score = &quot;</span><span class="token punctuation">,</span>top_k<span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector y_true2<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   matrix y_score2<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// 0 is in top 2</span>
                    <span class="token punctuation">{</span><span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token number">0.4</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// 1 is in top 2</span>
                    <span class="token punctuation">{</span><span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.4</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// 2 is in top 2</span>
                    <span class="token punctuation">{</span><span class="token number">0.7</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// 2 isn't in top 2</span>
   top_k<span class="token operator">=</span>y_true2<span class="token punctuation">.</span><span class="token function">ClassificationScore</span><span class="token punctuation">(</span>y_score2<span class="token punctuation">,</span>CLASSIFICATION_TOP_K_ACCURACY<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;top k = &quot;</span><span class="token punctuation">,</span>top_k<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   vector ap_micro<span class="token operator">=</span>y_true<span class="token punctuation">.</span><span class="token function">ClassificationScore</span><span class="token punctuation">(</span>y_scores<span class="token punctuation">,</span>CLASSIFICATION_AVERAGE_PRECISION<span class="token punctuation">,</span>AVERAGE_MICRO<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;average precision score micro = &quot;</span><span class="token punctuation">,</span>ap_micro<span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector ap_macro<span class="token operator">=</span>y_true<span class="token punctuation">.</span><span class="token function">ClassificationScore</span><span class="token punctuation">(</span>y_scores<span class="token punctuation">,</span>CLASSIFICATION_AVERAGE_PRECISION<span class="token punctuation">,</span>AVERAGE_MACRO<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;average precision score macro = &quot;</span><span class="token punctuation">,</span>ap_macro<span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector ap_weighted<span class="token operator">=</span>y_true<span class="token punctuation">.</span><span class="token function">ClassificationScore</span><span class="token punctuation">(</span>y_scores<span class="token punctuation">,</span>CLASSIFICATION_AVERAGE_PRECISION<span class="token punctuation">,</span>AVERAGE_WEIGHTED<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;average precision score weighted = &quot;</span><span class="token punctuation">,</span>ap_weighted<span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector ap_none<span class="token operator">=</span>y_true<span class="token punctuation">.</span><span class="token function">ClassificationScore</span><span class="token punctuation">(</span>y_scores<span class="token punctuation">,</span>CLASSIFICATION_AVERAGE_PRECISION<span class="token punctuation">,</span>AVERAGE_NONE<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;average precision score none = &quot;</span><span class="token punctuation">,</span>ap_none<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   vector area_micro<span class="token operator">=</span>y_true<span class="token punctuation">.</span><span class="token function">ClassificationScore</span><span class="token punctuation">(</span>y_scores<span class="token punctuation">,</span>CLASSIFICATION_ROC_AUC<span class="token punctuation">,</span>AVERAGE_MICRO<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;roc auc score micro = &quot;</span><span class="token punctuation">,</span>area_micro<span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector area_macro<span class="token operator">=</span>y_true<span class="token punctuation">.</span><span class="token function">ClassificationScore</span><span class="token punctuation">(</span>y_scores<span class="token punctuation">,</span>CLASSIFICATION_ROC_AUC<span class="token punctuation">,</span>AVERAGE_MACRO<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;roc auc score macro = &quot;</span><span class="token punctuation">,</span>area_macro<span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector area_weighted<span class="token operator">=</span>y_true<span class="token punctuation">.</span><span class="token function">ClassificationScore</span><span class="token punctuation">(</span>y_scores<span class="token punctuation">,</span>CLASSIFICATION_ROC_AUC<span class="token punctuation">,</span>AVERAGE_WEIGHTED<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;roc auc score weighted = &quot;</span><span class="token punctuation">,</span>area_weighted<span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector area_none<span class="token operator">=</span>y_true<span class="token punctuation">.</span><span class="token function">ClassificationScore</span><span class="token punctuation">(</span>y_scores<span class="token punctuation">,</span>CLASSIFICATION_ROC_AUC<span class="token punctuation">,</span>AVERAGE_NONE<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;roc auc score none = &quot;</span><span class="token punctuation">,</span>area_none<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">//--- 二元分类</span>
   vector y_pred_bin<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   vector y_true_bin<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   vector y_score_true<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0.3</span><span class="token punctuation">,</span><span class="token number">0.7</span><span class="token punctuation">,</span><span class="token number">0.1</span><span class="token punctuation">,</span><span class="token number">0.6</span><span class="token punctuation">,</span><span class="token number">0.9</span><span class="token punctuation">,</span><span class="token number">0.0</span><span class="token punctuation">,</span><span class="token number">0.4</span><span class="token punctuation">,</span><span class="token number">0.2</span><span class="token punctuation">,</span><span class="token number">0.8</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   matrix <span class="token function">y_score1_bin</span><span class="token punctuation">(</span>y_score_true<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   y_score1_bin<span class="token punctuation">.</span><span class="token function">Col</span><span class="token punctuation">(</span>y_score_true<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   matrix y_scores_bin<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0.7</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                        <span class="token punctuation">{</span><span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token number">0.7</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                        <span class="token punctuation">{</span><span class="token number">0.9</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                        <span class="token punctuation">{</span><span class="token number">0.4</span><span class="token punctuation">,</span> <span class="token number">0.6</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                        <span class="token punctuation">{</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.9</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                        <span class="token punctuation">{</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                        <span class="token punctuation">{</span><span class="token number">0.6</span><span class="token punctuation">,</span> <span class="token number">0.4</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                        <span class="token punctuation">{</span><span class="token number">0.8</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                        <span class="token punctuation">{</span><span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.8</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
 
   vector ap<span class="token operator">=</span>y_true_bin<span class="token punctuation">.</span><span class="token function">ClassificationScore</span><span class="token punctuation">(</span>y_scores_bin<span class="token punctuation">,</span>CLASSIFICATION_AVERAGE_PRECISION<span class="token punctuation">,</span>AVERAGE_BINARY<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;average precision score binary = &quot;</span><span class="token punctuation">,</span>ap<span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector ap2<span class="token operator">=</span>y_true_bin<span class="token punctuation">.</span><span class="token function">ClassificationScore</span><span class="token punctuation">(</span>y_score1_bin<span class="token punctuation">,</span>CLASSIFICATION_AVERAGE_PRECISION<span class="token punctuation">,</span>AVERAGE_BINARY<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;average precision score binary = &quot;</span><span class="token punctuation">,</span>ap2<span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector ap3<span class="token operator">=</span>y_true_bin<span class="token punctuation">.</span><span class="token function">ClassificationScore</span><span class="token punctuation">(</span>y_scores_bin<span class="token punctuation">,</span>CLASSIFICATION_AVERAGE_PRECISION<span class="token punctuation">,</span>AVERAGE_NONE<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;average precision score none = &quot;</span><span class="token punctuation">,</span>ap3<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
   vector area<span class="token operator">=</span>y_true_bin<span class="token punctuation">.</span><span class="token function">ClassificationScore</span><span class="token punctuation">(</span>y_scores_bin<span class="token punctuation">,</span>CLASSIFICATION_ROC_AUC<span class="token punctuation">,</span>AVERAGE_BINARY<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;roc auc score binary = &quot;</span><span class="token punctuation">,</span>area<span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector area2<span class="token operator">=</span>y_true_bin<span class="token punctuation">.</span><span class="token function">ClassificationScore</span><span class="token punctuation">(</span>y_score1_bin<span class="token punctuation">,</span>CLASSIFICATION_ROC_AUC<span class="token punctuation">,</span>AVERAGE_BINARY<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;roc auc score binary = &quot;</span><span class="token punctuation">,</span>area2<span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector area3<span class="token operator">=</span>y_true_bin<span class="token punctuation">.</span><span class="token function">ClassificationScore</span><span class="token punctuation">(</span>y_scores_bin<span class="token punctuation">,</span>CLASSIFICATION_ROC_AUC<span class="token punctuation">,</span>AVERAGE_NONE<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;roc auc score none = &quot;</span><span class="token punctuation">,</span>area3<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
 
<span class="token comment">/*
  top 1 accuracy score = [0.6666666666666666]
  top 2 accuracy score = [1]
  top k = [0.75]
  
  average precision score micro = [0.8513333333333333]
  average precision score macro = [0.9326666666666666]
  average precision score weighted = [0.9333333333333333]
  average precision score none = [1,1,0.7,1,0.9266666666666666,0.8333333333333333,1,0.8666666666666667,1,1]
  
  roc auc score micro = [0.9839506172839506]
  roc auc score macro = [0.9892068783068803]
  roc auc score weighted = [0.9887354497354497]
  roc auc score none = [1,1,0.9506172839506173,1,0.984,0.9821428571428571,1,0.9753086419753086,1,1]
  
  average precision score binary = [0.7961904761904761]
  average precision score binary = [0.7961904761904761]
  average precision score none = [0.7678571428571428,0.7961904761904761]
  
  roc auc score binary = [0.7]
  roc auc score binary = [0.7]
  roc auc score none = [0.7,0.7]
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br></div></div><h3 id="_7-10-10-precisionrecall"><a href="#_7-10-10-precisionrecall" class="header-anchor">#</a> 7.10.10  PrecisionRecall</h3> <p>计算值以构建精确调用曲线。与ClassificationScore类似，此方法应用于真值向量。</p> <p>bool vector::PrecisionRecall(
const matrix&amp;                 pred_scores,   // 包含每类概率分布的矩阵
const ENUM_ENUM_AVERAGE_MODE  mode           // 平均模式
matrix&amp;                       precision,     // 计算每个阈值的精确值
matrix&amp;                       recall,        // 计算每个阈值的调用值
matrix&amp;                       thresholds,    // 以降序排列阈值
);</p> <p>参数</p> <p>pred_scores</p> <p>[in]  包含一组水平向量（含有每个类的概率）的矩阵。矩阵行数必须与真值向量的大小相对应。</p> <p>模式</p> <p>[in] ENUM_AVERAGE_MODE枚举的平均模式。只使用AVERAGE_NONE，AVERAGE_BINARY和AVERAGE_MICRO。</p> <p>precision</p> <p>[out]  包含计算精度曲线值的矩阵。如果不使用平均模式 (AVERAGE_NONE)，则矩阵中的行数对应于模型类的数量。列数对应于真值向量的大小（或概率分布矩阵pred_score中的行数）。在微平均的情况下，矩阵中的行数对应于阈值的总数，不包括重复项。</p> <p>recall</p> <p>[out]  包含计算调用曲线值的矩阵。</p> <p>threshold</p> <p>[out]  对概率矩阵进行排序得到的阈值矩阵</p> <p>注意</p> <p>请参阅ClassificationScore方法的注释。</p> <p>例如</p> <p>从mnist.onnx模型收集统计数据的示例（99%准确率）。</p> <p>//--- 分类指标数据
vectorf y_true(images);
vectorf y_pred(images);
matrixf y_scores(images,10);</p> <p>//--- 输入输出
matrixf image(28,28);
vectorf result(10);</p> <p>//--- 测试
for(int test=0; test&lt;images; test++)
{
image=test_data[test].image;
if(!OnnxRun(model,ONNX_DEFAULT,image,result))
{
Print(&quot;OnnxRun error &quot;,GetLastError());
break;
}
result.Activation(result,AF_SOFTMAX);</p> <div class="language- extra-class"><pre><code> //--- 收集数据
  y_true[test]=(float)test_data[test].label;
  y_pred[test]=(float)result.ArgMax();
  y_scores.Row(result,test);
 }    }
</code></pre></div><p>Accuracy calculation</p> <p>vectorf accuracy=y_pred.ClassificationMetric(y_true,CLASSIFICATION_ACCURACY);
PrintFormat(&quot;accuracy=%f&quot;,accuracy[0]);</p> <p>accuracy=0.989000</p> <p>绘制精确调用图的示例，其中精确值绘制在y轴上，调用值绘制在x轴上。此外，精度图和调用图也分别绘制，阈值绘制在x轴上</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>    <span class="token keyword">if</span><span class="token punctuation">(</span>y_true<span class="token punctuation">.</span><span class="token function">PrecisionRecall</span><span class="token punctuation">(</span>y_scores<span class="token punctuation">,</span>AVERAGE_MICRO<span class="token punctuation">,</span>mat_precision<span class="token punctuation">,</span>mat_recall<span class="token punctuation">,</span>mat_thres<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token keyword">double</span> precision<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>recall<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>thres<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token function">ArrayResize</span><span class="token punctuation">(</span>precision<span class="token punctuation">,</span>mat_thres<span class="token punctuation">.</span><span class="token function">Cols</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">ArrayResize</span><span class="token punctuation">(</span>recall<span class="token punctuation">,</span>mat_thres<span class="token punctuation">.</span><span class="token function">Cols</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">ArrayResize</span><span class="token punctuation">(</span>thres<span class="token punctuation">,</span>mat_thres<span class="token punctuation">.</span><span class="token function">Cols</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
      <span class="token keyword">for</span><span class="token punctuation">(</span>uint i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>thres<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
         precision<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>mat_precision<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
         recall<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>mat_recall<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
         thres<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>mat_thres<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      thres<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>thres<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">0.001</span><span class="token punctuation">;</span>
 
      <span class="token function">PlotCurve</span><span class="token punctuation">(</span><span class="token string">&quot;Precision-Recall curve (micro average)&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;p-r&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>recall<span class="token punctuation">,</span>precision<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">Plot2Curves</span><span class="token punctuation">(</span><span class="token string">&quot;Precision-Recall (micro average)&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;precision&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;recall&quot;</span><span class="token punctuation">,</span>thres<span class="token punctuation">,</span>precision<span class="token punctuation">,</span>recall<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>Resulting curves:</p> <p><img src="/mql5yao/assets/img/precision_recall_curve.bcea1be9.png" alt="Resulting curves"></p> <p><img src="/mql5yao/assets/img/precision_recall_micro.8e34c740.png" alt="Resulting curves"></p> <h3 id="_7-10-11-receiveroperatingcharacteristic"><a href="#_7-10-11-receiveroperatingcharacteristic" class="header-anchor">#</a> 7.10.11  ReceiverOperatingCharacteristic</h3> <p>计算值以构建接收器工作特性(ROC)曲线。与ClassificationScore类似，此方法应用于真值向量。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span> vector<span class="token double-colon punctuation">::</span><span class="token function">ReceiverOperatingCharacteristic</span><span class="token punctuation">(</span>
   <span class="token keyword">const</span> matrix<span class="token operator">&amp;</span>                 pred_scores<span class="token punctuation">,</span>   <span class="token comment">// 包含每类概率分布的矩阵</span>
   <span class="token keyword">const</span> ENUM_ENUM_AVERAGE_MODE  mode           <span class="token comment">// 平均模式</span>
   matrix<span class="token operator">&amp;</span>                       fpr<span class="token punctuation">,</span>           <span class="token comment">// 计算每个阈值的假阳性率值</span>
   matrix<span class="token operator">&amp;</span>                       tpr<span class="token punctuation">,</span>           <span class="token comment">// 计算每个阈值的真阳性率值</span>
   matrix<span class="token operator">&amp;</span>                       thresholds<span class="token punctuation">,</span>    <span class="token comment">// 以降序排列阈值</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>参数</strong></p> <p>pred_scores</p> <p>[in]  包含一组水平向量（含有每个类的概率）的矩阵。矩阵行数必须与真值向量的大小相对应。</p> <p>模式</p> <p>[in] ENUM_AVERAGE_MODE枚举的平均模式。只使用AVERAGE_NONE，AVERAGE_BINARY和AVERAGE_MICRO。</p> <p>fpr</p> <p>[out]  假阳性率曲线计算值的矩阵。如果不使用平均模式 (AVERAGE_NONE)，则矩阵中的行数对应于模型类的数量。列数对应于真值向量的大小（或概率分布矩阵pred_score中的行数）。在微平均的情况下，矩阵中的行数对应于阈值的总数，不包括重复项。</p> <p>tpr</p> <p>[out]  真阳性率曲线计算值的矩阵。</p> <p>threshold</p> <p>[out]  对概率矩阵进行排序得到的阈值矩阵</p> <p><strong>注意</strong></p> <p>请参阅ClassificationScore方法的注释。</p> <p><strong>例如</strong></p> <p>绘制ROC图的示例，其中tpr值绘制在y轴上，fpr值绘制在x轴上。此外，fpr图和tpr图也分别绘制，阈值绘制在x轴上</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   matrixf mat_thres<span class="token punctuation">;</span>
   matrixf mat_fpr<span class="token punctuation">;</span>
   matrixf mat_tpr<span class="token punctuation">;</span>
 
   <span class="token keyword">if</span><span class="token punctuation">(</span>y_true<span class="token punctuation">.</span><span class="token function">ReceiverOperatingCharacteristic</span><span class="token punctuation">(</span>y_scores<span class="token punctuation">,</span>AVERAGE_MICRO<span class="token punctuation">,</span>mat_fpr<span class="token punctuation">,</span>mat_tpr<span class="token punctuation">,</span>mat_thres<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token keyword">double</span> fpr<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>tpr<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>thres<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token function">ArrayResize</span><span class="token punctuation">(</span>fpr<span class="token punctuation">,</span>mat_thres<span class="token punctuation">.</span><span class="token function">Cols</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">ArrayResize</span><span class="token punctuation">(</span>tpr<span class="token punctuation">,</span>mat_thres<span class="token punctuation">.</span><span class="token function">Cols</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">ArrayResize</span><span class="token punctuation">(</span>thres<span class="token punctuation">,</span>mat_thres<span class="token punctuation">.</span><span class="token function">Cols</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
      <span class="token keyword">for</span><span class="token punctuation">(</span>uint i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>fpr<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
         fpr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>mat_fpr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
         tpr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>mat_tpr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
         thres<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>mat_thres<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      thres<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>thres<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">0.001</span><span class="token punctuation">;</span>
 
      <span class="token function">PlotCurve</span><span class="token punctuation">(</span><span class="token string">&quot;ROC curve (micro average)&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;roc&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;0.5&quot;</span><span class="token punctuation">,</span>fpr<span class="token punctuation">,</span>tpr<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">Plot2Curves</span><span class="token punctuation">(</span><span class="token string">&quot;fpr-tpr (micro average)&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;fpr&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;tpr&quot;</span><span class="token punctuation">,</span>thres<span class="token punctuation">,</span>fpr<span class="token punctuation">,</span>tpr<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>结果曲线：</p> <p><img src="/mql5yao/assets/img/roc_curve_micro.63728337.png" alt="Roc_Curve"></p> <p><img src="/mql5yao/assets/img/fpr_tpr_micro.1008fd88.png" alt="fpr-tpr"></p> <p>图形输出代码很简单，并且基于&lt;Graphics/Graphic.mqh&gt;标准库。</p> <p>示例使用mnist.onnx模型的数据。代码在PrecisionRecall方法描述中展示。</p> <p>ROC AUC接近理想值。</p> <p><code>roc auc score micro = [0.99991]</code></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/mql5yao/Chapter/six.html" class="prev">
        06 第六章 数组函数
      </a></span> <span class="next"><a href="/mql5yao/Chapter/seven.html">
        08 第八章 函数转换
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/mql5yao/assets/js/app.8a48e4d1.js" defer></script><script src="/mql5yao/assets/js/2.8ccfeae3.js" defer></script><script src="/mql5yao/assets/js/1.abd3212e.js" defer></script><script src="/mql5yao/assets/js/25.31655e4d.js" defer></script>
  </body>
</html>
