<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>智能交易*姚 文档站</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/mql5yao/favicon.ico">
    <meta name="description" content="这是智能交易的文档站点。">
    <meta name="keywords" content="MQL,EA,智能交易,自动交易,量化,编程,培训">
    
    <link rel="preload" href="/mql5yao/assets/css/0.styles.7f3ae2a1.css" as="style"><link rel="preload" href="/mql5yao/assets/js/app.8a48e4d1.js" as="script"><link rel="preload" href="/mql5yao/assets/js/2.8ccfeae3.js" as="script"><link rel="preload" href="/mql5yao/assets/js/1.abd3212e.js" as="script"><link rel="preload" href="/mql5yao/assets/js/45.1ee1c2de.js" as="script"><link rel="prefetch" href="/mql5yao/assets/js/10.f43632ba.js"><link rel="prefetch" href="/mql5yao/assets/js/11.1d038644.js"><link rel="prefetch" href="/mql5yao/assets/js/12.e50722f3.js"><link rel="prefetch" href="/mql5yao/assets/js/13.bc6e6556.js"><link rel="prefetch" href="/mql5yao/assets/js/14.5cb8131f.js"><link rel="prefetch" href="/mql5yao/assets/js/15.bc368dfb.js"><link rel="prefetch" href="/mql5yao/assets/js/16.60e872ed.js"><link rel="prefetch" href="/mql5yao/assets/js/17.15a8a4c2.js"><link rel="prefetch" href="/mql5yao/assets/js/18.a3079194.js"><link rel="prefetch" href="/mql5yao/assets/js/19.2e53fae9.js"><link rel="prefetch" href="/mql5yao/assets/js/20.ff88a6ab.js"><link rel="prefetch" href="/mql5yao/assets/js/21.24994246.js"><link rel="prefetch" href="/mql5yao/assets/js/22.5048fb10.js"><link rel="prefetch" href="/mql5yao/assets/js/23.b0f62895.js"><link rel="prefetch" href="/mql5yao/assets/js/24.47212fdf.js"><link rel="prefetch" href="/mql5yao/assets/js/25.31655e4d.js"><link rel="prefetch" href="/mql5yao/assets/js/26.eaeeac1b.js"><link rel="prefetch" href="/mql5yao/assets/js/27.62ad36df.js"><link rel="prefetch" href="/mql5yao/assets/js/28.69609490.js"><link rel="prefetch" href="/mql5yao/assets/js/29.bd4055a1.js"><link rel="prefetch" href="/mql5yao/assets/js/3.0ebc6d24.js"><link rel="prefetch" href="/mql5yao/assets/js/30.f43e33e8.js"><link rel="prefetch" href="/mql5yao/assets/js/31.08aac79a.js"><link rel="prefetch" href="/mql5yao/assets/js/32.e40034cb.js"><link rel="prefetch" href="/mql5yao/assets/js/33.f14c86ef.js"><link rel="prefetch" href="/mql5yao/assets/js/34.35c02b74.js"><link rel="prefetch" href="/mql5yao/assets/js/35.048a5906.js"><link rel="prefetch" href="/mql5yao/assets/js/36.7be7df03.js"><link rel="prefetch" href="/mql5yao/assets/js/37.caf30399.js"><link rel="prefetch" href="/mql5yao/assets/js/38.7081ef66.js"><link rel="prefetch" href="/mql5yao/assets/js/39.8b16de3c.js"><link rel="prefetch" href="/mql5yao/assets/js/4.64cdca5a.js"><link rel="prefetch" href="/mql5yao/assets/js/40.c4bcc68d.js"><link rel="prefetch" href="/mql5yao/assets/js/41.9e814ceb.js"><link rel="prefetch" href="/mql5yao/assets/js/42.626ed300.js"><link rel="prefetch" href="/mql5yao/assets/js/43.9e56dbd2.js"><link rel="prefetch" href="/mql5yao/assets/js/44.b0aa6080.js"><link rel="prefetch" href="/mql5yao/assets/js/46.c7e60312.js"><link rel="prefetch" href="/mql5yao/assets/js/47.294d2506.js"><link rel="prefetch" href="/mql5yao/assets/js/48.9896cb6c.js"><link rel="prefetch" href="/mql5yao/assets/js/49.0b669611.js"><link rel="prefetch" href="/mql5yao/assets/js/5.6e0bc11f.js"><link rel="prefetch" href="/mql5yao/assets/js/50.d4317362.js"><link rel="prefetch" href="/mql5yao/assets/js/51.7cde1a30.js"><link rel="prefetch" href="/mql5yao/assets/js/52.593fbf2b.js"><link rel="prefetch" href="/mql5yao/assets/js/53.47314628.js"><link rel="prefetch" href="/mql5yao/assets/js/54.9177a36c.js"><link rel="prefetch" href="/mql5yao/assets/js/55.890a40de.js"><link rel="prefetch" href="/mql5yao/assets/js/56.950e221a.js"><link rel="prefetch" href="/mql5yao/assets/js/57.42541ac8.js"><link rel="prefetch" href="/mql5yao/assets/js/58.b782ed1e.js"><link rel="prefetch" href="/mql5yao/assets/js/59.0f7a8fa5.js"><link rel="prefetch" href="/mql5yao/assets/js/6.30ab1089.js"><link rel="prefetch" href="/mql5yao/assets/js/60.bb949f49.js"><link rel="prefetch" href="/mql5yao/assets/js/61.fb831bab.js"><link rel="prefetch" href="/mql5yao/assets/js/62.1d11fcd0.js"><link rel="prefetch" href="/mql5yao/assets/js/63.5e21940a.js"><link rel="prefetch" href="/mql5yao/assets/js/7.7481afc6.js"><link rel="prefetch" href="/mql5yao/assets/js/vendors~docsearch.b8e67d2d.js">
    <link rel="stylesheet" href="/mql5yao/assets/css/0.styles.7f3ae2a1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/mql5yao/" class="home-link router-link-active"><img src="/mql5yao/logo.png" alt="智能交易*姚 文档站" class="logo"> <span class="site-name can-hide">智能交易*姚 文档站</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/mql5yao/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/mql5yao/Chapter/start.html" class="nav-link">
  文档
</a></div><div class="nav-item"><a href="/mql5yao/Cutleeks/" class="nav-link">
  割韭菜XX招
</a></div><div class="nav-item"><a href="/mql5yao/support/" class="nav-link">
  支持本站
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/mql5yao/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/mql5yao/Chapter/start.html" class="nav-link">
  文档
</a></div><div class="nav-item"><a href="/mql5yao/Cutleeks/" class="nav-link">
  割韭菜XX招
</a></div><div class="nav-item"><a href="/mql5yao/support/" class="nav-link">
  支持本站
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>MQL5线上手册</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mql5yao/Chapter/start.html" class="sidebar-link">MQL5 参考</a></li><li><a href="/mql5yao/Chapter/one.html" class="sidebar-link">01 第一章 语言基础</a></li><li><a href="/mql5yao/Chapter/two.html" class="sidebar-link">02 第二章 标准常量，列举和架构</a></li><li><a href="/mql5yao/Chapter/three.html" class="sidebar-link">03 第三章 MQL5程序</a></li><li><a href="/mql5yao/Chapter/four.html" class="sidebar-link">04 第四章 预定义变量</a></li><li><a href="/mql5yao/Chapter/five.html" aria-current="page" class="active sidebar-link">05 第五章 普通函数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/five.html#_5-1-alert" class="sidebar-link">5.1 Alert</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/five.html#_5-2-checkpointer" class="sidebar-link">5.2 CheckPointer</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/five.html#_5-3-comment" class="sidebar-link">5.3 Comment</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/five.html#_5-4-cryptencode" class="sidebar-link">5.4 CryptEncode</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/five.html#_5-5-cryptdecode" class="sidebar-link">5.5 CryptDecode</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/five.html#_5-6-debugbreak" class="sidebar-link">5.6 DebugBreak</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/five.html#_5-7-expertremove" class="sidebar-link">5.7 ExpertRemove</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/five.html#_5-8-getpointer" class="sidebar-link">5.8 GetPointer</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/five.html#_5-9-gettickcount" class="sidebar-link">5.9 GetTickCount</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/five.html#_5-10-getmicrosecondcount" class="sidebar-link">5.10 GetMicrosecondCount</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/five.html#_5-11-messagebox" class="sidebar-link">5.11 MessageBox</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/five.html#_5-12-periodseconds" class="sidebar-link">5.12 PeriodSeconds</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/five.html#_5-13-playsound" class="sidebar-link">5.13 PlaySound</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/five.html#_5-14-print" class="sidebar-link">5.14 Print</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/five.html#_5-15-printformat" class="sidebar-link">5.15 PrintFormat</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/five.html#_5-16-resetlasterror" class="sidebar-link">5.16 ResetLastError</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/five.html#_5-17-resourcecreate" class="sidebar-link">5.17 ResourceCreate</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/five.html#_5-18-resourcefree" class="sidebar-link">5.18 ResourceFree</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/five.html#_5-19-resourcereadimage" class="sidebar-link">5.19 ResourceReadImage</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/five.html#_5-20-resourcesave" class="sidebar-link">5.20 ResourceSave</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/five.html#_5-21-setreturnerror" class="sidebar-link">5.21 SetReturnError</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/five.html#_5-22-setusererror" class="sidebar-link">5.22 SetUserError</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/five.html#_5-23-sleep" class="sidebar-link">5.23 Sleep</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/five.html#_5-24-terminalclose" class="sidebar-link">5.24 TerminalClose</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/five.html#_5-25-testerhideindicators" class="sidebar-link">5.25 TesterHideIndicators</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/five.html#_5-26-testerstatistics" class="sidebar-link">5.26 TesterStatistics</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/five.html#_5-27-testerstop" class="sidebar-link">5.27 TesterStop</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/five.html#_5-28-testerwithdrawal" class="sidebar-link">5.28 TesterWithdrawal</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/five.html#_5-29-translatekey" class="sidebar-link">5.29 TranslateKey</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/five.html#_5-30-zeromemory" class="sidebar-link">5.30 ZeroMemory</a></li></ul></li><li><a href="/mql5yao/Chapter/six.html" class="sidebar-link">06 第六章 数组函数</a></li><li><a href="/mql5yao/Chapter/add1.html" class="sidebar-link">07 第七章 矩阵和向量方法</a></li><li><a href="/mql5yao/Chapter/seven.html" class="sidebar-link">08 第八章 函数转换</a></li><li><a href="/mql5yao/Chapter/eight.html" class="sidebar-link">09 第九章 数学函数</a></li><li><a href="/mql5yao/Chapter/nine.html" class="sidebar-link">10 第十章 字符串函数</a></li><li><a href="/mql5yao/Chapter/ten.html" class="sidebar-link">11 第十一章 日期和时间</a></li><li><a href="/mql5yao/Chapter/eleven.html" class="sidebar-link">12 第十二章 账户信息</a></li><li><a href="/mql5yao/Chapter/twelve.html" class="sidebar-link">13 第十三章 检测</a></li><li><a href="/mql5yao/Chapter/thirteen.html" class="sidebar-link">14 第十四章 事件处理</a></li><li><a href="/mql5yao/Chapter/fourteen.html" class="sidebar-link">15 第十五章 市场信息</a></li><li><a href="/mql5yao/Chapter/fifteen.html" class="sidebar-link">16 第十六章 经济日历函数</a></li><li><a href="/mql5yao/Chapter/sixteen.html" class="sidebar-link">17 第十七章 时间序列和指标访问</a></li><li><a href="/mql5yao/Chapter/seventeen.html" class="sidebar-link">18 第十八章 自定义交易品种</a></li><li><a href="/mql5yao/Chapter/eighteen.html" class="sidebar-link">19 第十九章 图表操作</a></li><li><a href="/mql5yao/Chapter/ninteen.html" class="sidebar-link">20 第二十章 交易函数</a></li><li><a href="/mql5yao/Chapter/twenty.html" class="sidebar-link">21 第廿一章 交易信号</a></li><li><a href="/mql5yao/Chapter/twentyone.html" class="sidebar-link">22 第廿二章 网络函数</a></li><li><a href="/mql5yao/Chapter/twentytwo.html" class="sidebar-link">23 第廿三章 程序端全局变量</a></li><li><a href="/mql5yao/Chapter/twentythree.html" class="sidebar-link">24 第廿四章 文件函数</a></li><li><a href="/mql5yao/Chapter/twentyfour.html" class="sidebar-link">25 第廿五章 自定义指标</a></li><li><a href="/mql5yao/Chapter/twentyfive.html" class="sidebar-link">26 第廿六章 物件函数</a></li><li><a href="/mql5yao/Chapter/twentysix.html" class="sidebar-link">27 第廿七章 技术指标</a></li><li><a href="/mql5yao/Chapter/twentyseven.html" class="sidebar-link">28 第甘八章 处理优化结果</a></li><li><a href="/mql5yao/Chapter/twentyeight.html" class="sidebar-link">29 第廿九章 工作事件</a></li><li><a href="/mql5yao/Chapter/twentynine.html" class="sidebar-link">30 第三十章 使用OpenCL工作</a></li><li><a href="/mql5yao/Chapter/thirty.html" class="sidebar-link">31 第卅一章 使用数据库</a></li><li><a href="/mql5yao/Chapter/thirtyone.html" class="sidebar-link">32 第卅二章 使用DirectX</a></li><li><a href="/mql5yao/Chapter/thirtytwo.html" class="sidebar-link">33 第卅三章 MetaTrader与Python集成的模块</a></li><li><a href="/mql5yao/Chapter/add2.html" class="sidebar-link">34 第卅四章 ONNX模型</a></li><li><a href="/mql5yao/Chapter/thirtythree.html" class="sidebar-link">35 第卅五章 标准程序库</a></li><li><a href="/mql5yao/Chapter/AppendixI.html" class="sidebar-link">36 附录一 来自MQL4</a></li><li><a href="/mql5yao/Chapter/AppendixII.html" class="sidebar-link">37 附录二 MQL5 函数列表</a></li><li><a href="/mql5yao/Chapter/AppendixIII.html" class="sidebar-link">38 附录三 MQL5常量列表</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2>第五章 普通函数</h2> <p>这里列出了不包含在任何专门分组中的普通函数。</p> <table><thead><tr><th>函数</th> <th>命令</th></tr></thead> <tbody><tr><td>Alert</td> <td>在独立窗口中显示消息(弹窗式报警)</td></tr> <tr><td>CheckPointer</td> <td>返回对象指针的类型</td></tr> <tr><td>Comment</td> <td>在图表左上角显示注解文本</td></tr> <tr><td>CryptEncode</td> <td>将数据从 数组 转换为指定的 方法</td></tr> <tr><td>CryptDecode</td> <td>执行来自 数组 的数据的逆变换</td></tr> <tr><td>DebugBreak</td> <td>程序断点调试</td></tr> <tr><td>ExpertRemove</td> <td>停止 EA交易程序 并从图表中卸载</td></tr> <tr><td>GetPointer</td> <td>返回对象 指针</td></tr> <tr><td>GetTickCount</td> <td>返回系统启动后经过的毫秒数</td></tr> <tr><td>GetMicrosecondCount</td> <td>返回MQL5程序启动后经过微秒数</td></tr> <tr><td>MessageBox</td> <td>创建，显示消息盒子，然后管理(弹窗式消息)</td></tr> <tr><td>PeriodSeconds</td> <td>在周期中返回秒数</td></tr> <tr><td>PlaySound</td> <td>播放一个音频文件</td></tr> <tr><td>Print</td> <td>在日志中显示一则消息</td></tr> <tr><td>PrintFormat</td> <td>在日志文件中按照预先设定的格式，组织并打印一则字符串和变量的值组成的消息</td></tr> <tr><td>ResetLastError</td> <td>设置 预定义变量 _LastError的值 为 0</td></tr> <tr><td>ResourceCreate</td> <td>创建基于数据集的图像资源</td></tr> <tr><td>ResourceFree</td> <td>删除 动态创建资源 (释放分配的内存)</td></tr> <tr><td>ResourceReadImage</td> <td>读取由ResourceCreate()函数创建的，或在编译期间保存在EX5文件中的图形资源的数据</td></tr> <tr><td>ResourceSave</td> <td>将资源保存在指定文件</td></tr> <tr><td>SetUserError</td> <td>将预定义变量 _LastError 设置为等于 ERR_USER_ERROR_FIRST + user_error 的值</td></tr> <tr><td>SetReturnError</td> <td>设置完成操作时返回程序端进程的代码</td></tr> <tr><td>SendFTP</td> <td>按”选项”设置窗口中“FTP”标签中指定的地址发送一个文件</td></tr> <tr><td>SendMail</td> <td>按”选项”设置窗口中“电邮”标签中指定的地址发送一个邮件</td></tr> <tr><td>SendNotification</td> <td>按”选项”设置窗口中“通知”标签中指定的 MetaQuotes ID 推送一个短消息</td></tr> <tr><td>Sleep</td> <td>在指定的间隔内暂停当前EA程序 或 脚本 的执行。</td></tr> <tr><td>TerminalClose</td> <td>命令客户端完成操作</td></tr> <tr><td>TesterStatistics</td> <td>返回基于测试结果计算的指定统计量的值</td></tr> <tr><td>TesterWithdrawal</td> <td>在测试过程中模拟出金操作</td></tr> <tr><td>TranslateKey</td> <td>考虑当前输入语言 和 控制键状态 的虚拟按键编码，返回对应的Unicode字符。</td></tr> <tr><td>ZeroMemory</td> <td>重新设置通过引用传递给它的变量。除了具有构造函数的 类 和结构 之外，变量可以是任何类型的。</td></tr></tbody></table> <h2 id="_5-1-alert"><a href="#_5-1-alert" class="header-anchor">#</a> 5.1 Alert</h2> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>在独立窗口中显示消息<span class="token punctuation">(</span>弹窗式报警<span class="token punctuation">)</span>
    <span class="token keyword">void</span>  <span class="token function">Alert</span><span class="token punctuation">(</span>
   argument<span class="token punctuation">,</span>     <span class="token comment">// 第一值</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>           <span class="token comment">// 其他值</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>参数</p> <p>argument</p> <p>[in] 用逗号分隔的任何值。为了将信息输出分成几行，您可以使用“\n”或“\r\n”转义符。参数的数量不能超过64个。</p> <p>返回值</p> <p>没有返回值。</p> <p>注意</p> <p>数组不能作为参数传递给Alert() 函数，应该将数组的 元素 作为参数传递给Alert() 函数。双精度类型的数据可以输出小数点后8位，浮点类型的数据可以输出小数点后5位。要以不同的精度或以科学计数法的格式输出实际的数字，请使用DoubleToString()函数。</p> <p>布尔类型的数据输出为“true”或“false”字符串。日期的输出是YYYY.MM.DD HH:MI:SS格式。要以另一种格式显示日期，请使用TimeToString()函数。颜色类型的数据如果是在一个颜色集合中，输出时要么是一个R,G,B字符串，要么是一个颜色名称。</p> <p>Alert() 函数在策略测试器中不工作。</p> <h2 id="_5-2-checkpointer"><a href="#_5-2-checkpointer" class="header-anchor">#</a> 5.2 CheckPointer</h2> <p>函数返回对象指针的类型。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>ENUM_POINTER_TYPE  <span class="token function">CheckPointer</span><span class="token punctuation">(</span>
   object<span class="token operator">*</span> anyobject      <span class="token comment">// 对象指针</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>参数</p> <p>anyobject</p> <p>[in] 对象指针</p> <p>返回值</p> <p>从 ENUM_POINTER_TYPE 枚举中返回值。</p> <p>注意</p> <p>使用错误的指针，会导致终端运行时错误，直接终止程序。这就是为什么需要在使用指针之前调用CheckPointer函数。在下列情况下，指针可能不正确:
• 指针等于 NULL；
• 对象已被 delete 操作删除；</p> <p>这个函数可以用来检查 指针 的有效性。一个非零值保证，该指针可用于访问。</p> <p>示例：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 通过删除元素来删除列表                                              |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token class-name">CMyList</span><span class="token double-colon punctuation">::</span><span class="token function">Destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 循环工作服务指针</span>
   CItem<span class="token operator">*</span> item<span class="token punctuation">;</span>
<span class="token comment">//--- 循环检测并删除动态指针</span>
   <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">CheckPointer</span><span class="token punctuation">(</span>m_items<span class="token punctuation">)</span><span class="token operator">!=</span>POINTER_INVALID<span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      item<span class="token operator">=</span>m_items<span class="token punctuation">;</span>
      m_items<span class="token operator">=</span>m_items<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">CheckPointer</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token operator">==</span>POINTER_DYNAMIC<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
         <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Dynamic object &quot;</span><span class="token punctuation">,</span>item<span class="token punctuation">.</span><span class="token function">Identifier</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&quot; to be deleted&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">delete</span> <span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token keyword">else</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Non-dynamic object &quot;</span><span class="token punctuation">,</span>item<span class="token punctuation">.</span><span class="token function">Identifier</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&quot; cannot be deleted&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//---</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>相关参考
对象指针 ，检测对象指针 ， 对象删除操作符的删除</p> <h2 id="_5-3-comment"><a href="#_5-3-comment" class="header-anchor">#</a> 5.3 Comment</h2> <p>在图表左上角显示注解文本</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">void</span>  <span class="token function">Comment</span><span class="token punctuation">(</span>
   argument<span class="token punctuation">,</span>     <span class="token comment">// 第一值</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>           <span class="token comment">// 下一值</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>参数</p> <p>...</p> <p>[in]用逗号分隔的任何值。为了将信息输出分成几行，您可以使用“\n”或“\r\n”转义符。参数的数量不能超过64个。输入的注解文本(包括隐形的字符)的总长度不能超过2045个字节（在输出过程中超出的字符会被删去）</p> <p>返回值</p> <p>没有返回值</p> <p>注意</p> <p>数组不能作为参数传递给Comment()函数，数组必须按一个接一个的元素传递给Comment()函数。</p> <p>双精度类型的数据，精确度保留到小数点后16位，以 传统 或 科学计数法 的方式输出，取决于什么 方式 更紧凑。浮点型数据保留小数点后5位，要用另一个精度 或 预定义格式输出实际数字，请使用DoubleToString()函数。</p> <p>布尔类型的数据输出为“true”或“false”字符串。日期的输出是YYYY.MM.DD HH:MI:SS格式。要以另一种格式显示日期，请使用TimeToString()函数。颜色类型的数据如果是在一个颜色集合中，输出时要么是一个R,G,B字符串，要么是一个颜色名称。</p> <p>示例：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token function">OnTick</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//---</span>
   <span class="token keyword">double</span> Ask<span class="token punctuation">,</span>Bid<span class="token punctuation">;</span>
   <span class="token keyword">int</span> Spread<span class="token punctuation">;</span>
   Ask<span class="token operator">=</span><span class="token function">SymbolInfoDouble</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>SYMBOL_ASK<span class="token punctuation">)</span><span class="token punctuation">;</span>
   Bid<span class="token operator">=</span><span class="token function">SymbolInfoDouble</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>SYMBOL_BID<span class="token punctuation">)</span><span class="token punctuation">;</span>
   Spread<span class="token operator">=</span><span class="token function">SymbolInfoInteger</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>SYMBOL_SPREAD<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 3行输出值</span>
   <span class="token function">Comment</span><span class="token punctuation">(</span><span class="token function">StringFormat</span><span class="token punctuation">(</span><span class="token string">&quot;Show prices\nAsk = %G\nBid = %G\nSpread = %d&quot;</span><span class="token punctuation">,</span>Ask<span class="token punctuation">,</span>Bid<span class="token punctuation">,</span>Spread<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>相关参考
ChartSetString ， ChartGetString</p> <h2 id="_5-4-cryptencode"><a href="#_5-4-cryptencode" class="header-anchor">#</a> 5.4 CryptEncode</h2> <p>通过指定的 方法 转换来自数组的数据。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">int</span>  <span class="token function">CryptEncode</span><span class="token punctuation">(</span>
   ENUM_CRYPT_METHOD   method<span class="token punctuation">,</span>        <span class="token comment">// 方法</span>
   <span class="token keyword">const</span> uchar<span class="token operator">&amp;</span>        data<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token comment">// 源数组</span>
   <span class="token keyword">const</span> uchar<span class="token operator">&amp;</span>        key<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>         <span class="token comment">// 密钥</span>
   uchar<span class="token operator">&amp;</span>              result<span class="token punctuation">[</span><span class="token punctuation">]</span>       <span class="token comment">// 目标数组</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>参数</p> <p>method</p> <p>[in] 数据转换方法。取值范围是ENUM_CRYPT_METHOD 枚举值之一。</p> <p>data[]</p> <p>[in] 源数组。</p> <p>key[]</p> <p>[in] 密钥数组。</p> <p>result[]</p> <p>[out] 目标数组。</p> <p>返回值</p> <p>返回目标数组的字节数，如果发生错误则返回0。若要获得有关错误的信息，可以调用 GetLastError() 函数。</p> <p>例如：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| ArrayToHex                                                       |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
string <span class="token function">ArrayToHex</span><span class="token punctuation">(</span>uchar <span class="token operator">&amp;</span>arr<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">int</span> count<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   string res<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
<span class="token comment">//--- 检查</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>count<span class="token operator">&lt;</span><span class="token number">0</span> <span class="token operator">||</span> count<span class="token operator">&gt;</span><span class="token function">ArraySize</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span>
      count<span class="token operator">=</span><span class="token function">ArraySize</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 转换到 HEX 字符串</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
      res<span class="token operator">+=</span><span class="token function">StringFormat</span><span class="token punctuation">(</span><span class="token string">&quot;%.2X&quot;</span><span class="token punctuation">,</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//---</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 脚本程序起始函数                                                   |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   string text<span class="token operator">=</span><span class="token string">&quot;The quick brown fox jumps over the lazy dog&quot;</span><span class="token punctuation">;</span>
   string keystr<span class="token operator">=</span><span class="token string">&quot;ABCDEFG&quot;</span><span class="token punctuation">;</span>
   uchar src<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>dst<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>key<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">//--- 准备密钥</span>
   <span class="token function">StringToCharArray</span><span class="token punctuation">(</span>keystr<span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 复制文本到源数组src[]</span>
   <span class="token function">StringToCharArray</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span>src<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 打印初始数据</span>
   <span class="token function">PrintFormat</span><span class="token punctuation">(</span><span class="token string">&quot;Initial data: size=%d, string='%s'&quot;</span><span class="token punctuation">,</span><span class="token function">ArraySize</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">CharArrayToString</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 用key[]的DES56位密钥加密DES src[]</span>
   <span class="token keyword">int</span> res<span class="token operator">=</span><span class="token function">CryptEncode</span><span class="token punctuation">(</span>CRYPT_DES<span class="token punctuation">,</span>src<span class="token punctuation">,</span>key<span class="token punctuation">,</span>dst<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 检查错误</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token comment">//--- 打印加密数据</span>
      <span class="token function">PrintFormat</span><span class="token punctuation">(</span><span class="token string">&quot;Encoded data: size=%d %s&quot;</span><span class="token punctuation">,</span>res<span class="token punctuation">,</span><span class="token function">ArrayToHex</span><span class="token punctuation">(</span>dst<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 解码 dst[] 到 src[]</span>
      res<span class="token operator">=</span><span class="token function">CryptDecode</span><span class="token punctuation">(</span>CRYPT_DES<span class="token punctuation">,</span>dst<span class="token punctuation">,</span>key<span class="token punctuation">,</span>src<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 检查错误</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
         <span class="token comment">//--- 打印解码数据</span>
         <span class="token function">PrintFormat</span><span class="token punctuation">(</span><span class="token string">&quot;Decoded data: size=%d, string='%s'&quot;</span><span class="token punctuation">,</span><span class="token function">ArraySize</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">CharArrayToString</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token keyword">else</span>
         <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Error in CryptDecode. Error code=&quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
   <span class="token keyword">else</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Error in CryptEncode. Error code=&quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br></div></div><p>相关参考
数组函数， CryptDecode()</p> <h2 id="_5-5-cryptdecode"><a href="#_5-5-cryptdecode" class="header-anchor">#</a> 5.5 CryptDecode</h2> <p>执行数组数据逆转换，通过CryptEncode()转换。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">int</span>  <span class="token function">CryptEncode</span><span class="token punctuation">(</span>
   ENUM_CRYPT_METHOD   method<span class="token punctuation">,</span>        <span class="token comment">// 方法</span>
   <span class="token keyword">const</span> uchar<span class="token operator">&amp;</span>        data<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token comment">// 源数组</span>
   <span class="token keyword">const</span> uchar<span class="token operator">&amp;</span>        key<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>         <span class="token comment">// 密钥</span>
   uchar<span class="token operator">&amp;</span>              result<span class="token punctuation">[</span><span class="token punctuation">]</span>       <span class="token comment">// 目标数组</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>参数</p> <p>method</p> <p>[in] 数据转换方法。取值范围是ENUM_CRYPT_METHOD 枚举值之一。</p> <p>data[]</p> <p>[in] 源数组。</p> <p>key[]</p> <p>[in] 密钥数组。</p> <p>result[]</p> <p>[out] 目标数组。</p> <p>返回值</p> <p>返回目标数组的字节数，如果发生错误则返回0。若要获得有关错误的信息，可以调用 GetLastError() 函数。</p> <p>相关参考
数组函数，CryptEncode()</p> <h2 id="_5-6-debugbreak"><a href="#_5-6-debugbreak" class="header-anchor">#</a> 5.6 DebugBreak</h2> <p>在排除故障中的程序断点。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">void</span>  <span class="token function">DebugBreak</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>返回值</p> <p>没有返回值。</p> <p>注意</p> <p>只有在调试模式下启动程序时，才会中断MQL5程序的执行。该函数可用于查看变量值 和/或 进一步逐步执行。</p> <h2 id="_5-7-expertremove"><a href="#_5-7-expertremove" class="header-anchor">#</a> 5.7 ExpertRemove</h2> <p>此函数将停止 EA交易程序 并 从图表中卸载。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">void</span>  <span class="token function">ExpertRemove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>返回值</p> <p>没有返回值。</p> <p>注意</p> <p>一旦调用ExpertRemove()函数，EA交易不会立即停止，只是设立一个停止EA操作的标帜，之后不能处理任何事件，然后调用 OnDeinit() ，EA交易程序就会卸载并且从图表中删除。</p> <p>示例：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//|                                            Test_ExpertRemove.mq5 |</span>
<span class="token comment">//|                        Copyright 2009, MetaQuotes Software Corp. |</span>
<span class="token comment">//|                                             https://www.mql5.com |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">copyright </span><span class="token string">&quot;2009, MetaQuotes Software Corp.&quot;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">link      </span><span class="token string">&quot;https://www.mql5.com&quot;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">version   </span><span class="token string">&quot;1.00&quot;</span></span>
input <span class="token keyword">int</span> ticks_to_close<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">;</span><span class="token comment">//  EA 卸载前的跳价编号</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| EA反初始化函数                                                     |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">OnDeinit</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> reason<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//---</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token function">TimeCurrent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&quot;: &quot;</span> <span class="token punctuation">,</span>__FUNCTION__<span class="token punctuation">,</span><span class="token string">&quot; reason code = &quot;</span><span class="token punctuation">,</span>reason<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- &quot;清除&quot; 注释</span>
   <span class="token function">Comment</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//---</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| EA跳价编号函数                                                     |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">OnTick</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   <span class="token keyword">static</span> <span class="token keyword">int</span> tick_counter<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token comment">//---</span>
   tick_counter<span class="token operator">++</span><span class="token punctuation">;</span>
   <span class="token function">Comment</span><span class="token punctuation">(</span><span class="token string">&quot;\nBefore unloading expert advisor &quot;</span><span class="token punctuation">,</span><span class="token constant">__FILE__</span><span class="token punctuation">,</span><span class="token string">&quot; left&quot;</span><span class="token punctuation">,</span>
           <span class="token punctuation">(</span>ticks_to_close<span class="token operator">-</span>tick_counter<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&quot; ticks&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 以前</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>tick_counter<span class="token operator">&gt;=</span>ticks_to_close<span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">ExpertRemove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token function">TimeCurrent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&quot;: &quot;</span><span class="token punctuation">,</span>__FUNCTION__<span class="token punctuation">,</span><span class="token string">&quot; expert advisor will be unloaded&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;tick_counter =&quot;</span><span class="token punctuation">,</span>tick_counter<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//---</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><p>相关参考
程序运行 ， 客户端事件</p> <h2 id="_5-8-getpointer"><a href="#_5-8-getpointer" class="header-anchor">#</a> 5.8 GetPointer</h2> <p>此函数返回对象指针。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">void</span><span class="token operator">*</span>  <span class="token function">GetPointer</span><span class="token punctuation">(</span>
   any_class anyobject      <span class="token comment">// 任何类的对象</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>参数</p> <p>anyobject</p> <p>[in] 任何 类 的对象。</p> <p>返回值</p> <p>函数返回对象指针</p> <p>注意</p> <p>只有 类 对象有指针。结构的实例 和 简单类型的变量没有指针。类 对象不是使用new()操作符创建的，但是，例如，在对象数组中自动创建的 对象，仍然有一个指针。但是这个指针将是自动类型的POINTER_AUTOMATIC，因此delete()操作符不能应用于它。除此之外，类型指针与POINTER_AUTOMATIC类型的动态指针没有区别。</p> <p>由于结构类型和简单类型的变量没有指针，所以禁止将GetPointer()函数应用到它们。也禁止将指针作为函数参数传递。在这些情况下，编译器都会通知错误。</p> <p>试图调用不正确的指针会导致程序的运行时错误并直接终止。这就是为什么在使用指针之前应该调用CheckPointer()函数来检查一下。在下列情况下，指针可能不正确:</p> <p>• 指针等于 NULL ；
• 对象已被 delete 操作删除；</p> <p>这个函数可以用来检查 指针 的有效性。一个非零值保证，该指针可用于访问</p> <p>示例：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//|                                             Check_GetPointer.mq5 |</span>
<span class="token comment">//|                        Copyright 2009, MetaQuotes Software Corp. |</span>
<span class="token comment">//|                                             https://www.mql5.com |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">copyright </span><span class="token string">&quot;2009, MetaQuotes Software Corp.&quot;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">link      </span><span class="token string">&quot;https://www.mql5.com&quot;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">version   </span><span class="token string">&quot;1.00&quot;</span></span>

<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 执行列表元素的类                                                   |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">class</span> <span class="token class-name">CItem</span>
  <span class="token punctuation">{</span>
   <span class="token keyword">int</span>               m_id<span class="token punctuation">;</span>
   string            m_comment<span class="token punctuation">;</span>
   CItem<span class="token operator">*</span>            m_next<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
                     <span class="token function">CItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> m_id<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> m_comment<span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">;</span> m_next<span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
                    <span class="token operator">~</span><span class="token function">CItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Destructor of &quot;</span><span class="token punctuation">,</span>m_id<span class="token punctuation">,</span>
                                     <span class="token punctuation">(</span><span class="token function">CheckPointer</span><span class="token punctuation">(</span><span class="token function">GetPointer</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">==</span>POINTER_DYNAMIC<span class="token punctuation">)</span><span class="token operator">?</span>
                                     <span class="token string">&quot;dynamic&quot;</span><span class="token operator">:</span><span class="token string">&quot;non-dynamic&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">void</span>              <span class="token function">Initialize</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">,</span>string comm<span class="token punctuation">)</span> <span class="token punctuation">{</span> m_id<span class="token operator">=</span>id<span class="token punctuation">;</span> m_comment<span class="token operator">=</span>comm<span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">void</span>              <span class="token function">PrintMe</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">Print</span><span class="token punctuation">(</span>__FUNCTION__<span class="token punctuation">,</span><span class="token string">&quot;:&quot;</span><span class="token punctuation">,</span>m_id<span class="token punctuation">,</span>m_comment<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">int</span>               <span class="token function">Identifier</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span><span class="token punctuation">(</span>m_id<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   CItem<span class="token operator">*</span>            <span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">return</span><span class="token punctuation">(</span>m_next<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">void</span>              <span class="token function">Next</span><span class="token punctuation">(</span>CItem <span class="token operator">*</span>item<span class="token punctuation">)</span> <span class="token punctuation">{</span> m_next<span class="token operator">=</span>item<span class="token punctuation">;</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 列表中最简单的类                                                   |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">class</span> <span class="token class-name">CMyList</span>
  <span class="token punctuation">{</span>
   CItem<span class="token operator">*</span>            m_items<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
                     <span class="token function">CMyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> m_items<span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
                    <span class="token operator">~</span><span class="token function">CMyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">Destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">bool</span>             <span class="token function">InsertToBegin</span><span class="token punctuation">(</span>CItem<span class="token operator">*</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span>             <span class="token function">Destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 从开始嵌入列表元素                                                  |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">bool</span> <span class="token class-name">CMyList</span><span class="token double-colon punctuation">::</span><span class="token function">InsertToBegin</span><span class="token punctuation">(</span>CItem<span class="token operator">*</span> item<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">CheckPointer</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token operator">==</span>POINTER_INVALID<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//---</span>
   item<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span>m_items<span class="token punctuation">)</span><span class="token punctuation">;</span>
   m_items<span class="token operator">=</span>item<span class="token punctuation">;</span>
<span class="token comment">//---</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 通过删除元素删除列表                                                |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token class-name">CMyList</span><span class="token double-colon punctuation">::</span><span class="token function">Destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 循环工作服务指针</span>
   CItem<span class="token operator">*</span> item<span class="token punctuation">;</span>
<span class="token comment">//--- 循环检测并删除动态指针</span>
   <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">CheckPointer</span><span class="token punctuation">(</span>m_items<span class="token punctuation">)</span><span class="token operator">!=</span>POINTER_INVALID<span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      item<span class="token operator">=</span>m_items<span class="token punctuation">;</span>
      m_items<span class="token operator">=</span>m_items<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">CheckPointer</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token operator">==</span>POINTER_DYNAMIC<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
         <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Dynamyc object &quot;</span><span class="token punctuation">,</span>item<span class="token punctuation">.</span><span class="token function">Identifier</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&quot; to be deleted&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">delete</span> <span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token keyword">else</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Non-dynamic object &quot;</span><span class="token punctuation">,</span>item<span class="token punctuation">.</span><span class="token function">Identifier</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&quot; cannot be deleted&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//---</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 脚本程序启动函数                                                   |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   CMyList list<span class="token punctuation">;</span>
   CItem   items<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   CItem<span class="token operator">*</span>  item<span class="token punctuation">;</span>
<span class="token comment">//--- 创建并加入一个动态对象指针到列表</span>
   item<span class="token operator">=</span><span class="token keyword">new</span> CItem<span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>item<span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      item<span class="token punctuation">.</span><span class="token function">Initialize</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token string">&quot;dynamic&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      item<span class="token punctuation">.</span><span class="token function">PrintMe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      list<span class="token punctuation">.</span><span class="token function">InsertToBegin</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 添加自动指针到列表</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      items<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">Initialize</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token string">&quot;automatic&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      items<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">PrintMe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      item<span class="token operator">=</span><span class="token function">GetPointer</span><span class="token punctuation">(</span>items<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">CheckPointer</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token operator">!=</span>POINTER_INVALID<span class="token punctuation">)</span>
         list<span class="token punctuation">.</span><span class="token function">InsertToBegin</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 在列表开始添加一个以上动态对象指针</span>
   item<span class="token operator">=</span><span class="token keyword">new</span> CItem<span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>item<span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      item<span class="token punctuation">.</span><span class="token function">Initialize</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token string">&quot;dynamic&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      item<span class="token punctuation">.</span><span class="token function">PrintMe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      list<span class="token punctuation">.</span><span class="token function">InsertToBegin</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 删除所有列表元素</span>
   list<span class="token punctuation">.</span><span class="token function">Destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 脚本结束后所有列表元素都被删除</span>
<span class="token comment">//--- 在客户端查看 (专家)EA 标签</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br></div></div><p>相关参考
对象指针 ， 检测对象指针 ，对象删除操作符的删除</p> <h2 id="_5-9-gettickcount"><a href="#_5-9-gettickcount" class="header-anchor">#</a> 5.9 GetTickCount</h2> <p>自从程序开始以来，GetTickCount()函数返回已过去的毫秒数。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>uint  <span class="token function">GetTickCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>返回值</p> <p>无符号整型值</p> <p>注意</p> <p>计数器受系统定时器的限制。时间被存储为无符号整数，因此，如果一台计算机不间断地工作，那么每49.7天就会被填满。</p> <p>例如：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAX_SIZE</span> <span class="token expression"><span class="token number">40</span></span></span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 测量40个裴波那契数列计算时间的脚本                                    |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 记住初始值</span>
   uint start<span class="token operator">=</span><span class="token function">GetTickCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 在裴波那契数列获得下一个数列的变量</span>
   <span class="token keyword">long</span> fib<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token comment">//--- 循环计算来自裴波那契数列的指定数列量</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>MAX_SIZE<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> fib<span class="token operator">=</span><span class="token function">TestFibo</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 获取毫秒为单位的所用时间</span>
   uint time<span class="token operator">=</span><span class="token function">GetTickCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>start<span class="token punctuation">;</span>
<span class="token comment">//--- 导出信息到专家日志</span>
   <span class="token function">PrintFormat</span><span class="token punctuation">(</span><span class="token string">&quot;Calculating %d first Fibonacci numbers took %d ms&quot;</span><span class="token punctuation">,</span>MAX_SIZE<span class="token punctuation">,</span>time<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 已完成脚本</span>
   <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 通过数列号获得裴波那契数列的函数                                      |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">long</span> <span class="token function">TestFibo</span><span class="token punctuation">(</span><span class="token keyword">long</span> n<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 裴波那契数列的第一个成员</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>n<span class="token operator">&lt;</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 所有其他成员通过以下公式计算</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token function">TestFibo</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">TestFibo</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>相关参考
日期和时间</p> <h2 id="_5-10-getmicrosecondcount"><a href="#_5-10-getmicrosecondcount" class="header-anchor">#</a> 5.10 GetMicrosecondCount</h2> <p>自从程序开始以来，GetMicrosecondCount()函数返回已过去的微秒数。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>ulong  <span class="token function">GetMicrosecondCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>返回值</p> <p>无符号长整型的值。</p> <p>示例：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 测试函数                                                          |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   <span class="token keyword">int</span>    res_int<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
   <span class="token keyword">double</span> res_double<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token comment">//---</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">10000</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      res_int<span class="token operator">+=</span>i<span class="token operator">*</span>i<span class="token punctuation">;</span>
      res_int<span class="token operator">++</span><span class="token punctuation">;</span>
      res_double<span class="token operator">+=</span>i<span class="token operator">*</span>i<span class="token punctuation">;</span>
      res_double<span class="token operator">++</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 脚本程序开始函数                                                   |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   uint   ui<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>ui_max<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>ui_min<span class="token operator">=</span>INT_MAX<span class="token punctuation">;</span>
   ulong  ul<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>ul_max<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>ul_min<span class="token operator">=</span>INT_MAX<span class="token punctuation">;</span>
<span class="token comment">//--- 测量次数</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>count <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">;</span>count<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      uint  ui_res<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
      ulong ul_res<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token comment">//---</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>n<span class="token operator">&lt;</span><span class="token number">2</span><span class="token punctuation">;</span>n<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
         <span class="token comment">//--- 选择测量类型</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>n<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span> ui<span class="token operator">=</span><span class="token function">GetTickCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">else</span>     ul<span class="token operator">=</span><span class="token function">GetMicrosecondCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token comment">//--- 执行代码</span>
         <span class="token function">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token comment">//--- 添加测量结果 (根据类型)</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>n<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span> ui_res<span class="token operator">+=</span><span class="token function">GetTickCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>ui<span class="token punctuation">;</span>
         <span class="token keyword">else</span>     ul_res<span class="token operator">+=</span><span class="token function">GetMicrosecondCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>ul<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token comment">//--- 为两个测量计算最小和最大的时间值</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>ui_min<span class="token operator">&gt;</span>ui_res<span class="token punctuation">)</span> ui_min<span class="token operator">=</span>ui_res<span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>ui_max<span class="token operator">&lt;</span>ui_res<span class="token punctuation">)</span> ui_max<span class="token operator">=</span>ui_res<span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>ul_min<span class="token operator">&gt;</span>ul_res<span class="token punctuation">)</span> ul_min<span class="token operator">=</span>ul_res<span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>ul_max<span class="token operator">&lt;</span>ul_res<span class="token punctuation">)</span> ul_max<span class="token operator">=</span>ul_res<span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//---</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;GetTickCount error(msec): &quot;</span><span class="token punctuation">,</span>ui_max<span class="token operator">-</span>ui_min<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;GetMicrosecondCount error(msec): &quot;</span><span class="token punctuation">,</span><span class="token function">DoubleToString</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ul_max<span class="token operator">-</span>ul_min<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">1000.0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br></div></div><h2 id="_5-11-messagebox"><a href="#_5-11-messagebox" class="header-anchor">#</a> 5.11 MessageBox</h2> <p>此函数创建并显示一个对话框，并管理它。一个对话框可以包括信息和标题，任何组合的预定义的标签和命令按钮。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">int</span>  <span class="token function">MessageBox</span><span class="token punctuation">(</span>
   string  text<span class="token punctuation">,</span>             <span class="token comment">// 信息文本</span>
   string  caption<span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">,</span>     <span class="token comment">// 对话框表头</span>
   <span class="token keyword">int</span>     flags<span class="token operator">=</span><span class="token number">0</span>           <span class="token comment">// 对话框按键设置</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>参数</p> <p>text</p> <p>[in] 文本，包括信息输出。</p> <p>caption=NULL</p> <p>[in] 此项为可选项，显示标题文本。如果参数是空的，那么EA程序的名称将显示在标题中。</p> <p>flags=0</p> <p>[in] 此项为可选项，定义消息框的外观和行为。标帜可以指定一组标帜的组合。</p> <p>返回值</p> <p>如果函数成功执行，返回值是MessageBox()返回代码的枚举值常量之一。</p> <p>注意</p> <p>不建议在定制指示器中使用该函数，因为在等待用户响应时，对MessageBox()的调用会在整个过程中暂停指标的执行线程。由于每个交易品种的所有指标都在一个线程中执行，所以这个交易品种的所有时间框架的所有图表都将会被暂停。</p> <p>MessageBox()函数在策略测试中不工作。</p> <h2 id="_5-12-periodseconds"><a href="#_5-12-periodseconds" class="header-anchor">#</a> 5.12 PeriodSeconds</h2> <p>此函数返回一个时间框架的秒数。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">int</span>  <span class="token function">PeriodSeconds</span><span class="token punctuation">(</span>
   ENUM_TIMEFRAMES  period<span class="token operator">=</span>PERIOD_CURRENT      <span class="token comment">// 图表周期</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>参数</p> <p>period=PERIOD_CURRENT</p> <p>[in] 枚举值ENUM_TIMEFRAMES中的图表周期值，如果参数未标明，在程序运行中，返回当前图表时间框架周期的秒数。</p> <p>返回值</p> <p>所选周期中的秒数。</p> <p>相关参考</p> <p>_Period， 图表时间表 ， 日期和时间 ， 对象可见性</p> <h2 id="_5-13-playsound"><a href="#_5-13-playsound" class="header-anchor">#</a> 5.13 PlaySound</h2> <p>播放声音文件。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  <span class="token function">PlaySound</span><span class="token punctuation">(</span>
   string  filename      <span class="token comment">// 文件名</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>参量</p> <p>filename</p> <p>[in] 声音文件的路径。 如果 filename=NULL，停止回放。</p> <p>返回值</p> <p>true —— 如果发现文件， 否则 —— false.</p> <p>注意</p> <p>文件加载到terminal_directory\Sounds 的子目录中，只能播放wav类型文件。</p> <p>调用PlaySound()参数为 NULL 表示停止播放。</p> <p>PlaySound() 函数在策略测试中不工作。</p> <p>相关参考</p> <p>资源</p> <h2 id="_5-14-print"><a href="#_5-14-print" class="header-anchor">#</a> 5.14 Print</h2> <p>在EA交易日志中打印输出文本消息。参数可以是任何类型。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">void</span>  <span class="token function">Print</span><span class="token punctuation">(</span>
   argument<span class="token punctuation">,</span>     <span class="token comment">// 第一值</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>           <span class="token comment">// 下一值</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>参数</p> <p>...</p> <p>[in] 用逗号分隔的任意值，参数总数量不能超过64个。</p> <p>注意</p> <p>数组不能作为参数传递给Print()函数，数组必须按一个接一个的元素传递给Print()函数。</p> <p>双精度类型的数据，精确度保留到小数点后16位，以 传统 或 科学计数法 的方式输出，取决于什么 方式 更紧凑。浮点型数据保留小数点后5位，要用另一个精度 或 预定义格式输出实际数字，使用 PrintFormat() 函数。</p> <p>布尔类型的数据输出为“true”或“false”字符串。日期的输出是YYYY.MM.DD HH:MI:SS格式。要以另一种格式显示日期，请使用TimeToString()函数。颜色类型的数据如果是在一个颜色集合中，输出时要么是一个R,G,B字符串，要么是一个颜色名称。</p> <p>Print() 函数在优化期间在策略测试中不工作。</p> <p>示例：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 用Print()导出DBL_MAX，这相当于PrintFormat(%%.16G,DBL_MAX)</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;---- how DBL_MAX looks like -----&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Print(DBL_MAX)=&quot;</span><span class="token punctuation">,</span>DBL_MAX<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 现在用PrintFormat()导出DBL_MAX number</span>
   <span class="token function">PrintFormat</span><span class="token punctuation">(</span><span class="token string">&quot;PrintFormat(%%.16G,DBL_MAX)=%.16G&quot;</span><span class="token punctuation">,</span>DBL_MAX<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 导出到专家日志</span>
<span class="token comment">// Print(DBL_MAX)=1.797693134862316e+308</span>
<span class="token comment">// PrintFormat(%.16G,DBL_MAX)=1.797693134862316E+308</span>

<span class="token comment">//--- 请看浮动如何导出</span>
   <span class="token keyword">float</span> c<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>M_PI<span class="token punctuation">;</span> <span class="token comment">// 我们应该明确目标类型</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;c=&quot;</span><span class="token punctuation">,</span>c<span class="token punctuation">,</span> <span class="token string">&quot;    Pi=&quot;</span><span class="token punctuation">,</span>M_PI<span class="token punctuation">,</span> <span class="token string">&quot;    (float)M_PI=&quot;</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>M_PI<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// c=3.14159    Pi=3.141592653589793    (float)M_PI=3.14159</span>

<span class="token comment">//--- 显示真实类型算术运算会发生什么</span>
   <span class="token keyword">double</span> a<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span>b<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;---- Before arithmetic operations&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;a=&quot;</span><span class="token punctuation">,</span>a<span class="token punctuation">,</span><span class="token string">&quot;   b=&quot;</span><span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Print(DoubleToString(b,16))=&quot;</span><span class="token punctuation">,</span><span class="token function">DoubleToString</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- a 除以 b (7/200)</span>
   a<span class="token operator">=</span>a<span class="token operator">/</span>b<span class="token punctuation">;</span>
<span class="token comment">//--- 现在模仿恢复b变量的值</span>
   b<span class="token operator">=</span><span class="token number">7.0</span><span class="token operator">/</span>a<span class="token punctuation">;</span> <span class="token comment">// 期待 b=7.0/(7.0/200.0)=&gt;7.0/7.0*200.0=200 - 但却不同</span>
<span class="token comment">//--- 导出最新计算的b值</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;----- After arithmetic operations&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Print(b)=&quot;</span><span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Print(DoubleToString(b,16))=&quot;</span><span class="token punctuation">,</span><span class="token function">DoubleToString</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 导出到专家日志</span>
<span class="token comment">// Print(b)=200.0</span>
<span class="token comment">// Print(DoubleToString(b,16))=199.9999999999999716 (可见b不再等于200.0)</span>

<span class="token comment">//--- 创建一个非常小的值 epsilon=1E-013</span>
   <span class="token keyword">double</span> epsilon<span class="token operator">=</span><span class="token number">1e-13</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;---- Create a very small value&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;epsilon=&quot;</span><span class="token punctuation">,</span>epsilon<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获得 epsilon=1E-013</span>
<span class="token comment">//--- 现在从b减去epsilon 并且导出值到专家日志</span>
   b<span class="token operator">=</span>b<span class="token operator">-</span>epsilon<span class="token punctuation">;</span>
<span class="token comment">//--- 使用两种方式</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;---- After subtracting epsilon from the b variable&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Print(b)=&quot;</span><span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Print(DoubleToString(b,16))=&quot;</span><span class="token punctuation">,</span><span class="token function">DoubleToString</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 导出到专家日志</span>
<span class="token comment">// Print(b)=199.9999999999999  (现在减去epsilon以后的b值不能四舍五入到200)</span>
<span class="token comment">// Print(DoubleToString(b,16))=199.9999999999998578</span>
<span class="token comment">//    (现在减去epsilon以后的b值不能四舍五入到200)</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br></div></div><p>相关参考
DoubleToString, StringFormat</p> <h2 id="_5-15-printformat"><a href="#_5-15-printformat" class="header-anchor">#</a> 5.15 PrintFormat</h2> <p>在EA专家日志中，按照预先设定的格式，格式化并打印输出字符串和值。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">void</span>  <span class="token function">PrintFormat</span><span class="token punctuation">(</span>
   string format_string<span class="token punctuation">,</span>   <span class="token comment">// 格式行</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>                     <span class="token comment">// 简单类型值</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>参数 format_string</p> <p>[in] 格式规范字符串由简单的字符组成，如果格式字符串后跟参数，它也包含格式规范。</p> <p>...</p> <p>[in] 简单类型的任何值用逗号分隔，参数的总数量不能超过64个，包括格式化规范的字符。</p> <p>返回值</p> <p>字符串。</p> <p>注意</p> <p>PrintFormat() 函数在策略测试器中做优化时不工作。</p> <p>参数的数量，顺序和类型必须与格式化规范的修饰语明确匹配，否则打印结果无法确定。您可以使用 printf() 替代PrintFormat() 。</p> <p>如果格式规范字符串后跟参数，则该字符串必须包含表示这些参数的输出格式的格式规范。格式规范总是以百分号(%)开始。</p> <p>格式规范字符串是从左向右读取的。当满足第一个格式规范(如果有)时，格式化字符串之后的第一个参数的值将根据预先设置的规范进行转换和输出。第二种格式规范调用第二个参数的转换和输出，以此类推，直到格式字符串结束。</p> <p>格式规格字符如下形式：</p> <p>%[flags][width][.precision][{h | l | ll | I32 | I64}]type</p> <p>格式规范的每个字段要么是一个简单的符号，要么是一个表示简单格式选项的数字。最简单的格式规范只包含百分比符号(%)和定义输出参数类型的符号(例如，%s)。如果需要在格式字符串中输出百分号，请使用格式规范%%。</p> <p>标记(flags)</p> <table><thead><tr><th style="text-align:left;">标记</th> <th style="text-align:left;">描述</th> <th style="text-align:left;">默认动作</th></tr></thead> <tbody><tr><td style="text-align:left;">- (减号)</td> <td style="text-align:left;">在设置宽度内左对齐。</td> <td style="text-align:left;">右对齐</td></tr> <tr><td style="text-align:left;">+ (加号)</td> <td style="text-align:left;">打印输出 值 的 + 或 -  (正负)符号。</td> <td style="text-align:left;">只显示负号</td></tr> <tr><td style="text-align:left;">0 (零)</td> <td style="text-align:left;">在设置宽度内的输出值前加零。如果使用整数格式指定0标记(例如，u、x、x、o、d)和精度规范(例如，%04.d)，则忽略0。</td> <td style="text-align:left;">什么都不添加</td></tr> <tr><td style="text-align:left;">space</td> <td style="text-align:left;">如果值是一个 符号(+-号) 和 正值。在输出之前显示一个空格。</td> <td style="text-align:left;">不插入空间</td></tr> <tr><td style="text-align:left;">#</td> <td style="text-align:left;">如果与格式o、x或x一起使用，则分别在输出值0、0x或0x之前添加。</td> <td style="text-align:left;">什么都不添加</td></tr> <tr><td style="text-align:left;"></td> <td style="text-align:left;">如果与格式e、e、a或a一起使用，值总是以小数点显示。</td> <td style="text-align:left;">如果小数部分非零，显示小数点</td></tr> <tr><td style="text-align:left;"></td> <td style="text-align:left;">如果与格式g或g一起使用，标志将在输出值中定义小数点的存在，并防止前导零的切断。 当与格式c、d、i、u、s一起使用时，标记#被忽略。</td> <td style="text-align:left;">如果小数部分非零，显示小数点，切断前导零</td></tr></tbody></table> <p>宽度<br>
设置格式化值的最小输出符号数的非负十进制数。如果输出符号的数量小于指定的宽度，则从左边或右边添加相应数量的空格，这取决于对齐(标志)。如果有标志0(0)，则在输出值之前添加相应数量的零。如果输出符号的数量大于指定的宽度，输出值就不会被切断。<br>
如果将星号(*)指定为宽度，则必须在传递参数列表的相应位置指定int类型的值。它将用于指定输出值的宽度。 <br>
精确度<br>
一种非负十进制数，它将输出精度设为小数点后的位数。与宽度规范不同的是，精度规范可以在不舍入的情况下将分式的部分切断。
对于不同的格式类型，使用精度规范是不同的。</p> <table><thead><tr><th style="text-align:left;">类型</th> <th style="text-align:left;">描述</th> <th style="text-align:left;">默认动作</th></tr></thead> <tbody><tr><td style="text-align:left;">a, A</td> <td style="text-align:left;">精度规范设置小数点后的位数</td> <td style="text-align:left;">默认精确度 - 6</td></tr> <tr><td style="text-align:left;">c, C</td> <td style="text-align:left;">不使用</td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:left;">d, i, u, o, x, X</td> <td style="text-align:left;">设置最小输出位数。如果对应的参数中位数小于这个精度，则将0添加到输出值的左边。如果输出数字大于指定的精度，输出值就不会被切断</td> <td style="text-align:left;">默认精确度 - 1</td></tr> <tr><td style="text-align:left;">e, E, f</td> <td style="text-align:left;">设置小数点后的输出位数。最后一个数字被四舍五入</td> <td style="text-align:left;">默认精确度-6，如果建立的精确度是0或者小数部分空缺，不显示小数点</td></tr> <tr><td style="text-align:left;">g, G</td> <td style="text-align:left;">设置有意义数字的最大数目</td> <td style="text-align:left;">输出六位有意义数字</td></tr> <tr><td style="text-align:left;">s, S</td> <td style="text-align:left;">设置字符串的输出符号的数量。如果字符串长度超过了精度，字符串将被切断</td> <td style="text-align:left;">整个线路输出</td></tr></tbody></table> <p>h | l | ll | I32 | I64</p> <p>指定数据的大小，以参数的形式传递。</p> <table><thead><tr><th>参数类型</th> <th>使用前缀</th> <th>类型共同说明符</th></tr></thead> <tbody><tr><td>int</td> <td>l (小写字母 L)</td> <td>d, i, o, x, or X</td></tr> <tr><td>uint</td> <td>l (小写字母 L)</td> <td>o, u, x, or X</td></tr> <tr><td>long</td> <td>ll (两个小写字母 L)</td> <td>d, i, o, x, or X</td></tr> <tr><td>short</td> <td>h</td> <td>d, i, o, x, or X</td></tr> <tr><td>ushort</td> <td>h</td> <td>o, u, x, or X</td></tr> <tr><td>int</td> <td>I32</td> <td>d, i, o, x, or X</td></tr> <tr><td>uint</td> <td>I32</td> <td>o, u, x, or X</td></tr> <tr><td>long</td> <td>I64</td> <td>d, i, o, x, or X</td></tr> <tr><td>ulong</td> <td>I64</td> <td>o, u, x, or X</td></tr></tbody></table> <p>类型
类型说明符是格式化规范输出的唯一必需字段。</p> <table><thead><tr><th>符号</th> <th>类型</th> <th>输出格式</th></tr></thead> <tbody><tr><td>c</td> <td>int</td> <td>short 型字符(Unicode)</td></tr> <tr><td>C</td> <td>int</td> <td>char型字符(ANSI)</td></tr> <tr><td>d</td> <td>int</td> <td>带符号(+-号)的十进制整数</td></tr> <tr><td>i</td> <td>int</td> <td>带符号(+-号)的十进制整数</td></tr> <tr><td>o</td> <td>int</td> <td>无符号(+-号)的八进制整数</td></tr> <tr><td>u</td> <td>int</td> <td>无符号(+-号)的十进制整数</td></tr> <tr><td>x</td> <td>int</td> <td>无符号(+-号)的十六进制整数，使用&quot;abcdef&quot;</td></tr> <tr><td>X</td> <td>int</td> <td>无符号(+-号)的十六进制整数，使用 &quot;ABCDEF&quot;</td></tr> <tr><td>e</td> <td>double</td> <td>格式规范一个实数[-] d.dddde[+/-符号] ddd，其中d —— 表示一个十进制数字，dddd —— 表示一个或更多的十进制数字，ddd—— 表示一个三位数，决定指数的大小，符号 —— 表示正负。</td></tr> <tr><td>E</td> <td>double</td> <td>与e格式相同，除了指数的符号是由大写字母输出(E代替e)</td></tr> <tr><td>f</td> <td>double</td> <td>格式规范一个实数[-] dddd.dddd ，这里的 dddd —— 表示一个或多个十进制数字。小数点前显示数字的数目取决于数值的大小。小数点后位数取决于所需的精度。</td></tr> <tr><td>g</td> <td>double</td> <td>f或者e格式的输出实数值取决于输出量更紧凑</td></tr> <tr><td>G</td> <td>double</td> <td>F或者E的输出真值取决于输出量更紧凑</td></tr> <tr><td>a</td> <td>double</td> <td>格式规范一个实数 [−]0xh.hhhh p±dd,这里的h.hhhh —— 表示十六进制格式的尾数，使用&quot;abcdef&quot;,dd ——表示一个或者更多指数，小数点的位数由精度规范决定。</td></tr> <tr><td>A</td> <td>double</td> <td>格式规范一个实数 [−]0xh.hhhh P±dd。这里的hhhh —— 尾数以十六进制数字的形式，使用“ABCDEF”，dd ——表示一个或者更多指数，小数点的位数由精度规范决定。</td></tr> <tr><td>s</td> <td>string</td> <td>字符串输出</td></tr></tbody></table> <p>可以使用printf()取代PrintFormat()。
示例：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 交易服务器名称</span>
   string server<span class="token operator">=</span><span class="token function">AccountInfoString</span><span class="token punctuation">(</span>ACCOUNT_SERVER<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 账号</span>
   <span class="token keyword">int</span> login<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token function">AccountInfoInteger</span><span class="token punctuation">(</span>ACCOUNT_LOGIN<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 长整型值输出</span>
   <span class="token keyword">long</span> leverage<span class="token operator">=</span><span class="token function">AccountInfoInteger</span><span class="token punctuation">(</span>ACCOUNT_LEVERAGE<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">PrintFormat</span><span class="token punctuation">(</span><span class="token string">&quot;%s %d: leverage = 1:%I64d&quot;</span><span class="token punctuation">,</span>
               server<span class="token punctuation">,</span>login<span class="token punctuation">,</span>leverage<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 账户货币</span>
   string currency<span class="token operator">=</span><span class="token function">AccountInfoString</span><span class="token punctuation">(</span>ACCOUNT_CURRENCY<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 小数点后两位的双精度值输出</span>
   <span class="token keyword">double</span> equity<span class="token operator">=</span><span class="token function">AccountInfoDouble</span><span class="token punctuation">(</span>ACCOUNT_EQUITY<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">PrintFormat</span><span class="token punctuation">(</span><span class="token string">&quot;%s %d: account equity = %.2f %s&quot;</span><span class="token punctuation">,</span>
               server<span class="token punctuation">,</span>login<span class="token punctuation">,</span>equity<span class="token punctuation">,</span>currency<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- +/-符号强制输出的双精度值输出</span>
   <span class="token keyword">double</span> profit<span class="token operator">=</span><span class="token function">AccountInfoDouble</span><span class="token punctuation">(</span>ACCOUNT_PROFIT<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">PrintFormat</span><span class="token punctuation">(</span><span class="token string">&quot;%s %d: current result for open positions = %+.2f %s&quot;</span><span class="token punctuation">,</span>
               server<span class="token punctuation">,</span>login<span class="token punctuation">,</span>profit<span class="token punctuation">,</span>currency<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 小数点后可变数位的双精度值输出</span>
   <span class="token keyword">double</span> point_value<span class="token operator">=</span><span class="token function">SymbolInfoDouble</span><span class="token punctuation">(</span>_Symbol<span class="token punctuation">,</span>SYMBOL_POINT<span class="token punctuation">)</span><span class="token punctuation">;</span>
   string format_string<span class="token operator">=</span><span class="token function">StringFormat</span><span class="token punctuation">(</span><span class="token string">&quot;%%s: point value  = %%.%df&quot;</span><span class="token punctuation">,</span>_Digits<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">PrintFormat</span><span class="token punctuation">(</span>format_string<span class="token punctuation">,</span>_Symbol<span class="token punctuation">,</span>point_value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 整型值输出</span>
   <span class="token keyword">int</span> spread<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token function">SymbolInfoInteger</span><span class="token punctuation">(</span>_Symbol<span class="token punctuation">,</span>SYMBOL_SPREAD<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">PrintFormat</span><span class="token punctuation">(</span><span class="token string">&quot;%s: current spread in points = %d &quot;</span><span class="token punctuation">,</span>
               _Symbol<span class="token punctuation">,</span>spread<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 小数点后17个有意义数位的科学（浮点）格式双精度值输出</span>
   <span class="token function">PrintFormat</span><span class="token punctuation">(</span><span class="token string">&quot;DBL_MAX = %.17e&quot;</span><span class="token punctuation">,</span>DBL_MAX<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 小数点后17个有意义数位的科学（浮点）格式双精度值输出</span>
   <span class="token function">PrintFormat</span><span class="token punctuation">(</span><span class="token string">&quot;EMPTY_VALUE = %.17e&quot;</span><span class="token punctuation">,</span>EMPTY_VALUE<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 以默认精度使用PrintFormat()输出</span>
   <span class="token function">PrintFormat</span><span class="token punctuation">(</span><span class="token string">&quot;PrintFormat(EMPTY_VALUE) = %e&quot;</span><span class="token punctuation">,</span>EMPTY_VALUE<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 使用Print()简单输出</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Print(EMPTY_VALUE) = &quot;</span><span class="token punctuation">,</span>EMPTY_VALUE<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/* 执行结果
   MetaQuotes-Demo 1889998: leverage = 1:100
   MetaQuotes-Demo 1889998: account equity = 22139.86 USD
   MetaQuotes-Demo 1889998: current result for open positions = +174.00 USD
   EURUSD: point value  = 0.00001
   EURUSD: current spread in points = 12
   DBL_MAX = 1.79769313486231570e+308
   EMPTY_VALUE = 1.79769313486231570e+308
   PrintFormat(EMPTY_VALUE) = 1.797693e+308
   Print(EMPTY_VALUE) = 1.797693134862316e+308
*/</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br></div></div><p>相关参考
StringFormat ，DoubleToString ， 真实类型（双精度，浮点）</p> <h2 id="_5-16-resetlasterror"><a href="#_5-16-resetlasterror" class="header-anchor">#</a> 5.16 ResetLastError</h2> <p>设置预定义常量 _LastError 的值归0。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">void</span>  <span class="token function">ResetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>返回值</p> <p>没有返回值</p> <p>注意</p> <p>应该注意，GetLastError()函数不会让 _LastError变量归零。通常在调用函数之前调用ResetLastError()函数，然后检查是否有错误出现。</p> <h2 id="_5-17-resourcecreate"><a href="#_5-17-resourcecreate" class="header-anchor">#</a> 5.17 ResourceCreate</h2> <p>基于数据设置创建图像资源。该函数有两种变量：</p> <p>根据文件创建资源</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  <span class="token function">ResourceCreate</span><span class="token punctuation">(</span>
   <span class="token keyword">const</span> string      resource_name<span class="token punctuation">,</span>       <span class="token comment">// 资源名称</span>
   <span class="token keyword">const</span> string      path                 <span class="token comment">// 文件的相对路径</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>基于像素数组创建资源</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  <span class="token function">ResourceCreate</span><span class="token punctuation">(</span>
   <span class="token keyword">const</span> string      resource_name<span class="token punctuation">,</span>       <span class="token comment">// 资源名称</span>
   <span class="token keyword">const</span> uint<span class="token operator">&amp;</span>       data<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>              <span class="token comment">// 数据设置为数组</span>
   uint              img_width<span class="token punctuation">,</span>           <span class="token comment">// 图像的宽度</span>
   uint              img_height<span class="token punctuation">,</span>          <span class="token comment">// 图像的高度</span>
   uint              data_xoffset<span class="token punctuation">,</span>        <span class="token comment">// 图像左上角水平向右偏移量</span>
   uint              data_yoffset<span class="token punctuation">,</span>        <span class="token comment">// 图像左上角垂直向下偏移量</span>
   uint              data_width<span class="token punctuation">,</span>          <span class="token comment">// 基于数据设置的图像总宽度</span>
   ENUM_COLOR_FORMAT color_format         <span class="token comment">// 颜色处理方案</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>参数</p> <p>resource_name</p> <p>[in] 资源名称。</p> <p>data[][]</p> <p>[in] 用于创建完整图像的一维或二维数组。</p> <p>img_width</p> <p>[in] 矩形图像区域的宽度以图像的形式放置在资源中。它不能大于data_width值。</p> <p>img_height</p> <p>[in] 矩形图像区域的高度以图像的形式放置在资源中。</p> <p>data_xoffset</p> <p>[in] 图像的矩形区域的水平向右偏移量。</p> <p>data_yoffset</p> <p>[in] 图像的矩形区域的垂直向下偏移量。</p> <p>data_width</p> <p>[in] 只需要一维数组。它表示来自数据集的图像的全部宽度。如果data_width=0，则假定它等于img_width。对于二维数组，该参数被忽略，并假定它等于data[][]数组的第二个维度。</p> <p>color_format</p> <p>[in] 颜色处理方案，来自ENUM_COLOR_FORMAT 枚举值。</p> <p>返回值</p> <p>如果成功返回true，否则false。若要获得有关错误的信息，请调用GetLastError() 函数。可能会发生以下错误：<br>
• 4015 —— ERR_RESOURCE_NAME_DUPLICATED (动态和静态资源的相同名称)<br>
• 4016 —— ERR_RESOURCE_NOT_FOUND (资源没找到)<br>
• 4017 —— ERR_RESOURCE_UNSUPPORTED_TYPE (这种类型的资源不支持)<br>
• 4018 —— ERR_RESOURCE_NAME_IS_TOO_LONG (资源名称太长)<br></p> <p>ENUM_COLOR_FORMAT</p> <table><thead><tr><th>标识符</th> <th>描述</th></tr></thead> <tbody><tr><td>COLOR_FORMAT_XRGB_NOALPHA</td> <td>阿尔法通道的组件被忽略</td></tr> <tr><td>COLOR_FORMAT_ARGB_RAW</td> <td>客户端不处理颜色组件（用户必须正确设置）</td></tr> <tr><td>COLOR_FORMAT_ARGB_NORMALIZE</td> <td>客户端不处理颜色组件</td></tr></tbody></table> <p>相关参考
资源， ObjectCreate()， ObjectSetString()， OBJPROP_BMPFILE</p> <h2 id="_5-18-resourcefree"><a href="#_5-18-resourcefree" class="header-anchor">#</a> 5.18 ResourceFree</h2> <p>该函数删除动态创建的资源 (释放分配的内存)。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  <span class="token function">ResourceFree</span><span class="token punctuation">(</span>
   <span class="token keyword">const</span> string  resource_name      <span class="token comment">// 资源名称</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>参数</p> <p>resource_name</p> <p>[in] 资源 名称应以&quot;::&quot;开头。</p> <p>返回值</p> <p>如果成功返回true，否则false。若要获得有关错误的信息，请调用GetLastError() 函数。</p> <p>注意</p> <p>ResourceFree() 允许mql5应用开发者们管理内存消耗。从内存删除的绑定资源的图形对象 会在删除后正确显示。然而，新创建的图形对象(OBJ_BITMAP 和 OBJ_BITMAP_LABEL) 将不能使用已删除的资源。</p> <p>函数仅删除通过程序创建的动态资源。</p> <p>相关参考</p> <p>资源， ObjectCreate()， PlaySound()， ObjectSetString()， OBJPROP_BMPFILE</p> <h2 id="_5-19-resourcereadimage"><a href="#_5-19-resourcereadimage" class="header-anchor">#</a> 5.19 ResourceReadImage</h2> <p>函数读取来自通过ResourceCreate()函数创建的 或 编译期间保存在 EX5 文件中的图形资源的数据。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  <span class="token function">ResourceReadImage</span><span class="token punctuation">(</span>
   <span class="token keyword">const</span> string      resource_name<span class="token punctuation">,</span>       <span class="token comment">// 用于读取的图形资源名称</span>
   uint<span class="token operator">&amp;</span>             data<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>              <span class="token comment">// 用于从资源接收数据的数组</span>
   uint<span class="token operator">&amp;</span>             width<span class="token punctuation">,</span>               <span class="token comment">// 用于在资源中接收图像宽度</span>
   uint<span class="token operator">&amp;</span>             height<span class="token punctuation">,</span>              <span class="token comment">// 用于在资源中接收图像高度</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>参数</p> <p>resource_name</p> <p>[in] 包含图像的图形资源的名称。为了获得对其自身资源的访问权，该名称使用“::resourcename”的简单形式。如果我们从已编译的EX5文件中下载了一个资源，那么完整的名称应该与MQL5目录、文件和资源名称的路径一起使用—— “路径\filename.ex5::resourcename”。</p> <p>data[][]</p> <p>[in] 接收图形资源数据的一维或二维数组。</p> <p>img_width</p> <p>[out] 图形资源图像的像素宽度。</p> <p>img_height</p> <p>[out] 图形资源图像的像素高度。</p> <p>返回值</p> <p>如果成功返回true，否则false。若要获得有关错误的信息，请调用GetLastError() 函数。</p> <p>注意</p> <p>如果data[] 数组被用于创建图形资源， COLOR_FORMAT_ARGB_NORMALIZE 或 COLOR_FORMAT_XRGB_NOALPHA 颜色格式应该被使用。</p> <p>如果data[][]数组是二维的，它的第二个维度小于X(宽度)图形资源大小，那么ResourceReadImage()函数返回false，而不执行读取。但是如果资源存在，实际的图像大小将返回到宽度和高度参数。这将允许再次尝试从资源中接收数据。</p> <p>相关参考
资源， ObjectCreate()， ObjectSetString()， OBJPROP_BMPFILE</p> <h2 id="_5-20-resourcesave"><a href="#_5-20-resourcesave" class="header-anchor">#</a> 5.20 ResourceSave</h2> <p>保存资源到指定文件。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>    <span class="token keyword">bool</span>  <span class="token function">ResourceSave</span><span class="token punctuation">(</span>
   <span class="token keyword">const</span> string  resource_name      <span class="token comment">// 资源名称</span>
   <span class="token keyword">const</span> string  file_name          <span class="token comment">// 文件名称</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>参数</p> <p>resource_name</p> <p>[in] 资源名称，必须以&quot;::&quot;开始。</p> <p>file_name</p> <p>[in] 相对于MQL5\Files文件名称。</p> <p>返回值</p> <p>true 表示成功，否则false。对于错误信息，可调用GetLastError()查看。</p> <p>注意</p> <p>该函数总是覆盖一个文件，并在必要时在文件名中创建所有必需的中间目录。</p> <p>相关参考
资源， ObjectCreate()， PlaySound()， ObjectSetString()， OBJPROP_BMPFILE</p> <h2 id="_5-21-setreturnerror"><a href="#_5-21-setreturnerror" class="header-anchor">#</a> 5.21 SetReturnError</h2> <p>设置完成操作时返回程序端进程的代码。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">void</span>  <span class="token function">SetReturnError</span><span class="token punctuation">(</span>
   <span class="token keyword">int</span> ret_code      <span class="token comment">// 客户端完成代码</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>参数</p> <p>ret_code</p> <p>[in] 完成操作时由客户端进程返回的代码。</p> <p>返回值</p> <p>无返回值。</p> <p>注意</p> <p>使用SetReturnError()函数设置指定的 ret_code返回代码有利于分析通过命令行启用程序端时程序操作完成的原因。</p> <p>与TerminalClose()不同，SetReturnError()函数未完成程序端操作。相反，它只设置完成后返回程序端进程的代码。</p> <p>如果SetReturnError()函数被调用多次和/或从不同的MQL5程序调用，程序端返回最后一次设置的返回代码。</p> <p>除下列情况外，程序端进程完成后返回设置代码：</p> <p>执行期间发生严重错误；</p> <p>已调用以指定代码发行程序端操作完成命令的TerminalClose(int ret_code)函数。</p> <p>另见
程序运行、运行错误、未初始化原因代码、TerminalClose</p> <h2 id="_5-22-setusererror"><a href="#_5-22-setusererror" class="header-anchor">#</a> 5.22 SetUserError</h2> <p>设置 预定义变量 _LastError 的值，等于 ERR_USER_ERROR_FIRST + user_error</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">void</span>  <span class="token function">SetUserError</span><span class="token punctuation">(</span>
   ushort user_error<span class="token punctuation">,</span>   <span class="token comment">// 错误代码编号</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>参量</p> <p>user_error</p> <p>[in] 用户设置的错误代码编号。</p> <p>返回值</p> <p>没有返回值</p> <p>注意</p> <p>在使用SetUserError(user_error) 函数发生错误后， GetLastError() 返回值等于 ERR_USER_ERROR_FIRST + user_error.</p> <p>示例：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 设置错误编号 65537=(ERR_USER_ERROR_FIRST +1)</span>
   <span class="token function">SetUserError</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 获得上一个错误代码</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;GetLastError = &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
   Result
   GetLastError = 65537
*/</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="_5-23-sleep"><a href="#_5-23-sleep" class="header-anchor">#</a> 5.23 Sleep</h2> <p>在指定的间隔内暂停当前EA程序 或 脚本 的执行。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">void</span>  <span class="token function">Sleep</span><span class="token punctuation">(</span>
   <span class="token keyword">int</span>  milliseconds      <span class="token comment">// 间隔</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>参量</p> <p>milliseconds</p> <p>[in] 内部延期时间，单位:毫秒</p> <p>返回值</p> <p>没有返回值</p> <p>注意</p> <p>Sleep()函数不能被自定义指标调用，因为指标是以界面线路通过并不能够放慢速度，智能交易每0.1 second秒会检测。</p> <p>不能在自定义指标中调用Sleep()函数，因为指标是在接口线程中执行的，并且不能降低它的速度。该函数有一个内置检查，每0.1秒检查一次EA的停止标帜。</p> <h2 id="_5-24-terminalclose"><a href="#_5-24-terminalclose" class="header-anchor">#</a> 5.24 TerminalClose</h2> <p>该函数关闭客户端</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  <span class="token function">TerminalClose</span><span class="token punctuation">(</span>
   <span class="token keyword">int</span> ret_code      <span class="token comment">// 关闭客户端代码</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>参数</p> <p>ret_code</p> <p>[in] 返回代码，在操作完成后通过客户端返回。</p> <p>返回值</p> <p>函数成功true，否则false。</p> <p>注意</p> <p>TerminalClose() 函数不会立即停止客户端，它只命令客户端完成它的操作。</p> <p>EA交易的代码叫做TerminalClose()指令必须有立即完成所有的安排(例如，所有以前打开的文件必须以正常模式关闭)。该函数的调用通过 返回操作符执行。</p> <p>ret_code参数允许指示必要的返回代码，以分析在命令提示符启动时终止客户端操作的原因。</p> <p>示例：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//--- 输入参量</span>
input <span class="token keyword">int</span>  tiks_before<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">;</span> <span class="token comment">// 订单号数目直到终止</span>
input <span class="token keyword">int</span>  pips_to_go<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">;</span>   <span class="token comment">//  pips 间的距离</span>
input <span class="token keyword">int</span>  seconds_st<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">;</span>   <span class="token comment">// 给予EA交易的秒数</span>
<span class="token comment">//--- 全局</span>
datetime   launch_time<span class="token punctuation">;</span>
<span class="token keyword">int</span>        tick_counter<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| EA反法初始化函数                                                  |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">OnDeinit</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> reason<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//---</span>
   <span class="token function">Print</span><span class="token punctuation">(</span>__FUNCTION__<span class="token punctuation">,</span><span class="token string">&quot; reason code = &quot;</span><span class="token punctuation">,</span>reason<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Comment</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| EA跳价执行函数                                                     |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">OnTick</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   <span class="token keyword">static</span> <span class="token keyword">double</span> first_bid<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">;</span>
   MqlTick       tick<span class="token punctuation">;</span>
   <span class="token keyword">double</span>        distance<span class="token punctuation">;</span>
<span class="token comment">//---</span>
   <span class="token function">SymbolInfoTick</span><span class="token punctuation">(</span>_Symbol<span class="token punctuation">,</span>tick<span class="token punctuation">)</span><span class="token punctuation">;</span>
   tick_counter<span class="token operator">++</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>first_bid<span class="token operator">==</span><span class="token number">0.0</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      launch_time<span class="token operator">=</span>tick<span class="token punctuation">.</span>time<span class="token punctuation">;</span>
      first_bid<span class="token operator">=</span>tick<span class="token punctuation">.</span>bid<span class="token punctuation">;</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;first_bid =&quot;</span><span class="token punctuation">,</span>first_bid<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//---  pips 的价格距离</span>
   distance<span class="token operator">=</span><span class="token punctuation">(</span>tick<span class="token punctuation">.</span>bid<span class="token operator">-</span>first_bid<span class="token punctuation">)</span><span class="token operator">/</span>_Point<span class="token punctuation">;</span>
<span class="token comment">//--- 通过EA操作显示告示</span>
   string comm<span class="token operator">=</span><span class="token string">&quot;From the moment of start:\r\n\x25CF elapsed seconds: &quot;</span><span class="token operator">+</span>
               <span class="token function">IntegerToString</span><span class="token punctuation">(</span>tick<span class="token punctuation">.</span>time<span class="token operator">-</span>launch_time<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot; ;&quot;</span><span class="token operator">+</span>
               <span class="token string">&quot;\r\n\x25CF ticks received: &quot;</span><span class="token operator">+</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span>tick_counter<span class="token operator">+</span><span class="token string">&quot; ;&quot;</span><span class="token operator">+</span>
               <span class="token string">&quot;\r\n\x25CF price went in points: &quot;</span><span class="token operator">+</span><span class="token function">StringFormat</span><span class="token punctuation">(</span><span class="token string">&quot;%G&quot;</span><span class="token punctuation">,</span>distance<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Comment</span><span class="token punctuation">(</span>comm<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 检测关闭程序端状态的部分</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>tick_counter<span class="token operator">&gt;=</span>tiks_before<span class="token punctuation">)</span>
      <span class="token function">TerminalClose</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 推出订单号计数器</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>distance<span class="token operator">&gt;</span>pips_to_go<span class="token punctuation">)</span>
      <span class="token function">TerminalClose</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 同于pips_to_go增长pips数量</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>distance<span class="token operator">&lt;</span><span class="token operator">-</span>pips_to_go<span class="token punctuation">)</span>
      <span class="token function">TerminalClose</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 同于pips_to_go下降pips的数量</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>tick<span class="token punctuation">.</span>time<span class="token operator">-</span>launch_time<span class="token operator">&gt;</span>seconds_st<span class="token punctuation">)</span>
      <span class="token function">TerminalClose</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 超时终止</span>
<span class="token comment">//---</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br></div></div><p>相关参考
程序运行 ，执行错误 ， 无法初始化原因</p> <h2 id="_5-25-testerhideindicators"><a href="#_5-25-testerhideindicators" class="header-anchor">#</a> 5.25 TesterHideIndicators</h2> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>设置显示<span class="token operator">/</span>隐藏EA中使用的指标的模式。这个函数仅用于在测试期间管理已用指标的可见性。
<span class="token keyword">void</span>  <span class="token function">TesterHideIndicators</span><span class="token punctuation">(</span>
   <span class="token keyword">bool</span>      hide     <span class="token comment">// 标识</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>参数</p> <p>hide</p> <p>[in] 用于测试时隐藏指标的标识。设置隐藏已创建指标为true，否则为false。</p> <p>返回值</p> <p>无。</p> <p>注意</p> <p>默认情况下，已测试EA创建的所有指标都显示在可视测试图表上。此外，这些指标还显示在测试完成后自动打开的图表上。TesterHideIndicators()函数允许开发人员实现禁止显示已用指标的功能。</p> <p>若要禁止显示测试EA时已用的指标，请在创建EA句柄之前调用TesterHideIndicators()等于true – 在此后创建的所有指标都被标记为隐藏标识。这些指标在可视测试期间和测试完成后自动打开的图表上都不显示。</p> <p>若要禁用新创建指标的隐藏模式，请调用TesterHideIndicators() 等于false。只有从测试EA直接生成的指标才可以显示在测试图表上。这个规则只适用于&lt;data_folder&gt;MQL5\Profiles\Templates没有单一模板的情况下。</p> <p>如果&lt;data_folder&gt;MQL5\Profiles\Templates文件目录包含一个特殊模板&lt;EA_name&gt;.tpl，那么只有该模板的指标可以在可视测试期间和测试图表上显示。在这种情况下，测试EA中无已用指标可显示。即使在EA代码中调用TesterHideIndicators()等于true，这种情况下仍然存在。</p> <p>如果&lt;data_folder&gt;MQL5\Profiles\Templates目录不包含特殊模板&lt;EA_name&gt;.tpl而是以tester.tpl来替代，那么没有被TesterHideIndicators()函数禁用的来自tester.tpl的指标和来自EA的指标会在可视测试期间和测试图表上显示。如果没有tester.tpl模板，则使用default.tpl模板的指标来替代。</p> <p>如果策略测试发现了不合适的模板(&lt;EA_name&gt;.tpl，tester.tpl或default.tpl)，那么EA中使用的指标的显示则完全由TesterHideIndicators() 函数管理。</p> <p>例如：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span> <span class="token class-name">CSampleExpert</span><span class="token double-colon punctuation">::</span><span class="token function">InitIndicators</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   <span class="token function">TesterHideIndicators</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 创建MACD指标</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>m_handle_macd<span class="token operator">==</span>INVALID_HANDLE<span class="token punctuation">)</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>m_handle_macd<span class="token operator">=</span><span class="token function">iMACD</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">26</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span>PRICE_CLOSE<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">==</span>INVALID_HANDLE<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
         <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Error creating MACD indicator&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
   <span class="token function">TesterHideIndicators</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 创建EMA指标并将其添加到集</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>m_handle_ema<span class="token operator">==</span>INVALID_HANDLE<span class="token punctuation">)</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>m_handle_ema<span class="token operator">=</span><span class="token function">iMA</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>InpMATrendPeriod<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>MODE_EMA<span class="token punctuation">,</span>PRICE_CLOSE<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">==</span>INVALID_HANDLE<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
         <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Error creating EMA indicator&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
<span class="token comment">//--- 成功</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>另见
IndicatorRelease</p> <h2 id="_5-26-testerstatistics"><a href="#_5-26-testerstatistics" class="header-anchor">#</a> 5.26 TesterStatistics</h2> <p>函数返回基于测试结果计算的指定统计量的值。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>    <span class="token keyword">double</span>  <span class="token function">TesterStatistics</span><span class="token punctuation">(</span>
   ENUM_STATISTICS statistic_id      <span class="token comment">// ID</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>参数</p> <p>statistic_id</p> <p>[in] 来自 ENUM_STATISTICS 枚举的统计参数的ID。</p> <p>返回值</p> <p>来自测试结果的统计参数的值。</p> <p>在策略测试</p> <p>器中函数可以在OnTester() 或 OnDeinit() 内部调用。其他情况下结果不确定。</p> <h2 id="_5-27-testerstop"><a href="#_5-27-testerstop" class="header-anchor">#</a> 5.27 TesterStop</h2> <p>当测试时，给予程序操作完成命令。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">void</span>  <span class="token function">TesterStop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>返回值</p> <p>无返回值。</p> <p>注意</p> <p>TesterStop()函数是为测试代理上的EA例行早期关闭而设计的 – 例如，当达到指定数量的亏损交易或预先设定的下降水平时。</p> <p>TesterStop()调用被认为是测试的正常完成，因此OnTester() 函数被调用，将全部累积的交易统计数据和优化准则值提交到策略测试。</p> <p>在策略测试中调用 ExpertRemove()还意味着正常测试完成并允许获取交易统计数据，但EA从代理内存中卸载。在这种情况下，对下一组参数执行传递需要一段时间来重新加载重新。因此，TesterStop() 是早期例行完成测试的首选选项。</p> <p>另见
程序运行、测试交易策略、 ExpertRemove、SetReturnError</p> <h2 id="_5-28-testerwithdrawal"><a href="#_5-28-testerwithdrawal" class="header-anchor">#</a> 5.28 TesterWithdrawal</h2> <p>在测试过程中模拟出金操作</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">bool</span>  <span class="token function">TesterWithdrawal</span><span class="token punctuation">(</span>
   <span class="token keyword">double</span> money      <span class="token comment">// 出金总额</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>参数</p> <p>money</p> <p>[in] 要求出金的总金额（使用存款货币的单位）</p> <p>返回值</p> <p>成功，返回 true，否则 false.</p> <h2 id="_5-29-translatekey"><a href="#_5-29-translatekey" class="header-anchor">#</a> 5.29 TranslateKey</h2> <p>考虑当前输入语言 和 控制键状态 的虚拟按键编码，返回对应的Unicode字符。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">short</span>  <span class="token function">TranslateKey</span><span class="token punctuation">(</span>
   <span class="token keyword">int</span>  key_code      <span class="token comment">// 接收Unicode字符的 按键 码</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>参数</p> <p>key_code</p> <p>[in] 键码。</p> <p>返回值</p> <p>转换成功的Unicode字符。错误情况下，函数返回 -1。</p> <p>注意</p> <p>函数使用ToUnicodeEx将用户按下的键码转换为Unicode字符。如果没有触发ToUnicodeEx则可能发生错误 —— 例如，试图接收SHIFT键字符时。</p> <p>例如：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token function">OnChartEvent</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> id<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">long</span><span class="token operator">&amp;</span> lparam<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">double</span><span class="token operator">&amp;</span> dparam<span class="token punctuation">,</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> sparam<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>id<span class="token operator">==</span>CHARTEVENT_KEYDOWN<span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token keyword">short</span> sym<span class="token operator">=</span><span class="token function">TranslateKey</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>lparam<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 如果输入的字符成功转换为Unicode</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>sym<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span>
         <span class="token function">Print</span><span class="token punctuation">(</span>sym<span class="token punctuation">,</span><span class="token string">&quot;'&quot;</span><span class="token punctuation">,</span><span class="token function">ShortToString</span><span class="token punctuation">(</span>sym<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&quot;'&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">else</span>
         <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Error in TranslateKey for key=&quot;</span><span class="token punctuation">,</span>lparam<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>相关参考
客户端事件，OnChartEvent</p> <h2 id="_5-30-zeromemory"><a href="#_5-30-zeromemory" class="header-anchor">#</a> 5.30 ZeroMemory</h2> <p>函数重新设置(归零)通过形式参数传递给它的变量。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">void</span>  <span class="token function">ZeroMemory</span><span class="token punctuation">(</span>
   <span class="token keyword">void</span> <span class="token operator">&amp;</span> variable      <span class="token comment">// 变量重置</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>参数</p> <p>variable</p> <p>[in] [out] 变量通过形式参数传递，然后重置（从0开始初始化）</p> <p>返回值</p> <p>没有返回值</p> <p>注意</p> <p>如果传递的形式参数是一个字符串，那么调用将等效于表示为空值。</p> <p>对于简单类型及其数组，以及包含此类型的 结构/类，这是一个简单的重置。</p> <p>对于包含字符串和动态数组的对象，将对每个元素调用ZeroMemory()。</p> <p>对于任何不受const修饰符保护的数组，这将会把所有元素归零。</p> <p>对于复杂对象的数组，需要对每个元素调用ZeroMemory()。</p> <p>ZeroMemory()不能应用于具有受保护的 成员 或 继承的 类。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/mql5yao/Chapter/four.html" class="prev">
        04 第四章 预定义变量
      </a></span> <span class="next"><a href="/mql5yao/Chapter/six.html">
        06 第六章 数组函数
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/mql5yao/assets/js/app.8a48e4d1.js" defer></script><script src="/mql5yao/assets/js/2.8ccfeae3.js" defer></script><script src="/mql5yao/assets/js/1.abd3212e.js" defer></script><script src="/mql5yao/assets/js/45.1ee1c2de.js" defer></script>
  </body>
</html>
