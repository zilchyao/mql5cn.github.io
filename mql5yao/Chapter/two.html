<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>智能交易*姚 文档站</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/mql5yao/favicon.ico">
    <meta name="description" content="这是智能交易的文档站点。">
    <meta name="keywords" content="MQL,EA,智能交易,自动交易,量化,编程,培训">
    
    <link rel="preload" href="/mql5yao/assets/css/0.styles.c167a2d0.css" as="style"><link rel="preload" href="/mql5yao/assets/js/app.f23448f4.js" as="script"><link rel="preload" href="/mql5yao/assets/js/3.a8269cb7.js" as="script"><link rel="preload" href="/mql5yao/assets/js/2.45a03fa6.js" as="script"><link rel="prefetch" href="/mql5yao/assets/js/10.a59489eb.js"><link rel="prefetch" href="/mql5yao/assets/js/11.1fde020f.js"><link rel="prefetch" href="/mql5yao/assets/js/12.a5634cbb.js"><link rel="prefetch" href="/mql5yao/assets/js/13.1e1b93d8.js"><link rel="prefetch" href="/mql5yao/assets/js/14.17d955a5.js"><link rel="prefetch" href="/mql5yao/assets/js/15.429599a3.js"><link rel="prefetch" href="/mql5yao/assets/js/16.bcf982ab.js"><link rel="prefetch" href="/mql5yao/assets/js/17.76fde0dd.js"><link rel="prefetch" href="/mql5yao/assets/js/18.49626d28.js"><link rel="prefetch" href="/mql5yao/assets/js/19.0f21f003.js"><link rel="prefetch" href="/mql5yao/assets/js/20.18311061.js"><link rel="prefetch" href="/mql5yao/assets/js/21.63b34e06.js"><link rel="prefetch" href="/mql5yao/assets/js/22.a49527a7.js"><link rel="prefetch" href="/mql5yao/assets/js/23.2584759c.js"><link rel="prefetch" href="/mql5yao/assets/js/24.05b32517.js"><link rel="prefetch" href="/mql5yao/assets/js/25.991ff096.js"><link rel="prefetch" href="/mql5yao/assets/js/26.07e08c10.js"><link rel="prefetch" href="/mql5yao/assets/js/27.11150f9e.js"><link rel="prefetch" href="/mql5yao/assets/js/28.b5c9f3ea.js"><link rel="prefetch" href="/mql5yao/assets/js/29.a1ad142f.js"><link rel="prefetch" href="/mql5yao/assets/js/30.6da01d3d.js"><link rel="prefetch" href="/mql5yao/assets/js/31.28fa5dac.js"><link rel="prefetch" href="/mql5yao/assets/js/32.46aab1c1.js"><link rel="prefetch" href="/mql5yao/assets/js/33.f178c7a3.js"><link rel="prefetch" href="/mql5yao/assets/js/34.cd1eae3b.js"><link rel="prefetch" href="/mql5yao/assets/js/35.ee55e50b.js"><link rel="prefetch" href="/mql5yao/assets/js/36.56370362.js"><link rel="prefetch" href="/mql5yao/assets/js/37.2cc5b283.js"><link rel="prefetch" href="/mql5yao/assets/js/38.c3bba64a.js"><link rel="prefetch" href="/mql5yao/assets/js/39.86103eac.js"><link rel="prefetch" href="/mql5yao/assets/js/4.ffd96de7.js"><link rel="prefetch" href="/mql5yao/assets/js/40.0e36f079.js"><link rel="prefetch" href="/mql5yao/assets/js/41.17bccbf6.js"><link rel="prefetch" href="/mql5yao/assets/js/42.a40ca8ac.js"><link rel="prefetch" href="/mql5yao/assets/js/43.5a883397.js"><link rel="prefetch" href="/mql5yao/assets/js/44.19bdddfe.js"><link rel="prefetch" href="/mql5yao/assets/js/45.dec8257c.js"><link rel="prefetch" href="/mql5yao/assets/js/46.ed29615c.js"><link rel="prefetch" href="/mql5yao/assets/js/47.b6d07db1.js"><link rel="prefetch" href="/mql5yao/assets/js/48.d7ca24ca.js"><link rel="prefetch" href="/mql5yao/assets/js/5.47d44717.js"><link rel="prefetch" href="/mql5yao/assets/js/6.1f5c1ae1.js"><link rel="prefetch" href="/mql5yao/assets/js/7.1a679445.js"><link rel="prefetch" href="/mql5yao/assets/js/8.e80e8a9d.js"><link rel="prefetch" href="/mql5yao/assets/js/9.261aef18.js">
    <link rel="stylesheet" href="/mql5yao/assets/css/0.styles.c167a2d0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/mql5yao/" class="home-link router-link-active"><img src="/mql5yao/logo.png" alt="智能交易*姚 文档站" class="logo"> <span class="site-name can-hide">智能交易*姚 文档站</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/mql5yao/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/mql5yao/Chapter/start.html" class="nav-link">
  文档
</a></div><div class="nav-item"><a href="/mql5yao/Cutleeks/" class="nav-link">
  割韭菜XX招
</a></div><div class="nav-item"><a href="/mql5yao/support/" class="nav-link">
  支持本站
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/mql5yao/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/mql5yao/Chapter/start.html" class="nav-link">
  文档
</a></div><div class="nav-item"><a href="/mql5yao/Cutleeks/" class="nav-link">
  割韭菜XX招
</a></div><div class="nav-item"><a href="/mql5yao/support/" class="nav-link">
  支持本站
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>MQL5线上手册</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mql5yao/Chapter/start.html" class="sidebar-link">MQL5 参考</a></li><li><a href="/mql5yao/Chapter/one.html" class="sidebar-link">01 第一章 语言基础</a></li><li><a href="/mql5yao/Chapter/two.html" aria-current="page" class="active sidebar-link">02 第二章 标准常量，列举和架构</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-1-图表常量" class="sidebar-link">2 .1 图表常量</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-1-1-图表事件类型" class="sidebar-link">2.1.1 图表事件类型</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-1-2-图表时间表" class="sidebar-link">2.1.2 图表时间表</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-1-3-图表属性" class="sidebar-link">2.1.3 图表属性</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-1-4-定位常量" class="sidebar-link">2.1.4 定位常量</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-1-5-图表陈述-表示" class="sidebar-link">2.1.5 图表陈述(表示)</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-1-6-使用图表示例" class="sidebar-link">2.1.6 使用图表示例</a></li></ul></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-2-对象常量" class="sidebar-link">2 .2 对象常量</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-2-1-对象-物件-类型" class="sidebar-link">2.2.1 对象（物件）类型</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-2-2-对象属性" class="sidebar-link">2.2.2 对象属性</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-2-3-对象定位方法" class="sidebar-link">2.2.3 对象定位方法</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-2-4-附加物件的图表角落" class="sidebar-link">2.2.4 附加物件的图表角落</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-2-3-对象定位方法-2" class="sidebar-link">2.2.3 对象定位方法</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-2-5-对象可见性" class="sidebar-link">2.2.5 对象可见性</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-2-6-艾略特波浪级别" class="sidebar-link">2.2.6 艾略特波浪级别</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-2-7-江恩对象" class="sidebar-link">2.2.7 江恩对象</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-2-8-网页颜色" class="sidebar-link">2.2.8 网页颜色</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-2-9-wingding" class="sidebar-link">2.2.9 Wingding</a></li></ul></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-3-指标常量" class="sidebar-link">2 .3 指标常量</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-3-1-价格常数" class="sidebar-link">2.3.1 价格常数</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-3-2-平滑方式" class="sidebar-link">2.3.2 平滑方式</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-3-3-指标线" class="sidebar-link">2.3.3 指标线</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-3-4-绘画风格" class="sidebar-link">2.3.4 绘画风格</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-3-5-自定义指标属性" class="sidebar-link">2.3.5 自定义指标属性</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-3-6-技术指标类型" class="sidebar-link">2.3.6 技术指标类型</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-3-7-数据类型标识符" class="sidebar-link">2.3.7 数据类型标识符</a></li></ul></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-4-环境状态" class="sidebar-link">2 .4 环境状态</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-4-1-客户端属性" class="sidebar-link">2.4.1 客户端属性</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-4-2-运行mql程序属性" class="sidebar-link">2.4.2 运行MQL程序属性</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-4-3-交易品种属性" class="sidebar-link">2.4.3 交易品种属性</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-4-4-账户属性" class="sidebar-link">2.4.4 账户属性</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-4-5-测试统计" class="sidebar-link">2.4.5 测试统计</a></li></ul></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-5-交易常量" class="sidebar-link">2.5 交易常量</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-5-1-历史数据库属性" class="sidebar-link">2.5.1 历史数据库属性</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-5-2-订单属性" class="sidebar-link">2.5.2 订单属性</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-5-3-仓位属性" class="sidebar-link">2.5.3 仓位属性</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-5-4-交易属性" class="sidebar-link">2.5.4 交易属性</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-5-5-交易操作类型" class="sidebar-link">2.5.5 交易操作类型</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-5-6-交易事件-务-类型" class="sidebar-link">2.5.6 交易事件(务)类型</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-5-7-市场深度-dom-的交易订单" class="sidebar-link">2.5.7 市场深度(DOM)的交易订单</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-5-8-信号属性" class="sidebar-link">2.5.8 信号属性</a></li></ul></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-6-命名常量" class="sidebar-link">2.6 命名常量</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-6-1-预定义的宏替换" class="sidebar-link">2.6.1 预定义的宏替换</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-6-2-数学常量" class="sidebar-link">2.6.2 数学常量</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-6-3-数值类型的常量" class="sidebar-link">2.6.3 数值类型的常量</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-6-4-不能初始化原因代码" class="sidebar-link">2.6.4 不能初始化原因代码</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-6-5-检测对象指针" class="sidebar-link">2.6.5 检测对象指针</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-6-6-其它常量" class="sidebar-link">2.6.6 其它常量</a></li></ul></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-7-数据结构" class="sidebar-link">2.7 数据结构</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-7-1-mqldatetime" class="sidebar-link">2.7.1 MqlDateTime</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-7-2-mqlparam" class="sidebar-link">2.7.2 MqlParam</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-7-3-mqlrates" class="sidebar-link">2.7.3 MqlRates</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-7-4-mqlbookinfo" class="sidebar-link">2.7.4 MqlBookInfo</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-7-5-mqltraderequest" class="sidebar-link">2.7.5 MqlTradeRequest</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-7-6-mqltradecheckresult" class="sidebar-link">2.7.6 MqlTradeCheckResult</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-7-7-mqltraderesult" class="sidebar-link">2.7.7 MqlTradeResult</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-7-8-mqltradetransaction" class="sidebar-link">2.7.8 MqlTradeTransaction</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-7-9-mqltick" class="sidebar-link">2.7.9 MqlTick</a></li></ul></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-8-错误和警告代码" class="sidebar-link">2.8 错误和警告代码</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-8-1-交易服务器返回代码" class="sidebar-link">2.8.1 交易服务器返回代码</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-8-2-编译器警告" class="sidebar-link">2.8.2 编译器警告</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-8-3-编译错误" class="sidebar-link">2.8.3 编译错误</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-8-4-运行时间错误" class="sidebar-link">2.8.4 运行时间错误</a></li></ul></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-9-输入和输出常量" class="sidebar-link">2.9 输入和输出常量</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-9-1-文件打开标帜" class="sidebar-link">2.9.1 文件打开标帜</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-9-2-文件属性" class="sidebar-link">2.9.2 文件属性</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-9-3-文件内部-指针-位置" class="sidebar-link">2.9.3 文件内部(指针)位置</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-9-4-使用字符编码集" class="sidebar-link">2.9.4 使用字符编码集</a></li><li class="sidebar-sub-header"><a href="/mql5yao/Chapter/two.html#_2-9-5-对话框常量" class="sidebar-link">2.9.5 对话框常量</a></li></ul></li></ul></li><li><a href="/mql5yao/Chapter/three.html" class="sidebar-link">03 第三章 MQL5程序</a></li><li><a href="/mql5yao/Chapter/four.html" class="sidebar-link">04 第四章 预定义变量</a></li><li><a href="/mql5yao/Chapter/five.html" class="sidebar-link">05 第五章 普通函数</a></li><li><a href="/mql5yao/Chapter/six.html" class="sidebar-link">06 第六章 数组函数</a></li><li><a href="/mql5yao/Chapter/add1.html" class="sidebar-link">07 第add1章 矩阵和向量方法</a></li><li><a href="/mql5yao/Chapter/seven.html" class="sidebar-link">07 第七章 函数转换</a></li><li><a href="/mql5yao/Chapter/eight.html" class="sidebar-link">08 第八章 数学函数</a></li><li><a href="/mql5yao/Chapter/nine.html" class="sidebar-link">09 第九章 字符串函数</a></li><li><a href="/mql5yao/Chapter/ten.html" class="sidebar-link">10 第十章 日期和时间</a></li><li><a href="/mql5yao/Chapter/eleven.html" class="sidebar-link">11 第十一章 账户信息</a></li><li><a href="/mql5yao/Chapter/twelve.html" class="sidebar-link">12 第十二章 检测</a></li><li><a href="/mql5yao/Chapter/thirteen.html" class="sidebar-link">13 第十三章 事件处理</a></li><li><a href="/mql5yao/Chapter/fourteen.html" class="sidebar-link">14 第十四章 市场信息</a></li><li><a href="/mql5yao/Chapter/fifteen.html" class="sidebar-link">15 第十五章 经济日历函数</a></li><li><a href="/mql5yao/Chapter/sixteen.html" class="sidebar-link">16 第十六章 时间序列和指标访问</a></li><li><a href="/mql5yao/Chapter/seventeen.html" class="sidebar-link">17 第十七章 自定义交易品种</a></li><li><a href="/mql5yao/Chapter/eighteen.html" class="sidebar-link">18 第十八章 图表操作</a></li><li><a href="/mql5yao/Chapter/ninteen.html" class="sidebar-link">19 第十九章 交易函数</a></li><li><a href="/mql5yao/Chapter/twenty.html" class="sidebar-link">20 第二十章 交易信号</a></li><li><a href="/mql5yao/Chapter/twentyone.html" class="sidebar-link">21 第二十一章 网络函数</a></li><li><a href="/mql5yao/Chapter/twentytwo.html" class="sidebar-link">22 第二十二章 程序端全局变量</a></li><li><a href="/mql5yao/Chapter/twentythree.html" class="sidebar-link">23 第二十三章 文件函数</a></li><li><a href="/mql5yao/Chapter/twentyfour.html" class="sidebar-link">24 第二十四章 自定义指标</a></li><li><a href="/mql5yao/Chapter/twentyfive.html" class="sidebar-link">25 第二十五章 物件函数</a></li><li><a href="/mql5yao/Chapter/twentysix.html" class="sidebar-link">26 第二十六章 技术指标</a></li><li><a href="/mql5yao/Chapter/twentyseven.html" class="sidebar-link">27 第二十七章 处理优化结果</a></li><li><a href="/mql5yao/Chapter/twentyeight.html" class="sidebar-link">28 第二十八章 工作事件</a></li><li><a href="/mql5yao/Chapter/twentynine.html" class="sidebar-link">29 第二十九章 使用OpenCL工作</a></li><li><a href="/mql5yao/Chapter/thirty.html" class="sidebar-link">30 第三十章 使用数据库</a></li><li><a href="/mql5yao/Chapter/thirtyone.html" class="sidebar-link">31 第三十一章 使用DirectX</a></li><li><a href="/mql5yao/Chapter/thirtytwo.html" class="sidebar-link">32 第三十二章 集成</a></li><li><a href="/mql5yao/Chapter/add2.html" class="sidebar-link">32 第add2章 ONNX模型</a></li><li><a href="/mql5yao/Chapter/thirtythree.html" class="sidebar-link">33 第三十三章 标准程序库</a></li><li><a href="/mql5yao/Chapter/AppendixI.html" class="sidebar-link">34 附录一 来自MQL4</a></li><li><a href="/mql5yao/Chapter/AppendixII.html" class="sidebar-link">35 附录二 MQL5 函数列表</a></li><li><a href="/mql5yao/Chapter/AppendixIII.html" class="sidebar-link">36 附录三 MQL5常量列表</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2>第二章 标准常量，列举和架构</h2> <p>为了简化编写程序的过程，以及使程序代码文本更容易理解，在MQL5语言中预定义了一些标准常量和枚举型常量，此外，结构 服务也用于存储信息。</p> <p>标准常量与宏相似，且为int类型。</p> <p>这些常量是按其用途分组的:</p> <ul><li>图表常量 与价格图表共同使用：开盘，导航，设置参量；</li> <li>对象常量 可以用于处理在图表中创建和显示的图形对象;</li> <li>指标常量 用于标准和自定义指标；</li> <li>环境状态 环境状态常量描述了mql5程序的属性，显示了关于客户端、金融交易品种和当前帐户的信息;</li> <li>交易常量 允许在交易过程中指定各种信息;</li> <li>命名常量 是MQL5语言中的常量；</li> <li>数据结构 描述数据存储格式；</li> <li>错误和警告代码 描述编译器信息和交易服务器发出的交易请求；</li> <li>输入/输出常量 通常与文件函数一起工作，并通过MessageBox()函数在屏幕上显示消息。</li></ul> <h2 id="_2-1-图表常量"><a href="#_2-1-图表常量" class="header-anchor">#</a> 2 .1 图表常量</h2> <p>该常量描述了图表的各种属性，并分成如下组:</p> <ul><li>事件类型 —— 使用图表时发生的事件;</li> <li>图表时间表 —— 标准内置周期;</li> <li>图表属性 —— 用于图表函数参数的标识符;</li> <li>定位常量 —— 用于ChartNavigate()函数的参数值 ;</li> <li>展示图表 —— 设置图表外观.</li></ul> <h3 id="_2-1-1-图表事件类型"><a href="#_2-1-1-图表事件类型" class="header-anchor">#</a> 2.1.1 图表事件类型</h3> <p>可以使用预定义函数OnChartEvent()处理11种图表上的事件类型。对于自定义事件，在CHARTEVENT_CUSTOM到CHARTEVENT_CUSTOM_LAST包含的范围内提供了65535标识符。要生成自定义事件，应该使用EventChartCustom()函数。</p> <p><strong>ENUM_CHART_EVENT</strong></p> <table><thead><tr><th>ID</th> <th>说明</th></tr></thead> <tbody><tr><td>CHARTEVENT_KEYDOWN</td> <td>击键</td></tr> <tr><td>CHARTEVENT_MOUSE_MOVE</td> <td>鼠标移动，鼠标点击 (如果 <a href="http://mql5.digityao.online/h5mql5.html#enum_chart_property_integer" target="_blank" rel="noopener noreferrer">CHART_EVENT_MOUSE_MOVE<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>=true 为图表设置)</td></tr> <tr><td>CHARTEVENT_MOUSE_WHEEL</td> <td>按下或滚动鼠标滚轮(如果<a href="http://mql5.digityao.online/h5mql5.html#enum_chart_property_integer" target="_blank" rel="noopener noreferrer">CHART_EVENT_MOUSE_WHEEL<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>=True为图表设置)。</td></tr> <tr><td>CHARTEVENT_OBJECT_CREATE</td> <td>创建图形对象 (如果 <a href="http://mql5.digityao.online/h5mql5.html#enum_chart_property_integer" target="_blank" rel="noopener noreferrer">CHART_EVENT_OBJECT_CREATE<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>=true 为图表设置)。</td></tr> <tr><td>CHARTEVENT_OBJECT_CHANGE</td> <td>修改图形对象</td></tr> <tr><td>CHARTEVENT_OBJECT_DELETE</td> <td>创建图形对象  (如果 <a href="http://mql5.digityao.online/h5mql5.html#enum_chart_property_integer" target="_blank" rel="noopener noreferrer">CHART_EVENT_OBJECT_DELETE<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>=true 为图表设置)。</td></tr> <tr><td>CHARTEVENT_CLICK</td> <td>点击一个图表。</td></tr> <tr><td>CHARTEVENT_OBJECT_CLICK</td> <td>点击图形对象。</td></tr> <tr><td>CHARTEVENT_OBJECT_DRAG</td> <td>拖放图形对象。</td></tr> <tr><td>CHARTEVENT_OBJECT_ENDEDIT</td> <td>在图形对象编辑中结束文本编辑。</td></tr> <tr><td>CHARTEVENT_CHART_CHANGE</td> <td>通过属性对话框改变了图表大小或更改图表属性。</td></tr> <tr><td>CHARTEVENT_CUSTOM</td> <td>从一系列自定义事件中的初始化一个事件的数字编号。</td></tr> <tr><td>CHARTEVENT_CUSTOM_LAST</td> <td>从一系列自定义事件中的获得最后一个数字编号。</td></tr></tbody></table> <p>对于每个事件类型，OnChartEvent()函数的输入参数都有固定值，这在该事件处理过程中是必须的，事件和相应的参数值通过形式参数传递并列举在下表中</p> <table><thead><tr><th>事件</th> <th>ID参量值</th> <th>参数常量值</th> <th>dparam 参数值</th> <th>sparam 参数值</th></tr></thead> <tbody><tr><td>按键事件</td> <td>CHARTEVENT_KEYDOWN</td> <td>按键代码</td> <td>重复计数（用户按住按键的重复击键次数）</td> <td>描述键盘按键状态的位掩码的字符串值</td></tr> <tr><td>鼠标事件 (如果CHART_EVENT_MOUSE_MOVE=true 为图表设置)</td> <td>CHARTEVENT_MOUSE_MOVE</td> <td>X坐标</td> <td>Y坐标</td> <td>描述鼠标按键状态的位掩码的字符串值</td></tr> <tr><td>鼠标滚轮事件(如果CHART_EVENT_MOUSE_WHEEL=true为图表设置)</td> <td>CHARTEVENT_MOUSE_WHEEL</td> <td>键盘按键和鼠标按键的状态标识，鼠标指针的X和Y坐标。在<a href="http://mql5.digityao.online/h5mql5.html#chartevent_mouse_wheel" target="_blank" rel="noopener noreferrer">以下示例<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>查阅描述</td> <td>鼠标滚轮滚动的Delta值</td> <td>—</td></tr> <tr><td>图解对象创建事件 (如果 CHART_EVENT_OBJECT_CREATE=true 为图表设置)</td> <td>CHARTEVENT_OBJECT_CREATE</td> <td>—</td> <td>—</td> <td>创建的图表对象的名称</td></tr> <tr><td>通过性质对话转变对象性质事件</td> <td>CHARTEVENT_OBJECT_CHANGE</td> <td>—</td> <td>—</td> <td>修改的图表对象的名称</td></tr> <tr><td>图解对象删除事件 (如果CHART_EVENT_OBJECT_DELETE=true为图表设置)</td> <td>CHARTEVENT_OBJECT_DELETE</td> <td>—</td> <td>—</td> <td>删除图表对象的名称</td></tr> <tr><td>鼠标点击图表事件</td> <td>CHARTEVENT_CLICK</td> <td>X坐标</td> <td>Y坐标</td> <td>—</td></tr> <tr><td>鼠标点击属于图表的对象事件</td> <td>CHARTEVENT_OBJECT_CLICK</td> <td>X坐标</td> <td>Y坐标</td> <td>事件发生时图表对象的名称</td></tr> <tr><td>使用鼠标拖动图解对象事件</td> <td>CHARTEVENT_OBJECT_DRAG</td> <td>—</td> <td>—</td> <td>移动图表对象名称</td></tr> <tr><td>在编辑标签图表对象的进入访问完成文本编辑事件</td> <td>CHARTEVENT_OBJECT_ENDEDIT</td> <td>—</td> <td>—</td> <td>在文本编辑完成后编辑标签图表对象名称</td></tr> <tr><td>在N数字下用户使用ID事件</td> <td>CHARTEVENT_CUSTOM+N</td> <td>EventChartCustom() 函数的值</td> <td>EventChartCustom() 函数的值</td> <td>EventChartCustom() 函数的值</td></tr></tbody></table> <p><strong>示例：</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">KEY_NUMPAD_5</span>       <span class="token expression"><span class="token number">12</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">KEY_LEFT</span>           <span class="token expression"><span class="token number">37</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">KEY_UP</span>             <span class="token expression"><span class="token number">38</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">KEY_RIGHT</span>          <span class="token expression"><span class="token number">39</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">KEY_DOWN</span>           <span class="token expression"><span class="token number">40</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">KEY_NUMLOCK_DOWN</span>   <span class="token expression"><span class="token number">98</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">KEY_NUMLOCK_LEFT</span>  <span class="token expression"><span class="token number">100</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">KEY_NUMLOCK_5</span>     <span class="token expression"><span class="token number">101</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">KEY_NUMLOCK_RIGHT</span> <span class="token expression"><span class="token number">102</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">KEY_NUMLOCK_UP</span>    <span class="token expression"><span class="token number">104</span></span></span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 专家初始化函数                                                  |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">int</span> <span class="token function">OnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//---</span>
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;The expert with name &quot;</span><span class="token punctuation">,</span><span class="token function">MQL5InfoString</span><span class="token punctuation">(</span>MQL5_PROGRAM_NAME<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&quot; is running&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">//--- 启用对象创建事件 </span>
   <span class="token function">ChartSetInteger</span><span class="token punctuation">(</span><span class="token function">ChartID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>CHART_EVENT_OBJECT_CREATE<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">//--- 启用对象删除事件 </span>
   <span class="token function">ChartSetInteger</span><span class="token punctuation">(</span><span class="token function">ChartID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>CHART_EVENT_OBJECT_DELETE<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//---</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span>INIT_SUCCEEDED<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| ChartEvent 函数                                                  |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">OnChartEvent</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> id<span class="token punctuation">,</span>         <span class="token comment">// 事件标识符 </span>
                  <span class="token keyword">const</span> <span class="token keyword">long</span><span class="token operator">&amp;</span> lparam<span class="token punctuation">,</span>   <span class="token comment">// 事件长整型参量</span>
                  <span class="token keyword">const</span> <span class="token keyword">double</span><span class="token operator">&amp;</span> dparam<span class="token punctuation">,</span> <span class="token comment">// 事件双精度型参量</span>
                  <span class="token keyword">const</span> string<span class="token operator">&amp;</span> sparam  <span class="token comment">// 事件字符串型参量</span>
                  <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 鼠标左键点击图表</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>id<span class="token operator">==</span>CHARTEVENT_CLICK<span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;The coordinates of the mouse click on the chart are: x = &quot;</span><span class="token punctuation">,</span>lparam<span class="token punctuation">,</span><span class="token string">&quot;  y = &quot;</span><span class="token punctuation">,</span>dparam<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 鼠标点击图形物件</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>id<span class="token operator">==</span>CHARTEVENT_OBJECT_CLICK<span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;The mouse has been clicked on the object with name '&quot;</span><span class="token operator">+</span>sparam<span class="token operator">+</span><span class="token string">&quot;'&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 按下密钥</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>id<span class="token operator">==</span>CHARTEVENT_KEYDOWN<span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token keyword">switch</span><span class="token punctuation">(</span>lparam<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
         <span class="token keyword">case</span> KEY_NUMLOCK_LEFT<span class="token operator">:</span>  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;The KEY_NUMLOCK_LEFT has been pressed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token keyword">break</span><span class="token punctuation">;</span>
         <span class="token keyword">case</span> KEY_LEFT<span class="token operator">:</span>          <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;The KEY_LEFT has been pressed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">break</span><span class="token punctuation">;</span>
         <span class="token keyword">case</span> KEY_NUMLOCK_UP<span class="token operator">:</span>    <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;The KEY_NUMLOCK_UP has been pressed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">break</span><span class="token punctuation">;</span>
         <span class="token keyword">case</span> KEY_UP<span class="token operator">:</span>            <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;The KEY_UP has been pressed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token keyword">break</span><span class="token punctuation">;</span>
         <span class="token keyword">case</span> KEY_NUMLOCK_RIGHT<span class="token operator">:</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;The KEY_NUMLOCK_RIGHT has been pressed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">break</span><span class="token punctuation">;</span>
         <span class="token keyword">case</span> KEY_RIGHT<span class="token operator">:</span>         <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;The KEY_RIGHT has been pressed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">break</span><span class="token punctuation">;</span>
         <span class="token keyword">case</span> KEY_NUMLOCK_DOWN<span class="token operator">:</span>  <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;The KEY_NUMLOCK_DOWN has been pressed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token keyword">break</span><span class="token punctuation">;</span>
         <span class="token keyword">case</span> KEY_DOWN<span class="token operator">:</span>          <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;The KEY_DOWN has been pressed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">break</span><span class="token punctuation">;</span>
         <span class="token keyword">case</span> KEY_NUMPAD_5<span class="token operator">:</span>      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;The KEY_NUMPAD_5 has been pressed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">break</span><span class="token punctuation">;</span>
         <span class="token keyword">case</span> KEY_NUMLOCK_5<span class="token operator">:</span>     <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;The KEY_NUMLOCK_5 has been pressed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">break</span><span class="token punctuation">;</span>
         <span class="token keyword">default</span><span class="token operator">:</span>                <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Some not listed key has been pressed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token function">ChartRedraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 物件被删除了</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>id<span class="token operator">==</span>CHARTEVENT_OBJECT_DELETE<span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;The object with name &quot;</span><span class="token punctuation">,</span>sparam<span class="token punctuation">,</span><span class="token string">&quot; has been deleted&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 物件被创建了</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>id<span class="token operator">==</span>CHARTEVENT_OBJECT_CREATE<span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;The object with name &quot;</span><span class="token punctuation">,</span>sparam<span class="token punctuation">,</span><span class="token string">&quot; has been created&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 移动物件或者更改定位点坐标</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>id<span class="token operator">==</span>CHARTEVENT_OBJECT_DRAG<span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;The anchor point coordinates of the object with name &quot;</span><span class="token punctuation">,</span>sparam<span class="token punctuation">,</span><span class="token string">&quot; has been changed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 物件编辑文本被更改</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>id<span class="token operator">==</span>CHARTEVENT_OBJECT_ENDEDIT<span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;The text in the Edit field of the object with name &quot;</span><span class="token punctuation">,</span>sparam<span class="token punctuation">,</span><span class="token string">&quot; has been changed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>          
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br></div></div><p>对于CHARTEVENT_MOUSE_MOVE 事件 sparam 字符串参数包含有关键盘和鼠标按钮的状态信息：</p> <table><thead><tr><th>Bit</th> <th>描述</th></tr></thead> <tbody><tr><td>1</td> <td>鼠标左按键状态</td></tr> <tr><td>2</td> <td>鼠标右按键状态</td></tr> <tr><td>3</td> <td>SHIFT 按钮状态</td></tr> <tr><td>4</td> <td>CTRL 按钮状态</td></tr> <tr><td>5</td> <td>鼠标中按键状态</td></tr> <tr><td>6</td> <td>第一个额外鼠标键的状态</td></tr> <tr><td>7</td> <td>第二个额外鼠标键的状态</td></tr></tbody></table> <p><strong>示例：</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token comment">//| EA初始化函数                                                      | </span>
<span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token keyword">void</span> <span class="token function">OnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
  <span class="token punctuation">{</span> 
<span class="token comment">//--- 启用 CHART_EVENT_MOUSE_MOVE 信息 </span>
   <span class="token function">ChartSetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_EVENT_MOUSE_MOVE<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span> 
<span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token comment">//| 鼠标点选位置                                                      | </span>
<span class="token comment">//+------------------------------------------------------------------+ </span>
string <span class="token function">MouseState</span><span class="token punctuation">(</span>uint state<span class="token punctuation">)</span> 
  <span class="token punctuation">{</span> 
   string res<span class="token punctuation">;</span> 
   res<span class="token operator">+=</span><span class="token string">&quot;\nML: &quot;</span>   <span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token string">&quot;DN&quot;</span><span class="token operator">:</span><span class="token string">&quot;UP&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 鼠标左按键 </span>
   res<span class="token operator">+=</span><span class="token string">&quot;\nMR: &quot;</span>   <span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token operator">&amp;</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token string">&quot;DN&quot;</span><span class="token operator">:</span><span class="token string">&quot;UP&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 鼠标右按键 </span>
   res<span class="token operator">+=</span><span class="token string">&quot;\nMM: &quot;</span>   <span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token operator">&amp;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token string">&quot;DN&quot;</span><span class="token operator">:</span><span class="token string">&quot;UP&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 鼠标中按键 </span>
   res<span class="token operator">+=</span><span class="token string">&quot;\nMX: &quot;</span>   <span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token operator">&amp;</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token string">&quot;DN&quot;</span><span class="token operator">:</span><span class="token string">&quot;UP&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 鼠标第一个 X 键 </span>
   res<span class="token operator">+=</span><span class="token string">&quot;\nMY: &quot;</span>   <span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token operator">&amp;</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token string">&quot;DN&quot;</span><span class="token operator">:</span><span class="token string">&quot;UP&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 鼠标第二个 X 键 </span>
   res<span class="token operator">+=</span><span class="token string">&quot;\nSHIFT: &quot;</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token operator">&amp;</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token string">&quot;DN&quot;</span><span class="token operator">:</span><span class="token string">&quot;UP&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// shift 键 </span>
   res<span class="token operator">+=</span><span class="token string">&quot;\nCTRL: &quot;</span> <span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token operator">&amp;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">==</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token string">&quot;DN&quot;</span><span class="token operator">:</span><span class="token string">&quot;UP&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// control 键 </span>
   <span class="token keyword">return</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span> 
<span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token comment">//| ChartEvent 函数                                                   | </span>
<span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token keyword">void</span> <span class="token function">OnChartEvent</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> id<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">long</span> <span class="token operator">&amp;</span>lparam<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">double</span> <span class="token operator">&amp;</span>dparam<span class="token punctuation">,</span><span class="token keyword">const</span> string <span class="token operator">&amp;</span>sparam<span class="token punctuation">)</span> 
  <span class="token punctuation">{</span> 
   <span class="token keyword">if</span><span class="token punctuation">(</span>id<span class="token operator">==</span>CHARTEVENT_MOUSE_MOVE<span class="token punctuation">)</span> 
      <span class="token function">Comment</span><span class="token punctuation">(</span><span class="token string">&quot;POINT: &quot;</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>lparam<span class="token punctuation">,</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>dparam<span class="token punctuation">,</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">,</span><span class="token function">MouseState</span><span class="token punctuation">(</span><span class="token punctuation">(</span>uint<span class="token punctuation">)</span>sparam<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span>         
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>对于CHARTEVENT_MOUSE_WHEEL事件，参数lparam 和dparam 包含Ctrl和 Shift键，鼠标按键，光标坐标的状态信息和鼠标滚轮滚动值。为了更好的理解，请在图表上运行这个EA交易并滚动鼠标滚轮，同时按下不同的按键并按住代码中所描述的按键。</p> <p>CHARTEVENT_MOUSE_WHEEL 事件处理示例：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token comment">//| EA交易初始化函数                                                  | </span>
<span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token keyword">void</span> <span class="token function">OnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
  <span class="token punctuation">{</span> 
<span class="token comment">//--- 启用鼠标滚轮来滚动信息 </span>
   <span class="token function">ChartSetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_EVENT_MOUSE_WHEEL<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token keyword">return</span><span class="token punctuation">(</span>INIT_SUCCEEDED<span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span> 
<span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token comment">//| ChartEvent 函数                                                  | </span>
<span class="token comment">//+------------------------------------------------------------------+ </span>
<span class="token keyword">void</span> <span class="token function">OnChartEvent</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> id<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">long</span> <span class="token operator">&amp;</span>lparam<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">double</span> <span class="token operator">&amp;</span>dparam<span class="token punctuation">,</span><span class="token keyword">const</span> string <span class="token operator">&amp;</span>sparam<span class="token punctuation">)</span> 
  <span class="token punctuation">{</span> 
   <span class="token keyword">if</span><span class="token punctuation">(</span>id<span class="token operator">==</span>CHARTEVENT_MOUSE_WHEEL<span class="token punctuation">)</span> 
     <span class="token punctuation">{</span> 
      <span class="token comment">//--- 考虑这个事件的鼠标按键和滚轮的状态 </span>
      <span class="token keyword">int</span> flg_keys <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>lparam <span class="token operator">&gt;&gt;</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// Ctrl 和 Shift 键，鼠标按键的状态标识 </span>
      <span class="token keyword">int</span> x_cursor <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">short</span><span class="token punctuation">)</span>lparam<span class="token punctuation">;</span>         <span class="token comment">// 鼠标滚轮事件发生的X坐标 </span>
      <span class="token keyword">int</span> y_cursor <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">short</span><span class="token punctuation">)</span><span class="token punctuation">(</span>lparam <span class="token operator">&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 鼠标滚轮事件发生的Y坐标 </span>
      <span class="token keyword">int</span> delta    <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>dparam<span class="token punctuation">;</span>                <span class="token comment">// 鼠标滚动的总值，到达 +120 或 -120 时触发 </span>
      <span class="token comment">//--- 处理标识 </span>
      string str_keys<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">;</span> 
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>flg_keys <span class="token operator">&amp;</span> <span class="token number">0x0001</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span> str_keys<span class="token operator">+=</span><span class="token string">&quot;LMOUSE &quot;</span><span class="token punctuation">;</span> 
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>flg_keys <span class="token operator">&amp;</span> <span class="token number">0x0002</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span> str_keys<span class="token operator">+=</span><span class="token string">&quot;RMOUSE &quot;</span><span class="token punctuation">;</span> 
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>flg_keys <span class="token operator">&amp;</span> <span class="token number">0x0004</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span> str_keys<span class="token operator">+=</span><span class="token string">&quot;SHIFT &quot;</span><span class="token punctuation">;</span> 
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>flg_keys <span class="token operator">&amp;</span> <span class="token number">0x0008</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span> str_keys<span class="token operator">+=</span><span class="token string">&quot;CTRL &quot;</span><span class="token punctuation">;</span> 
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>flg_keys <span class="token operator">&amp;</span> <span class="token number">0x0010</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span> str_keys<span class="token operator">+=</span><span class="token string">&quot;MMOUSE &quot;</span><span class="token punctuation">;</span> 
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>flg_keys <span class="token operator">&amp;</span> <span class="token number">0x0020</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span> str_keys<span class="token operator">+=</span><span class="token string">&quot;X1MOUSE &quot;</span><span class="token punctuation">;</span> 
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>flg_keys <span class="token operator">&amp;</span> <span class="token number">0x0040</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span> str_keys<span class="token operator">+=</span><span class="token string">&quot;X2MOUSE &quot;</span><span class="token punctuation">;</span> 
       
      <span class="token keyword">if</span><span class="token punctuation">(</span>str_keys<span class="token operator">!=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span> 
         str_keys<span class="token operator">=</span><span class="token string">&quot;, keys='&quot;</span><span class="token operator">+</span><span class="token function">StringSubstr</span><span class="token punctuation">(</span>str_keys<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token function">StringLen</span><span class="token punctuation">(</span>str_keys<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;'&quot;</span><span class="token punctuation">;</span> 
      <span class="token function">PrintFormat</span><span class="token punctuation">(</span><span class="token string">&quot;%s: X=%d, Y=%d, delta=%d%s&quot;</span><span class="token punctuation">,</span><span class="token function">EnumToString</span><span class="token punctuation">(</span>CHARTEVENT_MOUSE_WHEEL<span class="token punctuation">)</span><span class="token punctuation">,</span>x_cursor<span class="token punctuation">,</span>y_cursor<span class="token punctuation">,</span>delta<span class="token punctuation">,</span>str_keys<span class="token punctuation">)</span><span class="token punctuation">;</span> 
     <span class="token punctuation">}</span> 
  <span class="token punctuation">}</span> 
<span class="token comment">//+------------------------------------------------------------------+ /* </span>
   Example of the output 
   CHARTEVENT_MOUSE_WHEEL<span class="token operator">:</span> Ctrl pressed<span class="token operator">:</span> X<span class="token operator">=</span><span class="token number">193</span><span class="token punctuation">,</span> Y<span class="token operator">=</span><span class="token number">445</span><span class="token punctuation">,</span> delta<span class="token operator">=</span><span class="token operator">-</span><span class="token number">120</span> 
   CHARTEVENT_MOUSE_WHEEL<span class="token operator">:</span> Shift pressed<span class="token operator">:</span> X<span class="token operator">=</span><span class="token number">186</span><span class="token punctuation">,</span> Y<span class="token operator">=</span><span class="token number">446</span><span class="token punctuation">,</span> delta<span class="token operator">=</span><span class="token number">120</span> 
   CHARTEVENT_MOUSE_WHEEL<span class="token operator">:</span>  X<span class="token operator">=</span><span class="token number">178</span><span class="token punctuation">,</span> Y<span class="token operator">=</span><span class="token number">447</span><span class="token punctuation">,</span> delta<span class="token operator">=</span><span class="token operator">-</span><span class="token number">120</span> 
   CHARTEVENT_MOUSE_WHEEL<span class="token operator">:</span>  X<span class="token operator">=</span><span class="token number">231</span><span class="token punctuation">,</span> Y<span class="token operator">=</span><span class="token number">449</span><span class="token punctuation">,</span> delta<span class="token operator">=</span><span class="token number">120</span> 
   CHARTEVENT_MOUSE_WHEEL<span class="token operator">:</span> MiddleButton pressed<span class="token operator">:</span> X<span class="token operator">=</span><span class="token number">231</span><span class="token punctuation">,</span> Y<span class="token operator">=</span><span class="token number">449</span><span class="token punctuation">,</span> delta<span class="token operator">=</span><span class="token number">120</span> 
   CHARTEVENT_MOUSE_WHEEL<span class="token operator">:</span> LeftButton pressed<span class="token operator">:</span> X<span class="token operator">=</span><span class="token number">279</span><span class="token punctuation">,</span> Y<span class="token operator">=</span><span class="token number">320</span><span class="token punctuation">,</span> delta<span class="token operator">=</span><span class="token operator">-</span><span class="token number">120</span> 
   CHARTEVENT_MOUSE_WHEEL<span class="token operator">:</span> RightButton pressed<span class="token operator">:</span> X<span class="token operator">=</span><span class="token number">253</span><span class="token punctuation">,</span> Y<span class="token operator">=</span><span class="token number">330</span><span class="token punctuation">,</span> delta<span class="token operator">=</span><span class="token number">120</span>  <span class="token operator">*</span><span class="token operator">/</span>          
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><p>另见</p> <p>事件处理函数 ，工作事件</p> <h3 id="_2-1-2-图表时间表"><a href="#_2-1-2-图表时间表" class="header-anchor">#</a> 2.1.2 图表时间表</h3> <p>所有预定义的图表时间周期都有一个唯一的标识符，当MQL5程序运行时，PERIOD_CURRENT 标识符代表当前图表的时间周期。</p> <p><strong>ENUM_TIMEFRAMES</strong></p> <table><thead><tr><th><strong>ID</strong></th> <th><strong>描述</strong></th></tr></thead> <tbody><tr><td>PERIOD_CURRENT</td> <td>当前图表的时间周期</td></tr> <tr><td>PERIOD_M1</td> <td>1 分钟</td></tr> <tr><td>PERIOD_M2</td> <td>2 分钟</td></tr> <tr><td>PERIOD_M3</td> <td>3 分钟</td></tr> <tr><td>PERIOD_M4</td> <td>4 分钟</td></tr> <tr><td>PERIOD_M5</td> <td>5 分钟</td></tr> <tr><td>PERIOD_M6</td> <td>6 分钟</td></tr> <tr><td>PERIOD_M10</td> <td>10 分钟</td></tr> <tr><td>PERIOD_M12</td> <td>12 分钟</td></tr> <tr><td>PERIOD_M15</td> <td>15 分钟</td></tr> <tr><td>PERIOD_M20</td> <td>20 分钟</td></tr> <tr><td>PERIOD_M30</td> <td>30 分钟</td></tr> <tr><td>PERIOD_H1</td> <td>1小时</td></tr> <tr><td>PERIOD_H2</td> <td>2 小时</td></tr> <tr><td>PERIOD_H3</td> <td>3 小时</td></tr> <tr><td>PERIOD_H4</td> <td>4 小时</td></tr> <tr><td>PERIOD_H6</td> <td>6小时</td></tr> <tr><td>PERIOD_H8</td> <td>8小时</td></tr> <tr><td>PERIOD_H12</td> <td>12 小时</td></tr> <tr><td>PERIOD_D1</td> <td>1 天</td></tr> <tr><td>PERIOD_W1</td> <td>1 周</td></tr> <tr><td>PERIOD_MN1</td> <td>1月</td></tr></tbody></table> <p><strong>示例：</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code> string chart_name=&quot;test_Object_Chart&quot;; 
   Print(&quot;Let's try to create a Chart object with the name &quot;,chart_name); 
//--- 如果没有这个物件-创建它 
   if(ObjectFind(0,chart_name) &lt; 0)ObjectCreate(0,chart_name,OBJ_CHART,0,0,0,0,0); 
//--- 定义交易品种 
   ObjectSetString(0,chart_name,OBJPROP_SYMBOL,&quot;EURUSD&quot;); 
//--- 设置定位点X坐标 
   ObjectSetInteger(0,chart_name,OBJPROP_XDISTANCE,100); 
//--- 设置定位点Y坐标 
   ObjectSetInteger(0,chart_name,OBJPROP_YDISTANCE,100); 
//--- 设置图表宽度 
   ObjectSetInteger(0,chart_name,OBJPROP_XSIZE,400); 
//--- 设置高度 
   ObjectSetInteger(0,chart_name,OBJPROP_YSIZE,300); 
//--- 设置时间表 
   ObjectSetInteger(0,chart_name,OBJPROP_PERIOD,PERIOD_D1); 
//--- 设置规模(从 0 到 5) 
   ObjectSetDouble(0,chart_name,OBJPROP_SCALE,4); 
//--- 禁止鼠标选择 
   ObjectSetInteger(0,chart_name,OBJPROP_SELECTABLE,false);        
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>另见</p> <p>秒周期 ，周期，日期和时间，对象可见性</p> <h3 id="_2-1-3-图表属性"><a href="#_2-1-3-图表属性" class="header-anchor">#</a> 2.1.3 图表属性</h3> <p>枚举类型的标识符 ENUM_CHART_PROPERTY用于处理图表函数的参数。在“属性(性质)类型”字段栏(列)里的缩写r/o表示该属性是只读的，不能更改。“属性(性质)类型”字段栏(列)中的w/o缩写意味着该属性只能写入，不能接收。当访问某个属性时，有必要指定一个附加的参数修饰符，它用来显示图表子窗口的数量。 0表示主窗口。</p> <p>定义图表属性的函数实际上用于向图表发送更改命令。如果这些函数成功执行，则该命令将包含在图表事件的公共队列中。在处理图表事件的队列时，将对图表执行更改。</p> <p>因此，不要期望在调用这些函数后，图表会立即进行可视化的变化更新。通常情况下，该图表会在更改事件之后自动更新 —— 如一个新的报价到达，调整图表窗口的大小等等。使用ChartRedraw()函数可以强制刷新图表。</p> <p>函数ChartSetInteger()和ChartGetInteger()。</p> <p><strong>ENUM_CHART_PROPERTY_INTEGER</strong></p> <table><thead><tr><th>ID</th> <th>描述</th> <th>性质类型</th></tr></thead> <tbody><tr><td>CHART_SHOW</td> <td>绘制价格图表。false情况下，不可绘制价格图表的任何属性并删除首行图表边界，包括时间和价格范围，快速导航条，日历事件标签，交易标签，指标和柱形图提示，指标子窗口，交易量直方图等等。 禁用绘制是使用图形资源创建自定义程序界面的理想方案。 无论CHART_SHOW属性值多少，都会始终绘制图形对象。</td> <td>bool</td></tr> <tr><td>CHART_IS_OBJECT</td> <td>识别“图表”(OBJ_CHART) 对象 ?C 图形对象返回true。真实图表返回false</td> <td>Bool r/o</td></tr> <tr><td>CHART_BRING_TO_TOP</td> <td>显示其他图表之上的图表</td> <td>Bool w/o</td></tr> <tr><td>CHART_CONTEXT_MENU</td> <td>启用/禁用右击访问快捷菜单。 当CHART_CONTEXT_MENU=false时，仅禁用图表快捷菜单。图表上对象的快捷菜单仍可使用。</td> <td>bool （默认为false）</td></tr> <tr><td>CHART_CROSSHAIR_TOOL</td> <td>启用/禁用中间单击访问十字光标工具。</td> <td>Bool （默认为true）</td></tr> <tr><td>CHART_MOUSE_SCROLL</td> <td>使用鼠标左键水平滚动图表。如果以下属性的值设为true也可以垂直滚动：CHART_SCALEFIX, CHART_SCALEFIX_11 or CHART_SCALE_PT_PER_BAR 当CHART_MOUSE_SCROLL=false时，不可使用鼠标滚轮滚动图表。</td> <td>bool</td></tr> <tr><td>CHART_EVENT_MOUSE_WHEEL</td> <td>发送鼠标滚轮事件的消息(CHARTEVENT_MOUSE_WHEEL) 到图表上的所有mql5程序</td> <td>Bool （默认为true）</td></tr> <tr><td>CHART_EVENT_MOUSE_MOVE</td> <td>发送鼠标移动和鼠标点击事件的通知 (CHARTEVENT_MOUSE_MOVE) 到图表上的所有mql5程序</td> <td>bool</td></tr> <tr><td>CHART_EVENT_OBJECT_CREATE</td> <td>发送创建新对象的事件通知 (CHARTEVENT_OBJECT_CREATE) 到图表上的所有mql5程序</td> <td>bool</td></tr> <tr><td>CHART_EVENT_OBJECT_DELETE</td> <td>发送删除对象的事件通知 (CHARTEVENT_OBJECT_DELETE) 到图表上的所有mql5程序</td> <td>bool</td></tr> <tr><td>CHART_MODE</td> <td>图表类型（蜡烛台、字节或线）</td> <td>enum   ENUM_CHART_MODE</td></tr> <tr><td>CHART_FOREGROUND</td> <td>背景的价格图表</td> <td>bool</td></tr> <tr><td>CHART_SHIFT</td> <td>左边缩进价格图表</td> <td>bool</td></tr> <tr><td>CHART_AUTOSCROLL</td> <td>自动移向图表的右边框</td> <td>bool</td></tr> <tr><td>CHART_KEYBOARD_CONTROL</td> <td>可以使用键盘管理图表（&quot;Home&quot;，&quot;End&quot;，&quot;PageUp&quot;，&quot;+&quot;，&quot;-&quot;，&quot;up arrow&quot;等）。设置为 false 的CHART_KEYBOARD_CONTROL在保留接收按下 OnChartEvent()</td> <td>bool</td></tr> <tr><td>CHART_QUICK_NAVIGATION</td> <td>允许图表拦截空格键和回车键来激活快速导航栏。双击鼠标或按下空格/回车键后，快速导航栏自动出现在图表底部。这可以使您快速更改交易品种，时间周期和第一可视栏日期。</td> <td>bool</td></tr> <tr><td>CHART_SCALE</td> <td>测量</td> <td>Int 从0到5</td></tr> <tr><td>CHART_SCALEFIX</td> <td>固定标盘模式</td> <td>bool</td></tr> <tr><td>CHART_SCALEFIX_11</td> <td>测量方式1:1</td> <td>bool</td></tr> <tr><td>CHART_SCALE_PT_PER_BAR</td> <td>每字节指定相关测量</td> <td>bool</td></tr> <tr><td>CHART_SHOW_OHLC</td> <td>在左上角显示OHLC值</td> <td>bool</td></tr> <tr><td>CHART_SHOW_BID_LINE</td> <td>在图表水平线上显示出价值</td> <td>bool</td></tr> <tr><td>CHART_SHOW_ASK_LINE</td> <td>在图表水平线上显示要价值</td> <td>bool</td></tr> <tr><td>CHART_SHOW_LAST_LINE</td> <td>在图表水平线上显示最终值</td> <td>bool</td></tr> <tr><td>CHART_SHOW_PERIOD_SEP</td> <td>在相邻周期显示垂直分离器</td> <td>bool</td></tr> <tr><td>CHART_SHOW_GRID</td> <td>在图表中显示网格</td> <td>bool</td></tr> <tr><td>CHART_SHOW_VOLUMES</td> <td>在图表中显示成交量</td> <td>enum   ENUM_CHART_VOLUME_MODE</td></tr> <tr><td>CHART_SHOW_OBJECT_DESCR</td> <td>显示对象的文本描述 (不可用于所有对象)</td> <td>bool</td></tr> <tr><td>CHART_VISIBLE_BARS</td> <td>图表上显示的字节数量</td> <td>int r/o</td></tr> <tr><td>CHART_WINDOWS_TOTAL</td> <td>图表窗口总数，包括指标预览窗口</td> <td>int r/o</td></tr> <tr><td>CHART_WINDOW_IS_VISIBLE</td> <td>预览窗口可见性</td> <td>bool r/o 修饰符 - 子窗口号</td></tr> <tr><td>CHART_WINDOW_HANDLE</td> <td>处理图表窗口（HWND）</td> <td>int r/o</td></tr> <tr><td>CHART_WINDOW_YDISTANCE</td> <td>指标子窗口的上帧与主图表窗口的上帧之间的距离，沿着Y轴垂直，以像素为单位。在鼠标事件情况下，根据图表主窗口的坐标传递光标坐标，而将指标子窗口的图形对象坐标设置相对于子窗口的左上角。 需要该值是为了将主图表的绝对坐标转换为子窗口的本地坐标，以便图形对象的正确工作，该坐标设置位置相对于子窗口帧的左上角。</td> <td>int r/o 修饰符 - 子窗口号</td></tr> <tr><td>CHART_FIRST_VISIBLE_BAR</td> <td>图表中第一可见字节字符。字节索引同于时序列 。</td> <td>int r/o</td></tr> <tr><td>CHART_WIDTH_IN_BARS</td> <td>以字节转发图表</td> <td>int r/o</td></tr> <tr><td>CHART_WIDTH_IN_PIXELS</td> <td>像素转发图表</td> <td>int r/o</td></tr> <tr><td>CHART_HEIGHT_IN_PIXELS</td> <td>图表像素高度</td> <td>Int 修饰符 - 子窗口号</td></tr> <tr><td>CHART_COLOR_BACKGROUND</td> <td>图表背景颜色</td> <td>color</td></tr> <tr><td>CHART_COLOR_FOREGROUND</td> <td>轴线、缩放和OHLC线的颜色</td> <td>color</td></tr> <tr><td>CHART_COLOR_GRID</td> <td>网格颜色</td> <td>color</td></tr> <tr><td>CHART_COLOR_VOLUME</td> <td>成交量颜色和开仓水平</td> <td>color</td></tr> <tr><td>CHART_COLOR_CHART_UP</td> <td>上升字节、阴影和大型烛台整体边界的颜色</td> <td>color</td></tr> <tr><td>CHART_COLOR_CHART_DOWN</td> <td>下降字节、阴影和支撑烛台的颜色</td> <td>color</td></tr> <tr><td>CHART_COLOR_CHART_LINE</td> <td>折线图颜色和日语烛台躲闪颜色</td> <td>color</td></tr> <tr><td>CHART_COLOR_CANDLE_BULL</td> <td>大型烛台主体颜色</td> <td>color</td></tr> <tr><td>CHART_COLOR_CANDLE_BEAR</td> <td>承受烛台主体颜色</td> <td>color</td></tr> <tr><td>CHART_COLOR_BID</td> <td>出价水平颜色</td> <td>color</td></tr> <tr><td>CHART_COLOR_ASK</td> <td>要价水平颜色</td> <td>color</td></tr> <tr><td>CHART_COLOR_LAST</td> <td>最后执行交易价格水平线颜色（Last）</td> <td>color</td></tr> <tr><td>CHART_COLOR_STOP_LEVEL</td> <td>停止订购水平颜色（斩仓和获利）</td> <td>color</td></tr> <tr><td>CHART_SHOW_TRADE_LEVELS</td> <td>在图表中显示交易水平（开仓水平、斩仓、获利和代办订单）</td> <td>bool</td></tr> <tr><td>CHART_DRAG_TRADE_LEVELS</td> <td>用鼠标在图表上拖拽交易水平的权限。拖拽模式默认启用(true 值)</td> <td>bool</td></tr> <tr><td>CHART_SHOW_DATE_SCALE</td> <td>显示图表的时间比例</td> <td>bool</td></tr> <tr><td>CHART_SHOW_PRICE_SCALE</td> <td>显示图表的价格比例</td> <td>bool</td></tr> <tr><td>CHART_SHOW_ONE_CLICK</td> <td>显示 &quot;单击交易&quot;面板在图表上</td> <td>bool</td></tr> <tr><td>CHART_IS_MAXIMIZED</td> <td>图表窗口最大化</td> <td>bool</td></tr> <tr><td>CHART_IS_MINIMIZED</td> <td>图表窗口最小化</td> <td>bool</td></tr></tbody></table> <p>函数 ChartSetDouble() 和 ChartGetDouble()</p> <p><strong>ENUM_CHART_PROPERTY_DOUBLE</strong></p> <table><thead><tr><th>ID</th> <th>描述</th> <th>性质类型</th></tr></thead> <tbody><tr><td>CHART_SHIFT_SIZE</td> <td>大小在右边百分比边界从零字节缩进</td> <td>double (10%-50%)</td></tr> <tr><td>CHART_FIXED_POSITION</td> <td>图表以百分比定位左边界的位置。在水平时间轴用小的灰白三角形标记定位的图表。只有在禁止进入订单号时图表自动滚到右侧它才会显示 (见 CHART_AUTOSCROLL property)。放大缩小时，定位的柱保留原位。</td> <td>double</td></tr> <tr><td>CHART_FIXED_MAX</td> <td>固定图表最大值</td> <td>double</td></tr> <tr><td>CHART_FIXED_MIN</td> <td>固定图表最小值</td> <td>double</td></tr> <tr><td>CHART_POINTS_PER_BAR</td> <td>测量相关的每个字节</td> <td>double</td></tr> <tr><td>CHART_PRICE_MIN</td> <td>图表最小值</td> <td>double r/o 修饰符 - 子窗口号</td></tr> <tr><td>CHART_PRICE_MAX</td> <td>图表最大值</td> <td>double r/o 修饰符 - 子窗口号</td></tr></tbody></table> <p>ChartSetString() 和 ChartGetString() 函数</p> <p><strong>ENUM_CHART_PROPERTY_STRING</strong></p> <table><thead><tr><th>ID</th> <th>描述</th> <th>性质类型</th></tr></thead> <tbody><tr><td>CHART_COMMENT</td> <td>图表中的评论文本</td> <td>string</td></tr> <tr><td>CHART_EXPERT_NAME</td> <td>在指定chart_id 图表上运行的EA交易的名称</td> <td>string</td></tr> <tr><td>CHART_SCRIPT_NAME</td> <td>在指定chart_id 图表上运行的脚本名称</td> <td>string</td></tr></tbody></table> <p><strong>示例：</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code> <span class="token keyword">int</span> chartMode<span class="token operator">=</span><span class="token function">ChartGetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_MODE<span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token keyword">switch</span><span class="token punctuation">(</span>chartMode<span class="token punctuation">)</span> 
     <span class="token punctuation">{</span> 
      <span class="token keyword">case</span><span class="token punctuation">(</span>CHART_BARS<span class="token punctuation">)</span><span class="token operator">:</span>    <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;CHART_BARS&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token keyword">break</span><span class="token punctuation">;</span> 
      <span class="token keyword">case</span><span class="token punctuation">(</span>CHART_CANDLES<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;CHART_CANDLES&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span> 
      <span class="token keyword">default</span><span class="token operator">:</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;CHART_LINE&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
     <span class="token punctuation">}</span> 
   <span class="token keyword">bool</span> shifted<span class="token operator">=</span><span class="token function">ChartGetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_SHIFT<span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token keyword">if</span><span class="token punctuation">(</span>shifted<span class="token punctuation">)</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;CHART_SHIFT = true&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token keyword">else</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;CHART_SHIFT = false&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token keyword">bool</span> autoscroll<span class="token operator">=</span><span class="token function">ChartGetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_AUTOSCROLL<span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token keyword">if</span><span class="token punctuation">(</span>autoscroll<span class="token punctuation">)</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;CHART_AUTOSCROLL = true&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token keyword">else</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;CHART_AUTOSCROLL = false&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token keyword">int</span> chartHandle<span class="token operator">=</span><span class="token function">ChartGetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_WINDOW_HANDLE<span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;CHART_WINDOW_HANDLE = &quot;</span><span class="token punctuation">,</span>chartHandle<span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token keyword">int</span> windows<span class="token operator">=</span><span class="token function">ChartGetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_WINDOWS_TOTAL<span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;CHART_WINDOWS_TOTAL = &quot;</span><span class="token punctuation">,</span>windows<span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token keyword">if</span><span class="token punctuation">(</span>windows<span class="token operator">&gt;</span><span class="token number">1</span><span class="token punctuation">)</span> 
     <span class="token punctuation">{</span> 
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> windows<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> 
        <span class="token punctuation">{</span> 
         <span class="token keyword">int</span> height<span class="token operator">=</span><span class="token function">ChartGetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_HEIGHT_IN_PIXELS<span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> 
         <span class="token keyword">double</span> priceMin<span class="token operator">=</span><span class="token function">ChartGetDouble</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_PRICE_MIN<span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> 
         <span class="token keyword">double</span> priceMax<span class="token operator">=</span><span class="token function">ChartGetDouble</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_PRICE_MAX<span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> 
         <span class="token function">Print</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token string">&quot;: CHART_HEIGHT_IN_PIXELS = &quot;</span><span class="token punctuation">,</span>height<span class="token punctuation">,</span><span class="token string">&quot; pixels&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
         <span class="token function">Print</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token string">&quot;: CHART_PRICE_MIN = &quot;</span><span class="token punctuation">,</span>priceMin<span class="token punctuation">)</span><span class="token punctuation">;</span> 
         <span class="token function">Print</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token string">&quot;: CHART_PRICE_MAX = &quot;</span><span class="token punctuation">,</span>priceMax<span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token punctuation">}</span> 
     <span class="token punctuation">}</span>          
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>另见</p> <p>使用图表示例</p> <h3 id="_2-1-4-定位常量"><a href="#_2-1-4-定位常量" class="header-anchor">#</a> 2.1.4 定位常量</h3> <p>ENUM_CHART_POSITION 列表中的三个标识符有可能是ChartNavigate()函数的位置参数的值。</p> <p><strong>ENUM_CHART_POSITION</strong></p> <table><thead><tr><th>ID</th> <th>描述</th></tr></thead> <tbody><tr><td>CHART_BEGIN</td> <td>图表开始（最原始价位）</td></tr> <tr><td>CHART_CURRENT_POS</td> <td>当前位置</td></tr> <tr><td>CHART_END</td> <td>图表末尾（当前价格）</td></tr></tbody></table> <p><strong>示例：</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code> <span class="token keyword">long</span> handle<span class="token operator">=</span><span class="token function">ChartOpen</span><span class="token punctuation">(</span><span class="token string">&quot;EURUSD&quot;</span><span class="token punctuation">,</span>PERIOD_H12<span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token keyword">if</span><span class="token punctuation">(</span>handle<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span> 
     <span class="token punctuation">{</span> 
      <span class="token function">ChartSetInteger</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span>CHART_AUTOSCROLL<span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token function">ChartSetInteger</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span>CHART_SHIFT<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token function">ChartSetInteger</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span>CHART_MODE<span class="token punctuation">,</span>CHART_LINE<span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token function">ResetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token keyword">bool</span> res<span class="token operator">=</span><span class="token function">ChartNavigate</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span>CHART_END<span class="token punctuation">,</span><span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>res<span class="token punctuation">)</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Navigate failed. Error = &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token function">ChartRedraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
     <span class="token punctuation">}</span>          
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="_2-1-5-图表陈述-表示"><a href="#_2-1-5-图表陈述-表示" class="header-anchor">#</a> 2.1.5 图表陈述(表示)</h3> <p>价格图表可以用以下三种方式陈列(表示)：
• 棒线图；
• 蜡烛图；
• 折线图。</p> <p>显示价格图表的具体方法是由函数ChartSetInteger(chart_handle、CHART_MODE、CHART_MODE)设置的，其中CHART_MODE是ENUM_CHART_MODE枚举的值之一。</p> <p><strong>ENUM_CHART_MODE</strong></p> <table><thead><tr><th>ID</th> <th>描述</th></tr></thead> <tbody><tr><td>CHART_BARS</td> <td>显示为序列棒线</td></tr> <tr><td>CHART_CANDLES</td> <td>显示日本蜡烛图</td></tr> <tr><td>CHART_LINE</td> <td>以收盘价格显示折线图</td></tr></tbody></table> <p>要在指定的报价图表中显示成交量的方法是，使用函数ChartSetInteger(chart_handle, chart_show_volume, volume_mode)，其中volume_mode是ENUM_CHART_VOLUME_MODE枚举的值之一。</p> <p><strong>ENUM_CHART_VOLUME_MODE</strong></p> <table><thead><tr><th>ID</th> <th>描述</th></tr></thead> <tbody><tr><td>CHART_VOLUME_HIDE</td> <td>成交量隐藏</td></tr> <tr><td>CHART_VOLUME_TICK</td> <td>最小价格成交量</td></tr> <tr><td>CHART_VOLUME_REAL</td> <td>交易成交量</td></tr></tbody></table> <p><strong>示例：</strong></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//--- 获得当前图表处理权 </span>
   <span class="token keyword">long</span> handle<span class="token operator">=</span><span class="token function">ChartID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token keyword">if</span><span class="token punctuation">(</span>handle<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// 如果成功，加上自定义 </span>
     <span class="token punctuation">{</span> 
      <span class="token comment">//--- 禁止自动滚动 </span>
      <span class="token function">ChartSetInteger</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span>CHART_AUTOSCROLL<span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token comment">//--- 设置图表右缩进 </span>
      <span class="token function">ChartSetInteger</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span>CHART_SHIFT<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token comment">//--- 显示蜡烛图 </span>
      <span class="token function">ChartSetInteger</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span>CHART_MODE<span class="token punctuation">,</span>CHART_CANDLES<span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token comment">//--- 从历史记录起始位置按100柱为一页滚动 </span>
      <span class="token function">ChartNavigate</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span>CHART_CURRENT_POS<span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token comment">//--- 设置订单交易量显示模式 </span>
      <span class="token function">ChartSetInteger</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span>CHART_SHOW_VOLUMES<span class="token punctuation">,</span>CHART_VOLUME_TICK<span class="token punctuation">)</span><span class="token punctuation">;</span> 
     <span class="token punctuation">}</span>          
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>另见：</p> <p>打开图表 ， 图表ID</p> <h3 id="_2-1-6-使用图表示例"><a href="#_2-1-6-使用图表示例" class="header-anchor">#</a> 2.1.6 使用图表示例</h3> <p>本节包含使用图表属性工作的示例。每个属性显示一个或两个完整的函数。这些函数允许设置/接收属性的值。这些函数可以在自定义的mql5应用程序中使用,可以被使用&quot;as is&quot;。</p> <p>下面的屏幕截图展示了图形面板，说明了图表属性的变化是如何改变其外观的。单击Next按钮，可以设置相应属性的新值，并查看图表窗口中的变化。</p> <p><img src="/mql5yao/assets/img/2.1.b2ff1437.jpg" alt="Alt text"></p> <p>面板的完整源代码位于 本节最后部分。</p> <p>图表属性和使用它们的样本函数
•CHART_IS_OBJECT 定义对象是否是真实图表或是 图形对象。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+ 
//| 定义对象是否是图表。如果它是                                        | 
//| 图形对象，则结果为true。如果它是真实                                | 
//| 图表，则结果变量为false值。                                        | 
//+------------------------------------------------------------------+ 
bool ChartIsObject(bool &amp;result,const long chart_ID=0) 
  { 
//--- 准备变量获得属性值 
   long value; 
//--- 重置错误的值 
   ResetLastError(); 
//--- 获得图表属性 
   if(!ChartGetInteger(chart_ID,CHART_IS_OBJECT,0,value)) 
     { 
      //--- 在EA日志显示错误信息 
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError()); 
      //--- 返回 false 
      return(false); 
     } 
//--- 在内存中存储图表属性的值 
   result=value; 
//--- 成功执行 
   return(true); 
  }          
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>•CHART_BRING_TO_TOP 显示所有其他图表的顶部的图表。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+----------------------------------------------------------------------+ 
//| 发送命令到程序端展示所有其他图表上面的图表。                             | 
//+----------------------------------------------------------------------+ 
bool ChartBringToTop(const long chart_ID=0) 
  { 
//--- 重置错误的值 
   ResetLastError(); 
//--- 显示所有其他图表的顶部的图表 
   if(!ChartSetInteger(chart_ID,CHART_BRING_TO_TOP,0,true)) 
     { 
      //--- 在EA日志显示错误信息 
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError()); 
      return(false); 
     } 
//--- 成功执行 
   return(true); 
  }          
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>•CHART_MOUSE_SCROLL 使用鼠标左键滚动图表的属性。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+--------------------------------------------------------------------------+ 
//| 该函数定义了使用鼠标左键滚动图表是否                                        | 
//| 被启用。                                                                 | 
//+--------------------------------------------------------------------------+ 
bool ChartMouseScrollGet(bool &amp;result,const long chart_ID=0) 
  { 
//--- 准备变量获得属性值 
   long value; 
//--- 重置错误的值 
   ResetLastError(); 
//--- 接收属性值 
   if(!ChartGetInteger(chart_ID,CHART_MOUSE_SCROLL,0,value)) 
     { 
      //--- 在EA日志显示错误信息 
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError()); 
      return(false); 
     } 
//--- 在内存中存储图表属性的值 
   result=value; 
//--- 成功执行 
   return(true); 
  } 
//+--------------------------------------------------------------------+ 
//| 该函数启用/禁用使用鼠标左键滚动图表。                                 | 
//+--------------------------------------------------------------------+ 
bool ChartMouseScrollSet(const bool value,const long chart_ID=0) 
  { 
//--- 重置错误的值 
   ResetLastError(); 
//--- 设置属性值 
   if(!ChartSetInteger(chart_ID,CHART_MOUSE_SCROLL,0,value)) 
     { 
      //--- 在EA日志显示错误信息 
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError()); 
      return(false); 
     } 
//--- 成功执行 
   return(true); 
  }          
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><p>•CHART_EVENT_MOUSE_MOVE  是发送有关移动事件和鼠标点击mql5应用程序 (CHARTEVENT_MOUSE_MOVE)的信息的属性。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+ 
//| 检查有关移动事件和鼠标点击的信息                                    | 
//| 被发送到图表上的所有mql5应用程序                                    | 
//+------------------------------------------------------------------+ 
bool ChartEventMouseMoveGet(bool &amp;result,const long chart_ID=0) 
  { 
//--- 准备变量获得属性值 
   long value; 
//--- 重置错误的值 
   ResetLastError(); 
//--- 接收属性值 
   if(!ChartGetInteger(chart_ID,CHART_EVENT_MOUSE_MOVE,0,value)) 
     { 
      //--- 在EA日志显示错误信息 
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError()); 
      return(false); 
     } 
//--- 在内存中存储图表属性的值 
   result=value; 
//--- 成功执行 
   return(true); 
  } 
//+------------------------------------------------------------------------------+ 
//| 该函数启用/禁用发送信息模式，有关移动                                           | 
//| 事件和在图表上鼠标点击mql5应用程序。                                            | 
//+------------------------------------------------------------------------------+ 
bool ChartEventMouseMoveSet(const bool value,const long chart_ID=0) 
  { 
//--- 重置错误的值 
   ResetLastError(); 
//--- 设置属性值 
   if(!ChartSetInteger(chart_ID,CHART_EVENT_MOUSE_MOVE,0,value)) 
     { 
      //--- 在EA日志显示错误信息 
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError()); 
      return(false); 
     } 
//--- 成功执行 
   return(true); 
  }          
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><p>•CHART_EVENT_OBJECT_CREATE 是发送有关创建图形对象事件到mql5应用程序 (CHARTEVENT_OBJECT_CREATE)的信息的属性。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+---------------------------------------------------------------------+ 
//| 检查是否有关创建图形对象事件的信息                                     | 
//| 被发送到图表上的所有mql5应用程序                                      | 
//+---------------------------------------------------------------------+ 
bool ChartEventObjectCreateGet(bool &amp;result,const long chart_ID=0) 
  { 
//--- 准备变量获得属性值 
   long value; 
//--- 重置错误的值 
   ResetLastError(); 
//--- 接收属性值 
   if(!ChartGetInteger(chart_ID,CHART_EVENT_OBJECT_CREATE,0,value)) 
     { 
      //--- 在EA日志显示错误信息 
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError()); 
      return(false); 
     } 
//--- 在内存中存储图表属性的值 
   result=value; 
//--- 成功执行 
   return(true); 
  } 
//+--------------------------------------------------------------------------+ 
//| 该函数启用/禁用发送信息模式，有关                                           | 
//| 图形对象创建事件到图表上所有的mql5应用程序。                                 | 
//+--------------------------------------------------------------------------+ 
bool ChartEventObjectCreateSet(const bool value,const long chart_ID=0) 
  { 
//--- 重置错误的值 
   ResetLastError(); 
//--- 设置属性值 
   if(!ChartSetInteger(chart_ID,CHART_EVENT_OBJECT_CREATE,0,value)) 
     { 
      //--- 在EA日志显示错误信息 
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError()); 
      return(false); 
     } 
//--- 成功执行 
   return(true); 
  }          
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><p>•CHART_EVENT_OBJECT_DELETE 是发送有关图表对象删除事件到mql5应用程序(CHARTEVENT_OBJECT_DELETE)的信息的属性。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+---------------------------------------------------------------------+ 
//| 检查有关图形对象删除事件的信息                                         | 
//| 被发送到图表上的所有mql5应用程序                                       | 
//+---------------------------------------------------------------------+ 
bool ChartEventObjectDeleteGet(bool &amp;result,const long chart_ID=0) 
  { 
//--- 准备变量获得属性值 
   long value; 
//--- 重置错误的值 
   ResetLastError(); 
//--- 接收属性值 
   if(!ChartGetInteger(chart_ID,CHART_EVENT_OBJECT_DELETE,0,value)) 
     { 
      //--- 在EA日志显示错误信息 
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError()); 
      return(false); 
     } 
//--- 在内存中存储图表属性的值 
   result=value; 
//--- 成功执行 
   return(true); 
  } 
//+--------------------------------------------------------------------------+ 
//| 该函数启用/禁用发送信息模式，有关                                           | 
//| 发送至所有mql5应用程序的图形对象删除事件的信息。                             | 
//+--------------------------------------------------------------------------+ 
bool ChartEventObjectDeleteSet(const bool value,const long chart_ID=0) 
  { 
//--- 重置错误的值 
   ResetLastError(); 
//--- 设置属性值 
   if(!ChartSetInteger(chart_ID,CHART_EVENT_OBJECT_DELETE,0,value)) 
     { 
      //--- 在EA日志显示错误信息 
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError()); 
      return(false); 
     } 
//--- 成功执行 
   return(true); 
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><p>•CHART_MODE —— 图表类型（蜡烛图，棒线图 或 折线图）。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+ 
//| 获得图表展示类型（蜡烛图，柱形图或                                  | 
//| 线型图）。                                                        | 
//+------------------------------------------------------------------+ 
ENUM_CHART_MODE ChartModeGet(const long chart_ID=0) 
  { 
//--- 准备变量获得属性值 
   long result=WRONG_VALUE; 
//--- 重置错误的值 
   ResetLastError(); 
//--- 接收属性值 
   if(!ChartGetInteger(chart_ID,CHART_MODE,0,result)) 
     { 
      //--- 在EA日志显示错误信息 
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError()); 
     } 
//--- 返回图表属性值 
   return((ENUM_CHART_MODE)result); 
  } 
//+------------------------------------------------------------------+ 
//| 设置图表显示类型（蜡烛图，柱形图或                                  | 
//| 线型图）。                                                        | 
//+------------------------------------------------------------------+ 
bool ChartModeSet(const long value,const long chart_ID=0) 
  { 
//--- 重置错误的值 
   ResetLastError(); 
//--- 设置属性值 
   if(!ChartSetInteger(chart_ID,CHART_MODE,value)) 
     { 
      //--- 在EA日志显示错误信息 
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError()); 
      return(false); 
     } 
//--- 成功执行 
   return(true); 
  }
//+------------------------------------------------------------------+ 
//| 获得图表展示类型（蜡烛图，柱形图或                                  | 
//| 线型图）。                                                        | 
//+------------------------------------------------------------------+ 
ENUM_CHART_MODE ChartModeGet(const long chart_ID=0) 
  { 
//--- 准备变量获得属性值 
   long result=WRONG_VALUE; 
//--- 重置错误的值 
   ResetLastError(); 
//--- 接收属性值 
   if(!ChartGetInteger(chart_ID,CHART_MODE,0,result)) 
     { 
      //--- 在EA日志显示错误信息 
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError()); 
     } 
//--- 返回图表属性值 
   return((ENUM_CHART_MODE)result); 
  } 
//+------------------------------------------------------------------+ 
//| 设置图表显示类型（蜡烛图，柱形图或                                  | 
//| 线型图）。                                                        | 
//+------------------------------------------------------------------+ 
bool ChartModeSet(const long value,const long chart_ID=0) 
  { 
//--- 重置错误的值 
   ResetLastError(); 
//--- 设置属性值 
   if(!ChartSetInteger(chart_ID,CHART_MODE,value)) 
     { 
      //--- 在EA日志显示错误信息 
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError()); 
      return(false); 
     } 
//--- 成功执行 
   return(true); 
  }          
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br></div></div><p>•CHART_FOREGROUND是在前台显示价格图表的属性。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+ 
//| 该函数定义是否价格图表显示在                                        | 
//| 前台。                                                            | 
//+------------------------------------------------------------------+ 
bool ChartForegroundGet(bool &amp;result,const long chart_ID=0) 
  { 
//--- 准备变量获得属性值 
   long value; 
//--- 重置错误的值 
   ResetLastError(); 
//--- 接收属性值 
   if(!ChartGetInteger(chart_ID,CHART_FOREGROUND,0,value)) 
     { 
      //--- 在EA日志显示错误信息 
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError()); 
      return(false); 
     } 
//--- 在内存中存储图表属性的值 
   result=value; 
//--- 成功执行 
   return(true); 
  } 
//+---------------------------------------------------------------------------+ 
//| 函数启用/禁用价格图表展示模式在                                              | 
//| 前台。                                                                     | 
//+---------------------------------------------------------------------------+ 
bool ChartForegroundSet(const bool value,const long chart_ID=0) 
  { 
//--- 重置错误的值 
   ResetLastError(); 
//--- 设置属性值 
   if(!ChartSetInteger(chart_ID,CHART_FOREGROUND,0,value)) 
     { 
      //--- 在EA日志显示错误信息 
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError()); 
      return(false); 
     } 
//--- 成功执行 
   return(true); 
  }0         
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><p>•CHART_SHIFT —— 从右边缘移动价格图表的模式。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------------------------+ 
//| 函数定义是否从右边缘移动价格图表的模式                                                 | 
//| 被启用。                                                                            | 
//+------------------------------------------------------------------------------------+ 
bool ChartShiftGet(bool &amp;result,const long chart_ID=0) 
  { 
//--- 准备变量获得属性值 
   long value; 
//--- 重置错误的值 
   ResetLastError(); 
//--- 接收属性值 
   if(!ChartGetInteger(chart_ID,CHART_SHIFT,0,value)) 
     { 
      //--- 在EA日志显示错误信息 
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError()); 
      return(false); 
     } 
//--- 在内存中存储图表属性的值 
   result=value; 
//--- 成功执行 
   return(true); 
  } 
//+--------------------------------------------------------------------------+ 
//| 函数启用/禁用价格图表展示模式                                          | 
//| 从右边缘开始移动。                                                      | 
//+--------------------------------------------------------------------------+ 
bool ChartShiftSet(const bool value,const long chart_ID=0) 
  { 
//--- 重置错误的值 
   ResetLastError(); 
//--- 设置属性值 
   if(!ChartSetInteger(chart_ID,CHART_SHIFT,0,value)) 
     { 
      //--- 在EA日志显示错误信息 
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError()); 
      return(false); 
     } 
//--- 成功执行 
   return(true); 
  }          
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><p>CHART_AUTOSCROLL —— 自动移动到图表右边缘的模式。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+---------------------------------------------------------------------+ 
//| 函数定义了新报价进入时是否启用                                         | 
//| 图表向右的自动滚动模式。                                              | 
//+---------------------------------------------------------------------+ 
bool ChartAutoscrollGet(bool &amp;result,const long chart_ID=0) 
  { 
//--- 准备变量获得属性值 
   long value; 
//--- 重置错误的值 
   ResetLastError(); 
//--- 接收属性值 
   if(!ChartGetInteger(chart_ID,CHART_AUTOSCROLL,0,value)) 
     { 
      //--- 在EA日志显示错误信息 
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError()); 
      return(false); 
     } 
//--- 在内存中存储图表属性的值 
   result=value; 
//--- 成功执行 
   return(true); 
  } 
//+------------------------------------------------------------------+ 
//| 该函数启用/禁用新报价进入时，图表向右的                             | 
//| 自动滚动模式。                                                    | 
//+------------------------------------------------------------------+ 
bool ChartAutoscrollSet(const bool value,const long chart_ID=0) 
  { 
//--- 重置错误的值 
   ResetLastError(); 
//--- 设置属性值 
   if(!ChartSetInteger(chart_ID,CHART_AUTOSCROLL,0,value)) 
     { 
      //--- 在EA日志显示错误信息 
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError()); 
      return(false); 
     } 
//--- 成功执行 
   return(true); 
  }          
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><p>•CHART_SCALE —— 图表比例属性。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+ 
//| 获得图表比例（从0到5）。                                           | 
//+------------------------------------------------------------------+ 
int ChartScaleGet(const long chart_ID=0) 
  { 
//--- 准备变量获得属性值 
   long result=-1; 
//--- 重置错误的值 
   ResetLastError(); 
//--- 接收属性值 
   if(!ChartGetInteger(chart_ID,CHART_SCALE,0,result)) 
     { 
      //--- 在EA日志显示错误信息 
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError()); 
     } 
//--- 返回图表属性值 
   return((int)result); 
  } 
//+------------------------------------------------------------------+ 
//| 设置图表比例（从0到5）。                                           | 
//+------------------------------------------------------------------+ 
bool ChartScaleSet(const long value,const long chart_ID=0) 
  { 
//--- 重置错误的值 
   ResetLastError(); 
//--- 设置属性值 
   if(!ChartSetInteger(chart_ID,CHART_SCALE,0,value)) 
     { 
      //--- 在EA日志显示错误信息 
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError()); 
      return(false); 
     } 
//--- 成功执行 
   return(true); 
  }          
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p>•CHART_SCALEFIX —— 固定图表比例模式。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+ 
//| 函数定义了是否启用固定比例模式。                                    | 
//+------------------------------------------------------------------+ 
bool ChartScaleFixGet(bool &amp;result,const long chart_ID=0) 
  { 
//--- 准备变量获得属性值 
   long value; 
//--- 重置错误的值 
   ResetLastError();
//--- 接收属性值 
   if(!ChartGetInteger(chart_ID,CHART_SCALEFIX,0,value)) 
     { 
      //--- 在EA日志显示错误信息 
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError()); 
      return(false); 
     } 
//--- 在内存中存储图表属性的值 
   result=value; 
//--- 成功执行 
   return(true); 
  } 
//+------------------------------------------------------------------+ 
//| 函数启用/禁用固定比例模式。                                        | 
//+------------------------------------------------------------------+ 
bool ChartScaleFixSet(const bool value,const long chart_ID=0) 
  { 
//--- 重置错误的值 
   ResetLastError(); 
//--- 设置属性值 
   if(!ChartSetInteger(chart_ID,CHART_SCALEFIX,0,value)) 
     { 
      //--- 在EA日志显示错误信息 
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError()); 
      return(false); 
     } 
//--- 成功执行 
   return(true); 
  }          
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p>•CHART_SCALEFIX_11 —— 1:1 图表比例模式。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+ 
//| 该函数定义了是否启用“1:1”比例。                                    | 
//+------------------------------------------------------------------+ 
bool ChartScaleFix11Get(bool &amp;result,const long chart_ID=0) 
  { 
//--- 准备变量获得属性值 
   long value; 
//--- 重置错误的值 
   ResetLastError(); 
//--- 接收属性值 
   if(!ChartGetInteger(chart_ID,CHART_SCALEFIX_11,0,value)) 
     { 
      //--- 在EA日志显示错误信息 
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError()); 
      return(false); 
     } 
//--- 在内存中存储图表属性的值 
   result=value; 
//--- 成功执行 
   return(true); 
  } 
//+------------------------------------------------------------------+ 
//| 函数启用/禁用“1:1”比例模式                                         | 
//+------------------------------------------------------------------+ 
bool ChartScaleFix11Set(const bool value,const long chart_ID=0) 
  { 
//--- 重置错误的值 
   ResetLastError(); 
//--- 设置属性值 
   if(!ChartSetInteger(chart_ID,CHART_SCALEFIX_11,0,value)) 
     { 
      //--- 在EA日志显示错误信息 
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError()); 
      return(false); 
     } 
//--- 成功执行 
   return(true); 
  }          
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p>•CHART_SCALE_PT_PER_BAR —— 指定每柱图表比例点数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------------------+ 
//| 函数定义了是否启用指定每柱图表比例点数的                                         | 
//| 模式。                                                                        | 
//+------------------------------------------------------------------------------+ 
bool ChartScalePerBarGet(bool &amp;result,const long chart_ID=0) 
  { 
//--- 准备变量获得属性值 
   long value; 
//--- 重置错误的值 
   ResetLastError(); 
//--- 接收属性值 
   if(!ChartGetInteger(chart_ID,CHART_SCALE_PT_PER_BAR,0,value)) 
     { 
      //--- 在EA日志显示错误信息 
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError()); 
      return(false); 
     } 
//--- 在内存中存储图表属性的值 
   result=value; 
//--- 成功执行 
   return(true); 
  } 
//+------------------------------------------------------------------------------------+ 
//| 函数启用/禁用指定每柱图表比例点数的                                                   | 
//| 模式。                                                                             | 
//+------------------------------------------------------------------------------------+ 
bool ChartScalePerBarSet(const bool value,const long chart_ID=0) 
  { 
//--- 重置错误的值 
   ResetLastError(); 
//--- 设置属性值 
   if(!ChartSetInteger(chart_ID,CHART_SCALE_PT_PER_BAR,0,value)) 
     { 
      //--- 在EA日志显示错误信息 
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError()); 
      return(false); 
     } 
//--- 成功执行 
   return(true); 
  }          
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><p>•CHART_SHOW_OHLC —— 在左上角展示OHLC值的属性。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+
//| 函数定义了是否启用在左上角展示OHLC值                                  |
//| 的模式。                                                           |
//+------------------------------------------------------------------+
bool ChartShowOHLCGet(bool &amp;result,const long chart_ID=0)
  {
//--- 准备变量获得属性值
   long value;
//--- 重置错误的值
   ResetLastError();
//--- 接收属性值
   if(!ChartGetInteger(chart_ID,CHART_SHOW_OHLC,0,value))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 在内存中存储图表属性的值
   result=value;
//--- 成功执行
   return(true);
  }
//+--------------------------------------------------------------------------+
//| 该函数启用/禁用在图表左上角显示OHLC值                                         |
//| 的模式。                                                                   |
//+--------------------------------------------------------------------------+
bool ChartShowOHLCSet(const bool value,const long chart_ID=0)
  {
//--- 重置错误的值
   ResetLastError();
//--- 设置属性值
   if(!ChartSetInteger(chart_ID,CHART_SHOW_OHLC,0,value))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><p>•CHART_SHOW_BID_LINE —— 图表水平线显示卖价值的属性</p> <div class="language- line-numbers-mode"><pre class="language-text"><code> //+-----------------------------------------------------------------------------+
//| 函数定义了在图表展示卖价值的模式是否                                             |
//| 被启用。                                                                      |
//+-----------------------------------------------------------------------------+
bool ChartShowBidLineGet(bool &amp;result,const long chart_ID=0)
  {
//--- 准备变量获得属性值
   long value;
//--- 重置错误的值
   ResetLastError();
//--- 接收属性值
   if(!ChartGetInteger(chart_ID,CHART_SHOW_BID_LINE,0,value))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 在内存中存储图表属性的值
   result=value;
//--- 成功执行
   return(true);
  }
//+--------------------------------------------------------------------+
//| 该函数启用/禁用在图表上展示卖价行的模式。                                |
//+--------------------------------------------------------------------+
bool ChartShowBidLineSet(const bool value,const long chart_ID=0)
  {
//--- 重置错误的值
   ResetLastError();
//--- 设置属性值
   if(!ChartSetInteger(chart_ID,CHART_SHOW_BID_LINE,0,value))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><p>•CHART_SHOW_ASK_LINE —— 图表水平线显示买价值的属性</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+-----------------------------------------------------------------------+
//| 函数定义了是否启用在图表上展示买价值线的模式。                               |
//+-----------------------------------------------------------------------+
bool ChartShowAskLineGet(bool &amp;result,const long chart_ID=0)
  {
//--- 准备变量获得属性值
   long value;
//--- 重置错误的值
   ResetLastError();
//--- 接收属性值
   if(!ChartGetInteger(chart_ID,CHART_SHOW_ASK_LINE,0,value))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 在内存中存储图表属性的值
   result=value;
//--- 成功执行
   return(true);
  }
//+-----------------------------------------------------------------------+
//| 该函数启用/禁用在图表上显示买价行的模式。                                   |
//+-----------------------------------------------------------------------+
bool ChartShowAskLineSet(const bool value,const long chart_ID=0)
  {
//--- 重置错误的值
   ResetLastError();
//--- 设置属性值
   if(!ChartSetInteger(chart_ID,CHART_SHOW_ASK_LINE,0,value))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p>•CHART_SHOW_LAST_LINE—— 图表水平线显示最近值的属性</p> <div class="language- line-numbers-mode"><pre class="language-text"><code> //+---------------------------------------------------------------------------------+
//| 该函数定义了是否启用显示最近执行的交易的价格行模式。                                    |
//+---------------------------------------------------------------------------------+
bool ChartShowLastLineGet(bool &amp;result,const long chart_ID=0)
  {
//--- 准备变量获得属性值
   long value;
//--- 重置错误的值
   ResetLastError();
//--- 接收属性值
   if(!ChartGetInteger(chart_ID,CHART_SHOW_LAST_LINE,0,value))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 在内存中存储图表属性的值
   result=value;
//--- 成功执行
   return(true);
  }
//+--------------------------------------------------------------------------------------+
//| 函数启用/禁用显示最近执行的交易的价格行模式。                                               |
//+--------------------------------------------------------------------------------------+
bool ChartShowLastLineSet(const bool value,const long chart_ID=0)
  {
//--- 重置错误的值
   ResetLastError();
//--- 设置属性值
   if(!ChartSetInteger(chart_ID,CHART_SHOW_LAST_LINE,0,value))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p>•CHART_SHOW_PERIOD_SEP—— 在相邻周期间展示垂直分隔符的属性</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+
//| 该函数定义了是否启用在相邻周期间                                      |
//| 展示垂直分隔符的模式。                                               |
//+------------------------------------------------------------------+
bool ChartShowPeriodSeparatorGet(bool &amp;result,const long chart_ID=0)
  {
//--- 准备变量获得属性值
   long value;
//--- 重置错误的值
   ResetLastError();
//--- 接收属性值
   if(!ChartGetInteger(chart_ID,CHART_SHOW_PERIOD_SEP,0,value))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 在内存中存储图表属性的值
   result=value;
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//|该函数启用/禁用在相邻周期间                                           |
//| 展示垂直分隔符的模式。                                               |
//+------------------------------------------------------------------+
bool ChartShowPeriodSepapatorSet(const bool value,const long chart_ID=0)
  {
//--- 重置错误的值
   ResetLastError();
//--- 设置属性值
   if(!ChartSetInteger(chart_ID,CHART_SHOW_PERIOD_SEP,0,value))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><p>•CHART_SHOW_GRID —— 展示图表网格的属性。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+
//| 该函数定义了是否展示图表网格。                                        |
//+------------------------------------------------------------------+
bool ChartShowGridGet(bool &amp;result,const long chart_ID=0)
  {
//--- 准备变量获得属性值
   long value;
//--- 重置错误的值
   ResetLastError();
//--- 接收属性值
   if(!ChartGetInteger(chart_ID,CHART_SHOW_GRID,0,value))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 在内存中存储图表属性的值
   result=value;
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 该函数启用/禁用图表网格。                                            |
//+------------------------------------------------------------------+
bool ChartShowGridSet(const bool value,const long chart_ID=0)
  {
//--- 重置错误的值
   ResetLastError();
//--- 设置属性值
   if(!ChartSetInteger(chart_ID,CHART_SHOW_GRID,0,value))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p>•CHART_SHOW_VOLUMES —— 在图表上展示交易量的属性。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code> //+------------------------------------------------------------------------+
//| 该函数定义了是否在图表上展示交易量（不                                       |
//| 显示，显示订单交易量，显示实际交易量）。                                       |
//+------------------------------------------------------------------------+
ENUM_CHART_VOLUME_MODE ChartShowVolumesGet(const long chart_ID=0)
  {
//--- 准备变量获得属性值
   long result=WRONG_VALUE;
//--- 重置错误的值
   ResetLastError();
//--- 接收属性值
   if(!ChartGetInteger(chart_ID,CHART_SHOW_VOLUMES,0,result))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
     }
//--- 返回图表属性值
   return((ENUM_CHART_VOLUME_MODE)result);
  }
//+------------------------------------------------------------------+
//| 该函数设置在图表上显示交易量的模式。                                   |
//+------------------------------------------------------------------+
bool ChartShowVolumesSet(const long value,const long chart_ID=0)
  {
//--- 重置错误的值
   ResetLastError();
//--- 设置属性值
   if(!ChartSetInteger(chart_ID,CHART_SHOW_VOLUMES,value))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><p>•CHART_SHOW_OBJECT_DESCR —— 图形对象弹出描述的属性。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+-------------------------------------------------------------------+
//| 函数定义了悬停鼠标时是否显示                                          |
//| 图形对象的弹出描述 。                                                 |
//+-------------------------------------------------------------------+
bool ChartShowObjectDescriptionGet(bool &amp;result,const long chart_ID=0)
  {
//--- 准备变量获得属性值
   long value;
//--- 重置错误的值
   ResetLastError();
//--- 接收属性值
   if(!ChartGetInteger(chart_ID,CHART_SHOW_OBJECT_DESCR,0,value))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 在内存中存储图表属性的值
   result=value;
//--- 成功执行
   return(true);
  }
//+--------------------------------------------------------------------------+
//| 该函数启用/禁用鼠标悬停时                                                    |
//| 显示图形对象弹出描述的模式。                                                  |
//+--------------------------------------------------------------------------+
bool ChartShowObjectDescriptionSet(const bool value,const long chart_ID=0)
  {
//--- 重置错误的值
   ResetLastError();
//--- 设置属性值
   if(!ChartSetInteger(chart_ID,CHART_SHOW_OBJECT_DESCR,0,value))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><p>•CHART_VISIBLE_BARS —— 定义图表上可用于展示的柱的数量。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+-----------------------------------------------------------------------+
//| 函数接收图表窗口中                                                      |
//| 显示的柱数（可见）。                                                       |
//+-----------------------------------------------------------------------+
int ChartVisibleBars(const long chart_ID=0)
  {
//--- 准备变量获得属性值
   long result=-1;
//--- 重置错误的值
   ResetLastError();
//--- 接收属性值
   if(!ChartGetInteger(chart_ID,CHART_VISIBLE_BARS,0,result))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
     }
//--- 返回图表属性值
   return((int)result);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>•CHART_WINDOWS_TOTAL—— 定义包括指标子窗口的图表窗口总数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+--------------------------------------------------------------------------+
//| 该函数获得所有图表窗口的总数包括指标                                          |
//| 子窗口。                                                                   |
//+--------------------------------------------------------------------------+
int ChartWindowsTotal(const long chart_ID=0)
  {
//--- 准备变量获得属性值
   long result=-1;
//--- 重置错误的值
   ResetLastError();
//--- 接收属性值
   if(!ChartGetInteger(chart_ID,CHART_WINDOWS_TOTAL,0,result))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
     }
//--- 返回图表属性值
   return((int)result);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>•CHART_WINDOW_IS_VISIBLE —— 定义子窗口的可视性。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+
//| 该函数定义了当前图表窗口或子窗口是否                                  |
//| 可见。                                                            |
//+------------------------------------------------------------------+
bool ChartWindowsIsVisible(bool &amp;result,const long chart_ID=0,const int sub_window=0)
  {
//--- 准备变量获得属性值
   long value;
//--- 重置错误的值
   ResetLastError();
//--- 接收属性值
   if(!ChartGetInteger(chart_ID,CHART_WINDOW_IS_VISIBLE,sub_window,value))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 在内存中存储图表属性的值
   result=value;
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>•CHART_WINDOW_HANDLE —— 返回图表句柄。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+
//| 函数获取图表句柄                                                   |
//+------------------------------------------------------------------+
int ChartWindowsHandle(const long chart_ID=0)
  {
//--- 准备变量获得属性值
   long result=-1;
//--- 重置错误的值
   ResetLastError();
//--- 接收属性值
   if(!ChartGetInteger(chart_ID,CHART_WINDOW_HANDLE,0,result))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
     }
//--- 返回图表属性值
   return((int)result);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>•CHART_WINDOW_YDISTANCE —— 定义指标子窗口上边框和图表主窗口上边框之间的像素距离。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+
//| 该函数获得子窗口上边框和                                            |
//| 图表主窗口上边框之间的像素距离。                                      |
//+------------------------------------------------------------------+
int ChartWindowsYDistance(const long chart_ID=0,const int sub_window=0)
  {
//--- 准备变量获得属性值
   long result=-1;
//--- 重置错误的值
   ResetLastError();
//--- 接收属性值
   if(!ChartGetInteger(chart_ID,CHART_WINDOW_YDISTANCE,sub_window,result))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
     }
//--- 返回图表属性值
   return((int)result);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>•CHART_FIRST_VISIBLE_BAR —— 返回图表上最先可见的柱的数量（与 时间序列相关的柱）。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+----------------------------------------------------------------------------+
//| 该函数接收图表上最先可见的柱数。                                                |
//| 像在时间序列一样执行索引，最近的柱指数更小。                                      |
//+----------------------------------------------------------------------------+
int ChartFirstVisibleBar(const long chart_ID=0)
  {
//--- 准备变量获得属性值
   long result=-1;
//--- 重置错误的值
   ResetLastError();
//--- 接收属性值
   if(!ChartGetInteger(chart_ID,CHART_FIRST_VISIBLE_BAR,0,result))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
     }
//--- 返回图表属性值
   return((int)result);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>•CHART_WIDTH_IN_BARS —— 返回图表柱形宽度。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+
//| 函数接收图表柱形宽度。                                               |
//+------------------------------------------------------------------+
int ChartWidthInBars(const long chart_ID=0)
  {
//--- 准备变量获得属性值
   long result=-1;
//--- 重置错误的值
   ResetLastError();
//--- 接收属性值
   if(!ChartGetInteger(chart_ID,CHART_WIDTH_IN_BARS,0,result))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
     }
//--- 返回图表属性值
   return((int)result);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>•CHART_WIDTH_IN_PIXELS —— 返回图表像素宽度。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+
//| 函数接收图表像素宽度。                                               |
//+------------------------------------------------------------------+
int ChartWidthInPixels(const long chart_ID=0)
  {
//--- 准备变量获得属性值
   long result=-1;
//--- 重置错误的值
   ResetLastError();
//--- 接收属性值
   if(!ChartGetInteger(chart_ID,CHART_WIDTH_IN_PIXELS,0,result))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
     }
//--- 返回图表属性值
   return((int)result);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>•CHART_HEIGHT_IN_PIXELS ——图表像素高度的属性。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+
//| 该函数接收图表的像素高度值。                                         |
//+------------------------------------------------------------------+
int ChartHeightInPixelsGet(const long chart_ID=0,const int sub_window=0)
  {
//--- 准备变量获得属性值
   long result=-1;
//--- 重置错误的值
   ResetLastError();
//--- 接收属性值
   if(!ChartGetInteger(chart_ID,CHART_HEIGHT_IN_PIXELS,sub_window,result))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
     }
//--- 返回图表属性值
   return((int)result);
  }
//+------------------------------------------------------------------+
//| 该函数设置了图表的像素高度值。                                        |
//+------------------------------------------------------------------+
bool ChartHeightInPixelsSet(const int value,const long chart_ID=0,const int sub_window=0)
  {
//--- 重置错误的值
   ResetLastError();
//--- 设置属性值
   if(!ChartSetInteger(chart_ID,CHART_HEIGHT_IN_PIXELS,sub_window,value))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p>•CHART_COLOR_BACKGROUND ——图表背景色。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+
//| 该函数接收图表背景色。                                               |
//+------------------------------------------------------------------+
color ChartBackColorGet(const long chart_ID=0)
  {
//--- 准备变量接收颜色
   long result=clrNONE;
//--- 重置错误的值
   ResetLastError();
//--- 接收图表背景色
   if(!ChartGetInteger(chart_ID,CHART_COLOR_BACKGROUND,0,result))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
     }
//--- 返回图表属性值
   return((color)result);
  }
//+------------------------------------------------------------------+
//| 该函数设置图表背景色。                                               |
//+------------------------------------------------------------------+
bool ChartBackColorSet(const color clr,const long chart_ID=0)
  {
//--- 重置错误的值
   ResetLastError();
//--- 设置图表背景色
   if(!ChartSetInteger(chart_ID,CHART_COLOR_BACKGROUND,clr))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p>•CHART_COLOR_FOREGROUND——坐标轴，比例尺和OHLC线的颜色。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+
//| 该函数接收坐标轴，比例尺和OHLC线的颜色。                               |
//+------------------------------------------------------------------+
color ChartForeColorGet(const long chart_ID=0)
  {
//--- 准备变量接收颜色
   long result=clrNONE;
//--- 重置错误的值
   ResetLastError();
//--- 接收坐标轴，比例尺和OHLC线的颜色
   if(!ChartGetInteger(chart_ID,CHART_COLOR_FOREGROUND,0,result))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
     }
//--- 返回图表属性值
   return((color)result);
  }
//+------------------------------------------------------------------+
//| 该函数设置坐标轴，比例尺和OHLC线的颜色。                               |
//+------------------------------------------------------------------+
bool ChartForeColorSet(const color clr,const long chart_ID=0)
  {
//--- 重置错误的值
   ResetLastError();
//--- 设置坐标轴，比例尺和OHLC线的颜色
   if(!ChartSetInteger(chart_ID,CHART_COLOR_FOREGROUND,clr))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p>•CHART_COLOR_GRID ——图表网格颜色。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+
//| 这个函数接收图表网格颜色。                                           |
//+------------------------------------------------------------------+
color ChartGridColorGet(const long chart_ID=0)
  {
//--- 准备变量接收颜色
   long result=clrNONE;
//--- 重置错误的值
   ResetLastError();
//---接收图表网格颜色
   if(!ChartGetInteger(chart_ID,CHART_COLOR_GRID,0,result))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
     }
//--- 返回图表属性值
   return((color)result);
  }
//+------------------------------------------------------------------+
//| 函数设置图表网格颜色。                                               |
//+------------------------------------------------------------------+
bool ChartGridColorSet(const color clr,const long chart_ID=0)
  {
//--- 重置错误的值
   ResetLastError();
//--- 设置图表网格颜色
   if(!ChartSetInteger(chart_ID,CHART_COLOR_GRID,clr))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p>• CHART_COLOR_VOLUME ——交易量和持仓水平的颜色</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+
//| 该函数接收交易量和市场入场水平                                       |
//| 的颜色。                                                           |
//+------------------------------------------------------------------+
color ChartVolumeColorGet(const long chart_ID=0)
  {
//--- 准备变量接收颜色
   long result=clrNONE;
//--- 重置错误的值
   ResetLastError();
//--- 接收交易量和市场入场水平的颜色
   if(!ChartGetInteger(chart_ID,CHART_COLOR_VOLUME,0,result))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
     }
//--- 返回图表属性值
   return((color)result);
  }
//+------------------------------------------------------------------+
//| 该函数设置交易量和市场入场水平                                       |
//| 的颜色。                                                           |
//+------------------------------------------------------------------+
bool ChartVolumeColorSet(const color clr,const long chart_ID=0)
  {
//--- 重置错误的值
   ResetLastError();
//--- 设置交易量和市场入场水平的颜色
   if(!ChartSetInteger(chart_ID,CHART_COLOR_VOLUME,clr))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><p>• CHART_COLOR_CHART_UP ——上柱，柱影和牛市蜡烛图主体边缘的颜色。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+
//| 这个函数接收下柱，柱影和熊市蜡烛图主体边缘                              |
//| 的颜色。                                                           |
//+------------------------------------------------------------------+
color ChartUpColorGet(const long chart_ID=0)
  {
//--- 准备变量接收颜色
   long result=clrNONE;
//--- 重置错误的值
   ResetLastError();
//--- 接收上柱，柱影和牛市蜡烛图主体边缘的颜色
   if(!ChartGetInteger(chart_ID,CHART_COLOR_CHART_UP,0,result))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
     }
//--- 返回图表属性值
   return((color)result);
  }
//+------------------------------------------------------------------+
//| 这个函数设置上柱，柱影和牛市蜡烛图主体边缘                              |
//| 的颜色。                                                           |
//+------------------------------------------------------------------+
bool ChartUpColorSet(const color clr,const long chart_ID=0)
  {
//--- 重置错误的值
   ResetLastError();
//--- 设置上柱，柱影和牛市蜡烛图主体边缘的颜色
   if(!ChartSetInteger(chart_ID,CHART_COLOR_CHART_UP,clr))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><p>•CHART_COLOR_CHART_DOWN——下柱，柱影和熊市蜡烛图主体边缘的颜色。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+
//| 这个函数接收下柱，柱影和熊市蜡烛图主体边缘                              |
//| 的颜色。                                                           |
//+------------------------------------------------------------------+
color ChartDownColorGet(const long chart_ID=0)
  {
//--- 准备变量接收颜色
   long result=clrNONE;
//--- 重置错误的值
   ResetLastError();
//--- 接收下柱，柱影和熊市蜡烛图主体边缘的颜色
   if(!ChartGetInteger(chart_ID,CHART_COLOR_CHART_DOWN,0,result))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
     }
//--- 返回图表属性值
   return((color)result);
  }
//+------------------------------------------------------------------+
//| 这个函数设置下柱，柱影和熊市蜡烛图主体边缘                              |
//| 的颜色。                                                           |
//+------------------------------------------------------------------+
bool ChartDownColorSet(const color clr,const long chart_ID=0)
  {
//--- 重置错误的值
   ResetLastError();
//--- 设置下柱，柱影和熊市蜡烛图主体边缘的颜色
   if(!ChartSetInteger(chart_ID,CHART_COLOR_CHART_DOWN,clr))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><p>•CHART_COLOR_CHART_LINE ——图表线和Doji蜡烛图的颜色。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------------+
//| 该函数接收图表线和Doji蜡烛图的颜色。                                        |
//+------------------------------------------------------------------------+
color ChartLineColorGet(const long chart_ID=0)
  {
//--- 准备变量接收颜色
   long result=clrNONE;
//--- 重置错误的值
   ResetLastError();
//--- 接收图表线和Doji蜡烛图的颜色
   if(!ChartGetInteger(chart_ID,CHART_COLOR_CHART_LINE,0,result))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
     }
//--- 返回图表属性值
   return((color)result);
  }
//+------------------------------------------------------------------+
//| 该函数设置图表线和Doji蜡烛图的颜色。                                  |
//+------------------------------------------------------------------+
bool ChartLineColorSet(const color clr,const long chart_ID=0)
  {
//--- 重置错误的值
   ResetLastError();
//--- 设置图表线和Doji蜡烛图的颜色
   if(!ChartSetInteger(chart_ID,CHART_COLOR_CHART_LINE,clr))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p>•CHART_COLOR_CANDLE_BULL——牛市蜡烛图主体的颜色。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+
//| 该函数接收牛市蜡烛图主体的颜色。                                      |
//+------------------------------------------------------------------+
color ChartBullColorGet(const long chart_ID=0)
  {
//--- 准备变量接收颜色
   long result=clrNONE;
//--- 重置错误的值
   ResetLastError();
//--- 接收牛市蜡烛图主体的颜色
   if(!ChartGetInteger(chart_ID,CHART_COLOR_CANDLE_BULL,0,result))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
     }
//--- 返回图表属性值
   return((color)result);
  }
//+------------------------------------------------------------------+
//| 该函数设置牛市蜡烛图主体的颜色。                                      |
//+------------------------------------------------------------------+
bool ChartBullColorSet(const color clr,const long chart_ID=0)
  {
//--- 重置错误的值
   ResetLastError();
//--- 设置牛市蜡烛图主体的颜色。
   if(!ChartSetInteger(chart_ID,CHART_COLOR_CANDLE_BULL,clr))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p>•CHART_COLOR_CANDLE_BEAR—— 熊市蜡烛图主体的颜色。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+
//| 该函数接收熊市蜡烛图主体的颜色。                                      |
//+------------------------------------------------------------------+
color ChartBearColorGet(const long chart_ID=0)
  {
//--- 准备变量接收颜色
   long result=clrNONE;
//--- 重置错误的值
   ResetLastError();
//--- 接收熊市蜡烛图主体的颜色
   if(!ChartGetInteger(chart_ID,CHART_COLOR_CANDLE_BEAR,0,result))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
     }
//--- 返回图表属性值
   return((color)result);
  }
//+------------------------------------------------------------------+
//| 该函数设置熊市蜡烛图主体的颜色。                                      |
//+------------------------------------------------------------------+
bool ChartBearColorSet(const color clr,const long chart_ID=0)
  {
//--- 重置错误的值
   ResetLastError();
//--- 设置熊市蜡烛图主体的颜色
   if(!ChartSetInteger(chart_ID,CHART_COLOR_CANDLE_BEAR,clr))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p>•CHART_COLOR_BID ——卖价线的颜色。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+
//| 函数接收卖价线的颜色。                                               |
//+------------------------------------------------------------------+
color ChartBidColorGet(const long chart_ID=0)
  {
//--- 准备变量接收颜色
   long result=clrNONE;
//--- 重置错误的值
   ResetLastError();
//--- 接收卖价线的颜色
   if(!ChartGetInteger(chart_ID,CHART_COLOR_BID,0,result))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
     }
//--- 返回图表属性值
   return((color)result);
  }
//+------------------------------------------------------------------+
//| 该函数设置卖价线的颜色。                                             |
//+------------------------------------------------------------------+
bool ChartBidColorSet(const color clr,const long chart_ID=0)
  {
//--- 重置错误的值
   ResetLastError();
//--- 设置卖价线的颜色
   if(!ChartSetInteger(chart_ID,CHART_COLOR_BID,clr))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p>•CHART_COLOR_ASK ——买价线的颜色。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+
//| 该函数接收买价线的颜色。                                             |
//+------------------------------------------------------------------+
color ChartAskColorGet(const long chart_ID=0)
  {
//--- 准备变量接收颜色
   long result=clrNONE;
//--- 重置错误的值
   ResetLastError();
//--- 接收买价线的颜色
   if(!ChartGetInteger(chart_ID,CHART_COLOR_ASK,0,result))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
     }
//--- 返回图表属性值
   return((color)result);
  }
//+------------------------------------------------------------------+
//| 该函数设置买价线的颜色。                                             |
//+------------------------------------------------------------------+
bool ChartAskColorSet(const color clr,const long chart_ID=0)
  {
//--- 重置错误的值
   ResetLastError();
//--- 设置买价线的颜色
   if(!ChartSetInteger(chart_ID,CHART_COLOR_ASK,clr))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p>•CHART_COLOR_LAST ——最近交易的价格线的颜色（收盘价）。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+----------------------------------------------------------------------+
//| 这个函数接收最近交易的价格线的颜色。                                       |
//+----------------------------------------------------------------------+
color ChartLastColorGet(const long chart_ID=0)
  {
//--- 准备变量接收颜色
   long result=clrNONE;
//--- 重置错误的值
   ResetLastError();
//--- 接收最近交易的价格线的颜色（收盘价）
   if(!ChartGetInteger(chart_ID,CHART_COLOR_LAST,0,result))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
     }
//--- 返回图表属性值
   return((color)result);
  }
//+------------------------------------------------------------------+
//| 这个函数设置最近交易的价格线                                         |
//| 的颜色。                                                           |
//+------------------------------------------------------------------+
bool ChartLastColorSet(const color clr,const long chart_ID=0)
  {
//--- 重置错误的值
   ResetLastError();
//--- 设置最近交易的价格线的颜色（收盘价）
   if(!ChartSetInteger(chart_ID,CHART_COLOR_LAST,clr))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><p>•CHART_COLOR_STOP_LEVEL——止损订单水平颜色（止损和获利）。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+--------------------------------------------------------------------+
//| 这个函数接收止损和获利水平的颜色。                                      |
//+--------------------------------------------------------------------+
color ChartStopLevelColorGet(const long chart_ID=0)
  {
//--- 准备变量接收颜色
   long result=clrNONE;
//--- 重置错误的值
   ResetLastError();
//--- 接收止损订单水平的颜色（止损和获利）
   if(!ChartGetInteger(chart_ID,CHART_COLOR_STOP_LEVEL,0,result))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
     }
//--- 返回图表属性值
   return((color)result);
  }
//+------------------------------------------------------------------+
//| 该函数设置止损和获利水平的颜色。                                      |
//+------------------------------------------------------------------+
bool ChartStopLevelColorSet(const color clr,const long chart_ID=0)
  {
//--- 重置错误的值
   ResetLastError();
//--- 设置止损订单水平的颜色（止损和获利）
   if(!ChartSetInteger(chart_ID,CHART_COLOR_STOP_LEVEL,clr))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p>•CHART_COLOR_STOP_LEVEL——止损订单水平颜色（止损和获利）。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+--------------------------------------------------------------------+
//| 这个函数接收止损和获利水平的颜色。                                      |
//+--------------------------------------------------------------------+
color ChartStopLevelColorGet(const long chart_ID=0)
  {
//--- 准备变量接收颜色
   long result=clrNONE;
//--- 重置错误的值
   ResetLastError();
//--- 接收止损订单水平的颜色（止损和获利）
   if(!ChartGetInteger(chart_ID,CHART_COLOR_STOP_LEVEL,0,result))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
     }
//--- 返回图表属性值
   return((color)result);
  }
//+------------------------------------------------------------------+
//| 该函数设置止损和获利水平的颜色。                                      |
//+------------------------------------------------------------------+
bool ChartStopLevelColorSet(const color clr,const long chart_ID=0)
  {
//--- 重置错误的值
   ResetLastError();
//--- 设置止损订单水平的颜色（止损和获利）
   if(!ChartSetInteger(chart_ID,CHART_COLOR_STOP_LEVEL,clr))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p>•CHART_SHOW_TRADE_LEVELS——在图表上显示交易水平的属性（持仓水平，止损，获利和挂单水平）。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+---------------------------------------------------------------------+
//| 这个函数定义是否在图表上显示交易水平。                                    |
//+---------------------------------------------------------------------+
bool ChartShowTradeLevelsGet(bool &amp;result,const long chart_ID=0)
  {
//--- 准备变量获得属性值
   long value;
//--- 重置错误的值
   ResetLastError();
//--- 接收属性值
   if(!ChartGetInteger(chart_ID,CHART_SHOW_TRADE_LEVELS,0,value))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 在内存中存储图表属性的值
   result=value;
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 该函数启用/禁用交易水平显示模式。                                     |
//+------------------------------------------------------------------+
bool ChartShowTradeLevelsSet(const bool value,const long chart_ID=0)
  {
//--- 重置错误的值
   ResetLastError();
//--- 设置属性值
   if(!ChartSetInteger(chart_ID,CHART_SHOW_TRADE_LEVELS,0,value))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p>•CHART_DRAG_TRADE_LEVELS——启用使用鼠标在图表上拖拽交易水平的能力的属性</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+---------------------------------------------------------------------------+
//| 这个函数定义是否允许使用鼠标在图表上拖拽交易                                    |
//| 水平。                                                                     |
//+---------------------------------------------------------------------------+
bool ChartDragTradeLevelsGet(bool &amp;result,const long chart_ID=0)
  {
//--- 准备变量获得属性值
   long value;
//--- 重置错误的值
   ResetLastError();
//--- 接收属性值
   if(!ChartGetInteger(chart_ID,CHART_DRAG_TRADE_LEVELS,0,value))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 在内存中存储图表属性的值
   result=value;
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 该函数启用/禁用使用鼠标在图表上拖拽交易水平                            |
//| 的模式。                                                           |
//+------------------------------------------------------------------+
bool ChartDragTradeLevelsSet(const bool value,const long chart_ID=0)
  {
//--- 重置错误的值
   ResetLastError();
//--- 设置属性值
   if(!ChartSetInteger(chart_ID,CHART_DRAG_TRADE_LEVELS,0,value))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><p>•CHART_SHOW_DATE_SCALE——在图表上显示时间比例的属性。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+--------------------------------------------------------------------+
//| 该函数定义是否在图表上显示时间比例。                                     |
//+--------------------------------------------------------------------+
bool ChartShowDateScaleGet(bool &amp;result,const long chart_ID=0)
  {
//--- 准备变量获得属性值
   long value;
//--- 重置错误的值
   ResetLastError();
//--- 接收属性值
   if(!ChartGetInteger(chart_ID,CHART_SHOW_DATE_SCALE,0,value))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 在内存中存储图表属性的值
   result=value;
//--- 成功执行
   return(true);
  }
//+-----------------------------------------------------------------------------+
//| 该函数启用/禁用在图表上显示时间比例的模式。                                        |
//+-----------------------------------------------------------------------------+
bool ChartShowDateScaleSet(const bool value,const long chart_ID=0)
  {
//--- 重置错误的值
   ResetLastError();
//--- 设置属性值
   if(!ChartSetInteger(chart_ID,CHART_SHOW_DATE_SCALE,0,value))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p>•CHART_SHOW_PRICE_SCALE ——在图表上显示价格比例的属性。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+--------------------------------------------------------------------+
//| 该函数定义是否在图表上显示价格比例。                                     |
//+--------------------------------------------------------------------+
bool ChartShowPriceScaleGet(bool &amp;result,const long chart_ID=0)
  {
//--- 准备变量获得属性值
   long value;
//--- 重置错误的值
   ResetLastError();
//--- 接收属性值
   if(!ChartGetInteger(chart_ID,CHART_SHOW_PRICE_SCALE,0,value))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 在内存中存储图表属性的值
   result=value;
//--- 成功执行
   return(true);
  }
//+----------------------------------------------------------------------------+
//| 该函数启用/禁用在图表上显示价格比例的模式。                                      |
//+----------------------------------------------------------------------------+
bool ChartShowPriceScaleSet(const bool value,const long chart_ID=0)
  {
//--- 重置错误的值
   ResetLastError();
//--- 设置属性值
   if(!ChartSetInteger(chart_ID,CHART_SHOW_PRICE_SCALE,0,value))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p>•CHART_SHOW_ONE_CLICK ——在图表上显示&quot;一键交易&quot;的属性。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+
//| 检查&quot;单击交易&quot; 面板是否显示在图表上                                   |
//+------------------------------------------------------------------+
bool ChartShowOneClickPanelGet(bool &amp;result,const long chart_ID=0)
  {
//--- 准备变量以获得属性值
   long value;
//--- 重置错误值
   ResetLastError();
//--- 接收属性值
   if(!ChartGetInteger(chart_ID,CHART_SHOW_ONE_CLICK,0,value))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 在内存中存储图表属性的值
   result=value;
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 启用/禁用显示&quot;单击交易&quot; 面板                                        |
//| 在图表上                                                          |
//+------------------------------------------------------------------+
bool ChartShowOneClickPanelSet(const bool value,const long chart_ID=0)
  {
//--- 重置错误值
   ResetLastError();
//--- 设置属性值
   if(!ChartSetInteger(chart_ID,CHART_SHOW_ONE_CLICK,0,value))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><p>•CHART_SHIFT_SIZE ——从右侧边界开始的零柱的百分比值转换大小。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+---------------------------------------------------------------------------+
//| 该函数接收从图表右侧边界开始的零柱的                                           |
//| 百分比值 转换大小（从10%直到50%）。                                             |
//+---------------------------------------------------------------------------+
double ChartShiftSizeGet(const long chart_ID=0)
  {
//--- 准备变量获得结果
   double result=EMPTY_VALUE;
//--- 重置错误的值
   ResetLastError();
//--- 接收属性值
   if(!ChartGetDouble(chart_ID,CHART_SHIFT_SIZE,0,result))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
     }
//--- 返回图表属性值
   return(result);
  }
//+--------------------------------------------------------------------------------------+
//| 这个函数设置从图表右侧边界开始的零柱的                                                    |
//| 百分比值转换大小（从10%直到50%）。要启用该转换                                               |
//| 模式，CHART_SHIFT 属性值应该设置为                                                       |
//| true。                                                                                |
//+--------------------------------------------------------------------------------------+
bool ChartShiftSizeSet(const double value,const long chart_ID=0)
  {
//--- 重置错误的值
   ResetLastError();
//--- 设置属性值
   if(!ChartSetDouble(chart_ID,CHART_SHIFT_SIZE,value))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><p>•CHART_FIXED_POSITION ——图表从左边界以百分比值固定位置。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+--------------------------------------------------------------------------+
//| 这个函数接收从左边界以百分比值                                               |
//| 固定位置的图表的位置。                                                       |
//+--------------------------------------------------------------------------+
double ChartFixedPositionGet(const long chart_ID=0)
  {
//--- 准备变量获得结果
   double result=EMPTY_VALUE;
//--- 重置错误的值
   ResetLastError();
//--- 接收属性值
   if(!ChartGetDouble(chart_ID,CHART_FIXED_POSITION,0,result))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
     }
//--- 返回图表属性值
   return(result);
  }
//+---------------------------------------------------------------------+
//| 这个函数设置从左边界以百分比值                                          |
//| 固定位置的图表的位置。若要查看固定位置                                    |
//| 图表的位置， CHART_AUTOSCROLL                                         |
//| 属性值应该设置为false。                                                |
//+---------------------------------------------------------------------+
bool ChartFixedPositionSet(const double value,const long chart_ID=0)
  {
//--- 重置错误的值
   ResetLastError();
//--- 设置属性值
   if(!ChartSetDouble(chart_ID,CHART_FIXED_POSITION,value))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><p>•CHART_FIXED_MAX ——表格的固定最大值属性。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+
//| 这个函数接收图表的固定最大值。                                        |
//+------------------------------------------------------------------+
double ChartFixedMaxGet(const long chart_ID=0)
  {
//--- 准备变量获得结果
   double result=EMPTY_VALUE;
//--- 重置错误的值
   ResetLastError();
//--- 接收属性值
   if(!ChartGetDouble(chart_ID,CHART_FIXED_MAX,0,result))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
     }
//--- 返回图表属性值
   return(result);
  }
//+------------------------------------------------------------------+
//| 这个函数设置图表的固定最大值。                                        |
//| 要改变属性的值，                                                    |
//| CHART_SCALEFIX 属性值应该提前设置为                                 |
//| true。                                                            |
//+------------------------------------------------------------------+
bool ChartFixedMaxSet(const double value,const long chart_ID=0)
  {
//--- 重置错误的值
   ResetLastError();
//--- 设置属性值
   if(!ChartSetDouble(chart_ID,CHART_FIXED_MAX,value))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p>•CHART_FIXED_MIN —— 图表固定最小值的属性。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+
//| 这个函数接收图表的固定最小值。                                        |
//+------------------------------------------------------------------+
double ChartFixedMinGet(const long chart_ID=0)
  {
//--- 准备变量获得结果
   double result=EMPTY_VALUE;
//--- 重置错误的值
   ResetLastError();
//--- 接收属性值
   if(!ChartGetDouble(chart_ID,CHART_FIXED_MIN,0,result))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
     }
//--- 返回图表属性值
   return(result);
  }
//+------------------------------------------------------------------+
//| 这个函数设置图表的固定最小值。                                        |
//| 要改变属性的值，                                                    |
//| CHART_SCALEFIX 属性值应该提前设置为                                 |
//| true。                                                            |
//+------------------------------------------------------------------+
bool ChartFixedMinSet(const double value,const long chart_ID=0)
  {
//--- 重置错误的值
   ResetLastError();
//--- 设置属性值
   if(!ChartSetDouble(chart_ID,CHART_FIXED_MIN,value))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p>•CHART_POINTS_PER_BAR —— 每柱比例尺的点数值。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+---------------------------------------------------------------------------+
//| 这个函数接收每柱图表比例尺的点数值。                                            |
//+---------------------------------------------------------------------------+
double ChartPointsPerBarGet(const long chart_ID=0)
  {
//--- 准备变量获得结果
   double result=EMPTY_VALUE;
//--- 重置错误的值
   ResetLastError();
//--- 接收属性值
   if(!ChartGetDouble(chart_ID,CHART_POINTS_PER_BAR,0,result))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
     }
//--- 返回图表属性值
   return(result);
  }
//+----------------------------------------------------------------------+
//| 这个函数设置每柱的图表比例尺的点数值。                                     |
//| 要查看这个属性值的变化结果，                                              |
//| 这个                                                                  |
//| CHART_SCALE_PT_PER_BAR 属性值应该提前设置为true。                        |
//+----------------------------------------------------------------------+
bool ChartPointsPerBarSet(const double value,const long chart_ID=0)
  {
//--- 重置错误的值
   ResetLastError();
//--- 设置属性值
   if(!ChartSetDouble(chart_ID,CHART_POINTS_PER_BAR,value))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p>•CHART_PRICE_MIN —— 返回图表的最小值。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+---------------------------------------------------------------------------------+
//| 这个函数接收主窗口或子窗口的图表最小值。                                              |
//+---------------------------------------------------------------------------------+
double ChartPriceMin(const long chart_ID=0,const int sub_window=0)
  {
//--- 准备变量获得结果
   double result=EMPTY_VALUE;
//--- 重置错误的值
   ResetLastError();
//--- 接收属性值
   if(!ChartGetDouble(chart_ID,CHART_PRICE_MIN,sub_window,result))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
     }
//--- 返回图表属性值
   return(result);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>•CHART_PRICE_MAX —— 返回图表的最大值。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>double ChartPriceMax(const long chart_ID=0,const int sub_window=0)
  {
//--- 准备变量获得结果
   double result=EMPTY_VALUE;
//--- 重置错误的值
   ResetLastError();
//--- 接收属性值
   if(!ChartGetDouble(chart_ID,CHART_PRICE_MAX,sub_window,result))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
     }
//--- 返回图表属性值
   return(result);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>•CHART_COMMENT—— 图表评论。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+----------------------------------------------------------------------+
//| 这个函数接收图表左上角的评论。                                            |
//+----------------------------------------------------------------------+
bool ChartCommentGet(string &amp;result,const long chart_ID=0)
  {
//--- 重置错误的值
   ResetLastError();
//--- 接收属性值
   if(!ChartGetString(chart_ID,CHART_COMMENT,result))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 这个函数设置图表左上角的评论。                                        |
//+------------------------------------------------------------------+
bool ChartCommentSet(const string str,const long chart_ID=0)
  {
//--- 重置错误的值
   ResetLastError();
//--- 设置属性值
   if(!ChartSetString(chart_ID,CHART_COMMENT,str))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p>•CHART_IS_MAXIMIZED—— 图表窗口最大化。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+
//| 定义如果当前图表窗口最大化                                           |
//+------------------------------------------------------------------+
bool ChartWindowsIsMaximized(bool &amp;result,const long chart_ID=0)
  {
//--- 准备接收属性值的变量
   long value;
//--- 重置错误值
   ResetLastError();
//--- 接收属性值
   if(!ChartGetInteger(chart_ID,CHART_IS_MAXIMIZED))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 在变量中存储图表属性值
   result=value;
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>•CHART_IS_MINIMIZED —— 图表窗口最小化。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+
//| 定义如果当前图表窗口最小化                                           |
//+------------------------------------------------------------------+
bool ChartWindowsIsMinimized(bool &amp;result,const long chart_ID=0)
  {
//--- 准备接收属性值的变量
   long value;
//--- 重置错误值
   ResetLastError();
//--- 接收属性值
   if(!ChartGetInteger(chart_ID,CHART_IS_MINIMIZED))
     {
      //--- 在EA日志显示错误信息
      Print(__FUNCTION__+&quot;, Error Code = &quot;,GetLastError());
      return(false);
     }
//--- 在变量中存储图表属性值
   result=value;
//--- 成功执行
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>图表属性面板</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 连接控制元素的程序库
#include &lt;ChartObjects\ChartObjectsTxtControls.mqh&gt;
//--- 预定义常量
#define X_PROPERTY_NAME_1    10  //第一列属性名的x坐标
#define X_PROPERTY_VALUE_1   225 //第一列属性值的 x 坐标
#define X_PROPERTY_NAME_2    345 // 第二和第三列的属性名的x坐标
#define X_PROPERTY_VALUE_2   550 // 第二和第三列的属性值的x坐标
#define X_BUTTON_1           285 // 第一列按钮的x坐标
#define X_BUTTON_2           700 //第二列按钮的 x 坐标
#define Y_PROPERTY_1         30  // 第一和第二列开始的y 坐标
#define Y_PROPERTY_2         286 // 第三列开始的y坐标
#define Y_DISTANCE           16  // y 轴的行间距
#define LAST_PROPERTY_NUMBER 111 // 最近图形的属性号
//--- 输入参数
input color InpFirstColor=clrDodgerBlue; // 奇数行的颜色
input color InpSecondColor=clrGoldenrod; // 偶数行的颜色
//--- 变量和数组
CChartObjectLabel  ExtLabelsName[];  // 显示属性名的标签
CChartObjectLabel  ExtLabelsValue[]; // 显示属性值的标签
CChartObjectButton ExtButtons[];     // 按钮
int                ExtNumbers[];     // 属性指数
string             ExtNames[];       // 属性名称
uchar              ExtDataTypes[];   // 属性数据类型（整型，双精度，字符串）
uint               ExtGroupTypes[];  // 存储有关属性归属于一个组的数据的数组
uchar              ExtDrawTypes[];   // 存储有关属性显示类型的数据的数组
double             ExtMaxValue[];    // 面板工作时最大可能的属性值
double             ExtMinValue[];    // 面板工作时最小可能的属性值
double             ExtStep[];        // 更改属性的步骤
int                ExtCount;         // 所有属性的总数
color              ExtColors[2];     // 用于显示行的颜色的数组
string             ExtComments[2];   // 评论数组 （用于CHART_COMMENT 属性）
//+------------------------------------------------------------------+
//| 自定义指标初始化函数                                                |
//+------------------------------------------------------------------+
int OnInit()
  {
//--- 在图表上显示评论
   Comment(&quot;SomeComment&quot;);
//--- 数组中存储颜色以便过后能够在它们之间切换
   ExtColors[0]=InpFirstColor;
   ExtColors[1]=InpSecondColor;
//--- 数组中存储评论以便过后在它们之间切换
   ExtComments[0]=&quot;FirstComment&quot;;
   ExtComments[1]=&quot;SecondComment&quot;;
//--- 准备并显示管理图表属性的控制面板
   if(!PrepareControls())
      return(INIT_FAILED);
//--- 成功执行
   return(INIT_SUCCEEDED);
  }
//+------------------------------------------------------------------+
//| EA的去初始化函数                                                   |
//+------------------------------------------------------------------+
void OnDeinit(const int reason)
  {
//--- 在图表上移除评论
   Comment(&quot;&quot;);
  }
//+------------------------------------------------------------------+
//| 图表事件处理程序                                                   |
//+------------------------------------------------------------------+
void OnChartEvent(const int id,
                  const long &amp;lparam,
                  const double &amp;dparam,
                  const string &amp;sparam)
  {
//--- 检查点击图表对象的事件
   if(id==CHARTEVENT_OBJECT_CLICK)
     {
      //--- 用分隔符分开对象名称
      string obj_name[];
      StringSplit(sparam,'_',obj_name);
      //--- 检查对象是否是个按钮
      if(obj_name[0]==&quot;Button&quot;)
        {
         //--- 接收按钮指数
         int index=(int)StringToInteger(obj_name[1]);
         //--- 不按按钮
         ExtButtons[index].State(false);
         //--- 根据类型设置新的属性值
         if(ExtDataTypes[index]=='I')
            ChangeIntegerProperty(index);
         if(ExtDataTypes[index]=='D')
            ChangeDoubleProperty(index);
         if(ExtDataTypes[index]=='S')
            ChangeStringProperty(index);
        }
     }
//--- 重画属性值
   RedrawProperties();
   ChartRedraw();
  }
//+------------------------------------------------------------------+
//| 改变图表的整型属性                                                  |
//+------------------------------------------------------------------+
void ChangeIntegerProperty(const int index)
  {
//--- 接收当前属性值
   long value=ChartGetInteger(0,(ENUM_CHART_PROPERTY_INTEGER)ExtNumbers[index]);
//--- 定义以下属性值
   switch(ExtDrawTypes[index])
     {
      case 'C':
         value=GetNextColor((color)value);
         break;
      default:
         value=(long)GetNextValue((double)value,index);
         break;
     }
//--- 设置新的属性值
   ChartSetInteger(0,(ENUM_CHART_PROPERTY_INTEGER)ExtNumbers[index],0,value);
  }
//+------------------------------------------------------------------+
//| 改变图表的双精度属性                                                |
//+------------------------------------------------------------------+
void ChangeDoubleProperty(const int index)
  {
//--- 接收当前属性值
   double value=ChartGetDouble(0,(ENUM_CHART_PROPERTY_DOUBLE)ExtNumbers[index]);
//--- 定义以下属性值
   value=GetNextValue(value,index);
//--- 设置新的属性值
   ChartSetDouble(0,(ENUM_CHART_PROPERTY_DOUBLE)ExtNumbers[index],value);
  }
//+------------------------------------------------------------------+
//| 改变图表的字符串属性                                                |
//+------------------------------------------------------------------+
void ChangeStringProperty(const int index)
  {
//--- 用于 ExtComments数组内转换的静态变量
   static uint comment_index=1;
//--- 改变接收另一个评论的指数
   comment_index=1-comment_index;
//--- 设置新的属性值
   ChartSetString(0,(ENUM_CHART_PROPERTY_STRING)ExtNumbers[index],ExtComments[comment_index]);
  }
//+------------------------------------------------------------------+
//| 定义下一个属性值                                                   |
//+------------------------------------------------------------------+
double GetNextValue(const double value,const int index)
  {
   if(value+ExtStep[index] &lt; =ExtMaxValue[index])
      return(value+ExtStep[index]);
   else
      return(ExtMinValue[index]);
  }
//+------------------------------------------------------------------+
//| 接收颜色类型属性的下一个颜色                                         |
//+------------------------------------------------------------------+
color GetNextColor(const color clr)
  {
//--- 返回以下颜色值
   switch(clr)
     {
      case clrWhite: return(clrRed);
      case clrRed:   return(clrGreen);
      case clrGreen: return(clrBlue);
      case clrBlue:  return(clrBlack);
      default:       return(clrWhite);
     }
  }
//+------------------------------------------------------------------+
//| 重画属性值                                                        |
//+------------------------------------------------------------------+
void RedrawProperties(void)
  {
//--- 属性值文本
   string text;
   long   value;
//--- 循环的属性数量
   for(int i=0; i&lt;ExtCount; i++)
     {
      text=&quot;&quot;;
      switch(ExtDataTypes[i])
        {
         case 'I':
            //--- 接收当前属性值
            if(!ChartGetInteger(0,(ENUM_CHART_PROPERTY_INTEGER)ExtNumbers[i],0,value))
            break;
            //--- 整型属性文本
            switch(ExtDrawTypes[i])
              {
               //--- 颜色属性
               case 'C':
                  text=(string)((color)value);
                  break;
                  //--- 布尔属性
               case 'B':
                  text=(string)((bool)value);
                  break;
                  //--- ENUM_CHART_MODE 枚举属性
               case 'M':
                  text=EnumToString((ENUM_CHART_MODE)value);
                  break;
                  //--- ENUM_CHART_VOLUME_MODE 枚举属性
               case 'V':
                  text=EnumToString((ENUM_CHART_VOLUME_MODE)value);
                  break;
                  //--- int 类型号
               default:
                  text=IntegerToString(value);
                  break;
              }
            break;
         case 'D':
            //--- 双精度属性文本
            text=DoubleToString(ChartGetDouble(0,(ENUM_CHART_PROPERTY_DOUBLE)ExtNumbers[i]),4);
            break;
         case 'S':
            //--- 字符串属性文本
            text=ChartGetString(0,(ENUM_CHART_PROPERTY_STRING)ExtNumbers[i]);
            break;
        }
      //--- 显示属性值
      ExtLabelsValue[i].Description(text);
     }
  }
//+------------------------------------------------------------------+
//| 创建管理图表属性面板                                                |
//+------------------------------------------------------------------+
bool PrepareControls(void)
  {
//--- 为数组存储分配内存
   MemoryAllocation(LAST_PROPERTY_NUMBER+1);
//--- 变量
   int i=0;     // 循环变量
   int col_1=0; // 第一列的属性数
   int col_2=0; // 第二列的属性数
   int col_3=0; // 第三列的属性数
//--- 当前属性数 - 0
   ExtCount=0;
//--- 在循环中查找属性
   while(i &lt; = LAST_PROPERTY_NUMBER)
     {
      //--- 存储当前属性数
      ExtNumbers[ExtCount]=i;
      //--- 增加循环变量值
      i++;
      //--- 检查是否有这个数的属性
      if(CheckNumber(ExtNumbers[ExtCount],ExtNames[ExtCount],ExtDataTypes[ExtCount],ExtGroupTypes[ExtCount],ExtDrawTypes[ExtCount]))
        {
         //--- 创建属性的控制元素
         switch(ExtGroupTypes[ExtCount])
           {
            case 1:
               //--- 创建属性标签和按钮
               if(!ShowProperty(ExtCount,0,X_PROPERTY_NAME_1,X_PROPERTY_VALUE_1,X_BUTTON_1,Y_PROPERTY_1+col_1*Y_DISTANCE,true))
               return(false);
               //--- 第一列的元素数已经增加
               col_1++;
               break;
            case 2:
               //--- 创建属性标签和按钮
               if(!ShowProperty(ExtCount,1,X_PROPERTY_NAME_2,X_PROPERTY_VALUE_2,X_BUTTON_2,Y_PROPERTY_1+col_2*Y_DISTANCE,true))
               return(false);
               //--- 第二列的元素数已经增加
               col_2++;
               break;
            case 3:
               //--- 只创建属性标签
               if(!ShowProperty(ExtCount,2,X_PROPERTY_NAME_2,X_PROPERTY_VALUE_2,0,Y_PROPERTY_2+col_3*Y_DISTANCE,false))
               return(false);
               //--- 第三列的元素数已经增加
               col_3++;
               break;
           }
         //--- 定义最大最小属性值和步骤
         GetMaxMinStep(ExtNumbers[ExtCount],ExtMaxValue[ExtCount],ExtMinValue[ExtCount],ExtStep[ExtCount]);
         //--- 增加属性数量
         ExtCount++;
        }
     }
//--- 释放数组不用的内存
   MemoryAllocation(ExtCount);
//--- 重画属性值
   RedrawProperties();
   ChartRedraw();
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 为数组分配内存                                                     |
//+------------------------------------------------------------------+
void MemoryAllocation(const int size)
  {
   ArrayResize(ExtLabelsName,size);
   ArrayResize(ExtLabelsValue,size);
   ArrayResize(ExtButtons,size);
   ArrayResize(ExtNumbers,size);
   ArrayResize(ExtNames,size);
   ArrayResize(ExtDataTypes,size);
   ArrayResize(ExtGroupTypes,size);
   ArrayResize(ExtDrawTypes,size);
   ArrayResize(ExtMaxValue,size);
   ArrayResize(ExtMinValue,size);
   ArrayResize(ExtStep,size);
  }
//+------------------------------------------------------------------+
//| 检查是否属性指数属于                                                |
//| ENUM_CHART_PROPERTIES 枚举                                        |
//+------------------------------------------------------------------+
bool CheckNumber(const int ind,string &amp;name,uchar &amp;data_type,uint &amp;group_type,uchar &amp;draw_type)
  {
//--- 检查属性是否是整型类型的属性
   ResetLastError();
   name=EnumToString((ENUM_CHART_PROPERTY_INTEGER)ind);
   if(_LastError==0)
     {
      data_type='I';                      // 来自 ENUM_CHART_PROPERTY_INTEGER 枚举的属性
      GetTypes(ind,group_type,draw_type); // 定义属性显示参数
      return(true);
     }
//--- 检查属性是否是双精度类型
   ResetLastError();
   name=EnumToString((ENUM_CHART_PROPERTY_DOUBLE)ind);
   if(_LastError==0)
     {
      data_type='D';                      // 来自 ENUM_CHART_PROPERTY_DOUBLE 枚举的属性
      GetTypes(ind,group_type,draw_type); // 定义属性显示参数
      return(true);
     }
//--- 检查属性是否是字符串类型
   ResetLastError();
   name=EnumToString((ENUM_CHART_PROPERTY_STRING)ind);
   if(_LastError==0)
     {
      data_type='S';                      // 来自 ENUM_CHART_PROPERTY_STRING 枚举的属性
      GetTypes(ind,group_type,draw_type); // 定义属性显示参数
      return(true);
     }
//--- 属性不属于任何枚举
   return(false);
  }
//+------------------------------------------------------------------+
//| 定义属性应该存储的组，                                               |
//| 以及其展示类型                                                     |
//+------------------------------------------------------------------+
void GetTypes(const int property_number,uint &amp;group_type,uchar &amp;draw_type)
  {
//--- 检查属性是否属于第三组
//--- 第三组属性显示在从CHART_BRING_TO_TOP开始的第二列
   if(CheckThirdGroup(property_number,group_type,draw_type))
      return;
//--- 检查属性是否属于第二组
//--- 第二组属性显示在第二列的开头
   if(CheckSecondGroup(property_number,group_type,draw_type))
      return;
//--- 如果您在这里找到了自己，属性属于第一组（第一列）
   CheckFirstGroup(property_number,group_type,draw_type);
  }
//+----------------------------------------------------------------------+
//| 这个函数检查属性是否属于第三组并                                          |
//| 在肯定回答时定义显示类型                                                 |
//+----------------------------------------------------------------------+
bool CheckThirdGroup(const int property_number,uint &amp;group_type,uchar &amp;draw_type)
  {
//--- 检查属性是否属于第三组
   switch(property_number)
     {
      //--- 布尔属性
      case CHART_IS_OBJECT:
      case CHART_WINDOW_IS_VISIBLE:
         draw_type='B';
         break;
         //--- 整型属性
      case CHART_VISIBLE_BARS:
      case CHART_WINDOWS_TOTAL:
      case CHART_WINDOW_HANDLE:
      case CHART_WINDOW_YDISTANCE:
      case CHART_FIRST_VISIBLE_BAR:
      case CHART_WIDTH_IN_BARS:
      case CHART_WIDTH_IN_PIXELS:
         draw_type='I';
         break;
         //--- 双精度属性
      case CHART_PRICE_MIN:
      case CHART_PRICE_MAX:
         draw_type='D';
         break;
         //--- 实际上，这个属性实在所有其他的上面显示图表的命令
         //--- 无需应用这个面板，因为窗口会始终保持
         //--- 在其他的上面，在我们使用之前
      case CHART_BRING_TO_TOP:
         draw_type=' ';
         break;
         //--- 属性不属于第三组
      default:
         return(false);
     }
//--- 属性属于第三组
   group_type=3;
   return(true);
  }
//+----------------------------------------------------------------------+
//| 这个函数检查属性是否属于第二组并                                          |
//| 在肯定回答时定义显示类型                                                 |
//+----------------------------------------------------------------------+
bool CheckSecondGroup(const int property_number,uint &amp;group_type,uchar &amp;draw_type)
  {
//--- 检查属性是否属于第二组
   switch(property_number)
     {
      //--- ENUM_CHART_MODE 类型属性
      case CHART_MODE:
         draw_type='M';
         break;
         //--- ENUM_CHART_VOLUME_MODE 类型属性
      case CHART_SHOW_VOLUMES:
         draw_type='V';
         break;
         //--- 字符串属性
      case CHART_COMMENT:
         draw_type='S';
         break;
         //--- 颜色属性
      case CHART_COLOR_BACKGROUND:
      case CHART_COLOR_FOREGROUND:
      case CHART_COLOR_GRID:
      case CHART_COLOR_VOLUME:
      case CHART_COLOR_CHART_UP:
      case CHART_COLOR_CHART_DOWN:
      case CHART_COLOR_CHART_LINE:
      case CHART_COLOR_CANDLE_BULL:
      case CHART_COLOR_CANDLE_BEAR:
      case CHART_COLOR_BID:
      case CHART_COLOR_ASK:
      case CHART_COLOR_LAST:
      case CHART_COLOR_STOP_LEVEL:
         draw_type='C';
         break;
         //--- 属性不属于第二组
      default:
         return(false);
     }
//--- 属性属于第二组
   group_type=2;
   return(true);
  }
//+-----------------------------------------------------------------------+
//| 这个函数被调用只有在已知                                                  |
//| 属性不属于第二和第三属性组时才可以                                         |
//+-----------------------------------------------------------------------+
void CheckFirstGroup(const int property_number,uint &amp;group_type,uchar &amp;draw_type)
  {
//--- 属性属于第一组
   group_type=1;
//--- 定义属性显示类型
   switch(property_number)
     {
      //--- 整型属性
      case CHART_SCALE:
      case CHART_HEIGHT_IN_PIXELS:
         draw_type='I';
         return;
         //--- 双精度属性
      case CHART_SHIFT_SIZE:
      case CHART_FIXED_POSITION:
      case CHART_FIXED_MAX:
      case CHART_FIXED_MIN:
      case CHART_POINTS_PER_BAR:
         draw_type='D';
         return;
         //--- 只保留布尔属性
      default:
         draw_type='B';
         return;
     }
  }
//+------------------------------------------------------------------+
//| 创建属性标签和按钮                                                  |
//+------------------------------------------------------------------+
bool ShowProperty(const int ind,const int type,const int x1,const int x2,
                  const int xb,const int y,const bool btn)
  {
//--- 用于ExtColors颜色数组内转换的静态数组
   static uint color_index[3]={1,1,1};
//--- 改变指数，接收另一个颜色
   color_index[type]=1-color_index[type];
//--- 显示属性的标签和按钮 (如果 btn=true)
   if(!LabelCreate(ExtLabelsName[ind],&quot;name_&quot;+(string)ind,ExtNames[ind],ExtColors[color_index[type]],x1,y))
      return(false);
   if(!LabelCreate(ExtLabelsValue[ind],&quot;value_&quot;+(string)ind,&quot;&quot;,ExtColors[color_index[type]],x2,y))
      return(false);
   if(btn &amp;&amp; !ButtonCreate(ExtButtons[ind],(string)ind,xb,y+1))
      return(false);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 创建标签                                                          |
//+------------------------------------------------------------------+
bool LabelCreate(CChartObjectLabel &amp;lbl,const string name,const string text,
                 const color clr,const int x,const int y)
  {
   if(!lbl.Create(0,&quot;Label_&quot;+name,0,x,y)) return(false);
   if(!lbl.Description(text))             return(false);
   if(!lbl.FontSize(10))                  return(false);
   if(!lbl.Color(clr))                    return(false);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 创建按钮                                                          |
//+------------------------------------------------------------------+
bool ButtonCreate(CChartObjectButton &amp;btn,const string name,
                  const int x,const int y)
  {
   if(!btn.Create(0,&quot;Button_&quot;+name,0,x,y,50,15)) return(false);
   if(!btn.Description(&quot;Next&quot;))                  return(false);
   if(!btn.FontSize(10))                         return(false);
   if(!btn.Color(clrBlack))                      return(false);
   if(!btn.BackColor(clrWhite))                  return(false);
   if(!btn.BorderColor(clrBlack))                return(false);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 定义最大和最小属性值和步骤                                           |
//+------------------------------------------------------------------+
void GetMaxMinStep(const int property_number,double &amp;max,double &amp;min,double &amp;step)
  {
   double value;
//--- 根据属性类型设置值
   switch(property_number)
     {
      case CHART_SCALE:
         max=5;
         min=0;
         step=1;
         break;
      case CHART_MODE:
      case CHART_SHOW_VOLUMES:
         max=2;
         min=0;
         step=1;
         break;
      case CHART_SHIFT_SIZE:
         max=50;
         min=10;
         step=2.5;
         break;
      case CHART_FIXED_POSITION:
         max=90;
         min=0;
         step=15;
         break;
      case CHART_POINTS_PER_BAR:
         max=19;
         min=1;
         step=3;
         break;
      case CHART_FIXED_MAX:
         value=ChartGetDouble(0,CHART_FIXED_MAX);
         max=value*1.25;
         min=value;
         step=value/32;
         break;
      case CHART_FIXED_MIN:
         value=ChartGetDouble(0,CHART_FIXED_MIN);
         max=value;
         min=value*0.75;
         step=value/32;
         break;
      case CHART_HEIGHT_IN_PIXELS:
         max=700;
         min=520;
         step=30;
         break;
         //--- 默认值
      default:
         max=1;
         min=0;
         step=1;
     }
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br><span class="line-number">292</span><br><span class="line-number">293</span><br><span class="line-number">294</span><br><span class="line-number">295</span><br><span class="line-number">296</span><br><span class="line-number">297</span><br><span class="line-number">298</span><br><span class="line-number">299</span><br><span class="line-number">300</span><br><span class="line-number">301</span><br><span class="line-number">302</span><br><span class="line-number">303</span><br><span class="line-number">304</span><br><span class="line-number">305</span><br><span class="line-number">306</span><br><span class="line-number">307</span><br><span class="line-number">308</span><br><span class="line-number">309</span><br><span class="line-number">310</span><br><span class="line-number">311</span><br><span class="line-number">312</span><br><span class="line-number">313</span><br><span class="line-number">314</span><br><span class="line-number">315</span><br><span class="line-number">316</span><br><span class="line-number">317</span><br><span class="line-number">318</span><br><span class="line-number">319</span><br><span class="line-number">320</span><br><span class="line-number">321</span><br><span class="line-number">322</span><br><span class="line-number">323</span><br><span class="line-number">324</span><br><span class="line-number">325</span><br><span class="line-number">326</span><br><span class="line-number">327</span><br><span class="line-number">328</span><br><span class="line-number">329</span><br><span class="line-number">330</span><br><span class="line-number">331</span><br><span class="line-number">332</span><br><span class="line-number">333</span><br><span class="line-number">334</span><br><span class="line-number">335</span><br><span class="line-number">336</span><br><span class="line-number">337</span><br><span class="line-number">338</span><br><span class="line-number">339</span><br><span class="line-number">340</span><br><span class="line-number">341</span><br><span class="line-number">342</span><br><span class="line-number">343</span><br><span class="line-number">344</span><br><span class="line-number">345</span><br><span class="line-number">346</span><br><span class="line-number">347</span><br><span class="line-number">348</span><br><span class="line-number">349</span><br><span class="line-number">350</span><br><span class="line-number">351</span><br><span class="line-number">352</span><br><span class="line-number">353</span><br><span class="line-number">354</span><br><span class="line-number">355</span><br><span class="line-number">356</span><br><span class="line-number">357</span><br><span class="line-number">358</span><br><span class="line-number">359</span><br><span class="line-number">360</span><br><span class="line-number">361</span><br><span class="line-number">362</span><br><span class="line-number">363</span><br><span class="line-number">364</span><br><span class="line-number">365</span><br><span class="line-number">366</span><br><span class="line-number">367</span><br><span class="line-number">368</span><br><span class="line-number">369</span><br><span class="line-number">370</span><br><span class="line-number">371</span><br><span class="line-number">372</span><br><span class="line-number">373</span><br><span class="line-number">374</span><br><span class="line-number">375</span><br><span class="line-number">376</span><br><span class="line-number">377</span><br><span class="line-number">378</span><br><span class="line-number">379</span><br><span class="line-number">380</span><br><span class="line-number">381</span><br><span class="line-number">382</span><br><span class="line-number">383</span><br><span class="line-number">384</span><br><span class="line-number">385</span><br><span class="line-number">386</span><br><span class="line-number">387</span><br><span class="line-number">388</span><br><span class="line-number">389</span><br><span class="line-number">390</span><br><span class="line-number">391</span><br><span class="line-number">392</span><br><span class="line-number">393</span><br><span class="line-number">394</span><br><span class="line-number">395</span><br><span class="line-number">396</span><br><span class="line-number">397</span><br><span class="line-number">398</span><br><span class="line-number">399</span><br><span class="line-number">400</span><br><span class="line-number">401</span><br><span class="line-number">402</span><br><span class="line-number">403</span><br><span class="line-number">404</span><br><span class="line-number">405</span><br><span class="line-number">406</span><br><span class="line-number">407</span><br><span class="line-number">408</span><br><span class="line-number">409</span><br><span class="line-number">410</span><br><span class="line-number">411</span><br><span class="line-number">412</span><br><span class="line-number">413</span><br><span class="line-number">414</span><br><span class="line-number">415</span><br><span class="line-number">416</span><br><span class="line-number">417</span><br><span class="line-number">418</span><br><span class="line-number">419</span><br><span class="line-number">420</span><br><span class="line-number">421</span><br><span class="line-number">422</span><br><span class="line-number">423</span><br><span class="line-number">424</span><br><span class="line-number">425</span><br><span class="line-number">426</span><br><span class="line-number">427</span><br><span class="line-number">428</span><br><span class="line-number">429</span><br><span class="line-number">430</span><br><span class="line-number">431</span><br><span class="line-number">432</span><br><span class="line-number">433</span><br><span class="line-number">434</span><br><span class="line-number">435</span><br><span class="line-number">436</span><br><span class="line-number">437</span><br><span class="line-number">438</span><br><span class="line-number">439</span><br><span class="line-number">440</span><br><span class="line-number">441</span><br><span class="line-number">442</span><br><span class="line-number">443</span><br><span class="line-number">444</span><br><span class="line-number">445</span><br><span class="line-number">446</span><br><span class="line-number">447</span><br><span class="line-number">448</span><br><span class="line-number">449</span><br><span class="line-number">450</span><br><span class="line-number">451</span><br><span class="line-number">452</span><br><span class="line-number">453</span><br><span class="line-number">454</span><br><span class="line-number">455</span><br><span class="line-number">456</span><br><span class="line-number">457</span><br><span class="line-number">458</span><br><span class="line-number">459</span><br><span class="line-number">460</span><br><span class="line-number">461</span><br><span class="line-number">462</span><br><span class="line-number">463</span><br><span class="line-number">464</span><br><span class="line-number">465</span><br><span class="line-number">466</span><br><span class="line-number">467</span><br><span class="line-number">468</span><br><span class="line-number">469</span><br><span class="line-number">470</span><br><span class="line-number">471</span><br><span class="line-number">472</span><br><span class="line-number">473</span><br><span class="line-number">474</span><br><span class="line-number">475</span><br><span class="line-number">476</span><br><span class="line-number">477</span><br><span class="line-number">478</span><br><span class="line-number">479</span><br><span class="line-number">480</span><br><span class="line-number">481</span><br><span class="line-number">482</span><br><span class="line-number">483</span><br><span class="line-number">484</span><br><span class="line-number">485</span><br><span class="line-number">486</span><br><span class="line-number">487</span><br><span class="line-number">488</span><br><span class="line-number">489</span><br><span class="line-number">490</span><br><span class="line-number">491</span><br><span class="line-number">492</span><br><span class="line-number">493</span><br><span class="line-number">494</span><br><span class="line-number">495</span><br><span class="line-number">496</span><br><span class="line-number">497</span><br><span class="line-number">498</span><br><span class="line-number">499</span><br><span class="line-number">500</span><br><span class="line-number">501</span><br><span class="line-number">502</span><br><span class="line-number">503</span><br><span class="line-number">504</span><br><span class="line-number">505</span><br><span class="line-number">506</span><br><span class="line-number">507</span><br><span class="line-number">508</span><br><span class="line-number">509</span><br><span class="line-number">510</span><br><span class="line-number">511</span><br><span class="line-number">512</span><br><span class="line-number">513</span><br><span class="line-number">514</span><br><span class="line-number">515</span><br><span class="line-number">516</span><br><span class="line-number">517</span><br><span class="line-number">518</span><br><span class="line-number">519</span><br><span class="line-number">520</span><br><span class="line-number">521</span><br><span class="line-number">522</span><br><span class="line-number">523</span><br><span class="line-number">524</span><br><span class="line-number">525</span><br><span class="line-number">526</span><br><span class="line-number">527</span><br><span class="line-number">528</span><br><span class="line-number">529</span><br><span class="line-number">530</span><br><span class="line-number">531</span><br><span class="line-number">532</span><br><span class="line-number">533</span><br><span class="line-number">534</span><br><span class="line-number">535</span><br><span class="line-number">536</span><br><span class="line-number">537</span><br><span class="line-number">538</span><br><span class="line-number">539</span><br><span class="line-number">540</span><br><span class="line-number">541</span><br><span class="line-number">542</span><br><span class="line-number">543</span><br><span class="line-number">544</span><br><span class="line-number">545</span><br><span class="line-number">546</span><br><span class="line-number">547</span><br><span class="line-number">548</span><br><span class="line-number">549</span><br><span class="line-number">550</span><br><span class="line-number">551</span><br><span class="line-number">552</span><br><span class="line-number">553</span><br><span class="line-number">554</span><br><span class="line-number">555</span><br><span class="line-number">556</span><br><span class="line-number">557</span><br><span class="line-number">558</span><br><span class="line-number">559</span><br><span class="line-number">560</span><br><span class="line-number">561</span><br><span class="line-number">562</span><br><span class="line-number">563</span><br><span class="line-number">564</span><br><span class="line-number">565</span><br><span class="line-number">566</span><br><span class="line-number">567</span><br><span class="line-number">568</span><br><span class="line-number">569</span><br><span class="line-number">570</span><br><span class="line-number">571</span><br><span class="line-number">572</span><br><span class="line-number">573</span><br><span class="line-number">574</span><br><span class="line-number">575</span><br></div></div><h2 id="_2-2-对象常量"><a href="#_2-2-对象常量" class="header-anchor">#</a> 2 .2 对象常量</h2> <p>在价格图表中可以创建44 个可显示的图解对象，所有与对象有关的常量都被分成9组：</p> <p>• 对象类型 —— 图解对象的标识符；
• 对象属性 —— 设置 或/和 获得 图解对象的属性参数；
• 对象定位方法 —— 在图表中定位对象常量；
• 定位角 —— 设置一个物体在图表上的相对位置;
• 对象可见性 —— 设置对象在 哪些/全部 时间框架图表 可显示;
• 艾略特波动水平 —— 波浪分级；
• 江恩对象 —— 江恩角度线(Gann fan) 和 江恩网格(Gann grid)的趋向常量；
• 网页颜色 —— 预定义网络颜色的常量；
• Wingdings —— Wingdings字库的字符代码；</p> <h3 id="_2-2-1-对象-物件-类型"><a href="#_2-2-1-对象-物件-类型" class="header-anchor">#</a> 2.2.1 对象（物件）类型</h3> <p>当使用ObjectCreate()函数创建图形对象时，必须指定要创建的对象的类型，类型可以是枚举型变量 ENUM_OBJECT 的一个值。对象属性的进一步规范可以使用与图形对象一起工作的函数。</p> <p>ENUM_OBJECT</p> <table><thead><tr><th>ID</th> <th>图标</th> <th>描述</th></tr></thead> <tbody><tr><td>OBJ_VLINE</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAIAAAAOCAAAAAFXGKIVAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAAXSURBVBhXY1jBMAsJLmGIQYKzMNCiqQBLfw4MtRlm9QAAAABJRU5ErkJggg==" alt="Alt text"></td> <td>垂直线</td></tr> <tr><td>OBJ_HLINE</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAMBAMAAAHXqaF/AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAYUExURQAAAKioqJqamqKioqSkpFxcXJWVlQAAAEjSsU0AAAAIdFJOU/////////8A3oO9WQAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAC1JREFUGNNjKIdBICqAoXIgIRoaGgBhoRGhoaEKqGIgAKeFlEBAEUMcTJaXAwDitSWjYo5q5wAAAABJRU5ErkJggg==" alt="Alt text"></td> <td>水平线</td></tr> <tr><td>OBJ_TREND</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMAgMAAAFcHITiAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAMUExURb17ezo6ezq9ewAAALz3ip8AAAAEdFJOU////wBAKqn0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAARElEQVQY0w3IUQmAQBAA0YlgkzOAoA2MaBUDCMomWdAfwWNc5uPBkNXOwlMeTDjwJlvihSNfcidnMtcxsDcM6U1CWfUHJzIjIhdnjGUAAAAASUVORK5CYII=" alt="Alt text"></td> <td>趋势线</td></tr> <tr><td>OBJ_TRENDBYANGLE</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAMAAAFfke11AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAB+UExURQAAANPT04aGhtHR0Xd3d8rKytDQ0HNzc8nJyc/Pz29vb87OzmlpacjIyMzMzGBgYMvLy1tbW1xcXKmpqVFRUVdXV8XFxd3d3WVlZaysrEtLS/Dw8MbGxtjY2E9PT0VFRUxMTJOTk4uLi8TExEhISNnZ2Tg4ODY2NkFBQQAAAE/F0X0AAAAqdFJOU///////////////////////////////////////////////////////ADKo8FwAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABpSURBVBhXTU/LCsAwCJOys5ciFnaQnUb+/wcXdaML+Egi2gogiMyaWckIJhc4xepb1DLVwHn2tFvH6Ho0XwxWmzDjarhHSFBk9PyuXLLeEwlN8lG1Ik1JfE3uOPlKjXKuUe79R/5hA3gAO0sbGZSNFy4AAAAASUVORK5CYII=" alt="Alt text"></td> <td>趋势线角度</td></tr> <tr><td>OBJ_CYCLES</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOBAMAAAGaYQB0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAkUExURQAAAKioqKSkpM7OzpqamlxcXM/Pz7+/v8HBwaKiopWVlQAAAFfvY7gAAAAMdFJOU///////////////ABLfzs4AAAAJcEhZcwAADsQAAA7EAZUrDhsAAABUSURBVBjTY9gNg2AkIsDgHQBCrgEMW7Zu3cCwZTOI2AIkNhpLb2DYWuwNJHaDCFc4y9gbKrHbdYvplmigQa67d0Pozc4QenswqjhUncju3Ru9dwMAGOw6SLOAZn0AAAAASUVORK5CYII=" alt="Alt text"></td> <td>周期线</td></tr> <tr><td>OBJ_ARROWED_LINE</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAFNn5ArAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAACLSURBVBhXY/j/HxmtzgUSYBaYOAwkqoGsJTCxJbnvIQyz1UtADJAEVAoEUBm5ufEQRvzj22CGo2Q8WKrZCiTK8H9WDIj+zwClIYpBAM74///29vhYhEB8/M6n73O3I6nQWhC/KxdIQwWSwtSBqkAssMCsWX4gCgyAArOWQG0CA4b/MchcJEMh4P9/ACxJ5DJFOAD2AAAAAElFTkSuQmCC" alt="Alt text"></td> <td>箭头线</td></tr> <tr><td>OBJ_CHANNEL</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAAGa2tLEAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAbUExURQAAAKSkpFxcXJqamoODg9bW1vv7+/Dw8AAAAB+hoJoAAAAJdFJOU///////////AFNPeBIAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAB7SURBVBjTFY0hD0JBDIOreBYuiCfJBVHJobAkCCQSya/g7G2XkP5s+rKsXbavGeTKrS17SGhE/MAPdFVFBhN514KaFikcWMNMpsDkDSp645iXL9Z5gnejm5tUnJ/QLNKBgr08woPkgLYvzKoBICrVXkuHucax6z6ZGsAf5FQtJOWJzeEAAAAASUVORK5CYII=" alt="Alt text"></td> <td>等距离通道</td></tr> <tr><td>OBJ_STDDEVCHANNEL</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAAGa2tLEAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAbUExURQAAAKSkpFxcXJqamoODg9bW1vv7+/Dw8AAAAB+hoJoAAAAJdFJOU///////////AFNPeBIAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAB7SURBVBjTFY0xDsJQDEO90REqho7oiyEjZeqKxMDIyMgReoSfVELv2LiK4jjRsyJctbflKNAcyp+iiztNlVGqB1IrC6QDU5op71GxiJGPznX7atouq299NbcFeX2JbYRTIM/xmTbgAPuXqEbXoGzB/D5I5uboNuaga/gD+xosrLik4IcAAAAASUVORK5CYII=" alt="Alt text"></td> <td>标准偏离通道</td></tr> <tr><td>OBJ_REGRESSION</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAQAgMAAAHDP/0BAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAMUExURb17ezo6ezq9ewAAALz3ip8AAAAEdFJOU////wBAKqn0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAVklEQVQY0w3IsQmAQBQE0WnADgRDyzCxrINrTjARNFCMzQ0UNBC+rsuwL1gON3kvcj0jGZ1EZhaVvwF1vDtf4gmKoAlyIH2tuRK6S3MqWBezZVPL9FL8X3A2u7EmB0sAAAAASUVORK5CYII=" alt="Alt text"></td> <td>线形回归通道</td></tr> <tr><td>OBJ_PITCHFORK</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAgMAAAEVmidkAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAMUExURb17ezo6ezq9ewAAALz3ip8AAAAEdFJOU////wBAKqn0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAWklEQVQY02M4wDCB4QOQPMtwmeE/EOcymDP8K2c4LsPw8TnDnXqG//UMf74zfD7PcN6WweYzmGHPUPOf4f9feSBx6a88w1/9S/8ZLv3Vv8jgDyThXKDst///ASiBMGgfxjb6AAAAAElFTkSuQmCC" alt="Alt text"></td> <td>安德鲁分叉线</td></tr> <tr><td>OBJ_GANNLINE</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAQBAMAAAGjvWOfAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAPUExURQAAAJqamlxcXKSkpAAAAJNuD9QAAAAFdFJOU/////8A+7YOUwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAFdJREFUGNM1jdsNgDAMA++jA6CKCRAToA6QUu8/E04qksiXh6Wgyhu5QAczOAO51C3dXVfLsfmuN7thWWkZliXL2Ff4fdJ8xEYyYRZEImhctSyf6r8j4AP6zBlBdcq2XgAAAABJRU5ErkJggg==" alt="Alt text"></td> <td>江恩线</td></tr> <tr><td>OBJ_GANNFAN</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAFfKj/FAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABCUExURQAAAOzs7M3NzXR0dGpqauTk5N3d3aWlpcPDw3x8fJOTk4uLi6ysrNTU1GNjY7W1tby8vIODg5ycnPDw8FxcXAAAAN/AsAwAAAAWdFJOU////////////////////////////wAB0sDkAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAmElEQVQYVy2PQQ7EMAgDTZByCUKIjf//1TVtOQBGE0xAAze4cNSsRaR7gQrYDcJDKS+gmbOXFE9U0ARk57CotZV/w0y4mKWcYnh3qappnyrYr/XwmT2mwPX0LQftGfLdY6K3G1fGvCZPM3xLPlvIcvP+5Azslu6RtH4Nj2fG1onPbhnf9OyqMkD+hPSJqNKvYXL9zn9CCvgD6poMi82LZAgAAAAASUVORK5CYII=" alt="Alt text"></td> <td>江恩扇形线</td></tr> <tr><td>OBJ_GANNGRID</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAAGa2tLEAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAYUExURZqamlxcXAAAAPz9/NbW1vDw8Obm5gAAAAVgPvwAAAAIdFJOU/////////8A3oO9WQAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAG9JREFUGNMdjLENAzEMA2kEAVu5Uq8mffwTeCLJeIDrRx9WBHFHEIXEjRL4hhfkGBcsMJMTWc6ezsLU2WCJ8A6KQ/DUhJOr9f0FfUdfPJzLXHSoTDklyNpIF0waVFovQzrx+TN3rIXXY8UVkLqciB/HZh7QlFq8eQAAAABJRU5ErkJggg==" alt="Alt text"></td> <td>江恩网格线</td></tr> <tr><td>OBJ_FIBO</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAQAgMAAAEs/ZY/AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAMUExURVxcXAAAAJqamgAAACiiAmoAAAAEdFJOU////wBAKqn0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAASElEQVQY02NgYPgAxqsYvgLpFQx/GL4w/P/DAAI1DP9rQGwUBBSJAZG7d+/ewGBsbGzA8P///w8Q7v//oQVAVvwHIAtMxH8AALE5Ltwfif7/AAAAAElFTkSuQmCC" alt="Alt text"></td> <td>斐波纳契回撤</td></tr> <tr><td>OBJ_FIBOTIMES</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAgMAAAEVmidkAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAMUExURVxcXJqamgAAAAAAAHdXQNUAAAAEdFJOU////wBAKqn0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAPElEQVQY02MAAQeGAgYBBiGG/2D4j8HcGIysGf7/ZvAvR0L1DP75DP5ZDP/fM/wHAkzi3yoQsR9G/NsPAEdVLiCm0d4wAAAAAElFTkSuQmCC" alt="Alt text"></td> <td>斐波纳契时间周期线</td></tr> <tr><td>OBJ_FIBOFAN</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAFfKj/FAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAA8UExURQAAANvb221tbezs7MzMzHNzc4ODg5OTk2RkZKSkpLW1tdTU1OXl5by8vJycnHt7e11dXY2NjcHBwQAAANVCTnYAAAAUdFJOU/////////////////////////8AT0/nEQAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAIRJREFUGFctjlEOwCAIQyEqqR+SJb3/XVdQYlj7LEMj+iwDjVT7SJNSZw7a8a322HEIKYbhlQfqpsgdKOFjllRo7harvhKeu/9I7EgXWStmBWxpQgvu2iYtyEhO3Okqx5EdJRucdZ69IELWA6lXCTiQ+eXRkq78EDKdrrg9U3XB1V0C5A8xWg1gUVhsPgAAAABJRU5ErkJggg==" alt="Alt text"></td> <td>斐波纳契扇形线</td></tr> <tr><td>OBJ_FIBOARC</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAFfKj/FAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAA/UExURQAAAImJicTExNvb29TU1GNjY+Xl5Xx8fHNzc6qqqpGRkZubm7S0tMzMzLy8vOvr66WlpVxcXGxsbICAgAAAAOvUrvsAAAAVdFJOU///////////////////////////ACvZfeoAAAAJcEhZcwAADsQAAA7EAZUrDhsAAACJSURBVBhXRU0JCgMwCLMUQSlahPz/rYt2Y0JtDo0CCKx7lOyoEiiEPCDHiqZ2oy8Gx2kEV98DkLe/9ocPWA23fYFdL6tFS2NxumfW0ppUDrELdsewev0pQF/Arl6hcAxp5lFBkVcFqeveVHfPpMiVm1ZlMYsvA1CPzOzsl24+8pB+N4f/hV9RAD4Hxw7nnwqemwAAAABJRU5ErkJggg==" alt="Alt text"></td> <td>斐波纳契弧线</td></tr> <tr><td>OBJ_FIBOCHANNEL</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAAGa2tLEAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAPUExURQAAAJqamlxcXKSkpAAAAJNuD9QAAAAFdFJOU/////8A+7YOUwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAGBJREFUGNMtjdkNxDAIROfDFVhuICsqiFyAsV//Ne2QBBBzCaFUF+7c2kugPXShYZ4xlNGddpo2XhCWhxDzoMNEJvbmKrmkwAzIm/ILPfrQj+4v+hX64IlY7YleQtVq/AEzvBybsr2boQAAAABJRU5ErkJggg==" alt="Alt text"></td> <td>斐波纳契通道</td></tr> <tr><td>OBJ_EXPANSION</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAAGa2tLEAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAPUExURVxcXAAAAJqamqSkpAAAAHXM03YAAAAFdFJOU/////8A+7YOUwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAFdJREFUGNNNSwkKwDAICywfEPqAQvuEfsAu/3/T1I4xMQcxAtALyAHm3sTyTAhpCYEGKkgxf9ozqFPYdKHLLXp+rl+tzDxTybhYpxFdM6TKm5Bapl686QG1mRi3vaMUvQAAAABJRU5ErkJggg==" alt="Alt text"></td> <td>斐波纳契扩展</td></tr> <tr><td>OBJ_ELLIOTWAVE5</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAPBAMAAAFoWmKKAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAPUExURQAAAJqamqSkpFxcXAAAAAcIq7cAAAAFdFJOU/////8A+7YOUwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAFtJREFUGNM9jdENwCAIRO/DBRq7gIEFGh1A9PafSbC2hLzcSy4AosHQMW+wg0SuJ/CyB5nNE5kCCLjqUIyhhG71eoA/Qs23uJkUk+k/hFOiXvnOvsWevgCckLgAXRcbEz3wPrwAAAAASUVORK5CYII=" alt="Alt text"></td> <td>艾略特驱动浪</td></tr> <tr><td>OBJ_ELLIOTWAVE3</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAPBAMAAAFoWmKKAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAPUExURQAAAJqamqSkpFxcXAAAAAcIq7cAAAAFdFJOU/////8A+7YOUwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAFZJREFUGNNVjMENwCAMA/1ghC6AYIGqDEDg9p+pSYQq9XOxFdsyXUJThpgC7aGRAruRjVBQPrhd3dE3WmG79/wx+QGrmcXarrnWyPa56AnOkmFi44jCC8zqHEHuArSzAAAAAElFTkSuQmCC" alt="Alt text"></td> <td>艾略特调整浪</td></tr> <tr><td>OBJ_RECTANGLE</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAMAAAFfke11AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAA2UExURaysrPv7+/X19erq6uPj49zc3NTU1MvLy8TExLy8vGNjY7S0tKSkpJubm5OTk4yMjAAAAAAAALseqI0AAAASdFJOU///////////////////////AOK/vxIAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABpSURBVBhXTU7RCkUxCHLEiIIY+/+fPeo5F64PNUttEEalDpAFXMLTXcXBaECyM8k5YKGeyjl0fFheN1ayoxFq09jWtW3qCnfeEiIc2/Y7gTLREKGVtxjGFO34nmGmPvayo0j0P34XjHsfONAF7ob3mBUAAAAASUVORK5CYII=" alt="Alt text"></td> <td>矩型</td></tr> <tr><td>OBJ_TRIANGLE</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAMAAAFfke11AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAA8UExURQAAAKSkpHl5edzc3IODg7S0tMTExMvLy+fn54yMjJycnOvr69PT03R0dKysrJWVlby8vG1tbWRkZAAAAFO+l50AAAAUdFJOU/////////////////////////8AT0/nEQAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAG5JREFUGFdNTVsKxEAIE/MRdEBkvP9dV20LG/CRGFWqpHwyOns2a0hFByCeOsJE6tQD5i3JLqZ39JZnHjw7J9bnYLCE42t/IF2v7fHH30BobrOUAZh/NANk7zw0+h8z3PSUnJeZqV6I3n98HxZVP4D4CthLXt2wAAAAAElFTkSuQmCC" alt="Alt text"></td> <td>三角形</td></tr> <tr><td>OBJ_ELLIPSE</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAOCAMAAAFm9lwuAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAA/UExURQAAAOzs7MzMzLq6urS0tMTExKSkpKurq+Pj49/f39TU1JGRkZubm/f394yMjIKCgmpqalxcXGRkZHNzcwAAALzmCJcAAAAVdFJOU///////////////////////////ACvZfeoAAAAJcEhZcwAADsQAAA7EAZUrDhsAAACGSURBVBhXPY7tCkMhDEP78SMUusI07/+si95toUibHqPGNMKcBhi92ijJDVp4ti1AxOOVB4ZWWZXoLXvvWakVA+GHgVdATpcfhjYRkYBbSt3vw6y91oG/Ok0AAqHzGqH7L/frjOJcMVV1o9DjxkFmKBKtWZ8ie7V2qn73Lz1ndudt/889Ij+WKQpSqlKhrgAAAABJRU5ErkJggg==" alt="Alt text"></td> <td>椭圆形</td></tr> <tr><td>OBJ_ARROW_THUMB_UP</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAFfKj/FAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABRUExURQAAAKOjo5ycnNzc3HR0dMzMzJOTlLS0tOLi4qysrLu8vISEhMTExOvr67a2t4yMjGRkZL/Av29vb9TV1sDBwXx8fNna2oeIh7e4uFtbWwAAAGraFQkAAAAbdFJOU///////////////////////////////////ACc0CzUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAACgSURBVBhXNY6NDgIxCIORUZPhnRJP08j7P6idP03Gmg4+Zj0Mad0Wrppt84mwnkr6gTYGhl0C0GsXVazd6bfR5h6xgcO6qhK1OO066hFr/5nv1DyTKWe8RQGDQkcCRywzAZSdFof5WlNS4AOT/kFSH1v6BbsnieWsmciJmgmnQqOQecR86Pax9q1gRGopiHHXyJZ5RW0KFJege3xEn16FN6okDw+HC87AAAAAAElFTkSuQmCC" alt="Alt text"></td> <td>大拇指向上</td></tr> <tr><td>OBJ_ARROW_THUMB_DOWN</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAFfKj/FAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABOUExURQAAAOPk5Ly8vLS0tJycnJOTk4yMjNTU1MTExKSkpKqqqtzc3MvMzNfY14ODg3R0dNna2nx8fOrr69/g4G5ubmdnZ7i5ub/Av1tbWwAAAPCC2R4AAAAadFJOU/////////////////////////////////8AFCIA2gAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAJtJREFUGFc1j+EKAzEIgyUTf2iGUDiY7/+ii7ebUEijfk1t3Jp2whzmPLCZHBvEWB2mAWwNzZgXWERoHvUmd5Qeo5bO8CfgHke7oVlijF1HKgzXOoK9PmpAranGbu56/znRK8qd7pmJFE+BvKopkopxBUx8AW+H3ZdSgdcGVKFbf8roaIdH6LoMgZWvgbzVYyhF7puqx5iKTTMzX11cDo2OcXUjAAAAAElFTkSuQmCC" alt="Alt text"></td> <td>大拇指向下</td></tr> <tr><td>OBJ_ARROW_UP</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAMAAAFfke11AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABFUExURQAAAJiYmGNjY/r6+tbW19TU09DQ0MvMzO/v78zLzMfHx8PDwr6+vsPDw6mpqbm5ubS0tK+vr6qqqqWlpqGhoZycnAAAAFUVHSoAAAAXdFJOU/////////////////////////////8A5kDmXgAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAF5JREFUGFdFjVEOgDAIQy1qMPFjkQ/uf1QLxfgyVgqDbZlbWt888NI2jJMRk2eiFXAzeVO9KKUt3Y+uA0vvIlQPzYtPB1n0KCmLy93XPUtJrOfv1tr6n8ga6UR2yHwBrgANvahlZnoAAAAASUVORK5CYII=" alt="Alt text"></td> <td>向上箭头</td></tr> <tr><td>OBJ_ARROW_DOWN</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAMAAAFfke11AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABFUExURQAAAGNjY6mpqZycnJiYmKWlpqGhoa+vr6qqqrm5ubS0tMPDw76+vu/v79DQ0MzLzMfHx8PDwvr6+tTU08vMzNbW1wAAAJZEntoAAAAXdFJOU/////////////////////////////8A5kDmXgAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAFlJREFUGFc9jEEKADEIAyt40MMiFOr/n7pG0wbqJIa6MlcG5lcmBQMrPEMl46uSoZObhIqoQTPSmxpRprKe2bcuqYmmihsvmr2oJXcpsdV9IrrmKX69cZT5A92EDef5OnTEAAAAAElFTkSuQmCC" alt="Alt text"></td> <td>向下箭头</td></tr> <tr><td>OBJ_ARROW_STOP</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAMAAAFfke11AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADYUExURQAAAO7m5daPhMZPO601H8E5IsVSQNaSiOC2sMQ9HeRVK+NYL99SK9ZHJMs5GLwlCbsvGuK8tt+0rtxMI+9mOfNxRfFzSextReRfOdhMKswzH7YgCuzh39RFH/JoOe9dO7UfCbQaArwwG9J6buxaK/luQetaQsceCcgtGf//88wfCtRSQ84hDNM0IdQiDeRQI9gzINUuGdpBGONOPdVvYcwwDNg5Fb4pEL0bBeUmEuiHfOrZ170hAscqCOUsGN2ck+utptuYjtyooOrc2tRzZcgsF+iBdgAAAKGa3CAAAABIdFJOU///////////////////////////////////////////////////////////////////////////////////////////////AJzs8mAAAAAJcEhZcwAADsQAAA7EAZUrDhsAAACwSURBVBhXPYxRC4IwFIXPqrcQMmTW8KHF0iYjxZpuMipDuP//HzV76LwczuV+H2gNr7EiaIM5HyqQNATaMFxKiURrTM6DEp5vQ4pa6ZgKhbXC1fHO1ueJCPuMH0QgKK5KKSf83oxAt7Q/ItTP4DwDuUh9op9Sq7ZNYsMujTjrMs7zUonhJAcGk/34Ja6649b8Z+VbzLbve3v1p8U1gl4ytHaQznj/XsxUPIwxYmRE9AVf7CF2Nr//QQAAAABJRU5ErkJggg==" alt="Alt text"></td> <td>停止标志</td></tr> <tr><td>OBJ_ARROW_CHECK</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAMAAAFfke11AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAEmUExURQAAAOjr57Tdq5fSipXPiKTYmd7q25HQgyyyD0HAAlHHD03FEkbBD1zCRW/GXE3GC5bnOKHsQprnQY7hPn7aNWnQJ0XAGDe2G4/PgcXzic3wqK7uX6HnWIXXRmHAL1O8Ij27FES6KuPn4pnoO7zkmZLLhZrSda7ncJrcYXXDTL3fr4TGdj2qGa3WpJHfPXu9X/T58rzetITIWme1R9zu10efMS2rDojJem/FL6rUnLHWqXu5bDOWGCyoEITZOW3AOozDflGiPz6dITudHimkDTK0Fo7eS2O4Ok6rLk27NsvZyHrWO4TXS1GsLWyxXFi1NSeRECSqBGDKJ2bIM2fBOVOuMCmNEiScB9ni10q8HUmxIkOmIR+nADi1HSmtC6vaoR6rAAAAAA+1APAAAABidFJOU/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8AEFaSqgAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAMZJREFUGFctjMtKw0AARW9oEjplqrEPsA1G3IhmlSo1QkTbDiODCyuEpISSydz//4nOwtV9cDhghHCPgMgsgvDZgtoSHBFJWmJBg8D68yqZLSRRZhxY+S1rY1qfzMOYnhc386Um9OrxKe9zXEeM2WrIWVUY9YBjnTXq5Ln+zbqNTzJ0QkzkeOoreCvW61Wa3h3vZUcMIqmKzcurN2/tFKX8/Np5rGjU4U/jx9Xv3+Z3bxrVugiMx7o7n9VHe/o3c+is60ckeQGBYS8rqVorBwAAAABJRU5ErkJggg==" alt="Alt text"></td> <td>检测标志</td></tr> <tr><td>OBJ_ARROW_LEFT_PRICE</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOBAMAAAGaYQB0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAYUExURQAAAKSkpFxcXH5+ftna2kRERI+PjwAAAKqTPosAAAAIdFJOU/////////8A3oO9WQAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAFdJREFUGNNjKGdQAmJFBhNHhvJyhvICBhcDBiUFEKO8vFyAwVBQWAHEKoATCgwuLu4gwkmBQUlJHU0WBBiMQcBciMEkBAgMhRjU0oBAXQgqLwRXBybLywFHMiPlxfkbJwAAAABJRU5ErkJggg==" alt="Alt text"></td> <td>左侧价格标签</td></tr> <tr><td>OBJ_ARROW_RIGHT_PRICE</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOBAMAAAGaYQB0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAYUExURf///1xcXKSkpH5+ftna2kRERI+PjwAAAPUucysAAAAIdFJOU/////////8A3oO9WQAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAE1JREFUGNNjYGAQBGMRFwYIYHFgYBQAMcCEoIuLAwMCKIAIZRcXAwZhJSUDBkVBQQEGTCDEbAwCDELKrkDgzCDEmAYEiQxCWNQyMDAAAOPrCEzFoNnGAAAAAElFTkSuQmCC" alt="Alt text"></td> <td>右侧价格标签</td></tr> <tr><td>OBJ_ARROW_BUY</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAALCAMAAAEGt9y8AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAByUExURf///z2M0ANcxrHT8o2/7JzG7YO46YS56oW46Xqx53mx53my522o5EOQ0WOh4QthyE2R202R2jyF1TuF1l6e1kKO0V2d1jyL0Ct50St50kGQ0R1vzh5wzRhrzBpr0Cd5zAxiyAtjyAtjySBuy7DC1gAAAEn1AG0AAAAmdFJOU/////////////////////////////////////////////////8Ap3qBvAAAAAlwSFlzAAAOwwAADsMBx2+oZAAAAFVJREFUGFclTEEKgDAMC1PZwR1koxYvDqr/f6NJTaFNmhAQJzAw4a1IecFJ4rVKddIZ8YqnvVWZzPLYwYf5xR3xyKW1rJljwS78wpo6E95HUovJuQF8ArUEQ/VLKhEAAAAASUVORK5CYII=" alt="Alt text"></td> <td>买入(做多)箭头</td></tr> <tr><td>OBJ_ARROW_SELL</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAALCAMAAAEGt9y8AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABXUExURbwmErgdB7gdBromEMtkVuPg3////89PQbsgBLsgA7shBLwjB7ogCM5aSc1LPcY4IcY4IsMsDrkfCc5OQss3F9NCIN1NKOpgNvKKau5lOvSZffWqkgAAAJTxvpwAAAAddFJOU/////////////////////////////////////8AWYbnagAAAAlwSFlzAAAOwwAADsMBx2+oZAAAAFNJREFUGFctTFsKgEAQkqGM/ZEN2mjq/vfMafNDxBdAkAASHESsYEAJ9b0RUkY4lysRi7n33UwN85/eGfUR5bTCxqp4dRw2pxznlLqy8C2ox4J8AQF5BGLQZZEjAAAAAElFTkSuQmCC" alt="Alt text"></td> <td>卖出(做空)箭头</td></tr> <tr><td>OBJ_ARROW</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOBAMAAAGaYQB0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAwUExURQAAAFxcXPDw8MrKyuzs7IODg2NjY9LS0q2trcHBwd/f36GhoX9/f3R0dJubmwAAAAp2MEQAAAAQdFJOU////////////////////wDgI10ZAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAdUlEQVQY0xVNQQrCQBDLE7rbi7ehK4J4GexdfEShV/Gol76pL/BpnRX0JjEbyJBkAgGxiY7BQIKBHLh0TbxdpxxfgZ/1HSple/PA3m96DK27pEBdk/qUohkFpOlu65UoKR8W+Uc57Vr+ec5ez1r5bsxjGxSMf6JbPPjudd8EAAAAAElFTkSuQmCC" alt="Alt text"></td> <td>箭头</td></tr> <tr><td>OBJ_TEXT</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOBAMAAAGaYQB0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAtUExURVxcXAAAAPDw8FNTVExMTEREROPj47y8vNLS0sPDw7W1tNjX13h4eNra2gAAAFs849MAAAAPdFJOU///////////////////ANTcmKEAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABiSURBVBjTPYm7DYAwDERvF0TLCMxAk5Yt0qalglEYhY42shRZoeFmwOZ3lt7z2ehxgDaaQLOgDqjiC+moycsm6Pnf2s6g/LDn94HGUhSFIYRRIcwxLd4ZEx+vt89pdqtF9QLLtFEAeZWGKgAAAABJRU5ErkJggg==" alt="Alt text"></td> <td>文本</td></tr> <tr><td>OBJ_LABEL</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOBAMAAAGaYQB0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAwUExURQAAAKurq6GhoXBwcGZmZlxcXMnJyb+/v42NjXp6etLS0ubm5peXl7W1tdzc3AAAAIbMhBoAAAAQdFJOU////////////////////wDgI10ZAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAb0lEQVQY0y2KIQ7CUBBE5wgYFKKXwaCKWVFVwxXQpKIaRyXH4ST4bdLm5wfxutuQzbyXzKz4X+kFml24HtckSxN4flwL60HM2R0TQwyF3lWZXCe+0cGOcyRcb+3u1++Srmb2Dk9QOjRaw926/AfYAOVvVHevKW5tAAAAAElFTkSuQmCC" alt="Alt text"></td> <td>文本标签</td></tr> <tr><td>OBJ_BUTTON</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAOCAMAAAGwU4ZLAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACTUExURQAAAOrq6pqampSVlfj4+NnZ2bq6uujo6I2MjO/v76SkpA4ODjs7O7OzsywsLIyNjYOEg+Tk5EdHR5ycnDg4OA0NDYODg3l4edjY2DU1NZSUlKKionl5eW5ubs/Pz3R0dCYmJjMzM5ubm01NTWRkZMjIyJaWllpaW1taW1NTU1NSU1NTUlJTUlJSUlJTU1NSUgAAAAFL+PsAAAAxdFJOU////////////////////////////////////////////////////////////////wAfmk4hAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAgklEQVQYV1VOywoEMQgLUksze/PS00oLA0svS///69bOCzZKNJCImBMfWSyO8uqMNcRB3FqBZ98vKQeIqqV30QqOMb5mZ2ZZTodEEswkNGxQhbusxjCzyDz+a96ApJRUU8qJsQmK0ijGDiq1YHd/t1a9b808/hrxXfaDop67N/71nD9FqxZx20WqAQAAAABJRU5ErkJggg==" alt="Alt text"></td> <td>按钮</td></tr> <tr><td>OBJ_CHART</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAOCAIAAAHeSjtLAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAGUSURBVChTlZE9a8JgEMfvK/g18kFc1YigCLpkskvrdyg6qMQEHDKIuBVEBEUsIi4OYhVqVKLFRQWDYIY4+IaE/vOiVWiH/oaHu3vuufvfPfRsQT6fLxwOX71araZpGnEcNxgMnFggEIDzZuHkgXj8hS6Xi+1ks1lSVRVPUUuSJFIUxX7Q6/Xo6TfM98FgcLfbNZtNFLohCAJ5vd75fF4qlb7uKBaLP+3vMUs5VR8xL/r9/vl8djKvYD6SZRnN4Th9rVmgyLxYr9dutxvjfFjAxppoNBpBlcvlarVatiTYkErj8RgDV6tVe2YAG2sz5RqGcTqd9vu9ruubzWaxWMxms8lkMhwOPy1goDAiptpYLNbtdrE0nNhLoVAQRZHn+VQqlUwmE4nEq0U6ncY2kEyRSAQ1jsfj4XBot9toWK/X3x/BpyKeyWSQTH6/HwNitO1222g0otEotNng724n4rlcDsnk8Xigb7lcQnqlUmEYZrVaIanT6cCwT4B4Pp9HMrEsiw6YcjqdojX9TblcRjKF/kUo9A0pI4ksdWJbqgAAAABJRU5ErkJggg==" alt="Alt text"></td> <td>图表</td></tr> <tr><td>OBJ_BITMAP</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAFoTx1HAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAItSURBVChTlVJdS2JRFD3/T4RwgiB80HGwLopmehkhMjMtueLFydGrohUV6IP0GL711psfkWAUgqIiqJRUKmq55p4tE/M6GzYHzt5n7b3WOiyVSiEYPAILHgWRz+fBotEodnZ2wO7u7nB9fQ12fBxFIpGAoih4e3sDo7IahUKBTqYocYTlMPZ9+2DT6RQXFxeQZRmsXq+jUqkgFostW3lkMhkwJa7QzefnJ8bjMZ6fn9HpdOhkclhGv99HPB7HwcEBRFFEKBTCZDIB41Nubm6QzWZxcnICg8FASASbSCZoWCQSgRSS4PcHsLfngdvtBiNsNWazGV5fX9Hr9dBsNrG97QDj1EajESRJQi6Xg8fjQa1Wg8VqAeODu90uXC4XnE4nNjY2qGg2m8E+Pj7w+PhIRLe2tnB5eYlkMgmj0bgkfXV1RZIIggC9Xk+N/KTi33h/f8fa2ho0Gs2ywCEGg8F/pSi6wGK/YxgOh1gsFpjP52i1WsTI5/PBbrfD6/Xi/Pwc1WoVT09P1Guz2cB+qaJxCbg2XCuHw4HT01OcnZ2R+9zSQCBArDl73itsboJJqjdc1Ha7jUajgfv7e3rIASwWC6xWK9LpNG5vb1EsFvHy8gKTyQQW8PtpzYeHB0Isl8solUqUXK3Dw0Osr6+TMKur37CysgKtVgvG3eEi7e7ukiH/Juei0+lIYv6l+Mf4UtXt/glRdZGvZlcb+XqCsEmcTD9M+K6axqd8PaBg7A/F3w4Xin6QcQAAAABJRU5ErkJggg==" alt="Alt text"></td> <td>位图</td></tr> <tr><td>OBJ_BITMAP_LABEL</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAMAAAFfke11AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABUUExURZycnJWUlYuLi4iIh4SEhXt7e+zs7HR0dAAAAPz8/PT09OTk5KysrGxsbKSkpNTU1Nvb22NkY8bGxs3NzYiHiLa2tlxcXFRUU0tLS7+/v3h4dwAAAKPthSsAAAAcdFJOU////////////////////////////////////wAXsuLXAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAjElEQVQYV01O0QoDMQjLJueQtbtK4dqL//+fy94mgkZjImCwBhDjVosA6y5NDdEM43yiBFHh/naYkhaw+4Ms3T3EJOEVIhDh1ngmYvSe81dPNiRE7WssaVWsLUH/CwrqvB0pw+H5g/6SqR05vMNi+ASzY05tBc85Z9pae2/9S3Yy1+WQMtUm80rZVH0BuuMKDSuRQU4AAAAASUVORK5CYII=" alt="Alt text"></td> <td>位图标签</td></tr> <tr><td>OBJ_EDIT</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAAGa2tLEAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAkUExURYGBgH19fAAAAHV2dWxsbGNjZE1NTePj41xdXFRUVFJRUgAAADkqU5AAAAAMdFJOU///////////////ABLfzs4AAAAJcEhZcwAADsQAAA7EAZUrDhsAAABQSURBVBjTY+Bm2A2BMLQNhnbvBglsgxMgrvVuGGu3OYiIxkKAZA02b968FQgYNu9OTgMKgBhbZwMZO4GMzdlgxtbdWzEYqWkQxtadQLBzJwAld1algs4sqAAAAABJRU5ErkJggg==" alt="Alt text"></td> <td>文本编辑框</td></tr> <tr><td>OBJ_EVENT</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB0AAAAPAgMAAAES5ByaAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAMUExURf///wAAAP/AywAAAFQRKF0AAAAEdFJOU////wBAKqn0AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAX0lEQVQY0z2LQQrAIAwE92l+wkK9V4iv8STUUw9FdF/ZJEKXZJkkGwCH9oUyrVR8wGkeYwzIvT3bfHQpaYwM6FwVzKIvw8h2fv1VaKoKklZqr0IZfchyoIOc6d4nD1d8TG4yPDLSfU0AAAAASUVORK5CYII=" alt="Alt text"></td> <td>“事件”对象在经济日历对应一个事件</td></tr> <tr><td>OBJ_RECTANGLE_LABEL</td> <td><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB0AAAASAgMAAAGtrA3fAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAMUExURShklkaCtGSg0gAAAADft9UAAAAEdFJOU////wBAKqn0AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAP0lEQVQY02NgYBBl0AKSYQyrGETDQAgIQkOgaNUKBtHQ0Ah0AgyArAQChNaqVQsY4IA1FATCGshkcK0CgVUNAElLKdhO5BigAAAAAElFTkSuQmCC" alt="Alt text"></td> <td>用于创建和设计自定义图形界面的“矩形标签”对象。</td></tr></tbody></table> <h4 id="_2-2-1-1-obj-vline垂直线"><a href="#_2-2-1-1-obj-vline垂直线" class="header-anchor">#</a> 2.2.1.1 OBJ_VLINE垂直线</h4> <p><img src="data:image/png;base64,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" alt="Alt text"></p> <p>ObjVLine</p> <p>注意</p> <p>绘制垂直线时，可以设置所有图表窗口的线显示模式（属性 OBJPROP_RAY）。</p> <p>示例</p> <p>下面的脚本创建并移动图表上的垂直线。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 描述
#property description &quot;Script draws \&quot;Vertical Line\&quot; graphical object.&quot;
#property description &quot;Anchor point date is set in percentage of&quot;
#property description &quot;the chart window width in bars.&quot;
//--- 启动脚本期间显示输入参数的窗口
#property script_show_inputs
//--- 脚本的输入参数
input string          InpName=&quot;VLine&quot;;     // 线的名称
input int             InpDate=25;          // 事件日期，%
input color           InpColor=clrRed;     // 线的颜色
input ENUM_LINE_STYLE InpStyle=STYLE_DASH; // 线的风格
input int             InpWidth=3;          // 线的宽度
input bool            InpBack=false;       // 背景线
input bool            InpSelection=true;   // 突出移动
input bool            InpRay=true;         // 线延续下降
input bool            InpHidden=true;      // 隐藏在对象列表
input long            InpZOrder=0;         // 鼠标单击优先
//+------------------------------------------------------------------+
//| 创建垂直线                                                        |
//+------------------------------------------------------------------+
bool VLineCreate(const long            chart_ID=0,        // 图表 ID
                 const string          name=&quot;VLine&quot;,      // 线的名称
                 const int             sub_window=0,      // 子窗口指数
                 datetime              time=0,            // 线的时间
                 const color           clr=clrRed,        // 线的颜色
                 const ENUM_LINE_STYLE style=STYLE_SOLID, // 线的风格
                 const int             width=1,           // 线的宽度
                 const bool            back=false,        // 在背景中
                 const bool            selection=true,    // 突出移动
                 const bool            ray=true,          // 线延续下降
                 const bool            hidden=true,       // 隐藏在对象列表
                 const long            z_order=0)         // 鼠标单击优先
  {
//--- 如果没有线的时间，通过收盘柱来绘制它
   if(!time)
      time=TimeCurrent();
//--- 重置错误的值
   ResetLastError();
//--- 创建垂直线
   if(!ObjectCreate(chart_ID,name,OBJ_VLINE,sub_window,time,0))
     {
      Print(__FUNCTION__,
            &quot;: failed to create a vertical line! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 设置线的颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//--- 设置线的显示风格
   ObjectSetInteger(chart_ID,name,OBJPROP_STYLE,style);
//--- 设置线的宽度
   ObjectSetInteger(chart_ID,name,OBJPROP_WIDTH,width);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 通过鼠标移动线的模式
//--- 当使用ObjectCreate函数创建图形对象时，对象不能
//--- 默认下突出并移动。在这个方法中，默认选择参数
//--- true 可以突出移动对象
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 启用 (true) 或禁用 (false) the mode of displaying the line in the chart subwindows
   ObjectSetInteger(chart_ID,name,OBJPROP_RAY,ray);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动垂直线                                                        |
//+------------------------------------------------------------------+
bool VLineMove(const long   chart_ID=0,   // 图表 ID
               const string name=&quot;VLine&quot;, // 线的名称
               datetime     time=0)       // 线的时间
  {
//--- 如果没有设置线的时间，将线移动到收盘柱
   if(!time)
      time=TimeCurrent();
//--- 重置错误的值
   ResetLastError();
//--- 移动垂直线
   if(!ObjectMove(chart_ID,name,0,time,0))
     {
      Print(__FUNCTION__,
            &quot;: failed to move the vertical line! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 删除垂直线                                                        |
//+------------------------------------------------------------------+
bool VLineDelete(const long   chart_ID=0,   // 图表 ID
                 const string name=&quot;VLine&quot;) // 线的名称
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除垂直线
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete the vertical line! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 检查输入参数的正确性
   if(InpDate &lt; 0 || InpDate &gt; 100)
     {
      Print(&quot;Error! Incorrect values of input parameters!&quot;);
      return;
     }
//--- 图表窗口的可见柱的数量
   int bars=(int)ChartGetInteger(0,CHART_VISIBLE_BARS);
//--- 存储要使用的日期值的数组
//--- 设置和改变线定位点的坐标
   datetime date[];
//--- 内存分配
   ArrayResize(date,bars);
//--- 填写日期数组
   ResetLastError();
   if(CopyTime(Symbol(),Period(),0,bars,date)==-1)
     {
      Print(&quot;Failed to copy time values! Error code = &quot;,GetLastError());
      return;
     }
//--- 定义画线的点
   int d=InpDate*(bars-1)/100;
//--- 创建垂直线
   if(!VLineCreate(0,InpName,0,date[d],InpColor,InpStyle,InpWidth,InpBack,
      InpSelection,InpRay,InpHidden,InpZOrder))
      return;
//--- 重画图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- 现在，移动线
//--- 循环计数器
   int h_steps=bars/2;
//--- 移动线
   for(int i=0;i&lt;h_steps;i++)
     {
      //--- 使用下面的值
      if(d&lt;bars-1)
         d+=1;
      //--- 移动点
      if(!VLineMove(0,InpName,date[d]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
      // 0.03 秒延迟
      Sleep(30);
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 删除图表通道
   VLineDelete(0,InpName);
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br></div></div><h4 id="_2-2-1-3-obj-trend趋势线"><a href="#_2-2-1-3-obj-trend趋势线" class="header-anchor">#</a> 2.2.1.3 OBJ_TREND趋势线</h4> <p><img src="data:image/png;base64,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" alt="Alt text"></p> <p>ObjTrend</p> <p>注意</p> <p>对于趋势线，可以指定它 向右 和/或 向左 延长显示的模式 (根据属性值OBJPROP_RAY_RIGHT 和 OBJPROP_RAY_LEFT 决定)。</p> <p>示例</p> <p>下面的脚本创建并移动图表上的趋势线。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 描述
#property description &quot;Script draws \&quot;Trend Line\&quot; graphical object.&quot;
#property description &quot;Anchor point coordinates are set in percentage of&quot;
#property description &quot;the chart window size.&quot;
//--- 启动脚本期间显示输入参数的窗口
#property script_show_inputs
//--- 脚本的输入参数
input string          InpName=&quot;Trend&quot;;     // 线的名称
input int             InpDate1=35;         // 第1个点的日期， %
input int             InpPrice1=60;        // 第1个点的价格， %
input int             InpDate2=65;         // 第2个点的日期，%
input int             InpPrice2=40;        // 第2个点的价格，%
input color           InpColor=clrRed;     // 线的颜色
input ENUM_LINE_STYLE InpStyle=STYLE_DASH; // 线的风格
input int             InpWidth=2;          // 线的宽度
input bool            InpBack=false;       // 背景线
input bool            InpSelection=true;   // 突出移动
input bool            InpRayLeft=false;    // 线延续向左
input bool            InpRayRight=false;   // 线延续向右
input bool            InpHidden=true;      // 隐藏在对象列表
input long            InpZOrder=0;         // 鼠标单击优先
//+------------------------------------------------------------------+
//| 通过已给的坐标创建趋势线                                            |
//+------------------------------------------------------------------+
bool TrendCreate(const long            chart_ID=0,        // 图表 ID
                 const string          name=&quot;TrendLine&quot;,  // 线的名称
                 const int             sub_window=0,      // 子窗口指数
                 datetime              time1=0,           // 第一个点的时间
                 double                price1=0,          // 第一个点的价格
                 datetime              time2=0,           // 第二个点的时间
                 double                price2=0,          // 第二个点的价格
                 const color           clr=clrRed,        // 线的颜色
                 const ENUM_LINE_STYLE style=STYLE_SOLID, // 线的风格
                 const int             width=1,           // 线的宽度
                 const bool            back=false,        // 在背景中
                 const bool            selection=true,    // 突出移动
                 const bool            ray_left=false,    // 线延续向左
                 const bool            ray_right=false,   // 线延续向右
                 const bool            hidden=true,       // 隐藏在对象列表
                 const long            z_order=0)         // 鼠标单击优先
  {
//--- 若未设置则设置定位点的坐标
   ChangeTrendEmptyPoints(time1,price1,time2,price2);
//--- 重置错误的值
   ResetLastError();
//--- 通过已给的坐标创建趋势线
   if(!ObjectCreate(chart_ID,name,OBJ_TREND,sub_window,time1,price1,time2,price2))
     {
      Print(__FUNCTION__,
            &quot;: failed to create a trend line! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 设置线的颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//--- 设置线的显示风格
   ObjectSetInteger(chart_ID,name,OBJPROP_STYLE,style);
//--- 设置线的宽度
   ObjectSetInteger(chart_ID,name,OBJPROP_WIDTH,width);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 通过鼠标移动线的模式
//--- 当使用ObjectCreate函数创建图形对象时，对象不能
//--- 默认下突出并移动。在这个方法中，默认选择参数
//--- true 可以突出移动对象
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 启用 (true) 或禁用 (false) 延续向左显示线的模式
   ObjectSetInteger(chart_ID,name,OBJPROP_RAY_LEFT,ray_left);
//--- 启用 (true) 或禁用 (false) 延续向右显示线的模式
   ObjectSetInteger(chart_ID,name,OBJPROP_RAY_RIGHT,ray_right);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动趋势线定位点                                                   |
//+------------------------------------------------------------------+
bool TrendPointChange(const long   chart_ID=0,       // 图表 ID
                      const string name=&quot;TrendLine&quot;, // 线的名称
                      const int    point_index=0,    // 定位点指数
                      datetime     time=0,           // 定位点时间坐标
                      double       price=0)          // 定位点价格坐标
  {
//--- 如果没有设置点的位置，则将其移动到当前的卖价柱
   if(!time)
      time=TimeCurrent();
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 重置错误的值
   ResetLastError();
//--- 移动趋势线定位点
   if(!ObjectMove(chart_ID,name,point_index,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to move the anchor point! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 这个函数删除图表的趋势线                                            |
//+------------------------------------------------------------------+
bool TrendDelete(const long   chart_ID=0,       // chart's ID
                 const string name=&quot;TrendLine&quot;) // 线的颜色
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除趋势线
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete a trend line! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 检查趋势线定位点的值和为空点设置                                      |
//| 默认的值                                                           |
//+------------------------------------------------------------------+
void ChangeTrendEmptyPoints(datetime &amp;time1,double &amp;price1,
                            datetime &amp;time2,double &amp;price2)
  {
//--- 如果第一点的时间没有设置，它将位于当前柱
   if(!time1)
      time1=TimeCurrent();
//--- 如果第一点的价格没有设置，则它将用卖价值
   if(!price1)
      price1=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 如果第二点的时间没有设置，它则位于第二点左侧的9个柱
   if(!time2)
     {
      //--- 接收最近10柱开盘时间的数组
      datetime temp[10];
      CopyTime(Symbol(),Period(),time1,10,temp);
      //--- 在第一点左侧9柱设置第二点
      time2=temp[0];
     }
//--- 如果第二点的价格没有设置，则它与第一点的价格相等
   if(!price2)
      price2=price1;
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 检查输入参数的正确性
   if(InpDate1 &lt; 0 || InpDate1 &gt; 100 || InpPrice1 &lt; 0 || InpPrice1 &gt; 100 ||
      InpDate2 &lt; 0 || InpDate2 &gt; 100 || InpPrice2 &lt; 0 || InpPrice2 &gt; 100)
     {
      Print(&quot;Error! Incorrect values of input parameters!&quot;);
      return;
     }
//--- 图表窗口的可见柱的数量
   int bars=(int)ChartGetInteger(0,CHART_VISIBLE_BARS);
//--- 价格数组大小
   int accuracy=1000;
//--- 存储要使用的日期和价格值的数组
//--- 设置和改变线定位点的坐标
   datetime date[];
   double   price[];
//--- 内存分配
   ArrayResize(date,bars);
   ArrayResize(price,accuracy);
//--- 填写日期数组
   ResetLastError();
   if(CopyTime(Symbol(),Period(),0,bars,date)==-1)
     {
      Print(&quot;Failed to copy time values! Error code = &quot;,GetLastError());
      return;
     }
//--- 填写价格数组
//--- 找出图表的最高值和最低值
   double max_price=ChartGetDouble(0,CHART_PRICE_MAX);
   double min_price=ChartGetDouble(0,CHART_PRICE_MIN);
//--- 定义变化的价格并填写该数组
   double step=(max_price-min_price)/accuracy;
   for(int i=0;i &lt; accuracy;i++)
      price[i]=min_price+i*step;
//--- 定义画线的点
   int d1=InpDate1*(bars-1)/100;
   int d2=InpDate2*(bars-1)/100;
   int p1=InpPrice1*(accuracy-1)/100;
   int p2=InpPrice2*(accuracy-1)/100;
//--- 创建趋势线
   if(!TrendCreate(0,InpName,0,date[d1],price[p1],date[d2],price[p2],InpColor,InpStyle,
      InpWidth,InpBack,InpSelection,InpRayLeft,InpRayRight,InpHidden,InpZOrder))
     {
      return;
     }
//--- 重画图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- 现在，移动线的定位点
//--- 循环计数器
   int v_steps=accuracy/5;
//--- 垂直移动第一个定位点
   for(int i=0;i &lt; v_steps;i++)
     {
      //--- 使用下面的值
      if(p1&gt;1)
         p1-=1;
      //--- 移动点
      if(!TrendPointChange(0,InpName,0,date[d1],price[p1]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 垂直移动第二个定位点
   for(int i=0;i &lt; v_steps;i++)
     {
      //--- 使用下面的值
      if(p2&lt;accuracy-1)
         p2+=1;
      //--- 移动点
      if(!TrendPointChange(0,InpName,1,date[d2],price[p2]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 半秒延迟
   Sleep(500);
//--- 循环计数器
   int h_steps=bars/2;
//--- 同时水平移动两个定位点
   for(int i=0;i&lt;h_steps;i++)
     {
      //--- 使用下面的值
      if(d1&lt;bars-1)
         d1+=1;
      if(d2&gt;1)
         d2-=1;
      //--- 切换点
      if(!TrendPointChange(0,InpName,0,date[d1],price[p1]))
         return;
      if(!TrendPointChange(0,InpName,1,date[d2],price[p2]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
      // 0.03 秒延迟
      Sleep(30);
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 删除趋势线
   TrendDelete(0,InpName);
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br></div></div><h4 id="_2-2-1-4-obj-trendbyangle角度趋势线"><a href="#_2-2-1-4-obj-trendbyangle角度趋势线" class="header-anchor">#</a> 2.2.1.4 OBJ_TRENDBYANGLE角度趋势线</h4> <p><img src="data:image/png;base64,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" alt="Alt text"></p> <p>ObjTrendByAngle</p> <p>注意</p> <p>对于角度趋势线，可以指定它 向右 和/或 向左 延长显示的模式 (根据属性值OBJPROP_RAY_RIGHT 和 OBJPROP_RAY_LEFT 决定)。</p> <p>角度 和 第二个锚点的坐标 这二个参数都可以用来设置直线的斜率。</p> <p>示例</p> <p>下面的脚本创建并移动图表上的角度趋势线。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 描述
#property description &quot;Script draws \&quot;Trend Line By Angle\&quot; graphical object.&quot;
#property description &quot;Anchor point coordinates are set in percentage of the size of&quot;
#property description &quot;the chart window.&quot;
//--- 启动脚本期间显示输入参数的窗口
#property script_show_inputs
//--- 脚本的输入参数
input string          InpName=&quot;Trend&quot;;     // 线的名称
input int             InpDate1=50;         // 第1个点的日期， %
input int             InpPrice1=75;        // 第1个点的价格， %
input int             InpAngle=0;          // 线型倾斜角
input color           InpColor=clrRed;     // 线的颜色
input ENUM_LINE_STYLE InpStyle=STYLE_DASH; // 线的风格
input int             InpWidth=2;          // 线的宽度
input bool            InpBack=false;       // 背景线
input bool            InpSelection=true;   // 突出移动
input bool            InpRayLeft=false;    // 线延续向左
input bool            InpRayRight=true;    // 线延续向右
input bool            InpHidden=true;      // 隐藏在对象列表
input long            InpZOrder=0;         // 鼠标单击优先
//+------------------------------------------------------------------+
//| 创建角度趋势线                                                     |
//+------------------------------------------------------------------+
bool TrendByAngleCreate(const long            chart_ID=0,        // 图表 ID
                        const string          name=&quot;TrendLine&quot;,  // 线的名称
                        const int             sub_window=0,      // 子窗口指数
                        datetime              time=0,            // 点的时间
                        double                price=0,           // 点的价格
                        const double          angle=45.0,        // 斜角
                        const color           clr=clrRed,        // 线的颜色
                        const ENUM_LINE_STYLE style=STYLE_SOLID, // 线的风格
                        const int             width=1,           // 线的宽度
                        const bool            back=false,        // 在背景中
                        const bool            selection=true,    // 突出移动
                        const bool            ray_left=false,    // 线延续向左
                        const bool            ray_right=true,    // 线延续向右
                        const bool            hidden=true,       // 隐藏在对象列表
                        const long            z_order=0)         // 鼠标单击优先
  {
//--- 创建第二个点以便于鼠标拖拽趋势线
   datetime time2=0;
   double   price2=0;
//--- 若未设置则设置定位点的坐标
   ChangeTrendEmptyPoints(time,price,time2,price2);
//--- 重置错误的值
   ResetLastError();
//--- 使用2个点创建趋势线
   if(!ObjectCreate(chart_ID,name,OBJ_TRENDBYANGLE,sub_window,time,price,time2,price2))
     {
      Print(__FUNCTION__,
            &quot;: failed to create a trend line! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 改变趋势线的斜角；改变斜角时，第二点的坐标
//--- 根据新的角度值，自动重新定义线的点
   ObjectSetDouble(chart_ID,name,OBJPROP_ANGLE,angle);
//--- 设置线的颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//--- 设置线的风格
   ObjectSetInteger(chart_ID,name,OBJPROP_STYLE,style);
//--- 设置线的宽度
   ObjectSetInteger(chart_ID,name,OBJPROP_WIDTH,width);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 通过鼠标移动线的模式
//--- 当使用ObjectCreate函数创建图形对象时，对象不能
//--- 默认下突出并移动。在这个方法中，默认选择参数
//--- true 可以突出移动对象
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 启用 (true) 或禁用 (false) 延续向左显示线的模式
   ObjectSetInteger(chart_ID,name,OBJPROP_RAY_LEFT,ray_left);
//--- 启用 (true) 或禁用 (false) 延续向右显示线的模式
   ObjectSetInteger(chart_ID,name,OBJPROP_RAY_RIGHT,ray_right);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 改变趋势线定位点的坐标                                              |
//+------------------------------------------------------------------+
bool TrendPointChange(const long   chart_ID=0,       // 图表 ID
                      const string name=&quot;TrendLine&quot;, // 线的名称
                      datetime     time=0,           // 定位点时间坐标
                      double       price=0)          // 定位点价格坐标
  {
//--- 如果没有设置点的位置，则将其移动到当前的卖价柱
   if(!time)
      time=TimeCurrent();
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 重置错误的值
   ResetLastError();
//--- 移动趋势线定位点
   if(!ObjectMove(chart_ID,name,0,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to move the anchor point! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 改变趋势线的斜角                                                   |
//+------------------------------------------------------------------+
bool TrendAngleChange(const long   chart_ID=0,       // 图表 ID
                      const string name=&quot;TrendLine&quot;, // 趋势线名称
                      const double angle=45)         // 趋势线斜角
  {
//--- 重置错误的值
   ResetLastError();
//--- 改变趋势线的斜角
   if(!ObjectSetDouble(chart_ID,name,OBJPROP_ANGLE,angle))
     {
      Print(__FUNCTION__,
            &quot;: failed to change the line's slope angle! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 删除趋势线                                                        |
//+------------------------------------------------------------------+
bool TrendDelete(const long   chart_ID=0,       // 图表 ID
                 const string name=&quot;TrendLine&quot;) // 线的颜色
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除趋势线
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete a trend line! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 检查趋势线定位点的值和为空点设置                                     |
//| 默认的值                                                          |
//+------------------------------------------------------------------+
void ChangeTrendEmptyPoints(datetime &amp;time1,double &amp;price1,
                            datetime &amp;time2,double &amp;price2)
  {
//--- 如果第一点的时间没有设置，它将位于当前柱
   if(!time1)
      time1=TimeCurrent();
//--- 如果第一点的价格没有设置，则它将用卖价值
   if(!price1)
      price1=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 设置第二坐标，辅助点
//--- 第二个点是左侧第9个柱并且价格相同
   datetime second_point_time[10];
   CopyTime(Symbol(),Period(),time1,10,second_point_time);
   time2=second_point_time[0];
   price2=price1;
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 检查输入参数的正确性
   if(InpDate1 &lt; 0 || InpDate1 &gt; 100 || InpPrice1 &lt; 0 || InpPrice1 &gt; 100)
     {
      Print(&quot;Error! Incorrect values of input parameters!&quot;);
      return;
     }
//--- 图表窗口的可见柱的数量
   int bars=(int)ChartGetInteger(0,CHART_VISIBLE_BARS);
//--- 价格数组大小
   int accuracy=1000;
//--- 存储要使用的日期和价格值的数组
//--- 设置和改变线定位点的坐标
   datetime date[];
   double   price[];
//--- 内存分配
   ArrayResize(date,bars);
   ArrayResize(price,accuracy);
//--- 填写日期数组
   ResetLastError();
   if(CopyTime(Symbol(),Period(),0,bars,date)==-1)
     {
      Print(&quot;Failed to copy time values! Error code = &quot;,GetLastError());
      return;
     }
//--- 填写价格数组
//--- 找出图表的最高值和最低值
   double max_price=ChartGetDouble(0,CHART_PRICE_MAX);
   double min_price=ChartGetDouble(0,CHART_PRICE_MIN);
//--- 定义变化的价格并填写该数组
   double step=(max_price-min_price)/accuracy;
   for(int i=0;i&lt; accuracy ;i++)
      price[i]=min_price+i*step;
//--- 定义画线的点
   int d1=InpDate1*(bars-1)/100;
   int p1=InpPrice1*(accuracy-1)/100;
//--- 创建趋势线
   if(!TrendByAngleCreate(0,InpName,0,date[d1],price[p1],InpAngle,InpColor,InpStyle,
      InpWidth,InpBack,InpSelection,InpRayLeft,InpRayRight,InpHidden,InpZOrder))
     {
      return;
     }
//--- 重画图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- 现在，移动和旋转线
//--- 循环计数器
   int v_steps=accuracy/2;
//--- 移动定位点并改变线的斜角
   for(int i=0;i&lt;v_steps;i++)
     {
      //--- 使用下面的值
      if(p1&gt;1)
         p1-=1;
      //--- 移动点
      if(!TrendPointChange(0,InpName,date[d1],price[p1]))
         return;
      if(!TrendAngleChange(0,InpName,18*(i+1)))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 从图表删除
   TrendDelete(0,InpName);
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br></div></div><h4 id="_2-2-1-5-obj-cycles循环周期线"><a href="#_2-2-1-5-obj-cycles循环周期线" class="header-anchor">#</a> 2.2.1.5 OBJ_CYCLES循环周期线</h4> <p><img src="data:image/png;base64,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" alt="Alt text"></p> <p>ObjCycles</p> <p>注意</p> <p>坚直线之间的距离是由对象的两个定位锚点的时间坐标来设定的。</p> <p>示例</p> <p>下面的脚本创建并移动图表上的循环周期线。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//--- 描述</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">description </span><span class="token string">&quot;Script creates cycle lines on the chart.&quot;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">description </span><span class="token string">&quot;Anchor point coordinates are set in percentage&quot;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">description </span><span class="token string">&quot;percentage of the chart window size.&quot;</span></span>
<span class="token comment">//--- 启动脚本期间显示输入参数的窗口</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">script_show_inputs</span></span>
<span class="token comment">//--- 脚本的输入参数</span>
input string          InpName<span class="token operator">=</span><span class="token string">&quot;Cycles&quot;</span><span class="token punctuation">;</span>   <span class="token comment">// 对象的名称</span>
input <span class="token keyword">int</span>             InpDate1<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span>        <span class="token comment">// 第1个点的日期， %</span>
input <span class="token keyword">int</span>             InpPrice1<span class="token operator">=</span><span class="token number">45</span><span class="token punctuation">;</span>       <span class="token comment">// 第1个点的价格， %</span>
input <span class="token keyword">int</span>             InpDate2<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">;</span>        <span class="token comment">// 第2个点的日期， %</span>
input <span class="token keyword">int</span>             InpPrice2<span class="token operator">=</span><span class="token number">55</span><span class="token punctuation">;</span>       <span class="token comment">// 第2个点的价格，%</span>
input color           InpColor<span class="token operator">=</span>clrRed<span class="token punctuation">;</span>    <span class="token comment">//循环线的颜色</span>
input ENUM_LINE_STYLE InpStyle<span class="token operator">=</span>STYLE_DOT<span class="token punctuation">;</span> <span class="token comment">// 循环线的风格</span>
input <span class="token keyword">int</span>             InpWidth<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>         <span class="token comment">// 循环线的宽度</span>
input <span class="token keyword">bool</span>            InpBack<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>      <span class="token comment">// 背景对象</span>
input <span class="token keyword">bool</span>            InpSelection<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>  <span class="token comment">// 突出移动</span>
input <span class="token keyword">bool</span>            InpHidden<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>     <span class="token comment">//隐藏在对象列表</span>
input <span class="token keyword">long</span>            InpZOrder<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>        <span class="token comment">// 鼠标单击优先</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 创建循环线                                                        |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">bool</span> <span class="token function">CyclesCreate</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">long</span>            chart_ID<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>        <span class="token comment">// 图表 ID</span>
                  <span class="token keyword">const</span> string          name<span class="token operator">=</span><span class="token string">&quot;Cycles&quot;</span><span class="token punctuation">,</span>     <span class="token comment">// 对象名称</span>
                  <span class="token keyword">const</span> <span class="token keyword">int</span>             sub_window<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>      <span class="token comment">// 子窗口指数</span>
                  datetime              time1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>           <span class="token comment">// 第一个点的时间</span>
                  <span class="token keyword">double</span>                price1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>          <span class="token comment">// 第一个点的价格</span>
                  datetime              time2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>           <span class="token comment">// 第二个点的时间</span>
                  <span class="token keyword">double</span>                price2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>          <span class="token comment">// 第二个点的价格</span>
                  <span class="token keyword">const</span> color           clr<span class="token operator">=</span>clrRed<span class="token punctuation">,</span>        <span class="token comment">// 循环线的颜色</span>
                  <span class="token keyword">const</span> ENUM_LINE_STYLE style<span class="token operator">=</span>STYLE_SOLID<span class="token punctuation">,</span> <span class="token comment">// 循环线的风格</span>
                  <span class="token keyword">const</span> <span class="token keyword">int</span>             width<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>           <span class="token comment">// 循环线的宽度</span>
                  <span class="token keyword">const</span> <span class="token keyword">bool</span>            back<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">,</span>        <span class="token comment">// 在背景中</span>
                  <span class="token keyword">const</span> <span class="token keyword">bool</span>            selection<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">,</span>    <span class="token comment">// 突出移动</span>
                  <span class="token keyword">const</span> <span class="token keyword">bool</span>            hidden<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">,</span>       <span class="token comment">// 隐藏在对象列表</span>
                  <span class="token keyword">const</span> <span class="token keyword">long</span>            z_order<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>         <span class="token comment">// 鼠标单击优先</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 若未设置则设置定位点的坐标</span>
   <span class="token function">ChangeCyclesEmptyPoints</span><span class="token punctuation">(</span>time1<span class="token punctuation">,</span>price1<span class="token punctuation">,</span>time2<span class="token punctuation">,</span>price2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 重置错误的值</span>
   <span class="token function">ResetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 通过已给的坐标创建循环线</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ObjectCreate</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJ_CYCLES<span class="token punctuation">,</span>sub_window<span class="token punctuation">,</span>time1<span class="token punctuation">,</span>price1<span class="token punctuation">,</span>time2<span class="token punctuation">,</span>price2<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span>__FUNCTION__<span class="token punctuation">,</span>
            <span class="token string">&quot;: failed to create cycle lines! Error code = &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 设置线的颜色</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_COLOR<span class="token punctuation">,</span>clr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 设置线的显示风格</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_STYLE<span class="token punctuation">,</span>style<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 设置线的宽度</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_WIDTH<span class="token punctuation">,</span>width<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 显示前景 (false) 或背景 (true)</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_BACK<span class="token punctuation">,</span>back<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 启用 (true) 或禁用 (false) 通过鼠标移动线的模式</span>
<span class="token comment">//--- 当使用ObjectCreate函数创建图形对象时，对象不能</span>
<span class="token comment">//--- 默认下突出并移动。在这个方法中，默认选择参数</span>
<span class="token comment">//--- true 可以突出移动对象</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_SELECTABLE<span class="token punctuation">,</span>selection<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_SELECTED<span class="token punctuation">,</span>selection<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_HIDDEN<span class="token punctuation">,</span>hidden<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 设置在图表中优先接收鼠标点击事件</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_ZORDER<span class="token punctuation">,</span>z_order<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 成功执行</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 移动定位点                                                        |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">bool</span> <span class="token function">CyclesPointChange</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">long</span>   chart_ID<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>    <span class="token comment">// 图表ID</span>
                       <span class="token keyword">const</span> string name<span class="token operator">=</span><span class="token string">&quot;Cycles&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 对象的名称</span>
                       <span class="token keyword">const</span> <span class="token keyword">int</span>    point_index<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 定位点指数</span>
                       datetime     time<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>        <span class="token comment">// 定位点时间坐标</span>
                       <span class="token keyword">double</span>       price<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>       <span class="token comment">// 定位点价格坐标</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 如果没有设置点的位置，则将其移动到当前的卖价柱</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>time<span class="token punctuation">)</span>
      time<span class="token operator">=</span><span class="token function">TimeCurrent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>price<span class="token punctuation">)</span>
      price<span class="token operator">=</span><span class="token function">SymbolInfoDouble</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>SYMBOL_BID<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 重置错误的值</span>
   <span class="token function">ResetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 移动定位点</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ObjectMove</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>point_index<span class="token punctuation">,</span>time<span class="token punctuation">,</span>price<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span>__FUNCTION__<span class="token punctuation">,</span>
            <span class="token string">&quot;: failed to move the anchor point! Error code = &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 成功执行</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 删除循环线                                                        |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">bool</span> <span class="token function">CyclesDelete</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">long</span>   chart_ID<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>    <span class="token comment">// 图表 ID</span>
                  <span class="token keyword">const</span> string name<span class="token operator">=</span><span class="token string">&quot;Cycles&quot;</span><span class="token punctuation">)</span> <span class="token comment">// 对象的名称</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 重置错误的值</span>
   <span class="token function">ResetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 删除循环线</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ObjectDelete</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span>__FUNCTION__<span class="token punctuation">,</span>
            <span class="token string">&quot;: failed to delete cycle lines! Error code = &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 成功执行</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+-----------------------------------------------------------------------+</span>
<span class="token comment">//| 检查循环线定位点的值和为空点设置                                          |</span>
<span class="token comment">//| 默认的值                                                               |</span>
<span class="token comment">//+-----------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">ChangeCyclesEmptyPoints</span><span class="token punctuation">(</span>datetime <span class="token operator">&amp;</span>time1<span class="token punctuation">,</span><span class="token keyword">double</span> <span class="token operator">&amp;</span>price1<span class="token punctuation">,</span>
                             datetime <span class="token operator">&amp;</span>time2<span class="token punctuation">,</span><span class="token keyword">double</span> <span class="token operator">&amp;</span>price2<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 如果第一点的时间没有设置，它将位于当前柱</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>time1<span class="token punctuation">)</span>
      time1<span class="token operator">=</span><span class="token function">TimeCurrent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 如果第一点的价格没有设置，则它将用卖价值</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>price1<span class="token punctuation">)</span>
      price1<span class="token operator">=</span><span class="token function">SymbolInfoDouble</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>SYMBOL_BID<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 如果第二点的时间没有设置，它则位于第二点左侧的9个柱</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>time2<span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token comment">//--- 接收最近10柱开盘时间的数组</span>
      datetime temp<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token function">CopyTime</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">Period</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>time1<span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 在第一点左侧9柱设置第二点</span>
      time2<span class="token operator">=</span>temp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 如果第二点的价格没有设置，则它与第一点的价格相等</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>price2<span class="token punctuation">)</span>
      price2<span class="token operator">=</span>price1<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 脚本程序起始函数                                                   |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 检查输入参数的正确性</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>InpDate1 <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> InpDate1 <span class="token operator">&gt;</span> <span class="token number">100</span> <span class="token operator">||</span> InpPrice1 <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> InpPrice1 <span class="token operator">&gt;</span> <span class="token number">100</span> <span class="token operator">||</span>
      InpDate2 <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> InpDate2 <span class="token operator">&gt;</span> <span class="token number">100</span> <span class="token operator">||</span> InpPrice2 <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> InpPrice2 <span class="token operator">&gt;</span> <span class="token number">100</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Error! Incorrect values of input parameters!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 图表窗口的可见柱的数量</span>
   <span class="token keyword">int</span> bars<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token function">ChartGetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_VISIBLE_BARS<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 价格数组大小</span>
   <span class="token keyword">int</span> accuracy<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">;</span>
<span class="token comment">//--- 存储要使用的日期和价格值的数组</span>
<span class="token comment">//--- 设置和改变循环线定位点的坐标</span>
   datetime date<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token keyword">double</span>   price<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">//--- 内存分配</span>
   <span class="token function">ArrayResize</span><span class="token punctuation">(</span>date<span class="token punctuation">,</span>bars<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">ArrayResize</span><span class="token punctuation">(</span>price<span class="token punctuation">,</span>accuracy<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 填写日期数组</span>
   <span class="token function">ResetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">CopyTime</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">Period</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>bars<span class="token punctuation">,</span>date<span class="token punctuation">)</span><span class="token operator">==</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to copy time values! Error code = &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 填写价格数组</span>
<span class="token comment">//--- 找出图表的最高值和最低值</span>
   <span class="token keyword">double</span> max_price<span class="token operator">=</span><span class="token function">ChartGetDouble</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_PRICE_MAX<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">double</span> min_price<span class="token operator">=</span><span class="token function">ChartGetDouble</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_PRICE_MIN<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 定义变化的价格并填写该数组</span>
   <span class="token keyword">double</span> step<span class="token operator">=</span><span class="token punctuation">(</span>max_price<span class="token operator">-</span>min_price<span class="token punctuation">)</span><span class="token operator">/</span>accuracy<span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span> accuracy <span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
      price<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>min_price<span class="token operator">+</span>i<span class="token operator">*</span>step<span class="token punctuation">;</span>
<span class="token comment">//--- 定义画循环线的点</span>
   <span class="token keyword">int</span> d1<span class="token operator">=</span>InpDate1<span class="token operator">*</span><span class="token punctuation">(</span>bars<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span> d2<span class="token operator">=</span>InpDate2<span class="token operator">*</span><span class="token punctuation">(</span>bars<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span> p1<span class="token operator">=</span>InpPrice1<span class="token operator">*</span><span class="token punctuation">(</span>accuracy<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span> p2<span class="token operator">=</span>InpPrice2<span class="token operator">*</span><span class="token punctuation">(</span>accuracy<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">;</span>
<span class="token comment">//--- 创建趋势线</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">CyclesCreate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>InpName<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>date<span class="token punctuation">[</span>d1<span class="token punctuation">]</span><span class="token punctuation">,</span>price<span class="token punctuation">[</span>p1<span class="token punctuation">]</span><span class="token punctuation">,</span>date<span class="token punctuation">[</span>d2<span class="token punctuation">]</span><span class="token punctuation">,</span>price<span class="token punctuation">[</span>p2<span class="token punctuation">]</span><span class="token punctuation">,</span>InpColor<span class="token punctuation">,</span>
      InpStyle<span class="token punctuation">,</span>InpWidth<span class="token punctuation">,</span>InpBack<span class="token punctuation">,</span>InpSelection<span class="token punctuation">,</span>InpHidden<span class="token punctuation">,</span>InpZOrder<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 重画图表并等待1秒</span>
   <span class="token function">ChartRedraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 现在，移动定位点</span>
<span class="token comment">//--- 循环计数器</span>
   <span class="token keyword">int</span> h_steps<span class="token operator">=</span>bars<span class="token operator">/</span><span class="token number">5</span><span class="token punctuation">;</span>
<span class="token comment">//--- 移动第二个定位点</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span> h_steps <span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token comment">//--- 使用下面的值</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>d2<span class="token operator">&lt;</span>bars<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
         d2<span class="token operator">+=</span><span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 移动点</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">CyclesPointChange</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>InpName<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>date<span class="token punctuation">[</span>d2<span class="token punctuation">]</span><span class="token punctuation">,</span>price<span class="token punctuation">[</span>p2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 检查脚本操作是否已经强制禁用</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">IsStopped</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 重画图表</span>
      <span class="token function">ChartRedraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 0.05 秒延迟</span>
      <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 1 秒延迟</span>
   <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 循环计数器</span>
   h_steps<span class="token operator">=</span>bars<span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">;</span>
<span class="token comment">//--- 移动第一个定位点</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span> h_steps <span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token comment">//--- 使用下面的值</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>d1<span class="token operator">&lt;</span>bars<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
         d1<span class="token operator">+=</span><span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 移动点</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">CyclesPointChange</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>InpName<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>date<span class="token punctuation">[</span>d1<span class="token punctuation">]</span><span class="token punctuation">,</span>price<span class="token punctuation">[</span>p1<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 检查脚本操作是否已经强制禁用</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">IsStopped</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 重画图表</span>
      <span class="token function">ChartRedraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 0.05 秒延迟</span>
      <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 1 秒延迟</span>
   <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 删除图表对象</span>
   <span class="token function">CyclesDelete</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>InpName<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">ChartRedraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 1 秒延迟</span>
   <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//---</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br></div></div><h4 id="_2-2-1-6-obj-arrowed-line箭头线"><a href="#_2-2-1-6-obj-arrowed-line箭头线" class="header-anchor">#</a> 2.2.1.6 OBJ_ARROWED_LINE箭头线</h4> <p><img src="data:image/png;base64,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" alt="Alt text"></p> <p>ObjArrowedLine</p> <p>示例</p> <p>下面的脚本创建并移动图表上的箭头线。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//--- 描述</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">description </span><span class="token string">&quot;Script draws \&quot;Arrowed line\&quot; graphical object.&quot;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">description </span><span class="token string">&quot;Anchor point coordinates are set in percentage of&quot;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">description </span><span class="token string">&quot;the chart window size.&quot;</span></span>
<span class="token comment">//--- 启动脚本期间显示输入参数的窗口</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">script_show_inputs</span></span>
<span class="token comment">//--- 脚本的输入参数</span>
input string          InpName<span class="token operator">=</span><span class="token string">&quot;ArrowedLine&quot;</span><span class="token punctuation">;</span> <span class="token comment">// 线的名称</span>
input <span class="token keyword">int</span>             InpDate1<span class="token operator">=</span><span class="token number">35</span><span class="token punctuation">;</span>           <span class="token comment">// 第1个点的日期，%</span>
input <span class="token keyword">int</span>             InpPrice1<span class="token operator">=</span><span class="token number">60</span><span class="token punctuation">;</span>          <span class="token comment">// 第1个点的价格，%</span>
input <span class="token keyword">int</span>             InpDate2<span class="token operator">=</span><span class="token number">65</span><span class="token punctuation">;</span>           <span class="token comment">// 第2个点的日期，%</span>
input <span class="token keyword">int</span>             InpPrice2<span class="token operator">=</span><span class="token number">40</span><span class="token punctuation">;</span>          <span class="token comment">// 第2个点的价格，%</span>
input color           InpColor<span class="token operator">=</span>clrRed<span class="token punctuation">;</span>       <span class="token comment">// 线的颜色</span>
input ENUM_LINE_STYLE InpStyle<span class="token operator">=</span>STYLE_DASH<span class="token punctuation">;</span>   <span class="token comment">// 线的风格</span>
input <span class="token keyword">int</span>             InpWidth<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>            <span class="token comment">// 线的宽度</span>
input <span class="token keyword">bool</span>            InpBack<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>         <span class="token comment">// 背景线</span>
input <span class="token keyword">bool</span>            InpSelection<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>     <span class="token comment">// 突出移动</span>
input <span class="token keyword">bool</span>            InpHidden<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token comment">// 隐藏在对象列表</span>
input <span class="token keyword">long</span>            InpZOrder<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>           <span class="token comment">// 鼠标单击优先</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 通过已给的坐标创建箭头线                                            |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">bool</span> <span class="token function">ArrowedLineCreate</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">long</span>            chart_ID<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>         <span class="token comment">// 图表 ID</span>
                       <span class="token keyword">const</span> string          name<span class="token operator">=</span><span class="token string">&quot;ArrowedLine&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 线的名称</span>
                       <span class="token keyword">const</span> <span class="token keyword">int</span>             sub_window<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>       <span class="token comment">// 子窗口指数</span>
                       datetime              time1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>            <span class="token comment">// 第一个点的时间</span>
                       <span class="token keyword">double</span>                price1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>           <span class="token comment">// 第一个点的价格</span>
                       datetime              time2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>            <span class="token comment">// 第二个点的时间</span>
                       <span class="token keyword">double</span>                price2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>           <span class="token comment">// 第二个点的价格</span>
                       <span class="token keyword">const</span> color           clr<span class="token operator">=</span>clrRed<span class="token punctuation">,</span>         <span class="token comment">// 线的颜色</span>
                       <span class="token keyword">const</span> ENUM_LINE_STYLE style<span class="token operator">=</span>STYLE_SOLID<span class="token punctuation">,</span>  <span class="token comment">// 线的风格</span>
                       <span class="token keyword">const</span> <span class="token keyword">int</span>             width<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>            <span class="token comment">// 线的宽度</span>
                       <span class="token keyword">const</span> <span class="token keyword">bool</span>            back<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">,</span>         <span class="token comment">// 在背景中</span>
                       <span class="token keyword">const</span> <span class="token keyword">bool</span>            selection<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">,</span>     <span class="token comment">// 突出移动</span>
                       <span class="token keyword">const</span> <span class="token keyword">bool</span>            hidden<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">,</span>        <span class="token comment">// 隐藏在对象列表</span>
                       <span class="token keyword">const</span> <span class="token keyword">long</span>            z_order<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>          <span class="token comment">// 鼠标单击优先</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 若未设置则设置定位点的坐标</span>
   <span class="token function">ChangeArrowedLineEmptyPoints</span><span class="token punctuation">(</span>time1<span class="token punctuation">,</span>price1<span class="token punctuation">,</span>time2<span class="token punctuation">,</span>price2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 重置错误的值</span>
   <span class="token function">ResetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 通过已给的坐标创建箭头线</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ObjectCreate</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJ_ARROWED_LINE<span class="token punctuation">,</span>sub_window<span class="token punctuation">,</span>time1<span class="token punctuation">,</span>price1<span class="token punctuation">,</span>time2<span class="token punctuation">,</span>price2<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span>__FUNCTION__<span class="token punctuation">,</span>
            <span class="token string">&quot;: failed to create an arrowed line! Error code = &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 设置线的颜色</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_COLOR<span class="token punctuation">,</span>clr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 设置线的显示风格</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_STYLE<span class="token punctuation">,</span>style<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 设置线的宽度</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_WIDTH<span class="token punctuation">,</span>width<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 显示前景 (false) 或背景 (true)</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_BACK<span class="token punctuation">,</span>back<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 启用 (true) 或禁用 (false) 通过鼠标移动线的模式</span>
<span class="token comment">//--- 当使用ObjectCreate函数创建图形对象时，对象不能</span>
<span class="token comment">//--- 默认下突出并移动。在这个方法中，默认选择参数</span>
<span class="token comment">//--- true 可以突出移动对象</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_SELECTABLE<span class="token punctuation">,</span>selection<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_SELECTED<span class="token punctuation">,</span>selection<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_HIDDEN<span class="token punctuation">,</span>hidden<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 设置在图表中优先接收鼠标点击事件</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_ZORDER<span class="token punctuation">,</span>z_order<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 成功执行</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 移动箭头线的定位点                                                 |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">bool</span> <span class="token function">ArrowedLinePointChange</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">long</span>   chart_ID<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>         <span class="token comment">// 图表 ID</span>
                            <span class="token keyword">const</span> string name<span class="token operator">=</span><span class="token string">&quot;ArrowedLine&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 线的名称</span>
                            <span class="token keyword">const</span> <span class="token keyword">int</span>    point_index<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>      <span class="token comment">// 定位点指数</span>
                            datetime     time<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>             <span class="token comment">// 定位点时间坐标</span>
                            <span class="token keyword">double</span>       price<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>            <span class="token comment">// 定位点价格坐标</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 如果没有设置点的位置，则将其移动到当前的卖价柱</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>time<span class="token punctuation">)</span>
      time<span class="token operator">=</span><span class="token function">TimeCurrent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>price<span class="token punctuation">)</span>
      price<span class="token operator">=</span><span class="token function">SymbolInfoDouble</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>SYMBOL_BID<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 重置错误的值</span>
   <span class="token function">ResetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 移动线的定位点</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ObjectMove</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>point_index<span class="token punctuation">,</span>time<span class="token punctuation">,</span>price<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span>__FUNCTION__<span class="token punctuation">,</span>
            <span class="token string">&quot;: failed to move the anchor point! Error code = &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 成功执行</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 这个函数移除图表的箭头线                                            |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">bool</span> <span class="token function">ArrowedLineDelete</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">long</span>   chart_ID<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>         <span class="token comment">// 图表 ID</span>
                       <span class="token keyword">const</span> string name<span class="token operator">=</span><span class="token string">&quot;ArrowedLine&quot;</span><span class="token punctuation">)</span> <span class="token comment">// 线的名称</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 重置错误的值</span>
   <span class="token function">ResetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 删除箭头线</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ObjectDelete</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span>__FUNCTION__<span class="token punctuation">,</span>
            <span class="token string">&quot;: failed to create an arrowed line! Error code = &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 成功执行</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 检查定位点的值和为空点设置                                           |</span>
<span class="token comment">//| 默认的值                                                          |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">ChangeArrowedLineEmptyPoints</span><span class="token punctuation">(</span>datetime <span class="token operator">&amp;</span>time1<span class="token punctuation">,</span><span class="token keyword">double</span> <span class="token operator">&amp;</span>price1<span class="token punctuation">,</span>
                                  datetime <span class="token operator">&amp;</span>time2<span class="token punctuation">,</span><span class="token keyword">double</span> <span class="token operator">&amp;</span>price2<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 如果第一点的时间没有设置，它将位于当前柱</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>time1<span class="token punctuation">)</span>
      time1<span class="token operator">=</span><span class="token function">TimeCurrent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 如果第一点的价格没有设置，则它将用卖价值</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>price1<span class="token punctuation">)</span>
      price1<span class="token operator">=</span><span class="token function">SymbolInfoDouble</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>SYMBOL_BID<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 如果第二点的时间没有设置，它则位于第二点左侧的9个柱</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>time2<span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token comment">//--- 接收最近10柱开盘时间的数组</span>
      datetime temp<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token function">CopyTime</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">Period</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>time1<span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 在第一点左侧9柱设置第二点</span>
      time2<span class="token operator">=</span>temp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 如果第二点的价格没有设置，则它与第一点的价格相等</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>price2<span class="token punctuation">)</span>
      price2<span class="token operator">=</span>price1<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 脚本程序起始函数                                                   |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 检查输入参数的正确性</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>InpDate1 <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> InpDate1 <span class="token operator">&gt;</span> <span class="token number">100</span> <span class="token operator">||</span> InpPrice1 <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> InpPrice1 <span class="token operator">&gt;</span> <span class="token number">100</span> <span class="token operator">||</span>
      InpDate2 <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> InpDate2 <span class="token operator">&gt;</span> <span class="token number">100</span> <span class="token operator">||</span> InpPrice2 <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> InpPrice2 <span class="token operator">&gt;</span> <span class="token number">100</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Error! Incorrect values of input parameters!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 图表窗口的可见柱的数量</span>
   <span class="token keyword">int</span> bars<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token function">ChartGetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_VISIBLE_BARS<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 价格数组大小</span>
   <span class="token keyword">int</span> accuracy<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">;</span>
<span class="token comment">//--- 存储要使用的日期和价格值的数组</span>
<span class="token comment">//--- 设置和改变线定位点的坐标</span>
   datetime date<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token keyword">double</span>   price<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">//--- 内存分配</span>
   <span class="token function">ArrayResize</span><span class="token punctuation">(</span>date<span class="token punctuation">,</span>bars<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">ArrayResize</span><span class="token punctuation">(</span>price<span class="token punctuation">,</span>accuracy<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 填写日期数组</span>
   <span class="token function">ResetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">CopyTime</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">Period</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>bars<span class="token punctuation">,</span>date<span class="token punctuation">)</span><span class="token operator">==</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to copy time values! Error code = &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 填写价格数组</span>
<span class="token comment">//--- 找出图表的最高值和最低值</span>
   <span class="token keyword">double</span> max_price<span class="token operator">=</span><span class="token function">ChartGetDouble</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_PRICE_MAX<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">double</span> min_price<span class="token operator">=</span><span class="token function">ChartGetDouble</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_PRICE_MIN<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 定义变化的价格并填写该数组</span>
   <span class="token keyword">double</span> step<span class="token operator">=</span><span class="token punctuation">(</span>max_price<span class="token operator">-</span>min_price<span class="token punctuation">)</span><span class="token operator">/</span>accuracy<span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span> accuracy <span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
      price<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>min_price<span class="token operator">+</span>i<span class="token operator">*</span>step<span class="token punctuation">;</span>
<span class="token comment">//--- 定义画线的点</span>
   <span class="token keyword">int</span> d1<span class="token operator">=</span>InpDate1<span class="token operator">*</span><span class="token punctuation">(</span>bars<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span> d2<span class="token operator">=</span>InpDate2<span class="token operator">*</span><span class="token punctuation">(</span>bars<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span> p1<span class="token operator">=</span>InpPrice1<span class="token operator">*</span><span class="token punctuation">(</span>accuracy<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span> p2<span class="token operator">=</span>InpPrice2<span class="token operator">*</span><span class="token punctuation">(</span>accuracy<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">;</span>
<span class="token comment">//--- 创建箭头线</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ArrowedLineCreate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>InpName<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>date<span class="token punctuation">[</span>d1<span class="token punctuation">]</span><span class="token punctuation">,</span>price<span class="token punctuation">[</span>p1<span class="token punctuation">]</span><span class="token punctuation">,</span>date<span class="token punctuation">[</span>d2<span class="token punctuation">]</span><span class="token punctuation">,</span>price<span class="token punctuation">[</span>p2<span class="token punctuation">]</span><span class="token punctuation">,</span>
      InpColor<span class="token punctuation">,</span>InpStyle<span class="token punctuation">,</span>InpWidth<span class="token punctuation">,</span>InpBack<span class="token punctuation">,</span>InpSelection<span class="token punctuation">,</span>InpHidden<span class="token punctuation">,</span>InpZOrder<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 重画图表并等待1秒</span>
   <span class="token function">ChartRedraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 现在，移动线的定位点</span>
<span class="token comment">//--- 循环计数器</span>
   <span class="token keyword">int</span> v_steps<span class="token operator">=</span>accuracy<span class="token operator">/</span><span class="token number">5</span><span class="token punctuation">;</span>
<span class="token comment">//--- 垂直移动第二个定位点</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span> v_steps <span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token comment">//--- 使用下面的值</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>p2<span class="token operator">&lt;</span> accuracy<span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">)</span>
         p2<span class="token operator">+=</span><span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 移动点</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ArrowedLinePointChange</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>InpName<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>date<span class="token punctuation">[</span>d2<span class="token punctuation">]</span><span class="token punctuation">,</span>price<span class="token punctuation">[</span>p2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 检查脚本操作是否已经强制禁用</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">IsStopped</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 重画图表</span>
      <span class="token function">ChartRedraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 垂直移动第一个定位点</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span> v_steps<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token comment">//--- 使用下面的值</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>p1<span class="token operator">&gt;</span><span class="token number">1</span><span class="token punctuation">)</span>
         p1<span class="token operator">-=</span><span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 移动点</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ArrowedLinePointChange</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>InpName<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>date<span class="token punctuation">[</span>d1<span class="token punctuation">]</span><span class="token punctuation">,</span>price<span class="token punctuation">[</span>p1<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 检查脚本操作是否已经强制禁用</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">IsStopped</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 重画图表</span>
      <span class="token function">ChartRedraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 半秒延迟</span>
   <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 循环计数器</span>
   <span class="token keyword">int</span> h_steps<span class="token operator">=</span>bars<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>
<span class="token comment">//--- 同时水平移动两个定位点</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span> h_steps <span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token comment">//--- 使用下面的值</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>d1<span class="token operator">&lt;</span> bars<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
         d1<span class="token operator">+=</span><span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>d2<span class="token operator">&gt;</span><span class="token number">1</span><span class="token punctuation">)</span>
         d2<span class="token operator">-=</span><span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 切换点</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ArrowedLinePointChange</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>InpName<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>date<span class="token punctuation">[</span>d1<span class="token punctuation">]</span><span class="token punctuation">,</span>price<span class="token punctuation">[</span>p1<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ArrowedLinePointChange</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>InpName<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>date<span class="token punctuation">[</span>d2<span class="token punctuation">]</span><span class="token punctuation">,</span>price<span class="token punctuation">[</span>p2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 检查脚本操作是否已经强制禁用</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">IsStopped</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 重画图表</span>
      <span class="token function">ChartRedraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 0.03 秒延迟</span>
      <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 1 秒延迟</span>
   <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 删除箭头线</span>
   <span class="token function">ArrowedLineDelete</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>InpName<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">ChartRedraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 1 秒延迟</span>
   <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//---</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br></div></div><h4 id="_2-2-1-7-obj-channel等距通道"><a href="#_2-2-1-7-obj-channel等距通道" class="header-anchor">#</a> 2.2.1.7 OBJ_CHANNEL等距通道</h4> <p><img src="data:image/png;base64,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" alt="Alt text"></p> <p>ObjChannel</p> <p>注意</p> <p>对于等距通道线，可以指定它 向右 和/或 向左 延长显示的模式 (根据属性值OBJPROP_RAY_RIGHT 和 OBJPROP_RAY_LEFT 决定)。也可以设置颜色填充通道的模式。</p> <p>示例</p> <p>下面的脚本创建并移动图表上的等距通道。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 描述
#property description &quot;Script draws \&quot;Equidistant Channel\&quot; graphical object.&quot;
#property description &quot;Anchor point coordinates are set in percentage of the size of&quot;
#property description &quot;the chart window.&quot;
//--- 启动脚本期间显示输入参数的窗口
#property script_show_inputs
//--- 脚本的输入参数
input string          InpName=&quot;Channel&quot;;   // 通道名称
input int             InpDate1=25;         // 第1个点的日期， %
input int             InpPrice1=60;        // 第1个点的价格， %
input int             InpDate2=65;         // 第2个点的日期，%
input int             InpPrice2=80;        // 第2个点的价格，%
input int             InpDate3=30;         // 第3个点的日期， %
input int             InpPrice3=40;        // 第3个点的价格，%
input color           InpColor=clrRed;     // 通道的颜色
input ENUM_LINE_STYLE InpStyle=STYLE_DASH; // 通道线的风格
input int             InpWidth=2;          // 通道线的宽度
input bool            InpBack=false;       // 背景通道
input bool            InpFill=false;       // 填充通道颜色
input bool            InpSelection=true;   // 突出移动
input bool            InpRayLeft=false;    // 通道延续向左
input bool            InpRayRight=false;   // 通道延续向右
input bool            InpHidden=true;      // 隐藏在对象列表
input long            InpZOrder=0;         // 鼠标单击优先
//+------------------------------------------------------------------+
//| 通过已给的坐标创建等距通道                                           |
//+------------------------------------------------------------------+
bool ChannelCreate(const long            chart_ID=0,        // 图表 ID
                   const string          name=&quot;Channel&quot;,    // 通道的名称
                   const int             sub_window=0,      // 子窗口指数
                   datetime              time1=0,           // 第一个点的时间
                   double                price1=0,          //第一个点的价格
                   datetime              time2=0,           // 第二个点的时间
                   double                price2=0,          // 第二个点的价格
                   datetime              time3=0,           //第三个点的时间
                   double                price3=0,          // 第三个点的价格
                   const color           clr=clrRed,        // 通道的颜色
                   const ENUM_LINE_STYLE style=STYLE_SOLID, // 通道线的风格
                   const int             width=1,           // 通道线的宽度
                   const bool            fill=false,        // 填充通道颜色
                   const bool            back=false,        // 在背景中
                   const bool            selection=true,    // 突出移动
                   const bool            ray_left=false,    // 通道延续向左
                   const bool            ray_right=false,   // 通道延续向右
                   const bool            hidden=true,       // 隐藏在对象列表
                   const long            z_order=0)         // 鼠标单击优先
  {
//--- 若未设置则设置定位点的坐标
   ChangeChannelEmptyPoints(time1,price1,time2,price2,time3,price3);
//--- 重置错误的值
   ResetLastError();
//--- 通过已给的坐标创建通道
   if(!ObjectCreate(chart_ID,name,OBJ_CHANNEL,sub_window,time1,price1,time2,price2,time3,price3))
     {
      Print(__FUNCTION__,
            &quot;: failed to create an equidistant channel! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 设置通道颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//--- 设置通道线的风格
   ObjectSetInteger(chart_ID,name,OBJPROP_STYLE,style);
//--- 设置通道线的宽度
   ObjectSetInteger(chart_ID,name,OBJPROP_WIDTH,width);
//--- 启用 (true) 或禁用 (false) 填充通道的模式
   ObjectSetInteger(chart_ID,name,OBJPROP_FILL,fill);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 突出通道移动的模式
//--- 当使用ObjectCreate函数创建图形对象时，对象不能
//--- 默认下突出并移动。在这个方法中，默认选择参数
//--- true 可以突出移动对象
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 启用 (true) 或禁用 (false) 延续向左显示通道的模式
   ObjectSetInteger(chart_ID,name,OBJPROP_RAY_LEFT,ray_left);
//--- 启用 (true) 或禁用 (false) 延续向右显示通道的模式
   ObjectSetInteger(chart_ID,name,OBJPROP_RAY_RIGHT,ray_right);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动通道的定位点                                                   |
//+------------------------------------------------------------------+
bool ChannelPointChange(const long   chart_ID=0,     // 图表 ID
                        const string name=&quot;Channel&quot;, // 通道的名称
                        const int    point_index=0,  // 定位点指数
                        datetime     time=0,         // 定位点时间坐标
                        double       price=0)        // 定位点价格坐标
  {
//--- 如果没有设置点的位置，则将其移动到当前的卖价柱
   if(!time)
      time=TimeCurrent();
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 重置错误的值
   ResetLastError();
//--- 移动定位点
   if(!ObjectMove(chart_ID,name,point_index,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to move the anchor point! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 删除通道                                                          |
//+------------------------------------------------------------------+
bool ChannelDelete(const long   chart_ID=0,     // 图表 ID
                   const string name=&quot;Channel&quot;) // 通道的名称
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除通道
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete the channel! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+-------------------------------------------------------------------------+
//| 检查通道定位点的值和为空点设置                                              |
//| 默认的值                                                                 |
//+-------------------------------------------------------------------------+
void ChangeChannelEmptyPoints(datetime &amp;time1,double &amp;price1,datetime &amp;time2,
                              double &amp;price2,datetime &amp;time3,double &amp;price3)
  {
//--- 如果第二点（右侧）的时间没有设置，它将位于当前柱
   if(!time2)
      time2=TimeCurrent();
//--- 如果第二点的价格没有设置，则它将用卖价值
   if(!price2)
      price2=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 如果第一点（左侧）的时间没有设置，它则位于第二点左侧的9个柱
   if(!time1)
     {
      //--- 接收最近10柱开盘时间的数组
      datetime temp[10];
      CopyTime(Symbol(),Period(),time2,10,temp);
      //--- 在第二点左侧9柱设置第一点
      time1=temp[0];
     }
//--- 如果第一个点的价格没有设置，则高于第二个点移动300点
   if(!price1)
      price1=price2+300*SymbolInfoDouble(Symbol(),SYMBOL_POINT);
//--- 如果第三个点的时间没有设置，则它与第一个点的时间相一致
   if(!time3)
      time3=time1;
//--- 如果第三个点的价格没有设置，则它与第二点的价格相等
   if(!price3)
      price3=price2;
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 检查输入参数的正确性
   if(InpDate1 &lt; 0 || InpDate1 &gt; 100 || InpPrice1 &lt; 0 || InpPrice1 &gt; 100 ||
      InpDate2 &lt; 0 || InpDate2 &gt; 100 || InpPrice2 &lt; 0 || InpPrice2 &gt; 100 ||
      InpDate3 &lt; 0 || InpDate3 &gt; 100 || InpPrice3 &lt; 0 || InpPrice3 &gt; 100)
     {
      Print(&quot;Error! Incorrect values of input parameters!&quot;);
      return;
     }
//--- 图表窗口的可见柱的数量
   int bars=(int)ChartGetInteger(0,CHART_VISIBLE_BARS);
//--- 价格数组大小
   int accuracy=1000;
//--- 存储要使用的日期和价格值的数组
//--- 设置和改变通道定位点的坐标
   datetime date[];
   double   price[];
//--- 内存分配
   ArrayResize(date,bars);
   ArrayResize(price,accuracy);
//--- 填写日期数组
   ResetLastError();
   if(CopyTime(Symbol(),Period(),0,bars,date)==-1)
     {
      Print(&quot;Failed to copy time values! Error code = &quot;,GetLastError());
      return;
     }
//--- 填写价格数组
//--- 找出图表的最高值和最低值
   double max_price=ChartGetDouble(0,CHART_PRICE_MAX);
   double min_price=ChartGetDouble(0,CHART_PRICE_MIN);
//--- 定义变化的价格并填写该数组
   double step=(max_price-min_price)/accuracy;
   for(int i=0;i &lt; accuracy ;i++)
      price[i]=min_price+i*step;
//--- 定义绘制通道的点
   int d1=InpDate1*(bars-1)/100;
   int d2=InpDate2*(bars-1)/100;
   int d3=InpDate3*(bars-1)/100;
   int p1=InpPrice1*(accuracy-1)/100;
   int p2=InpPrice2*(accuracy-1)/100;
   int p3=InpPrice3*(accuracy-1)/100;
//--- 创建等距通道
   if(!ChannelCreate(0,InpName,0,date[d1],price[p1],date[d2],price[p2],date[d3],price[p3],InpColor,
      InpStyle,InpWidth,InpFill,InpBack,InpSelection,InpRayLeft,InpRayRight,InpHidden,InpZOrder))
     {
      return;
     }
//--- 重画图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- 现在，移动通道定位点
//--- 循环计数器
   int h_steps=bars/6;
//--- 移动第二个定位点
   for(int i=0;i&lt; h_steps;i++)
     {
      //--- 使用下面的值
      if(d2&lt; bars-1)
         d2+=1;
      //--- 移动点
      if(!ChannelPointChange(0,InpName,1,date[d2],price[p2]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
      // 0.05 秒延迟
      Sleep(50);
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 移动第一个定位点
   for(int i=0;i&lt; h_steps ;i++)
     {
      //--- 使用下面的值
      if(d1&gt;1)
         d1-=1;
      //--- 移动点
      if(!ChannelPointChange(0,InpName,0,date[d1],price[p1]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
      // 0.05 秒延迟
      Sleep(50);
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 循环计数器
   int v_steps=accuracy/10;
//--- 移动第三个定位点
   for(int i=0;i&lt; v_steps ;i++)
     {
      //--- 使用下面的值
      if(p3&gt;1)
         p3-=1;
      //--- 移动点
      if(!ChannelPointChange(0,InpName,2,date[d3],price[p3]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 删除图表通道
   ChannelDelete(0,InpName);
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br></div></div><h4 id="_2-2-1-8-obj-stddevchannel标准偏差通道。"><a href="#_2-2-1-8-obj-stddevchannel标准偏差通道。" class="header-anchor">#</a> 2.2.1.8 OBJ_STDDEVCHANNEL标准偏差通道。</h4> <p><img src="/mql5yao/assets/img/sec6.b947f0b9.png" alt="Alt text"></p> <p>ObjStdDevChannel</p> <p>注意</p> <p>对于等距通道线，可以指定它 向右 和/或 向左 延长显示的模式 (根据属性值OBJPROP_RAY_RIGHT 和 OBJPROP_RAY_LEFT 决定)。也可以设置颜色填充通道的模式。</p> <p>示例</p> <p>下面的脚本创建并移动图表上的等距通道线。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 描述
#property description &quot;Script draws \&quot;Equidistant Channel\&quot; graphical object.&quot;
#property description &quot;Anchor point coordinates are set in percentage of the size of&quot;
#property description &quot;the chart window.&quot;
//--- 启动脚本期间显示输入参数的窗口
#property script_show_inputs
//--- 脚本的输入参数
input string          InpName=&quot;Channel&quot;;   // 通道名称
input int             InpDate1=25;         // 第1个点的日期， %
input int             InpPrice1=60;        // 第1个点的价格， %
input int             InpDate2=65;         // 第2个点的日期，%
input int             InpPrice2=80;        // 第2个点的价格，%
input int             InpDate3=30;         // 第3个点的日期， %
input int             InpPrice3=40;        // 第3个点的价格，%
input color           InpColor=clrRed;     // 通道的颜色
input ENUM_LINE_STYLE InpStyle=STYLE_DASH; // 通道线的风格
input int             InpWidth=2;          // 通道线的宽度
input bool            InpBack=false;       // 背景通道
input bool            InpFill=false;       // 填充通道颜色
input bool            InpSelection=true;   // 突出移动
input bool            InpRayLeft=false;    // 通道延续向左
input bool            InpRayRight=false;   // 通道延续向右
input bool            InpHidden=true;      // 隐藏在对象列表
input long            InpZOrder=0;         // 鼠标单击优先
//+------------------------------------------------------------------+
//| 通过已给的坐标创建等距通道                                           |
//+------------------------------------------------------------------+
bool ChannelCreate(const long            chart_ID=0,        // 图表 ID
                   const string          name=&quot;Channel&quot;,    // 通道的名称
                   const int             sub_window=0,      // 子窗口指数
                   datetime              time1=0,           // 第一个点的时间
                   double                price1=0,          //第一个点的价格
                   datetime              time2=0,           // 第二个点的时间
                   double                price2=0,          // 第二个点的价格
                   datetime              time3=0,           //第三个点的时间
                   double                price3=0,          // 第三个点的价格
                   const color           clr=clrRed,        // 通道的颜色
                   const ENUM_LINE_STYLE style=STYLE_SOLID, // 通道线的风格
                   const int             width=1,           // 通道线的宽度
                   const bool            fill=false,        // 填充通道颜色
                   const bool            back=false,        // 在背景中
                   const bool            selection=true,    // 突出移动
                   const bool            ray_left=false,    // 通道延续向左
                   const bool            ray_right=false,   // 通道延续向右
                   const bool            hidden=true,       // 隐藏在对象列表
                   const long            z_order=0)         // 鼠标单击优先
  {
//--- 若未设置则设置定位点的坐标
   ChangeChannelEmptyPoints(time1,price1,time2,price2,time3,price3);
//--- 重置错误的值
   ResetLastError();
//--- 通过已给的坐标创建通道
   if(!ObjectCreate(chart_ID,name,OBJ_CHANNEL,sub_window,time1,price1,time2,price2,time3,price3))
     {
      Print(__FUNCTION__,
            &quot;: failed to create an equidistant channel! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 设置通道颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//--- 设置通道线的风格
   ObjectSetInteger(chart_ID,name,OBJPROP_STYLE,style);
//--- 设置通道线的宽度
   ObjectSetInteger(chart_ID,name,OBJPROP_WIDTH,width);
//--- 启用 (true) 或禁用 (false) 填充通道的模式
   ObjectSetInteger(chart_ID,name,OBJPROP_FILL,fill);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 突出通道移动的模式
//--- 当使用ObjectCreate函数创建图形对象时，对象不能
//--- 默认下突出并移动。在这个方法中，默认选择参数
//--- true 可以突出移动对象
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 启用 (true) 或禁用 (false) 延续向左显示通道的模式
   ObjectSetInteger(chart_ID,name,OBJPROP_RAY_LEFT,ray_left);
//--- 启用 (true) 或禁用 (false) 延续向右显示通道的模式
   ObjectSetInteger(chart_ID,name,OBJPROP_RAY_RIGHT,ray_right);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动通道的定位点                                                   |
//+------------------------------------------------------------------+
bool ChannelPointChange(const long   chart_ID=0,     // 图表 ID
                        const string name=&quot;Channel&quot;, // 通道的名称
                        const int    point_index=0,  // 定位点指数
                        datetime     time=0,         // 定位点时间坐标
                        double       price=0)        // 定位点价格坐标
  {
//--- 如果没有设置点的位置，则将其移动到当前的卖价柱
   if(!time)
      time=TimeCurrent();
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 重置错误的值
   ResetLastError();
//--- 移动定位点
   if(!ObjectMove(chart_ID,name,point_index,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to move the anchor point! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 删除通道                                                          |
//+------------------------------------------------------------------+
bool ChannelDelete(const long   chart_ID=0,     // 图表 ID
                   const string name=&quot;Channel&quot;) // 通道的名称
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除通道
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete the channel! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+-------------------------------------------------------------------------+
//| 检查通道定位点的值和为空点设置                                              |
//| 默认的值                                                                 |
//+-------------------------------------------------------------------------+
void ChangeChannelEmptyPoints(datetime &amp;time1,double &amp;price1,datetime &amp;time2,
                              double &amp;price2,datetime &amp;time3,double &amp;price3)
  {
//--- 如果第二点（右侧）的时间没有设置，它将位于当前柱
   if(!time2)
      time2=TimeCurrent();
//--- 如果第二点的价格没有设置，则它将用卖价值
   if(!price2)
      price2=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 如果第一点（左侧）的时间没有设置，它则位于第二点左侧的9个柱
   if(!time1)
     {
      //--- 接收最近10柱开盘时间的数组
      datetime temp[10];
      CopyTime(Symbol(),Period(),time2,10,temp);
      //--- 在第二点左侧9柱设置第一点
      time1=temp[0];
     }
//--- 如果第一个点的价格没有设置，则高于第二个点移动300点
   if(!price1)
      price1=price2+300*SymbolInfoDouble(Symbol(),SYMBOL_POINT);
//--- 如果第三个点的时间没有设置，则它与第一个点的时间相一致
   if(!time3)
      time3=time1;
//--- 如果第三个点的价格没有设置，则它与第二点的价格相等
   if(!price3)
      price3=price2;
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 检查输入参数的正确性
   if(InpDate1 &lt; 0 || InpDate1 &gt; 100 || InpPrice1 &lt; 0 || InpPrice1 &gt; 100 ||
      InpDate2 &lt; 0 || InpDate2 &gt; 100 || InpPrice2 &lt; 0 || InpPrice2 &gt; 100 ||
      InpDate3 &lt; 0 || InpDate3 &gt; 100 || InpPrice3 &lt; 0 || InpPrice3 &gt; 100)
     {
      Print(&quot;Error! Incorrect values of input parameters!&quot;);
      return;
     }
//--- 图表窗口的可见柱的数量
   int bars=(int)ChartGetInteger(0,CHART_VISIBLE_BARS);
//--- 价格数组大小
   int accuracy=1000;
//--- 存储要使用的日期和价格值的数组
//--- 设置和改变通道定位点的坐标
   datetime date[];
   double   price[];
//--- 内存分配
   ArrayResize(date,bars);
   ArrayResize(price,accuracy);
//--- 填写日期数组
   ResetLastError();
   if(CopyTime(Symbol(),Period(),0,bars,date)==-1)
     {
      Print(&quot;Failed to copy time values! Error code = &quot;,GetLastError());
      return;
     }
//--- 填写价格数组
//--- 找出图表的最高值和最低值
   double max_price=ChartGetDouble(0,CHART_PRICE_MAX);
   double min_price=ChartGetDouble(0,CHART_PRICE_MIN);
//--- 定义变化的价格并填写该数组
   double step=(max_price-min_price)/accuracy;
   for(int i=0;i&lt; accuracy;i++)
      price[i]=min_price+i*step;
//--- 定义绘制通道的点
   int d1=InpDate1*(bars-1)/100;
   int d2=InpDate2*(bars-1)/100;
   int d3=InpDate3*(bars-1)/100;
   int p1=InpPrice1*(accuracy-1)/100;
   int p2=InpPrice2*(accuracy-1)/100;
   int p3=InpPrice3*(accuracy-1)/100;
//--- 创建等距通道
   if(!ChannelCreate(0,InpName,0,date[d1],price[p1],date[d2],price[p2],date[d3],price[p3],InpColor,
      InpStyle,InpWidth,InpFill,InpBack,InpSelection,InpRayLeft,InpRayRight,InpHidden,InpZOrder))
     {
      return;
     }
//--- 重画图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- 现在，移动通道定位点
//--- 循环计数器
   int h_steps=bars/6;
//--- 移动第二个定位点
   for(int i=0;i&lt;h_steps;i++)
     {
      //--- 使用下面的值
      if(d2&lt; bars-1)
         d2+=1;
      //--- 移动点
      if(!ChannelPointChange(0,InpName,1,date[d2],price[p2]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
      // 0.05 秒延迟
      Sleep(50);
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 移动第一个定位点
   for(int i=0;i&lt; h_steps;i++)
     {
      //--- 使用下面的值
      if(d1&gt;1)
         d1-=1;
      //--- 移动点
      if(!ChannelPointChange(0,InpName,0,date[d1],price[p1]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
      // 0.05 秒延迟
      Sleep(50);
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 循环计数器
   int v_steps=accuracy/10;
//--- 移动第三个定位点
   for(int i=0;i&lt; v_steps ;i++)
     {
      //--- 使用下面的值
      if(p3&gt;1)
         p3-=1;
      //--- 移动点
      if(!ChannelPointChange(0,InpName,2,date[d3],price[p3]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 删除图表通道
   ChannelDelete(0,InpName);
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br></div></div><h4 id="_2-2-1-9-obj-regression线性回归通道"><a href="#_2-2-1-9-obj-regression线性回归通道" class="header-anchor">#</a> 2.2.1.9 OBJ_REGRESSION线性回归通道</h4> <p><img src="/mql5yao/assets/img/sec8.ccdefca7.png" alt="Alt text"></p> <p>ObjRegression</p> <p>注意</p> <p>对线性回归通道，它可以指定延续向右和/或向左展示的模式 (OBJPROP_RAY_RIGHT 和 OBJPROP_RAY_LEFT 相应的属性)。也可以设置颜色填充通道的模式。</p> <p>示例</p> <p>下面的脚本创建并移动图表上的等距通道线。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 描述
#property description &quot;Script draws \&quot;Linear Regression Channel\&quot; graphical object.&quot;
#property description &quot;Anchor point coordinates are set in percentage of the size of&quot;
#property description &quot;the chart window.&quot;
//--- 启动脚本期间显示输入参数的窗口
#property script_show_inputs
//--- 脚本的输入参数
input string          InpName=&quot;Regression&quot;; // 通道名称
input int             InpDate1=10;          // 第1个点的日期， %
input int             InpDate2=40;          // 第2个点的日期， %
input color           InpColor=clrRed;      // 通道的颜色
input ENUM_LINE_STYLE InpStyle=STYLE_DASH;  // 通道线的风格
input int             InpWidth=2;           // 通道线的宽度
input bool            InpFill=false;        // 填充通道颜色
input bool            InpBack=false;        // 背景通道
input bool            InpSelection=true;    // 突出移动
input bool            InpRayLeft=false;     // 通道延续向左
input bool            InpRayRight=false;    // 通道延续向右
input bool            InpHidden=true;       // 隐藏在对象列表
input long            InpZOrder=0;          // 鼠标单击优先
//+------------------------------------------------------------------+
//| 通过已给的坐标创建线性回归通道                                       |
//+------------------------------------------------------------------+
bool RegressionCreate(const long            chart_ID=0,        // 图表 ID
                      const string          name=&quot;Regression&quot;, // 通道名称
                      const int             sub_window=0,      // 子窗口指数
                      datetime              time1=0,           // 第一个点的时间
                      datetime              time2=0,           // 第二个点的时间
                      const color           clr=clrRed,        // 通道的颜色
                      const ENUM_LINE_STYLE style=STYLE_SOLID, // 通道线的风格
                      const int             width=1,           // 通道线的宽度
                      const bool            fill=false,        // 填充通道颜色
                      const bool            back=false,        // 在背景中
                      const bool            selection=true,    // 突出移动
                      const bool            ray_left=false,    // 通道延续到向左
                      const bool            ray_right=false,   // 通道延续到向右
                      const bool            hidden=true,       // 隐藏在对象列表
                      const long            z_order=0)         // 鼠标单击优先
  {
//--- 若未设置则设置定位点的坐标
   ChangeRegressionEmptyPoints(time1,time2);
//--- 重置错误的值
   ResetLastError();
//--- 通过已给的坐标创建通道
   if(!ObjectCreate(chart_ID,name,OBJ_REGRESSION,sub_window,time1,0,time2,0))
     {
      Print(__FUNCTION__,
            &quot;: failed to create linear regression channel! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 设置通道颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//--- 设置通道线的风格
   ObjectSetInteger(chart_ID,name,OBJPROP_STYLE,style);
//--- 设置通道线的宽度
   ObjectSetInteger(chart_ID,name,OBJPROP_WIDTH,width);
//--- 启用 (true) 或禁用 (false) 填充通道的模式
   ObjectSetInteger(chart_ID,name,OBJPROP_FILL,fill);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 突出通道移动的模式
//--- 当使用ObjectCreate函数创建图形对象时，对象不能
//--- 默认下突出并移动。在这个方法中，默认选择参数
//--- true 可以突出移动对象
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 启用 (true) 或禁用 (false) 延续向左显示通道的模式
   ObjectSetInteger(chart_ID,name,OBJPROP_RAY_LEFT,ray_left);
//--- 启用 (true) 或禁用 (false) 延续向右显示通道的模式
   ObjectSetInteger(chart_ID,name,OBJPROP_RAY_RIGHT,ray_right);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动通道的定位点                                                   |
//+------------------------------------------------------------------+
bool RegressionPointChange(const long   chart_ID=0,     //图表 ID
                           const string name=&quot;Channel&quot;, // 通道名称
                           const int    point_index=0,  // 定位点指数
                           datetime     time=0)         // 定位点时间坐标
  {
//--- 如果没有设置点的时间，将点移动到当前柱
   if(!time)
      time=TimeCurrent();
//--- 重置错误的值
   ResetLastError();
//--- 移动定位点
   if(!ObjectMove(chart_ID,name,point_index,time,0))
     {
      Print(__FUNCTION__,
            &quot;: failed to move the anchor point! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 删除通道                                                          |
//+------------------------------------------------------------------+
bool RegressionDelete(const long   chart_ID=0,     // 图表 ID
                      const string name=&quot;Channel&quot;) // 通道名称
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除通道
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete the channel! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+-------------------------------------------------------------------------+
//| 检查通道定位点的值和为空点设置                                              |
//| 默认的值                                                                 |
//+-------------------------------------------------------------------------+
void ChangeRegressionEmptyPoints(datetime &amp;time1,datetime &amp;time2)
  {
//--- 如果第二点的时间没有设置，它将位于当前柱
   if(!time2)
      time2=TimeCurrent();
//--- 如果第一点的时间没有设置，它则位于第二点左侧的9个柱
   if(!time1)
     {
      //--- 接收最近10柱开盘时间的数组
      datetime temp[10];
      CopyTime(Symbol(),Period(),time2,10,temp);
      //--- 在第二点左侧9柱设置第一点
      time1=temp[0];
     }
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 检查输入参数的正确性
   if(InpDate1 &lt; 0 || InpDate1 &gt; 100 ||
      InpDate2 &lt; 0 || InpDate2 &gt; 100)
     {
      Print(&quot;Error! Incorrect values of input parameters!&quot;);
      return;
     }
//--- 图表窗口的可见柱的数量
   int bars=(int)ChartGetInteger(0,CHART_VISIBLE_BARS);
//--- 价格数组大小
   int accuracy=1000;
//--- 存储要使用的日期和价格值的数组
//--- 设置和改变通道定位点的坐标
   datetime date[];
   double   price[];
//--- 内存分配
   ArrayResize(date,bars);
   ArrayResize(price,accuracy);
//--- 填写日期数组
   ResetLastError();
   if(CopyTime(Symbol(),Period(),0,bars,date)==-1)
     {
      Print(&quot;Failed to copy time values! Error code = &quot;,GetLastError());
      return;
     }
//--- 填写价格数组
//--- 找出图表的最高值和最低值
   double max_price=ChartGetDouble(0,CHART_PRICE_MAX);
   double min_price=ChartGetDouble(0,CHART_PRICE_MIN);
//--- 定义变化的价格并填写该数组
   double step=(max_price-min_price)/accuracy;
   for(int i=0;i&lt;accuracy ;i++)
      price[i]=min_price+i*step;
//--- 定义绘制通道的点
   int d1=InpDate1*(bars-1)/100;
   int d2=InpDate2*(bars-1)/100;
//--- 创建线性回归通道
   if(!RegressionCreate(0,InpName,0,date[d1],date[d2],InpColor,InpStyle,InpWidth,
      InpFill,InpBack,InpSelection,InpRayLeft,InpRayRight,InpHidden,InpZOrder))
     {
      return;
     }
//--- 重画图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- 现在，水平向右移动通道
//--- 循环计数器
   int h_steps=bars/2;
//--- 移动通道
   for(int i=0;i&lt;h_steps;i++)
     {
      //--- 使用下面的值
      if(d1&lt;bars-1)
         d1+=1;
      if(d2&lt;bars-1)
         d2+=1;
      //--- 移动定位点
      if(!RegressionPointChange(0,InpName,0,date[d1]))
         return;
      if(!RegressionPointChange(0,InpName,1,date[d2]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
      // 0.05 秒延迟
      Sleep(50);
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 删除图表通道
   RegressionDelete(0,InpName);
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br></div></div><h4 id="_2-2-1-10-obj-pitchfork安德鲁鱼叉线"><a href="#_2-2-1-10-obj-pitchfork安德鲁鱼叉线" class="header-anchor">#</a> 2.2.1.10 OBJ_PITCHFORK安德鲁鱼叉线</h4> <p><img src="/mql5yao/assets/img/sec9.70fc1c9d.png" alt="Alt text"></p> <p>ObjPitchfork</p> <p>注意</p> <p>对于安德鲁鱼叉线，可以指定它 向右 和/或 向左 延长显示的模式 (根据属性值OBJPROP_RAY_RIGHT 和 OBJPROP_RAY_LEFT 决定)。</p> <p>您也可以指定线的级别数，它们的值和颜色。</p> <p>示例</p> <p>下面的脚本创建并移动图表上的安德鲁鱼叉线。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 描述
#property description &quot;Script draws \&quot;Andrews’ Pitchfork\&quot; graphical object.&quot;
#property description &quot;Anchor point coordinates are set in percentage of&quot;
#property description &quot;the chart window size.&quot;
//--- 启动脚本期间显示输入参数的窗口
#property script_show_inputs
//--- 脚本的输入参数
input string          InpName=&quot;Pitchfork&quot;;  // 鱼叉名称
input int             InpDate1=14;          // 第1个点的日期， %
input int             InpPrice1=40;         // 第1个点的价格， %
input int             InpDate2=18;          // 第2个点的日期， %
input int             InpPrice2=50;         // 第2个点的价格， %
input int             InpDate3=18;          // 第3个点的日期， %
input int             InpPrice3=30;         // 第3个点的价格， %
input color           InpColor=clrRed;      // 鱼叉颜色
input ENUM_LINE_STYLE InpStyle=STYLE_SOLID; // 鱼叉线的风格
input int             InpWidth=1;           // 鱼叉线的宽度
input bool            InpBack=false;        // 背景鱼叉线
input bool            InpSelection=true;    // 突出移动
input bool            InpRayLeft=false;     // 鱼叉线延续向左
input bool            InpRayRight=false;    // 鱼叉线延续向右
input bool            InpHidden=true;       // 隐藏在对象列表
input long            InpZOrder=0;          // 鼠标单击优先
//+------------------------------------------------------------------+
//| 通过已给的坐标创建安德鲁鱼叉线                                       |
//+------------------------------------------------------------------+
bool PitchforkCreate(const long            chart_ID=0,        // 图表 ID
                     const string          name=&quot;Pitchfork&quot;,  // 鱼叉线名称
                     const int             sub_window=0,      // 子窗口指数
                     datetime              time1=0,           // 第一个点的时间
                     double                price1=0,          // 第一个点的价格
                     datetime              time2=0,           // 第二个点的时间
                     double                price2=0,          // 第二个点的价格
                     datetime              time3=0,           // 第三个点的时间
                     double                price3=0,          // 第三个点的价格
                     const color           clr=clrRed,        // 鱼叉线的颜色
                     const ENUM_LINE_STYLE style=STYLE_SOLID, // 鱼叉线的风格
                     const int             width=1,           // 鱼叉线的宽度
                     const bool            back=false,        // 在背景中
                     const bool            selection=true,    // 突出移动
                     const bool            ray_left=false,    // 鱼叉线延续向左
                     const bool            ray_right=false,   // 鱼叉线延续向右
                     const bool            hidden=true,       // 隐藏在对象列表
                     const long            z_order=0)         // 鼠标单击优先
  {
//--- 若未设置则设置定位点的坐标
   ChangeChannelEmptyPoints(time1,price1,time2,price2,time3,price3);
//--- 重置错误的值
   ResetLastError();
//--- 通过已给的坐标创建安德鲁鱼叉线
   if(!ObjectCreate(chart_ID,name,OBJ_PITCHFORK,sub_window,time1,price1,time2,price2,time3,price3))
     {
      Print(__FUNCTION__,
            &quot;: failed to create \&quot;Andrews' Pitchfork\&quot;! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 设置颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//---设置线的风格
   ObjectSetInteger(chart_ID,name,OBJPROP_STYLE,style);
//--- 设置线的宽度
   ObjectSetInteger(chart_ID,name,OBJPROP_WIDTH,width);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 突出鱼叉线移动的模式
//--- 当使用ObjectCreate函数创建图形对象时，对象不能
//--- 默认下突出并移动。在这个方法中，默认选择参数
//--- true 可以突出移动对象
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 启用 (true) 或禁用 (false) 延续向左显示鱼叉线的模式
   ObjectSetInteger(chart_ID,name,OBJPROP_RAY_LEFT,ray_left);
//--- 启用 (true) 或禁用 (false) 延续向右显示鱼叉线的模式
   ObjectSetInteger(chart_ID,name,OBJPROP_RAY_RIGHT,ray_right);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 设置安德鲁鱼叉线水平的数量和参数                                      |
//+------------------------------------------------------------------+
bool PitchforkLevelsSet(int             levels,           // 水平线的数量
                        double          &amp;values[],        // 水平线的值
                        color           &amp;colors[],        // 水平线的颜色
                        ENUM_LINE_STYLE &amp;styles[],        // 水平线的风格
                        int             &amp;widths[],        // 水平线的宽度
                        const long      chart_ID=0,       // 图表 ID
                        const string    name=&quot;Pitchfork&quot;) // 鱼叉线的名称
  {
//--- 检查数组大小
   if(levels!=ArraySize(colors) || levels!=ArraySize(styles) ||
      levels!=ArraySize(widths) || levels!=ArraySize(widths))
     {
      Print(__FUNCTION__,&quot;: array length does not correspond to the number of levels, error!&quot;);
      return(false);
     }
//--- 设置水平数量
   ObjectSetInteger(chart_ID,name,OBJPROP_LEVELS,levels);
//--- 设置循环中水平的属性
   for(int i=0;i&lt; levels ;i++)
     {
      //--- 水平的值
      ObjectSetDouble(chart_ID,name,OBJPROP_LEVELVALUE,i,values[i]);
      //--- 水平的颜色
      ObjectSetInteger(chart_ID,name,OBJPROP_LEVELCOLOR,i,colors[i]);
      //--- 水平的风格
      ObjectSetInteger(chart_ID,name,OBJPROP_LEVELSTYLE,i,styles[i]);
      //--- 水平的宽度
      ObjectSetInteger(chart_ID,name,OBJPROP_LEVELWIDTH,i,widths[i]);
      //--- 水平的描述
      ObjectSetString(chart_ID,name,OBJPROP_LEVELTEXT,i,DoubleToString(100*values[i],1));
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动安德鲁鱼叉线的定位点                                            |
//+------------------------------------------------------------------+
bool PitchforkPointChange(const long   chart_ID=0,       // 图表 ID
                          const string name=&quot;Pitchfork&quot;, // 通道的名称
                          const int    point_index=0,    // 定位点指数
                          datetime     time=0,           // 定位点时间坐标
                          double       price=0)          // 定位点价格坐标
  {
//--- 如果没有设置点的位置，则将其移动到当前的卖价柱
   if(!time)
      time=TimeCurrent();
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 重置错误的值
   ResetLastError();
//--- 移动定位点
   if(!ObjectMove(chart_ID,name,point_index,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to move the anchor point! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 删除安德鲁鱼叉线                                                   |
//+------------------------------------------------------------------+
bool PitchforkDelete(const long   chart_ID=0,       // 图表 ID
                     const string name=&quot;Pitchfork&quot;) // 通道的名称
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除通道
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete \&quot;Andrews' Pitchfork\&quot;! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+----------------------------------------------------------------------+
//| 检查安德鲁鱼叉线定位点的值和为空点设置                                    |
//| 默认的值                                                              |
//+----------------------------------------------------------------------+
void ChangeChannelEmptyPoints(datetime &amp;time1,double &amp;price1,datetime &amp;time2,
                              double &amp;price2,datetime &amp;time3,double &amp;price3)
  {
//--- 如果第二点（右上侧）的时间没有设置，它将位于当前柱
   if(!time2)
      time2=TimeCurrent();
//--- 如果第二点的价格没有设置，则它将用卖价值
   if(!price2)
      price2=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 如果第一点（左侧）的时间没有设置，它则位于第二点左侧的9个柱
   if(!time1)
     {
      //--- 接收最近10柱开盘时间的数组
      datetime temp[10];
      CopyTime(Symbol(),Period(),time2,10,temp);
      //--- 在第二点左侧9柱设置第一点
      time1=temp[0];
     }
//--- 如果第一个点的价格没有设置，则低于第二个点移动200点
   if(!price1)
      price1=price2-200*SymbolInfoDouble(Symbol(),SYMBOL_POINT);
//--- 如果第三个点的时间没有设置，则它与第二个点的时间相一致
   if(!time3)
      time3=time2;
//---如果第三个点的价格没有设置，则低于第一个点移动200点
   if(!price3)
      price3=price1-200*SymbolInfoDouble(Symbol(),SYMBOL_POINT);
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 检查输入参数的正确性
   if(InpDate1 &lt; 0 || InpDate1 &gt; 100 || InpPrice1 &lt; 0 || InpPrice1 &gt; 100 ||
      InpDate2 &lt; 0 || InpDate2 &gt; 100 || InpPrice2 &lt; 0 || InpPrice2 &gt; 100 ||
      InpDate3 &lt; 0 || InpDate3 &gt; 100 || InpPrice3 &lt; 0 || InpPrice3 &gt; 100)
     {
      Print(&quot;Error! Incorrect values of input parameters!&quot;);
      return;
     }
//--- 图表窗口的可见柱的数量
   int bars=(int)ChartGetInteger(0,CHART_VISIBLE_BARS);
//--- 价格数组大小
   int accuracy=1000;
//--- 存储要使用的日期和价格值的数组
//--- 设置和改变安德鲁鱼叉线的定位点的坐标
   datetime date[];
   double   price[];
//--- 内存分配
   ArrayResize(date,bars);
   ArrayResize(price,accuracy);
//--- 填写日期数组
   ResetLastError();
   if(CopyTime(Symbol(),Period(),0,bars,date)==-1)
     {
      Print(&quot;Failed to copy time values! Error code = &quot;,GetLastError());
      return;
     }
//--- 填写价格数组
//--- 找出图表的最高值和最低值
   double max_price=ChartGetDouble(0,CHART_PRICE_MAX);
   double min_price=ChartGetDouble(0,CHART_PRICE_MIN);
//--- 定义变化的价格并填写该数组
   double step=(max_price-min_price)/accuracy;
   for(int i=0;i&lt; accuracy ;i++)
      price[i]=min_price+i*step;
//--- 定义绘制安德鲁鱼叉线的点
   int d1=InpDate1*(bars-1)/100;
   int d2=InpDate2*(bars-1)/100;
   int d3=InpDate3*(bars-1)/100;
   int p1=InpPrice1*(accuracy-1)/100;
   int p2=InpPrice2*(accuracy-1)/100;
   int p3=InpPrice3*(accuracy-1)/100;
//--- 创建安德鲁鱼叉线
   if(!PitchforkCreate(0,InpName,0,date[d1],price[p1],date[d2],price[p2],date[d3],price[p3],
      InpColor,InpStyle,InpWidth,InpBack,InpSelection,InpRayLeft,InpRayRight,InpHidden,InpZOrder))
     {
      return;
     }
//--- 重画图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- 现在，移动鱼叉线定位点
//--- 循环计数器
   int v_steps=accuracy/10;
//--- 移动第一个定位点
   for(int i=0;i&lt;v_steps ;i++)
     {
      //--- 使用下面的值
      if(p1&gt;1)
         p1-=1;
      //--- 移动点
      if(!PitchforkPointChange(0,InpName,0,date[d1],price[p1]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 循环计数器
   int h_steps=bars/8;
//--- 移动第三个定位点
   for(int i=0;i&lt;h_steps ;i++)
     {
      //--- 使用下面的值
      if(d3&lt;bars-1)
         d3+=1;
      //--- 移动点
      if(!PitchforkPointChange(0,InpName,2,date[d3],price[p3]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
      //--- 重画图表
      ChartRedraw();
      // 0.05 秒延迟
      Sleep(50);
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 循环计数器
   v_steps=accuracy/10;
//--- 移动第二个定位点
   for(int i=0;i&lt;v_steps ;i++)
     {
      //--- 使用下面的值
      if(p2&gt;1)
         p2-=1;
      //--- 移动点
      if(!PitchforkPointChange(0,InpName,1,date[d2],price[p2]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 删除图表鱼叉线
   PitchforkDelete(0,InpName);
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br><span class="line-number">292</span><br><span class="line-number">293</span><br><span class="line-number">294</span><br><span class="line-number">295</span><br><span class="line-number">296</span><br><span class="line-number">297</span><br><span class="line-number">298</span><br><span class="line-number">299</span><br><span class="line-number">300</span><br><span class="line-number">301</span><br><span class="line-number">302</span><br><span class="line-number">303</span><br><span class="line-number">304</span><br><span class="line-number">305</span><br><span class="line-number">306</span><br><span class="line-number">307</span><br><span class="line-number">308</span><br><span class="line-number">309</span><br><span class="line-number">310</span><br><span class="line-number">311</span><br><span class="line-number">312</span><br><span class="line-number">313</span><br><span class="line-number">314</span><br><span class="line-number">315</span><br><span class="line-number">316</span><br><span class="line-number">317</span><br><span class="line-number">318</span><br></div></div><h4 id="_2-2-1-11-obj-gannline江恩线"><a href="#_2-2-1-11-obj-gannline江恩线" class="header-anchor">#</a> 2.2.1.11 OBJ_GANNLINE江恩线</h4> <p><img src="data:image/png;base64,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" alt="Alt text"></p> <p>ObjPitchfork</p> <p>注意</p> <p>对于江恩线，可以指定它 向右 和/或 向左 延长显示的模式 (根据属性值OBJPROP_RAY_RIGHT 和 OBJPROP_RAY_LEFT 决定)。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 描述
#property description &quot;Script draws \&quot;Gann Line\&quot; graphical object.&quot;
#property description &quot;Anchor point coordinates are set in percentage of&quot;
#property description &quot;the chart window size.&quot;
//--- 启动脚本期间显示输入参数的窗口
#property script_show_inputs
//--- 脚本的输入参数
input string          InpName=&quot;GannLine&quot;;        // 线的名称
input int             InpDate1=20;               // 第1个点的日期，%
input int             InpPrice1=75;              // 第1个点的价格， %
input int             InpDate2=80;               // 第2个点的日期，%
input double          InpAngle=0.0;              // 江恩角度线
input double          InpScale=1.0;              // 比例
input color           InpColor=clrRed;           // 线的颜色
input ENUM_LINE_STYLE InpStyle=STYLE_DASHDOTDOT; // 线的风格
input int             InpWidth=2;                // 线的宽度
input bool            InpBack=false;             // 背景线
input bool            InpSelection=true;         // 突出移动
input bool            InpRayLeft=false;          // 线延续向左
input bool            InpRayRight=true;          // 线延续向右
input bool            InpHidden=true;            // 隐藏在对象列表
input long            InpZOrder=0;               // 鼠标单击优先
//+------------------------------------------------------------------+
//| 通过已给的坐标，角度和比例创建江恩线                                   |
//+------------------------------------------------------------------+
bool GannLineCreate(const long            chart_ID=0,        // 图表 ID
                    const string          name=&quot;GannLine&quot;,   // 线的名称
                    const int             sub_window=0,      // 子窗口指数
                    datetime              time1=0,           // 第一个点的时间
                    double                price1=0,          // 第一个点的价格
                    datetime              time2=0,           // 第二个点的时间
                    const double          angle=1.0,         // 江恩角度线
                    const double          scale=1.0,         // 比例
                    const color           clr=clrRed,        // 线的颜色
                    const ENUM_LINE_STYLE style=STYLE_SOLID, // 线的风格
                    const int             width=1,           // 线的宽度
                    const bool            back=false,        // 在背景中
                    const bool            selection=true,    // 突出移动
                    const bool            ray_left=false,    // 线延续向左
                    const bool            ray_right=true,    // 线延续向右
                    const bool            hidden=true,       // 隐藏在对象列表
                    const long            z_order=0)         // 鼠标单击优先
  {
//--- 若未设置则设置定位点的坐标
   ChangeGannLineEmptyPoints(time1,price1,time2);
//--- 重置错误的值
   ResetLastError();
//--- 通过已给的坐标创建江恩线
//--- 第二定位点的正确坐标被重新定义
//--- 江恩角度线和/或比例自动更改后，
   if(!ObjectCreate(chart_ID,name,OBJ_GANNLINE,sub_window,time1,price1,time2,0))
     {
      Print(__FUNCTION__,
            &quot;: failed to create \&quot;Gann Line\&quot;! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 改变江恩角度线
   ObjectSetDouble(chart_ID,name,OBJPROP_ANGLE,angle);
//--- 改变比例 (每柱的点数)
   ObjectSetDouble(chart_ID,name,OBJPROP_SCALE,scale);
//--- 设置线的颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//--- 设置线的显示风格
   ObjectSetInteger(chart_ID,name,OBJPROP_STYLE,style);
//--- 设置线的宽度
   ObjectSetInteger(chart_ID,name,OBJPROP_WIDTH,width);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 突出线移动的模式
//--- 当使用ObjectCreate函数创建图形对象时，对象不能
//--- 默认下突出并移动。在这个方法中，默认选择参数
//--- true 可以突出移动对象
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 启用 (true) 或禁用 (false) 延续向左显示线的模式
   ObjectSetInteger(chart_ID,name,OBJPROP_RAY_LEFT,ray_left);
//--- 启用 (true) 或禁用 (false) 延续向右显示线的模式
   ObjectSetInteger(chart_ID,name,OBJPROP_RAY_RIGHT,ray_right);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动江恩线定位点                                                   |
//+------------------------------------------------------------------+
bool GannLinePointChange(const long   chart_ID=0,      // 图表 ID
                         const string name=&quot;GannLine&quot;, // 线的名称
                         const int    point_index=0,   // 定位点指数
                         datetime     time=0,          // 定位点时间坐标
                         double       price=0)         // 定位点价格坐标
  {
//--- 如果没有设置点的位置，则将其移动到当前的卖价柱
   if(!time)
      time=TimeCurrent();
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 重置错误的值
   ResetLastError();
//--- 移动线的定位点
   if(!ObjectMove(chart_ID,name,point_index,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to move the anchor point! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 改变江恩角度线                                                     |
//+------------------------------------------------------------------+
bool GannLineAngleChange(const long   chart_ID=0,      // 图表 ID
                         const string name=&quot;GannLine&quot;, // 线的名称
                         const double angle=1.0)       // 江恩角度线
  {
//--- 重置错误的值
   ResetLastError();
//--- 改变江恩角度线
   if(!ObjectSetDouble(chart_ID,name,OBJPROP_ANGLE,angle))
     {
      Print(__FUNCTION__,
            &quot;: failed to change Gann angle! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 改变江恩线的比例                                                   |
//+------------------------------------------------------------------+
bool GannLineScaleChange(const long   chart_ID=0,      // 图表 ID
                         const string name=&quot;GannLine&quot;, // 线的名称
                         const double scale=1.0)       // 比例
  {
//--- 重置错误的值
   ResetLastError();
//--- 改变比例 (每柱的点数)
   if(!ObjectSetDouble(chart_ID,name,OBJPROP_SCALE,scale))
     {
      Print(__FUNCTION__,
            &quot;: failed to change the scale! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 这个函数移除图表江恩线                                              |
//+------------------------------------------------------------------+
bool GannLineDelete(const long   chart_ID=0,      // 图表 ID
                    const string name=&quot;GannLine&quot;) // 线的名称
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除江恩线。
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete \&quot;Gann Line\&quot;! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 检查江恩线定位点的值和为空点设置                                      |
//| 默认的值                                                          |
//+------------------------------------------------------------------+
void ChangeGannLineEmptyPoints(datetime &amp;time1,double &amp;price1,datetime &amp;time2)
  {
//--- 如果第二点的时间没有设置，它将位于当前柱
   if(!time2)
      time2=TimeCurrent();
//--- 如果第一点的时间没有设置，它则位于第二点左侧的9个柱
   if(!time1)
     {
      //--- 接收最近10柱开盘时间的数组
      datetime temp[10];
      CopyTime(Symbol(),Period(),time2,10,temp);
      //--- 在第二点左侧9柱设置第一点
      time1=temp[0];
     }
//--- 如果第一点的价格没有设置，则它将用卖价值
   if(!price1)
      price1=SymbolInfoDouble(Symbol(),SYMBOL_BID);
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 检查输入参数的正确性
   if(InpDate1 &lt; 0 || InpDate1 &gt; 100 || InpPrice1 &lt; 0 || InpPrice1 &gt; 100 ||
      InpDate2 &lt; 0 || InpDate2 &gt; 100)
     {
      Print(&quot;Error! Incorrect values of input parameters!&quot;);
      return;
     }
//--- 图表窗口的可见柱的数量
   int bars=(int)ChartGetInteger(0,CHART_VISIBLE_BARS);
//--- 价格数组大小
   int accuracy=1000;
//--- 存储要使用的日期和价格值的数组
//--- 设置和改变线定位点的坐标
   datetime date[];
   double   price[];
//--- 内存分配
   ArrayResize(date,bars);
   ArrayResize(price,accuracy);
//--- 填写日期数组
   ResetLastError();
   if(CopyTime(Symbol(),Period(),0,bars,date)==-1)
     {
      Print(&quot;Failed to copy time values! Error code = &quot;,GetLastError());
      return;
     }
//--- 填写价格数组
//--- 找出图表的最高值和最低值
   double max_price=ChartGetDouble(0,CHART_PRICE_MAX);
   double min_price=ChartGetDouble(0,CHART_PRICE_MIN);
//--- 定义变化的价格并填写该数组
   double step=(max_price-min_price)/accuracy;
   for(int i=0;i&lt; accuracy ;i++)
      price[i]=min_price+i*step;
//--- 定义绘制江恩线的点
   int d1=InpDate1*(bars-1)/100;
   int d2=InpDate2*(bars-1)/100;
   int p1=InpPrice1*(accuracy-1)/100;
//--- 创建江恩线
   if(!GannLineCreate(0,InpName,0,date[d1],price[p1],date[d2],InpAngle,InpScale,InpColor,
      InpStyle,InpWidth,InpBack,InpSelection,InpRayLeft,InpRayRight,InpHidden,InpZOrder))
     {
      return;
     }
//--- 重画图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- 现在，移动线的定位点和改变角度
//--- 循环计数器
   int v_steps=accuracy/2;
//--- 垂直移动第一个定位点
   for(int i=0;i&lt; v_steps ;i++)
     {
      //--- 使用下面的值
      if(p1&gt;1)
         p1-=1;
      //--- 移动点
      if(!GannLinePointChange(0,InpName,0,date[d1],price[p1]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 半秒延迟
   Sleep(500);
//--- 定义江恩角度线的当前值（已变化
//--- 当移动第一个定位点以后）
   double curr_angle;
   if(!ObjectGetDouble(0,InpName,OBJPROP_ANGLE,0,curr_angle))
      return;
//--- 循环计数器
   v_steps=accuracy/8;
//--- 改变江恩角度线
   for(int i=0;i&lt; v_steps ;i++)
     {
      if(!GannLineAngleChange(0,InpName,curr_angle-0.05*i))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 删除图表线
   GannLineDelete(0,InpName);
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br></div></div><h4 id="_2-2-1-12-obj-gannfan江恩扇形线"><a href="#_2-2-1-12-obj-gannfan江恩扇形线" class="header-anchor">#</a> 2.2.1.12 OBJ_GANNFAN江恩扇形线</h4> <p><img src="/mql5yao/assets/img/sec11.eabf91f9.png" alt="Alt text"></p> <p>ObjGannFan</p> <p>注意</p> <p>对于江恩扇形线，可以指定 ENUM_GANN_DIRECTION 枚举的趋势类型。通过调整比例值 (OBJPROP_SCALE)，可以改变扇形线的倾斜角。</p> <p>示例</p> <p>下面的脚本创建并移动图表上的江恩扇形线。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 描述
#property description &quot;Script draws \&quot;Gann Fan\&quot; graphical object.&quot;
#property description &quot;Anchor point coordinates are set in percentage of&quot;
#property description &quot;the chart window size.&quot;
//--- 启动脚本期间显示输入参数的窗口
#property script_show_inputs
//--- 脚本的输入参数
input string          InpName=&quot;GannFan&quot;;         // 扇形线名称
input int             InpDate1=15;               // 第1个点的日期，%
input int             InpPrice1=25;              // 第1个点的价格，%
input int             InpDate2=85;               // 第2个点的日期，%
input double          InpScale=2.0;              // 比例
input bool            InpDirection=false;        // 趋势方向
input color           InpColor=clrRed;           // 扇形线的颜色
input ENUM_LINE_STYLE InpStyle=STYLE_DASHDOTDOT; // 扇形线的风格
input int             InpWidth=1;                // 扇形线的宽度
input bool            InpBack=false;             // 背景扇形线
input bool            InpSelection=true;         // 突出移动
input bool            InpHidden=true;            // 隐藏在对象列表
input long            InpZOrder=0;               // 鼠标单击优先
//+------------------------------------------------------------------+
//| 创建江恩扇形线                                                     |
//+------------------------------------------------------------------+
bool GannFanCreate(const long            chart_ID=0,        // 图表 ID
                   const string          name=&quot;GannFan&quot;,    // 扇形线的名称
                   const int             sub_window=0,      // 子窗口指数
                   datetime              time1=0,           // 第一个点的时间
                   double                price1=0,          //第一个点的价格
                   datetime              time2=0,           // 第二个点的时间
                   const double          scale=1.0,         // 比例
                   const bool            direction=true,    // 趋势方向
                   const color           clr=clrRed,        // 扇形线颜色
                   const ENUM_LINE_STYLE style=STYLE_SOLID, // 扇形线的风格
                   const int             width=1,           // 扇形线的宽度
                   const bool            back=false,        // 在背景中
                   const bool            selection=true,    // 突出移动
                   const bool            hidden=true,       // 隐藏在对象列表
                   const long            z_order=0)         // 鼠标单击优先
  {
//--- 若未设置则设置定位点的坐标
   ChangeGannFanEmptyPoints(time1,price1,time2);
//--- 重置错误的值
   ResetLastError();
//--- 通过已给的坐标创建江恩扇形线
   if(!ObjectCreate(chart_ID,name,OBJ_GANNFAN,sub_window,time1,price1,time2,0))
     {
      Print(__FUNCTION__,
            &quot;: failed to create \&quot;Gann Fan\&quot;! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 改变比例 (每柱的点数)
   ObjectSetDouble(chart_ID,name,OBJPROP_SCALE,scale);
//--- 改变江恩扇形线趋势方向（true - 下降，false - 上升）
   ObjectSetInteger(chart_ID,name,OBJPROP_DIRECTION,direction);
//--- 设置扇形线颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//--- 设置扇形线的显示风格
   ObjectSetInteger(chart_ID,name,OBJPROP_STYLE,style);
//--- 设置扇形线的宽度
   ObjectSetInteger(chart_ID,name,OBJPROP_WIDTH,width);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 突出扇形线移动的模式
//--- 当使用ObjectCreate函数创建图形对象时，对象不能
//--- 默认下突出并移动。在这个方法中，默认选择参数
//--- true 可以突出移动对象
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动江恩扇形线定位点                                                |
//+------------------------------------------------------------------+
bool GannFanPointChange(const long   chart_ID=0,     // 图表 ID
                        const string name=&quot;GannFan&quot;, // 扇形线的名称
                        const int    point_index=0,  // 定位点指数
                        datetime     time=0,         // 定位点时间坐标
                        double       price=0)        // 定位点价格坐标
  {
//--- 如果没有设置点的位置，则将其移动到当前的卖价柱
   if(!time)
      time=TimeCurrent();
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 重置错误的值
   ResetLastError();
//--- 移动扇形线的定位点
   if(!ObjectMove(chart_ID,name,point_index,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to move the anchor point! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 改变江恩扇形线的比例                                                |
//+------------------------------------------------------------------+
bool GannFanScaleChange(const long   chart_ID=0,     // 图表 ID
                        const string name=&quot;GannFan&quot;, // 扇形线的名称
                        const double scale=1.0)      // scale
  {
//--- 重置错误的值
   ResetLastError();
//--- 改变比例 (每柱的点数)
   if(!ObjectSetDouble(chart_ID,name,OBJPROP_SCALE,scale))
     {
      Print(__FUNCTION__,
            &quot;: failed to change the scale! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 改变江恩扇形线的趋势方向                                            |
//+------------------------------------------------------------------+
bool GannFanDirectionChange(const long   chart_ID=0,     // 图表 ID
                            const string name=&quot;GannFan&quot;, // 扇形线的名称
                            const bool   direction=true) // 趋势方向
  {
//--- 重置错误的值
   ResetLastError();
//--- 改变江恩扇形线的趋势方向
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_DIRECTION,direction))
     {
      Print(__FUNCTION__,
            &quot;: failed to change trend direction! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 这个函数移除图表的江恩扇形线                                         |
//+------------------------------------------------------------------+
bool GannFanDelete(const long   chart_ID=0,     // 图表 ID
                   const string name=&quot;GannFan&quot;) // 扇形线的名称
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除江恩扇形线
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete \&quot;Gann Fan\&quot;! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 检查江恩扇形线定位点的值和为空点设置                                  |
//| 默认的值                                                          |
//+------------------------------------------------------------------+
void ChangeGannFanEmptyPoints(datetime &amp;time1,double &amp;price1,datetime &amp;time2)
  {
//--- 如果第二点的时间没有设置，它将位于当前柱
   if(!time2)
      time2=TimeCurrent();
//--- 如果第一点的时间没有设置，它则位于第二点左侧的9个柱
   if(!time1)
     {
      //--- 接收最近10柱开盘时间的数组
      datetime temp[10];
      CopyTime(Symbol(),Period(),time2,10,temp);
      //--- 在第二点左侧9柱设置第一点
      time1=temp[0];
     }
//--- 如果第一点的价格没有设置，则它将用卖价值
   if(!price1)
      price1=SymbolInfoDouble(Symbol(),SYMBOL_BID);
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 检查输入参数的正确性
   if(InpDate1 &lt; 0 || InpDate1 &gt; 100 || InpPrice1 &lt; 0 || InpPrice1 &gt; 100 ||
      InpDate2 &lt; 0 || InpDate2 &gt; 100)
     {
      Print(&quot;Error! Incorrect values of input parameters!&quot;);
      return;
     }
//--- 图表窗口的可见柱的数量
   int bars=(int)ChartGetInteger(0,CHART_VISIBLE_BARS);
//--- 价格数组大小
   int accuracy=1000;
//--- 存储要使用的日期和价格值的数组
//--- 设置和改变扇形线的定位点的坐标
   datetime date[];
   double   price[];
//--- 内存分配
   ArrayResize(date,bars);
   ArrayResize(price,accuracy);
//--- 填写日期数组
   ResetLastError();
   if(CopyTime(Symbol(),Period(),0,bars,date)==-1)
     {
      Print(&quot;Failed to copy time values! Error code = &quot;,GetLastError());
      return;
     }
//--- 填写价格数组
//--- 找出图表的最高值和最低值
   double max_price=ChartGetDouble(0,CHART_PRICE_MAX);
   double min_price=ChartGetDouble(0,CHART_PRICE_MIN);
//--- 定义变化的价格并填写该数组
   double step=(max_price-min_price)/accuracy;
   for(int i=0;i&lt;accuracy ;i++)
      price[i]=min_price+i*step;
//--- 定义绘制江恩扇形线的点
   int d1=InpDate1*(bars-1)/100;
   int d2=InpDate2*(bars-1)/100;
   int p1=InpPrice1*(accuracy-1)/100;
//--- 创建江恩扇形线
   if(!GannFanCreate(0,InpName,0,date[d1],price[p1],date[d2],InpScale,InpDirection,
      InpColor,InpStyle,InpWidth,InpBack,InpSelection,InpHidden,InpZOrder))
     {
      return;
     }
//--- 重画图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- 现在，移动扇形线的定位点
//--- 循环计数器
   int v_steps=accuracy/2;
//--- 垂直移动第一个定位点
   for(int i=0;i&lt;v_steps ;i++)
     {
      //--- 使用下面的值
      if(p1&lt;accuracy-1)
         p1+=1;
      //--- 移动点
      if(!GannFanPointChange(0,InpName,0,date[d1],price[p1]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 改变扇形线的趋势方向降一级
   GannFanDirectionChange(0,InpName,true);
//--- 重画图表
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//--- 删除图表扇形线
   GannFanDelete(0,InpName);
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br></div></div><h4 id="_2-2-1-13-obj-ganngrid江恩网格"><a href="#_2-2-1-13-obj-ganngrid江恩网格" class="header-anchor">#</a> 2.2.1.13 OBJ_GANNGRID江恩网格</h4> <p><img src="/mql5yao/assets/img/sec12.34fde19a.png" alt="Alt text"></p> <p>ObjGannGrid</p> <p>注意</p> <p>对于江恩网格，可以从 ENUM_GANN_DIRECTION指定趋势类型。通过调整比例值(OBJPROP_SCALE)，可以改变网格线的倾斜角。</p> <p>示例</p> <p>下面的脚本创建并移动图表上的江恩网格。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 描述
#property description &quot;Script draws \&quot;Gann Grid\&quot; graphical object.&quot;
#property description &quot;Anchor point coordinates of the grid are set in percentage of&quot;
#property description &quot;the chart window size.&quot;
//--- 启动脚本期间显示输入参数的窗口
#property script_show_inputs
//--- 脚本的输入参数
input string          InpName=&quot;GannGrid&quot;;        // 网格名称
input int             InpDate1=15;               // 第1个点的日期，%
input int             InpPrice1=25;              // 第1个点的价格，%
input int             InpDate2=35;               // 第2个点的日期，%
input double          InpScale=3.0;              // 比例
input bool            InpDirection=false;        // 趋势方向
input color           InpColor=clrRed;           // 网格颜色
input ENUM_LINE_STYLE InpStyle=STYLE_DASHDOTDOT; // 网格线的风格
input int             InpWidth=1;                // 扇形线的宽度
input bool            InpBack=false;             // 背景网格
input bool            InpSelection=true;         // 突出移动
input bool            InpHidden=true;            // 隐藏在对象列表
input long            InpZOrder=0;               // 鼠标单击优先
//+------------------------------------------------------------------+
//| 创建江恩网格                                                       |
//+------------------------------------------------------------------+
bool GannGridCreate(const long            chart_ID=0,        // 图表ID
                    const string          name=&quot;GannGrid&quot;,   // 网格的名称
                    const int             sub_window=0,      // 子窗口指数
                    datetime              time1=0,           // 第一个点的时间
                    double                price1=0,          // 第一个点的价格
                    datetime              time2=0,           // 第二个点的时间
                    const double          scale=1.0,         // 比例
                    const bool            direction=true,    // 趋势方向
                    const color           clr=clrRed,        // 网格颜色
                    const ENUM_LINE_STYLE style=STYLE_SOLID, // 网格线的风格
                    const int             width=1,           // 网格线的宽度
                    const bool            back=false,        // 在背景中
                    const bool            selection=true,    // 突出移动
                    const bool            hidden=true,       // 隐藏在对象列表
                    const long            z_order=0)         // 鼠标单击优先
  {
//--- 若未设置则设置定位点的坐标
   ChangeGannGridEmptyPoints(time1,price1,time2);
//--- 重置错误的值
   ResetLastError();
//--- 通过已给的坐标创建江恩网格
   if(!ObjectCreate(chart_ID,name,OBJ_GANNGRID,sub_window,time1,price1,time2,0))
     {
      Print(__FUNCTION__,
            &quot;: failed to create \&quot;Gann Grid\&quot;! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 改变比例 (每柱的点数)
   ObjectSetDouble(chart_ID,name,OBJPROP_SCALE,scale);
//--- 改变江恩扇形线趋势方向（true - 下降，false - 上升）
   ObjectSetInteger(chart_ID,name,OBJPROP_DIRECTION,direction);
//--- 设置网格颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//--- 设置网格线的显示风格
   ObjectSetInteger(chart_ID,name,OBJPROP_STYLE,style);
//--- 设置网格线的宽度
   ObjectSetInteger(chart_ID,name,OBJPROP_WIDTH,width);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 突出网格线移动的模式
//--- 当使用ObjectCreate函数创建图形对象时，对象不能
//--- 默认下突出并移动。在这个方法中，默认选择参数
//--- true 可以突出移动对象
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动江恩网格定位点                                                  |
//+------------------------------------------------------------------+
bool GannGridPointChange(const long   chart_ID=0,      // 图表 ID
                         const string name=&quot;GannGrid&quot;, // 网格的名称
                         const int    point_index=0,   // 定位点指数
                         datetime     time=0,          // 定位点时间坐标
                         double       price=0)         // 定位点价格坐标
  {
//--- 如果没有设置点的位置，则将其移动到当前的卖价柱
   if(!time)
      time=TimeCurrent();
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 重置错误的值
   ResetLastError();
//--- 移动网格的定位点
   if(!ObjectMove(chart_ID,name,point_index,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to move the anchor point! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 改变江恩网格的比例                                                  |
//+------------------------------------------------------------------+
bool GannGridScaleChange(const long   chart_ID=0,      // 图表 ID
                         const string name=&quot;GannGrid&quot;, // 网格
                         const double scale=1.0)       // 比例
  {
//--- 重置错误的值
   ResetLastError();
//--- 改变比例 (每柱的点数)
   if(!ObjectSetDouble(chart_ID,name,OBJPROP_SCALE,scale))
     {
      Print(__FUNCTION__,
            &quot;: failed to change the scale! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 改变江恩网格线的趋势方向                                            |
//+------------------------------------------------------------------+
bool GannGridDirectionChange(const long   chart_ID=0,      // 图表 ID
                             const string name=&quot;GannGrid&quot;, // 网格的名称
                             const bool   direction=true)  // 趋势方向
  {
//--- 重置错误的值
   ResetLastError();
//--- 改变江恩网格线的趋势方向
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_DIRECTION,direction))
     {
      Print(__FUNCTION__,
            &quot;: failed to change trend direction! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 这个函数移除图表的江恩扇形线                                         |
//+------------------------------------------------------------------+
bool GannGridDelete(const long   chart_ID=0,      // 图表 ID
                    const string name=&quot;GannGrid&quot;) // 网格的名称
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除江恩网格
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete \&quot;Gann Grid\&quot;! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 检查江恩网格线定位点的值和为空点设置                                  |
//| 默认的值                                                          |
//+------------------------------------------------------------------+
void ChangeGannGridEmptyPoints(datetime &amp;time1,double &amp;price1,datetime &amp;time2)
  {
//--- 如果第二点的时间没有设置，它将位于当前柱
   if(!time2)
      time2=TimeCurrent();
//--- 如果第一点的时间没有设置，它则位于第二点左侧的9个柱
   if(!time1)
     {
      //--- 接收最近10柱开盘时间的数组
      datetime temp[10];
      CopyTime(Symbol(),Period(),time2,10,temp);
      //--- 在第二点左侧9柱设置第一点
      time1=temp[0];
     }
//--- 如果第一点的价格没有设置，则它将用卖价值
   if(!price1)
      price1=SymbolInfoDouble(Symbol(),SYMBOL_BID);
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 检查输入参数的正确性
   if(InpDate1 &lt; 0 || InpDate1 &gt; 100 || InpPrice1 &lt; 0 || InpPrice1 &gt; 100 ||
      InpDate2 &lt; 0 || InpDate2 &gt; 100)
     {
      Print(&quot;Error! Incorrect values of input parameters!&quot;);
      return;
     }
//--- 图表窗口的可见柱的数量
   int bars=(int)ChartGetInteger(0,CHART_VISIBLE_BARS);
//--- 价格数组大小
   int accuracy=1000;
//--- 存储要使用的日期和价格值的数组
//--- 设置和改变网格定位点的坐标
   datetime date[];
   double   price[];
//--- 内存分配
   ArrayResize(date,bars);
   ArrayResize(price,accuracy);
//--- 填写日期数组
   ResetLastError();
   if(CopyTime(Symbol(),Period(),0,bars,date)==-1)
     {
      Print(&quot;Failed to copy time values! Error code = &quot;,GetLastError());
      return;
     }
//--- 填写价格数组
//--- 找出图表的最高值和最低值
   double max_price=ChartGetDouble(0,CHART_PRICE_MAX);
   double min_price=ChartGetDouble(0,CHART_PRICE_MIN);
//--- 定义变化的价格并填写该数组
   double step=(max_price-min_price)/accuracy;
   for(int i=0;i&lt; accuracy;i++)
      price[i]=min_price+i*step;
//--- 定义绘制江恩网格线的点
   int d1=InpDate1*(bars-1)/100;
   int d2=InpDate2*(bars-1)/100;
   int p1=InpPrice1*(accuracy-1)/100;
//--- 创建江恩网格
   if(!GannGridCreate(0,InpName,0,date[d1],price[p1],date[d2],InpScale,InpDirection,
      InpColor,InpStyle,InpWidth,InpBack,InpSelection,InpHidden,InpZOrder))
     {
      return;
     }
//--- 重画图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- now, move the grid's anchor points
//--- 循环计数器
   int v_steps=accuracy/4;
//--- 垂直移动第一个定位点
   for(int i=0;i&lt;v_steps;i++)
     {
      //--- 使用下面的值
      if(p1&lt;accuracy-1)
         p1+=1;
      if(!GannGridPointChange(0,InpName,0,date[d1],price[p1]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 循环计数器
   int h_steps=bars/4;
//---水平移动第二个定位点
   for(int i=0;i&lt; h_steps;i++)
     {
      //--- 使用下面的值
      if(d2&lt;bars-1)
         d2+=1;
      if(!GannGridPointChange(0,InpName,1,date[d2],0))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
      // 0.05 秒延迟
      Sleep(50);
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 改变网格线的趋势方向降一级
   GannGridDirectionChange(0,InpName,true);
//--- 重画图表
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//--- 删除图表网格
   GannGridDelete(0,InpName);
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br></div></div><h4 id="_2-2-1-14-obj-fibo斐波纳契回调线"><a href="#_2-2-1-14-obj-fibo斐波纳契回调线" class="header-anchor">#</a> 2.2.1.14 OBJ_FIBO斐波纳契回调线</h4> <p><img src="data:image/png;base64,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" alt="Alt text"></p> <p>ObjFiboLevels</p> <p>注意</p> <p>对于斐波纳契回调线，可以指定它 向右 和/或 向左 延长显示的模式 (根据属性值OBJPROP_RAY_RIGHT 和 OBJPROP_RAY_LEFT 决定)。</p> <p>您也可以指定线的级别数，它们的值和颜色。</p> <p>示例</p> <p>下面的脚本创建并移动图表上的斐波纳契回调线。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 描述
#property description &quot;Script draws \&quot;Fibonacci Retracement\&quot; graphical object.&quot;
#property description &quot;Anchor point coordinates are set in percentage of&quot;
#property description &quot;the chart window size.&quot;
//--- 启动脚本期间显示输入参数的窗口
#property script_show_inputs
//--- 脚本的输入参数
input string          InpName=&quot;FiboLevels&quot;;      // 对象名称
input int             InpDate1=10;               // 第1个点的日期，%
input int             InpPrice1=65;              // 第1个点的价格，%
input int             InpDate2=90;               // 第2个点的日期，%
input int             InpPrice2=85;              // 第2个点的价格，%
input color           InpColor=clrRed;           // 对象的颜色
input ENUM_LINE_STYLE InpStyle=STYLE_DASHDOTDOT; // 线的风格
input int             InpWidth=2;                // 线的宽度
input bool            InpBack=false;             // 背景对象
input bool            InpSelection=true;         // 突出移动
input bool            InpRayLeft=false;          // 对象延续向左
input bool            InpRayRight=false;         // 对象延续向右
input bool            InpHidden=true;            // 隐藏在对象列表
input long            InpZOrder=0;               // 鼠标单击优先
//+------------------------------------------------------------------+
//| 通过已给的坐标创建斐波纳契回调线                                     |
//+------------------------------------------------------------------+
bool FiboLevelsCreate(const long            chart_ID=0,        // 图表 ID
                      const string          name=&quot;FiboLevels&quot;, // 对象名称
                      const int             sub_window=0,      // 子窗口指数
                      datetime              time1=0,           // 第一个点的时间
                      double                price1=0,          // 第一个点的价格
                      datetime              time2=0,           // 第二个点的时间
                      double                price2=0,          // 第二个点的价格
                      const color           clr=clrRed,        // 对象颜色
                      const ENUM_LINE_STYLE style=STYLE_SOLID, // 对象线的风格
                      const int             width=1,           // 对象线的宽度
                      const bool            back=false,        // 在背景中
                      const bool            selection=true,    // 突出移动
                      const bool            ray_left=false,    // 对象持续向左
                      const bool            ray_right=false,   // 对象持续向右
                      const bool            hidden=true,       // 隐藏在对象列表
                      const long            z_order=0)         // 鼠标单击优先
  {
//--- 若未设置则设置定位点的坐标
   ChangeFiboLevelsEmptyPoints(time1,price1,time2,price2);
//--- 重置错误的值
   ResetLastError();
//--- 用给定的坐标创建斐波纳契回调线
   if(!ObjectCreate(chart_ID,name,OBJ_FIBO,sub_window,time1,price1,time2,price2))
     {
      Print(__FUNCTION__,
            &quot;: failed to create \&quot;Fibonacci Retracement\&quot;! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 设置颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//--- 设置线的风格
   ObjectSetInteger(chart_ID,name,OBJPROP_STYLE,style);
//--- 设置线的宽度
   ObjectSetInteger(chart_ID,name,OBJPROP_WIDTH,width);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 突出通道移动的模式
//--- 当使用ObjectCreate函数创建图形对象时，对象不能
//--- 默认下突出并移动。在这个方法中，默认选择参数
//--- true 可以突出移动对象
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 启用 (true) 或禁用 (false) 延续向左显示对象的模式
   ObjectSetInteger(chart_ID,name,OBJPROP_RAY_LEFT,ray_left);
//--- 启用 (true) 或禁用 (false) 延续向右显示对象的模式
   ObjectSetInteger(chart_ID,name,OBJPROP_RAY_RIGHT,ray_right);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 设置水平的数量和参数                                                |
//+------------------------------------------------------------------+
bool FiboLevelsSet(int             levels,            // 水平线的数量
                   double          &amp;values[],         // 水平线的值
                   color           &amp;colors[],         // 水平线的颜色
                   ENUM_LINE_STYLE &amp;styles[],         // 水平线的风格
                   int             &amp;widths[],         // 水平线的宽度
                   const long      chart_ID=0,        // 图表ID
                   const string    name=&quot;FiboLevels&quot;) // 对象名称
  {
//--- 检查数组大小
   if(levels!=ArraySize(colors) || levels!=ArraySize(styles) ||
      levels!=ArraySize(widths) || levels!=ArraySize(widths))
     {
      Print(__FUNCTION__,&quot;: array length does not correspond to the number of levels, error!&quot;);
      return(false);
     }
//--- 设置水平数量
   ObjectSetInteger(chart_ID,name,OBJPROP_LEVELS,levels);
//--- 设置循环中水平的属性
   for(int i=0;i&lt;levels;i++)
     {
      //--- 水平的值
      ObjectSetDouble(chart_ID,name,OBJPROP_LEVELVALUE,i,values[i]);
      //--- 水平的颜色
      ObjectSetInteger(chart_ID,name,OBJPROP_LEVELCOLOR,i,colors[i]);
      //--- 水平的风格
      ObjectSetInteger(chart_ID,name,OBJPROP_LEVELSTYLE,i,styles[i]);
      //--- 水平的宽度
      ObjectSetInteger(chart_ID,name,OBJPROP_LEVELWIDTH,i,widths[i]);
      //--- 水平的描述
      ObjectSetString(chart_ID,name,OBJPROP_LEVELTEXT,i,DoubleToString(100*values[i],1));
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动斐波纳契回调线的定位点                                           |
//+------------------------------------------------------------------+
bool FiboLevelsPointChange(const long   chart_ID=0,        // 图表 ID
                           const string name=&quot;FiboLevels&quot;, // 对象名称
                           const int    point_index=0,     // 定位点指数
                           datetime     time=0,            // 定位点时间坐标
                           double       price=0)           // 定位点价格坐标
  {
//--- 如果没有设置点的位置，则将其移动到当前的卖价柱
   if(!time)
      time=TimeCurrent();
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 重置错误的值
   ResetLastError();
//--- 移动定位点
   if(!ObjectMove(chart_ID,name,point_index,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to move the anchor point! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 删除斐波纳契回调线                                                  |
//+------------------------------------------------------------------+
bool FiboLevelsDelete(const long   chart_ID=0,        // 图表 ID
                      const string name=&quot;FiboLevels&quot;) // 对象名称
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除对象
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete \&quot;Fibonacci Retracement\&quot;! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 检查斐波纳契回调线定位点的值和为空点设置                               |
//| 默认的值                                                          |
//+------------------------------------------------------------------+
void ChangeFiboLevelsEmptyPoints(datetime &amp;time1,double &amp;price1,
                                 datetime &amp;time2,double &amp;price2)
  {
//--- 如果第二点的时间没有设置，它将位于当前柱
   if(!time2)
      time2=TimeCurrent();
//--- 如果第二点的价格没有设置，则它将用卖价值
   if(!price2)
      price2=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 如果第一点的时间没有设置，它则位于第二点左侧的9个柱
   if(!time1)
     {
      //--- 接收最近10柱开盘时间的数组
      datetime temp[10];
      CopyTime(Symbol(),Period(),time2,10,temp);
      //--- 在第二点左侧9柱设置第一点
      time1=temp[0];
     }
//--- 如果第一个点的价格没有设置，则低于第二个点移动200点
   if(!price1)
      price1=price2-200*SymbolInfoDouble(Symbol(),SYMBOL_POINT);
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 检查输入参数的正确性
   if(InpDate1 &lt; 0 || InpDate1 &gt; 100 || InpPrice1 &lt; 0 || InpPrice1 &gt; 100 ||
      InpDate2 &lt; 0 || InpDate2 &gt; 100 || InpPrice2 &lt; 0 || InpPrice2 &gt; 100)
     {
      Print(&quot;Error! Incorrect values of input parameters!&quot;);
      return;
     }
//--- 图表窗口的可见柱的数量
   int bars=(int)ChartGetInteger(0,CHART_VISIBLE_BARS);
//--- 价格数组大小
   int accuracy=1000;
//--- 存储要使用的日期和价格值的数组
//--- 设置和改变斐波纳契回调线的定位点的坐标
   datetime date[];
   double   price[];
//--- 内存分配
   ArrayResize(date,bars);
   ArrayResize(price,accuracy);
//--- 填写日期数组
   ResetLastError();
   if(CopyTime(Symbol(),Period(),0,bars,date)==-1)
     {
      Print(&quot;Failed to copy time values! Error code = &quot;,GetLastError());
      return;
     }
//--- 填写价格数组
//--- 找出图表的最高值和最低值
   double max_price=ChartGetDouble(0,CHART_PRICE_MAX);
   double min_price=ChartGetDouble(0,CHART_PRICE_MIN);
//--- 定义变化的价格并填写该数组
   double step=(max_price-min_price)/accuracy;
   for(int i=0;i&lt;accuracy;i++)
      price[i]=min_price+i*step;
//--- 定义绘制斐波纳契回调线的点
   int d1=InpDate1*(bars-1)/100;
   int d2=InpDate2*(bars-1)/100;
   int p1=InpPrice1*(accuracy-1)/100;
   int p2=InpPrice2*(accuracy-1)/100;
//--- 创建对象
   if(!FiboLevelsCreate(0,InpName,0,date[d1],price[p1],date[d2],price[p2],InpColor,
      InpStyle,InpWidth,InpBack,InpSelection,InpRayLeft,InpRayRight,InpHidden,InpZOrder))
     {
      return;
     }
//--- 重画图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- 现在，移动定位点
//--- 循环计数器
   int v_steps=accuracy*2/5;
//--- 移动第一个定位点
   for(int i=0;i&lt;v_steps ;i++)
     {
      //--- 使用下面的值
      if(p1&gt;1)
         p1-=1;
      //--- 移动点
      if(!FiboLevelsPointChange(0,InpName,0,date[d1],price[p1]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 循环计数器
   v_steps=accuracy*4/5;
//--- 移动第二个定位点
   for(int i=0;i&lt; v_steps;i++)
     {
      //--- 使用下面的值
      if(p2&gt;1)
         p2-=1;
      //--- 移动点
      if(!FiboLevelsPointChange(0,InpName,1,date[d2],price[p2]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 删除图表对象
   FiboLevelsDelete(0,InpName);
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br></div></div><h4 id="_2-2-1-15-obj-fibotimes斐波纳契-黄金分割-时间周期线"><a href="#_2-2-1-15-obj-fibotimes斐波纳契-黄金分割-时间周期线" class="header-anchor">#</a> 2.2.1.15 OBJ_FIBOTIMES斐波纳契(黄金分割)时间周期线</h4> <p><img src="data:image/png;base64,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" alt="Alt text"></p> <p>ObjFiboTimes</p> <p>注意</p> <p>对于 &quot;斐波纳契时间周期线&quot;，可以指定线水平的数量，它们的值和颜色。</p> <p>示例</p> <p>下面的脚本创建并移动图表上的斐波纳契时间周期线。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 描述
#property description &quot;Script draws \&quot;Fibonacci Time Zones\&quot; graphical object.&quot;
#property description &quot;Anchor point coordinates are set in percentage of the size of&quot;
#property description &quot;the chart window.&quot;
//--- 启动脚本期间显示输入参数的窗口
#property script_show_inputs
//--- 脚本的输入参数
input string          InpName=&quot;FiboTimes&quot;;       // 对象名称
input int             InpDate1=10;               // 第1个点的日期，%
input int             InpPrice1=45;              // 第1个点的价格，%
input int             InpDate2=20;               // 第2个点的日期，%
input int             InpPrice2=55;              // 第2个点的价格，%
input color           InpColor=clrRed;           // 对象的颜色
input ENUM_LINE_STYLE InpStyle=STYLE_DASHDOTDOT; // 线的风格
input int             InpWidth=2;                // 线的宽度
input bool            InpBack=false;             // 背景对象
input bool            InpSelection=true;         // 突出移动
input bool            InpHidden=true;            // 隐藏在对象列表
input long            InpZOrder=0;               // 鼠标单击优先
//+------------------------------------------------------------------+
//| 通过已给的坐标创建斐波纳契时间周期线                                  |
//+------------------------------------------------------------------+
bool FiboTimesCreate(const long            chart_ID=0,        // 图表 ID
                     const string          name=&quot;FiboTimes&quot;,  // 对象名称
                     const int             sub_window=0,      // 子窗口指数
                     datetime              time1=0,           // 第一个点的时间
                     double                price1=0,          // 第一个点的价格
                     datetime              time2=0,           // 第二个点的时间
                     double                price2=0,          // 第二个点的价格
                     const color           clr=clrRed,        // 对象颜色
                     const ENUM_LINE_STYLE style=STYLE_SOLID, // 对象线的风格
                     const int             width=1,           // 对象线的宽度
                     const bool            back=false,        // 在背景中
                     const bool            selection=true,    // 突出移动
                     const bool            hidden=true,       // 隐藏在对象列表
                     const long            z_order=0)         // 鼠标单击优先
  {
//--- 若未设置则设置定位点的坐标
   ChangeFiboTimesEmptyPoints(time1,price1,time2,price2);
//--- 重置错误的值
   ResetLastError();
//--- 通过已给的坐标创建斐波纳契时间周期线
   if(!ObjectCreate(chart_ID,name,OBJ_FIBOTIMES,sub_window,time1,price1,time2,price2))
     {
      Print(__FUNCTION__,
            &quot;: failed to create \&quot;Fibonacci Time Zones\&quot;! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 设置颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//--- 设置线的风格
   ObjectSetInteger(chart_ID,name,OBJPROP_STYLE,style);
//--- 设置线的宽度
   ObjectSetInteger(chart_ID,name,OBJPROP_WIDTH,width);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 突出通道移动的模式
//--- 当使用ObjectCreate函数创建图形对象时，对象不能
//--- 默认下突出并移动。在这个方法中，默认选择参数
//--- true 可以突出移动对象
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 设置水平的数量和参数                                                |
//+------------------------------------------------------------------+
bool FiboTimesLevelsSet(int             levels,           // 水平线的数量
                        double          &amp;values[],        // 水平线的值
                        color           &amp;colors[],        // 水平线的颜色
                        ENUM_LINE_STYLE &amp;styles[],        // 水平线的风格
                        int             &amp;widths[],        // 水平线的宽度
                        const long      chart_ID=0,       // 图表 ID
                        const string    name=&quot;FiboTimes&quot;) // 对象名称
  {
//--- 检查数组大小
   if(levels!=ArraySize(colors) || levels!=ArraySize(styles) ||
      levels!=ArraySize(widths) || levels!=ArraySize(widths))
     {
      Print(__FUNCTION__,&quot;: array length does not correspond to the number of levels, error!&quot;);
      return(false);
     }
//--- 设置水平数量
   ObjectSetInteger(chart_ID,name,OBJPROP_LEVELS,levels);
//--- 设置循环中水平的属性
   for(int i=0;i&lt;levels ;i++)
     {
      //--- 水平的值
      ObjectSetDouble(chart_ID,name,OBJPROP_LEVELVALUE,i,values[i]);
      //--- 水平的颜色
      ObjectSetInteger(chart_ID,name,OBJPROP_LEVELCOLOR,i,colors[i]);
      //--- 水平的风格
      ObjectSetInteger(chart_ID,name,OBJPROP_LEVELSTYLE,i,styles[i]);
      //--- 水平的宽度
      ObjectSetInteger(chart_ID,name,OBJPROP_LEVELWIDTH,i,widths[i]);
      //--- 水平的描述
      ObjectSetString(chart_ID,name,OBJPROP_LEVELTEXT,i,DoubleToString(values[i],1));
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动斐波纳契时间周期线的定位点                                       |
//+------------------------------------------------------------------+
bool FiboTimesPointChange(const long   chart_ID=0,       // 图表 ID
                          const string name=&quot;FiboTimes&quot;, // 对象名称
                          const int    point_index=0,    // 定位点指数
                          datetime     time=0,           // 定位点时间坐标
                          double       price=0)          // 定位点价格坐标
  {
//--- 如果没有设置点的位置，则将其移动到当前的卖价柱
   if(!time)
      time=TimeCurrent();
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 重置错误的值
   ResetLastError();
//--- 移动定位点
   if(!ObjectMove(chart_ID,name,point_index,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to move the anchor point! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 删除斐波纳契时间周期线                                              |
//+------------------------------------------------------------------+
bool FiboTimesDelete(const long   chart_ID=0,       // 图表 ID
                     const string name=&quot;FiboTimes&quot;) // 对象名称
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除对象
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete \&quot;Fibonacci Time Zones\&quot;! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 检查斐波纳契时间周期线定位点的值和                                    |
//| 为空点设置默认的值                                                  |
//+------------------------------------------------------------------+
void ChangeFiboTimesEmptyPoints(datetime &amp;time1,double &amp;price1,
                                datetime &amp;time2,double &amp;price2)
  {
//--- 如果第一点的时间没有设置，它将位于当前柱
   if(!time1)
      time1=TimeCurrent();
//--- 如果第一点的价格没有设置，则它将用卖价值
   if(!price1)
      price1=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 如果第二点的时间没有设置，它则位于第二点左侧的2个柱
   if(!time2)
     {
      //--- 接收最近3柱开盘时间的数组
      datetime temp[3];
      CopyTime(Symbol(),Period(),time1,3,temp);
      //--- 在第二点左侧2柱设置第一点
      time2=temp[0];
     }
//--- 如果第二点的价格没有设置，则它与第一点的价格相等
   if(!price2)
      price2=price1;
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 检查输入参数的正确性
   if(InpDate1 &lt; 0 || InpDate1 &gt; 100 || InpPrice1 &lt; 0 || InpPrice1 &gt; 100 ||
      InpDate2 &lt; 0 || InpDate2 &gt; 100 || InpPrice2 &lt; 0 || InpPrice2 &gt; 100)
     {
      Print(&quot;Error! Incorrect values of input parameters!&quot;);
      return;
     }
//--- 图表窗口的可见柱的数量
   int bars=(int)ChartGetInteger(0,CHART_VISIBLE_BARS);
//--- 价格数组大小
   int accuracy=1000;
//--- 存储要使用的日期和价格值的数组
//--- 设置和改变斐波纳契时间周期线的定位点的坐标
   datetime date[];
   double   price[];
//--- 内存分配
   ArrayResize(date,bars);
   ArrayResize(price,accuracy);
//--- 填写日期数组
   ResetLastError();
   if(CopyTime(Symbol(),Period(),0,bars,date)==-1)
     {
      Print(&quot;Failed to copy time values! Error code = &quot;,GetLastError());
      return;
     }
//--- 填写价格数组
//--- 找出图表的最高值和最低值
   double max_price=ChartGetDouble(0,CHART_PRICE_MAX);
   double min_price=ChartGetDouble(0,CHART_PRICE_MIN);
//--- 定义变化的价格并填写该数组
   double step=(max_price-min_price)/accuracy;
   for(int i=0;i&lt;accuracy ;i++)
      price[i]=min_price+i*step;
//--- 定义绘制斐波纳契时间周期线的点
   int d1=InpDate1*(bars-1)/100;
   int d2=InpDate2*(bars-1)/100;
   int p1=InpPrice1*(accuracy-1)/100;
   int p2=InpPrice2*(accuracy-1)/100;
//--- 创建对象
   if(!FiboTimesCreate(0,InpName,0,date[d1],price[p1],date[d2],price[p2],
      InpColor,InpStyle,InpWidth,InpBack,InpSelection,InpHidden,InpZOrder))
     {
      return;
     }
//--- 重画图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- 现在，移动定位点
//--- 循环计数器
   int h_steps=bars*2/5;
//--- 移动第二个定位点
   for(int i=0;i&lt; h_steps;i++)
     {
      //--- 使用下面的值
      if(d2&lt; bars-1)
         d2+=1;
      //--- 移动点
      if(!FiboTimesPointChange(0,InpName,1,date[d2],price[p2]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
      // 0.05 秒延迟
      Sleep(50);
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 循环计数器
   h_steps=bars*3/5;
//--- 移动第一个定位点
   for(int i=0;i&lt;h_steps ;i++)
     {
      //--- 使用下面的值
      if(d1&lt; bars-1)
         d1+=1;
      //--- 移动点
      if(!FiboTimesPointChange(0,InpName,0,date[d1],price[p1]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
      // 0.05 秒延迟
      Sleep(50);
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 删除图表对象
   FiboTimesDelete(0,InpName);
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br></div></div><h4 id="_2-2-1-16-obj-fibofan斐波纳契-黄金分割-扇形线"><a href="#_2-2-1-16-obj-fibofan斐波纳契-黄金分割-扇形线" class="header-anchor">#</a> 2.2.1.16 OBJ_FIBOFAN斐波纳契(黄金分割)扇形线</h4> <p><img src="data:image/png;base64,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" alt="Alt text"></p> <p>ObjFiboFan</p> <p>注意</p> <p>对于&quot;斐波纳契扇形线&quot;，可以指定线水平的数量，它们的值和颜色</p> <p>示例</p> <p>下面的脚本创建并移动图表上的斐波纳契扇形线。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 描述
#property description &quot;Script draws \&quot;Fibonacci Fan\&quot; graphical object.&quot;
#property description &quot;Anchor point coordinates are set in percentage of&quot;
#property description &quot;the chart window size.&quot;
//--- 启动脚本期间显示输入参数的窗口
#property script_show_inputs
//--- 脚本的输入参数
input string          InpName=&quot;FiboFan&quot;;         // 扇形线名称
input int             InpDate1=10;               // 第1个点的日期，%
input int             InpPrice1=25;              // 第1个点的价格，%
input int             InpDate2=30;               // 第2个点的日期，%
input int             InpPrice2=50;              // 第2个点的价格，%
input color           InpColor=clrRed;           // 扇形线的颜色
input ENUM_LINE_STYLE InpStyle=STYLE_DASHDOTDOT; // 线的风格
input int             InpWidth=2;                // 线的宽度
input bool            InpBack=false;             // 背景对象
input bool            InpSelection=true;         // 突出移动
input bool            InpHidden=true;            // 隐藏在对象列表
input long            InpZOrder=0;               // 鼠标单击优先
//+------------------------------------------------------------------+
//| 通过已给的坐标创建斐波纳契扇形线                                     |
//+------------------------------------------------------------------+
bool FiboFanCreate(const long            chart_ID=0,        // 图表ID
                   const string          name=&quot;FiboFan&quot;,    // 扇形线名称
                   const int             sub_window=0,      // 子窗口指数
                   datetime              time1=0,           // 第一个点的时间
                   double                price1=0,          //第一个点的价格
                   datetime              time2=0,           // 第二个点的时间
                   double                price2=0,          // 第二个点的价格
                   const color           clr=clrRed,        // 扇形线颜色
                   const ENUM_LINE_STYLE style=STYLE_SOLID, // 扇形线的风格
                   const int             width=1,           // 扇形线的宽度
                   const bool            back=false,        // 在背景中
                   const bool            selection=true,    // 突出移动
                   const bool            hidden=true,       // 隐藏在对象列表
                   const long            z_order=0)         // 鼠标单击优先
  {
//--- 若未设置则设置定位点的坐标
   ChangeFiboFanEmptyPoints(time1,price1,time2,price2);
//--- 重置错误的值
   ResetLastError();
//--- 通过已给的坐标创建斐波纳契扇形线
   if(!ObjectCreate(chart_ID,name,OBJ_FIBOFAN,sub_window,time1,price1,time2,price2))
     {
      Print(__FUNCTION__,
            &quot;: failed to create \&quot;Fibonacci Fan\&quot;! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 设置颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//--- 设置线的风格
   ObjectSetInteger(chart_ID,name,OBJPROP_STYLE,style);
//--- 设置线的宽度
   ObjectSetInteger(chart_ID,name,OBJPROP_WIDTH,width);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 突出扇形线移动的模式
//--- 当使用ObjectCreate函数创建图形对象时，对象不能
//--- 默认下突出并移动。在这个方法中，默认选择参数
//--- true 可以突出移动对象
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 设置水平的数量和参数                                                |
//+------------------------------------------------------------------+
bool FiboFanLevelsSet(int             levels,         // 水平线的数量
                      double          &amp;values[],      // 水平线的值
                      color           &amp;colors[],      // 水平线的颜色
                      ENUM_LINE_STYLE &amp;styles[],      // 水平线的风格
                      int             &amp;widths[],      // 水平线的宽度
                      const long      chart_ID=0,     // 图表 ID
                      const string    name=&quot;FiboFan&quot;) // 扇形线名称
  {
//--- 检查数组大小
   if(levels!=ArraySize(colors) || levels!=ArraySize(styles) ||
      levels!=ArraySize(widths) || levels!=ArraySize(widths))
     {
      Print(__FUNCTION__,&quot;: array length does not correspond to the number of levels, error!&quot;);
      return(false);
     }
//--- 设置水平数量
   ObjectSetInteger(chart_ID,name,OBJPROP_LEVELS,levels);
//--- 设置循环中水平的属性
   for(int i=0;i&lt;levels ;i++)
     {
      //--- 水平的值
      ObjectSetDouble(chart_ID,name,OBJPROP_LEVELVALUE,i,values[i]);
      //--- 水平的颜色
      ObjectSetInteger(chart_ID,name,OBJPROP_LEVELCOLOR,i,colors[i]);
      //--- 水平的风格
      ObjectSetInteger(chart_ID,name,OBJPROP_LEVELSTYLE,i,styles[i]);
      //--- 水平的宽度
      ObjectSetInteger(chart_ID,name,OBJPROP_LEVELWIDTH,i,widths[i]);
      //--- 水平的描述
      ObjectSetString(chart_ID,name,OBJPROP_LEVELTEXT,i,DoubleToString(100*values[i],1));
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动斐波纳契扇形线定位点                                            |
//+------------------------------------------------------------------+
bool FiboFanPointChange(const long   chart_ID=0,     // 图表 ID
                        const string name=&quot;FiboFan&quot;, // 扇形线名称
                        const int    point_index=0,  // 定位点指数
                        datetime     time=0,         // 定位点时间坐标
                        double       price=0)        // 定位点价格坐标
  {
//--- 如果没有设置点的位置，则将其移动到当前的卖价柱
   if(!time)
      time=TimeCurrent();
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 重置错误的值
   ResetLastError();
//--- 移动定位点
   if(!ObjectMove(chart_ID,name,point_index,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to move the anchor point! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 删除斐波纳契扇形线                                                 |
//+------------------------------------------------------------------+
bool FiboFanDelete(const long   chart_ID=0,     // 图表 ID
                   const string name=&quot;FiboFan&quot;) // 扇形线名称
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除扇形线
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete \&quot;Fibonacci Fan\&quot;! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 检查斐波纳契扇形线定位点的值和为空点设置                               |
//| 默认的值                                                          |
//+------------------------------------------------------------------+
void ChangeFiboFanEmptyPoints(datetime &amp;time1,double &amp;price1,
                              datetime &amp;time2,double &amp;price2)
  {
//--- 如果第二点的时间没有设置，它将位于当前柱
   if(!time2)
      time2=TimeCurrent();
//--- 如果第二点的价格没有设置，则它将用卖价值
   if(!price2)
      price2=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 如果第一点的时间没有设置，它则位于第二点左侧的9个柱
   if(!time1)
     {
      //--- 接收最近10柱开盘时间的数组
      datetime temp[10];
      CopyTime(Symbol(),Period(),time2,10,temp);
      //--- 在第二点左侧9柱设置第一点
      time1=temp[0];
     }
//--- 如果第一个点的价格没有设置，则低于第二个点移动200点
   if(!price1)
      price1=price2-200*SymbolInfoDouble(Symbol(),SYMBOL_POINT);
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 检查输入参数的正确性
   if(InpDate1 &lt; 0 || InpDate1 &gt; 100 || InpPrice1 &lt; 0 || InpPrice1 &gt; 100 ||
      InpDate2 &lt; 0 || InpDate2 &gt; 100 || InpPrice2 &lt; 0 || InpPrice2 &gt; 100)
     {
      Print(&quot;Error! Incorrect values of input parameters!&quot;);
      return;
     }
//--- 图表窗口的可见柱的数量
   int bars=(int)ChartGetInteger(0,CHART_VISIBLE_BARS);
//--- 价格数组大小
   int accuracy=1000;
//--- 存储要使用的日期和价格值的数组
//--- 设置和改变斐波纳契扇形线的定位点的坐标
   datetime date[];
   double   price[];
//--- 内存分配
   ArrayResize(date,bars);
   ArrayResize(price,accuracy);
//--- 填写日期数组
   ResetLastError();
   if(CopyTime(Symbol(),Period(),0,bars,date)==-1)
     {
      Print(&quot;Failed to copy time values! Error code = &quot;,GetLastError());
      return;
     }
//--- 填写价格数组
//--- 找出图表的最高值和最低值
   double max_price=ChartGetDouble(0,CHART_PRICE_MAX);
   double min_price=ChartGetDouble(0,CHART_PRICE_MIN);
//--- 定义变化的价格并填写该数组
   double step=(max_price-min_price)/accuracy;
   for(int i=0;i&lt;accuracy ;i++)
      price[i]=min_price+i*step;
//--- 定义绘制斐波纳契扇形线的点
   int d1=InpDate1*(bars-1)/100;
   int d2=InpDate2*(bars-1)/100;
   int p1=InpPrice1*(accuracy-1)/100;
   int p2=InpPrice2*(accuracy-1)/100;
//--- 创建对象
   if(!FiboFanCreate(0,InpName,0,date[d1],price[p1],date[d2],price[p2],
      InpColor,InpStyle,InpWidth,InpBack,InpSelection,InpHidden,InpZOrder))
     {
      return;
     }
//--- 重画图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- 现在，移动扇形线的定位点
//--- 循环计数器
   int v_steps=accuracy/2;
//--- 移动第一个定位点
   for(int i=0;i&lt;v_steps ;i++)
     {
      //--- 使用下面的值
      if(p1&lt;accuracy-1)
         p1+=1;
      //--- 移动点
      if(!FiboFanPointChange(0,InpName,0,date[d1],price[p1]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 循环计数器
   int h_steps=bars/4;
//--- 移动第二个定位点
   for(int i=0;i&lt;h_steps;i++)
     {
      //--- 使用下面的值
      if(d2&lt;bars-1)
         d2+=1;
      //--- 移动点
      if(!FiboFanPointChange(0,InpName,1,date[d2],price[p2]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
      // 0.05 秒延迟
      Sleep(50);
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 删除图表对象
   FiboFanDelete(0,InpName);
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br></div></div><h4 id="_2-2-1-17-obj-fiboarc斐波纳契-黄金分割-弧形线"><a href="#_2-2-1-17-obj-fiboarc斐波纳契-黄金分割-弧形线" class="header-anchor">#</a> 2.2.1.17 OBJ_FIBOARC斐波纳契(黄金分割)弧形线</h4> <p><img src="data:image/png;base64,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" alt="Alt text"></p> <p>ObjFiboArc</p> <p>注意</p> <p>对于 &quot;斐波纳契弧形线&quot;，可以指定整个椭圆的演示模式。曲率半径可以通过改变定位点比例和坐标来指定。</p> <p>您也可以指定线的级别数，它们的值和颜色。</p> <p>示例</p> <p>下面的脚本创建并移动图表上的斐波纳契弧形线。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 描述
#property description &quot;Script draws \&quot;Fibonacci Arcs\&quot; graphical object.&quot;
#property description &quot;Anchor point coordinates are set in percentage of&quot;
#property description &quot;the chart window size.&quot;
//--- 启动脚本期间显示输入参数的窗口
#property script_show_inputs
//--- 脚本的输入参数
input string          InpName=&quot;FiboArc&quot;;         // 对象名称
input int             InpDate1=25;               // 第1个点的日期，%
input int             InpPrice1=25;              // 第1个点的价格，%
input int             InpDate2=35;               // 第2个点的日期，%
input int             InpPrice2=55;              // 第2个点的价格，%
input double          InpScale=3.0;              // 比例
input bool            InpFullEllipse=true;       // 弧形线的形状
input color           InpColor=clrRed;           // 线的颜色
input ENUM_LINE_STYLE InpStyle=STYLE_DASHDOTDOT; // 线的风格
input int             InpWidth=2;                // 线的宽度
input bool            InpBack=false;             // 背景对象
input bool            InpSelection=true;         // 突出移动
input bool            InpHidden=true;            // 隐藏在对象列表
input long            InpZOrder=0;               // 鼠标单击优先
//+------------------------------------------------------------------+
//| 通过已给的坐标创建斐波纳契弧形线                                      |
//+------------------------------------------------------------------+
bool FiboArcCreate(const long            chart_ID=0,         // 图表 ID
                   const string          name=&quot;FiboArc&quot;,     // 对象名称
                   const int             sub_window=0,       // 子窗口指数
                   datetime              time1=0,            // 第一个点的时间
                   double                price1=0,           // 第一个点的价格
                   datetime              time2=0,            // 第二个点的时间
                   double                price2=0,           // 第二个点的价格
                   const double          scale=1.0,          // 比例
                   const bool            full_ellipse=false, // 弧形线的形状
                   const color           clr=clrRed,         // 线的颜色
                   const ENUM_LINE_STYLE style=STYLE_SOLID,  // 线的风格
                   const int             width=1,            // 线的宽度
                   const bool            back=false,         // 在背景中
                   const bool            selection=true,     // 突出移动
                   const bool            hidden=true,        // 隐藏在对象列表
                   const long            z_order=0)          // 鼠标单击优先
  {
//--- 若未设置则设置定位点的坐标
   ChangeFiboArcEmptyPoints(time1,price1,time2,price2);
//--- 重置错误的值
   ResetLastError();
//--- 通过已给的坐标创建斐波纳契弧形线
   if(!ObjectCreate(chart_ID,name,OBJ_FIBOARC,sub_window,time1,price1,time2,price2))
     {
      Print(__FUNCTION__,
            &quot;: failed to create \&quot;Fibonacci Arcs\&quot;! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 设置比例
   ObjectSetDouble(chart_ID,name,OBJPROP_SCALE,scale);
//--- 设置弧形线显示为全椭圆(true) 或半椭圆(false)
   ObjectSetInteger(chart_ID,name,OBJPROP_ELLIPSE,full_ellipse);
//--- 设置颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//--- 设置线的风格
   ObjectSetInteger(chart_ID,name,OBJPROP_STYLE,style);
//--- 设置线的宽度
   ObjectSetInteger(chart_ID,name,OBJPROP_WIDTH,width);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 突出弧形线移动的模式
//--- 当使用ObjectCreate函数创建图形对象时，对象不能
//--- 默认下突出并移动。在这个方法中，默认选择参数
//--- true 可以突出移动对象
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 设置水平的数量和参数                                                |
//+------------------------------------------------------------------+
bool FiboArcLevelsSet(int             levels,         // 水平线的数量
                      double          &amp;values[],      // 水平线的值
                      color           &amp;colors[],      // 水平线的颜色
                      ENUM_LINE_STYLE &amp;styles[],      // 水平线的风格
                      int             &amp;widths[],      // 水平线的宽度
                      const long      chart_ID=0,     // 图表 ID
                      const string    name=&quot;FiboArc&quot;) // 对象名称
  {
//--- 检查数组大小
   if(levels!=ArraySize(colors) || levels!=ArraySize(styles) ||
      levels!=ArraySize(widths) || levels!=ArraySize(widths))
     {
      Print(__FUNCTION__,&quot;: array length does not correspond to the number of levels, error!&quot;);
      return(false);
     }
//--- 设置水平数量
   ObjectSetInteger(chart_ID,name,OBJPROP_LEVELS,levels);
//--- 设置循环中水平的属性
   for(int i=0;i&lt;levels;i++)
     {
      //--- 水平的值
      ObjectSetDouble(chart_ID,name,OBJPROP_LEVELVALUE,i,values[i]);
      //--- 水平的颜色
      ObjectSetInteger(chart_ID,name,OBJPROP_LEVELCOLOR,i,colors[i]);
      //--- 水平的风格
      ObjectSetInteger(chart_ID,name,OBJPROP_LEVELSTYLE,i,styles[i]);
      //--- 水平的宽度
      ObjectSetInteger(chart_ID,name,OBJPROP_LEVELWIDTH,i,widths[i]);
      //--- 水平的描述
      ObjectSetString(chart_ID,name,OBJPROP_LEVELTEXT,i,DoubleToString(100*values[i],1));
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动斐波纳契弧形线的定位点                                           |
//+------------------------------------------------------------------+
bool FiboArcPointChange(const long   chart_ID=0,     // 图表 ID
                        const string name=&quot;FiboArc&quot;, // 对象名称
                        const int    point_index=0,  // 定位点指数
                        datetime     time=0,         // 定位点时间坐标
                        double       price=0)        // 定位点价格坐标
  {
//--- 如果没有设置点的位置，则将其移动到当前的卖价柱
   if(!time)
      time=TimeCurrent();
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 重置错误的值
   ResetLastError();
//--- 移动定位点
   if(!ObjectMove(chart_ID,name,point_index,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to move the anchor point! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 删除斐波纳契弧形线                                                  |
//+------------------------------------------------------------------+
bool FiboArcDelete(const long   chart_ID=0,     // 图表 ID
                   const string name=&quot;FiboArc&quot;) // 对象名称
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除对象
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete \&quot;Fibonacci Arcs\&quot;! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 检查斐波纳契弧形线定位点的值和为空点设置                               |
//| 默认的值                                                          |
//+------------------------------------------------------------------+
void ChangeFiboArcEmptyPoints(datetime &amp;time1,double &amp;price1,
                              datetime &amp;time2,double &amp;price2)
  {
//--- 如果第二点的时间没有设置，它将位于当前柱
   if(!time2)
      time2=TimeCurrent();
//--- 如果第二点的价格没有设置，则它将用卖价值
   if(!price2)
      price2=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 如果第一点的时间没有设置，它则位于第二点左侧的9个柱
   if(!time1)
     {
      //--- 接收最近10柱开盘时间的数组
      datetime temp[10];
      CopyTime(Symbol(),Period(),time2,10,temp);
      //--- 在第二点左侧9柱设置第一点
      time1=temp[0];
     }
//--- 如果第一个点的价格没有设置，则低于第二个点移动300点
   if(!price1)
      price1=price2-300*SymbolInfoDouble(Symbol(),SYMBOL_POINT);
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 检查输入参数的正确性
   if(InpDate1&lt;0 || InpDate1&gt;100 || InpPrice1&lt;0 || InpPrice1&gt;100 ||
      InpDate2&lt;0 || InpDate2&gt;100 || InpPrice2&lt;0 || InpPrice2&gt;100)
     {
      Print(&quot;Error! Incorrect values of input parameters!&quot;);
      return;
     }
//--- 图表窗口的可见柱的数量
   int bars=(int)ChartGetInteger(0,CHART_VISIBLE_BARS);
//--- 价格数组大小
   int accuracy=1000;
//--- 存储要使用的日期和价格值的数组
//--- 设置和改变斐波纳契弧形线的定位点的坐标
   datetime date[];
   double   price[];
//--- 内存分配
   ArrayResize(date,bars);
   ArrayResize(price,accuracy);
//--- 填写日期数组
   ResetLastError();
   if(CopyTime(Symbol(),Period(),0,bars,date)==-1)
     {
      Print(&quot;Failed to copy time values! Error code = &quot;,GetLastError());
      return;
     }
//--- 填写价格数组
//--- 找出图表的最高值和最低值
   double max_price=ChartGetDouble(0,CHART_PRICE_MAX);
   double min_price=ChartGetDouble(0,CHART_PRICE_MIN);
//--- 定义变化的价格并填写该数组
   double step=(max_price-min_price)/accuracy;
   for(int i=0;i&lt;accuracy;i++)
      price[i]=min_price+i*step;
//--- 定义绘制斐波纳契弧形线的点
   int d1=InpDate1*(bars-1)/100;
   int d2=InpDate2*(bars-1)/100;
   int p1=InpPrice1*(accuracy-1)/100;
   int p2=InpPrice2*(accuracy-1)/100;
//--- 创建对象
   if(!FiboArcCreate(0,InpName,0,date[d1],price[p1],date[d2],price[p2],InpScale,
      InpFullEllipse,InpColor,InpStyle,InpWidth,InpBack,InpSelection,InpHidden,InpZOrder))
     {
      return;
     }
//--- 重画图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- 现在，移动定位点
//--- 循环计数器
   int v_steps=accuracy/5;
//--- 移动第一个定位点
   for(int i=0;i&lt;v_steps;i++)
     {
      //--- 使用下面的值
      if(p1&lt;accuracy-1)
         p1+=1;
      //--- 移动点
      if(!FiboArcPointChange(0,InpName,0,date[d1],price[p1]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 循环计数器
   int h_steps=bars/5;
//--- 移动第二个定位点
   for(int i=0;i&lt;h_steps;i++)
     {
      //--- 使用下面的值
      if(d2&lt;bars-1)
         d2+=1;
      //--- 移动点
      if(!FiboArcPointChange(0,InpName,1,date[d2],price[p2]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
      // 0.05 秒延迟
      Sleep(50);
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 删除图表对象
   FiboArcDelete(0,InpName);
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br></div></div><h4 id="_2-2-1-18-obj-fibochannel斐波纳契-黄金分割-通道线"><a href="#_2-2-1-18-obj-fibochannel斐波纳契-黄金分割-通道线" class="header-anchor">#</a> 2.2.1.18 OBJ_FIBOCHANNEL斐波纳契(黄金分割)通道线</h4> <p><img src="data:image/png;base64,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" alt="Alt text"></p> <p>ObjFiboChannel</p> <p>注意</p> <p>对于斐波纳契通道线，可以指定它 向右 和/或 向左 延长显示的模式 (根据属性值OBJPROP_RAY_RIGHT 和 OBJPROP_RAY_LEFT 决定)。</p> <p>您也可以指定线的级别数，它们的值和颜色。</p> <p>示例</p> <p>下面的脚本创建和移动图表上的斐波纳契通道线。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 描述
#property description &quot;Script draws \&quot;Fibonacci Channel\&quot; graphical object.&quot;
#property description &quot;Anchor point coordinates are set in percentage of&quot;
#property description &quot;the chart window size.&quot;
//--- 启动脚本期间显示输入参数的窗口
#property script_show_inputs
//--- 脚本的输入参数
input string          InpName=&quot;FiboChannel&quot;;     // 通道名称
input int             InpDate1=20;               // 第1个点的日期，%
input int             InpPrice1=10;              // 第1个点的价格，%
input int             InpDate2=60;               // 第2个点的日期，%
input int             InpPrice2=30;              // 第2个点的价格，%
input int             InpDate3=20;               // 第3个点的日期，%
input int             InpPrice3=25;              // 第3个点的价格，%
input color           InpColor=clrRed;           // 通道的颜色
input ENUM_LINE_STYLE InpStyle=STYLE_DASHDOTDOT; // 通道线的风格
input int             InpWidth=2;                // 通道线的宽度
input bool            InpBack=false;             // 背景通道
input bool            InpSelection=true;         // 突出移动
input bool            InpRayLeft=false;          // 通道延续向左
input bool            InpRayRight=false;         // 通道延续向右
input bool            InpHidden=true;            // 隐藏在对象列表
input long            InpZOrder=0;               // 鼠标单击优先
//+------------------------------------------------------------------+
//| 通过已给的坐标创建斐波纳契通道线                                     |
//+------------------------------------------------------------------+
bool FiboChannelCreate(const long            chart_ID=0,         // 图表 ID
                       const string          name=&quot;FiboChannel&quot;, // 通道名称
                       const int             sub_window=0,       // 子窗口指数
                       datetime              time1=0,            // 第一个点的时间
                       double                price1=0,           // 第一个点的价格
                       datetime              time2=0,            // 第二个点的时间
                       double                price2=0,           // 第二个点的价格
                       datetime              time3=0,            // 第三个点的时间
                       double                price3=0,           // 第三个点的价格
                       const color           clr=clrRed,         // 通道的颜色
                       const ENUM_LINE_STYLE style=STYLE_SOLID,  // 通道线的风格
                       const int             width=1,            // 通道线的宽度
                       const bool            back=false,         // 在背景中
                       const bool            selection=true,     // 突出移动
                       const bool            ray_left=false,     // 通道延续向左
                       const bool            ray_right=false,    // 通道延续向右
                       const bool            hidden=true,        // 隐藏在对象列表
                       const long            z_order=0)          // 鼠标单击优先
  {
//--- 若未设置则设置定位点的坐标
   ChangeFiboChannelEmptyPoints(time1,price1,time2,price2,time3,price3);
//--- 重置错误的值
   ResetLastError();
//--- 通过已给的坐标创建通道
   if(!ObjectCreate(chart_ID,name,OBJ_FIBOCHANNEL,sub_window,time1,price1,time2,price2,time3,price3))
     {
      Print(__FUNCTION__,
            &quot;: failed to create \&quot;Fibonacci Channel\&quot;! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 设置通道颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//--- 设置通道线的风格
   ObjectSetInteger(chart_ID,name,OBJPROP_STYLE,style);
//--- 设置通道线的宽度
   ObjectSetInteger(chart_ID,name,OBJPROP_WIDTH,width);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 突出通道移动的模式
//--- 当使用ObjectCreate函数创建图形对象时，对象不能
//--- 默认下突出并移动。在这个方法中，默认选择参数
//--- true 可以突出移动对象
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 启用 (true) 或禁用 (false) 延续向左显示通道的模式
   ObjectSetInteger(chart_ID,name,OBJPROP_RAY_LEFT,ray_left);
//--- 启用 (true) 或禁用 (false) 延续向右显示通道的模式
   ObjectSetInteger(chart_ID,name,OBJPROP_RAY_RIGHT,ray_right);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 设置水平的数量和参数                                                |
//+------------------------------------------------------------------+
bool FiboChannelLevelsSet(int             levels,             // 水平线的数量
                          double          &amp;values[],          // 水平线的值
                          color           &amp;colors[],          // 水平线的颜色
                          ENUM_LINE_STYLE &amp;styles[],          // 水平线的风格
                          int             &amp;widths[],          // 水平线的宽度
                          const long      chart_ID=0,         // 图表 ID
                          const string    name=&quot;FiboChannel&quot;) // 对象名称
  {
//--- 检查数组大小
   if(levels!=ArraySize(colors) || levels!=ArraySize(styles) ||
      levels!=ArraySize(widths) || levels!=ArraySize(widths))
     {
      Print(__FUNCTION__,&quot;: array length does not correspond to the number of levels, error!&quot;);
      return(false);
     }
//--- 设置水平数量
   ObjectSetInteger(chart_ID,name,OBJPROP_LEVELS,levels);
//--- 设置循环中水平的属性
   for(int i=0;i&lt;levels ;i++)
     {
      //--- 水平的值
      ObjectSetDouble(chart_ID,name,OBJPROP_LEVELVALUE,i,values[i]);
      //--- 水平的颜色
      ObjectSetInteger(chart_ID,name,OBJPROP_LEVELCOLOR,i,colors[i]);
      //--- 水平的风格
      ObjectSetInteger(chart_ID,name,OBJPROP_LEVELSTYLE,i,styles[i]);
      //--- 水平的宽度
      ObjectSetInteger(chart_ID,name,OBJPROP_LEVELWIDTH,i,widths[i]);
      //--- 水平的描述
      ObjectSetString(chart_ID,name,OBJPROP_LEVELTEXT,i,DoubleToString(100*values[i],1));
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动斐波纳契通道线的定位点                                           |
//+------------------------------------------------------------------+
bool FiboChannelPointChange(const long   chart_ID=0,         // 图表 ID
                            const string name=&quot;FiboChannel&quot;, // 通道名称
                            const int    point_index=0,      // 定位点指数
                            datetime     time=0,             // 定位点时间坐标
                            double       price=0)            // 定位点价格坐标
  {
//--- 如果没有设置点的位置，则将其移动到当前的卖价柱
   if(!time)
      time=TimeCurrent();
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 重置错误的值
   ResetLastError();
//--- 移动定位点
   if(!ObjectMove(chart_ID,name,point_index,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to move the anchor point! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 删除通道                                                          |
//+------------------------------------------------------------------+
bool FiboChannelDelete(const long   chart_ID=0,         // 图表 ID
                       const string name=&quot;FiboChannel&quot;) // 通道名称
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除通道
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete \&quot;Fibonacci Channel\&quot;! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 检查斐波纳契通道定位点的值和为空点设置                                 |
//| 默认的值                                                           |
//+------------------------------------------------------------------+
void ChangeFiboChannelEmptyPoints(datetime &amp;time1,double &amp;price1,datetime &amp;time2,
                                  double &amp;price2,datetime &amp;time3,double &amp;price3)
  {
//--- 如果第二点（右侧）的时间没有设置，它将位于当前柱
   if(!time2)
      time2=TimeCurrent();
//--- 如果第二点的价格没有设置，则它将用卖价值
   if(!price2)
      price2=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 如果第一点（左侧）的时间没有设置，它则位于第二点左侧的9个柱
   if(!time1)
     {
      //--- 接收最近10柱开盘时间的数组
      datetime temp[10];
      CopyTime(Symbol(),Period(),time2,10,temp);
      //--- 在第二点左侧9柱设置第一点
      time1=temp[0];
     }
//--- 如果第一个点的价格没有设置，则高于第二个点移动300点
   if(!price1)
      price1=price2+300*SymbolInfoDouble(Symbol(),SYMBOL_POINT);
//--- 如果第三个点的时间没有设置，则它与第一个点的时间相一致
   if(!time3)
      time3=time1;
//--- 如果第三个点的价格没有设置，则它与第二点的价格相等
   if(!price3)
      price3=price2;
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 检查输入参数的正确性
   if(InpDate1&lt;0 || InpDate1&gt;100 || InpPrice1&lt;0 || InpPrice1&gt;100 ||
      InpDate2&lt;0 || InpDate2&gt;100 || InpPrice2&lt;0 || InpPrice2&gt;100 ||
      InpDate3&lt;0 || InpDate3&gt;100 || InpPrice3&lt;0 || InpPrice3&gt;100)
     {
      Print(&quot;Error! Incorrect values of input parameters!&quot;);
      return;
     }
//--- 图表窗口的可见柱的数量
   int bars=(int)ChartGetInteger(0,CHART_VISIBLE_BARS);
//--- 价格数组大小
   int accuracy=1000;
//--- 存储要使用的日期和价格值的数组
//--- 设置和改变通道定位点的坐标
   datetime date[];
   double   price[];
//--- 内存分配
   ArrayResize(date,bars);
   ArrayResize(price,accuracy);
//--- 填写日期数组
   ResetLastError();
   if(CopyTime(Symbol(),Period(),0,bars,date)==-1)
     {
      Print(&quot;Failed to copy time values! Error code = &quot;,GetLastError());
      return;
     }
//--- 填写价格数组
//--- 找出图表的最高值和最低值
   double max_price=ChartGetDouble(0,CHART_PRICE_MAX);
   double min_price=ChartGetDouble(0,CHART_PRICE_MIN);
//--- 定义变化的价格并填写该数组
   double step=(max_price-min_price)/accuracy;
   for(int i=0;i&lt;accuracy ;i++)
      price[i]=min_price+i*step;
//--- 定义绘制通道的点
   int d1=InpDate1*(bars-1)/100;
   int d2=InpDate2*(bars-1)/100;
   int d3=InpDate3*(bars-1)/100;
   int p1=InpPrice1*(accuracy-1)/100;
   int p2=InpPrice2*(accuracy-1)/100;
   int p3=InpPrice3*(accuracy-1)/100;
//--- 创建斐波纳契通道
   if(!FiboChannelCreate(0,InpName,0,date[d1],price[p1],date[d2],price[p2],date[d3],price[p3],
      InpColor,InpStyle,InpWidth,InpBack,InpSelection,InpRayLeft,InpRayRight,InpHidden,InpZOrder))
     {
      return;
     }
//--- 重画图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- 现在，移动通道定位点
//--- 循环计数器
   int h_steps=bars/10;
//--- 移动第一个定位点
   for(int i=0;i&lt;h_steps ;i++)
     {
      //--- 使用下面的值
      if(d1&gt;1)
         d1-=1;
      //--- 移动点
      if(!FiboChannelPointChange(0,InpName,0,date[d1],price[p1]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
      // 0.05 秒延迟
      Sleep(50);
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 循环计数器
   int v_steps=accuracy/10;
//--- 移动第二个定位点
   for(int i=0;i&lt;v_steps ;i++)
     {
      //--- 使用下面的值
      if(p2&gt;1)
         p2-=1;
      //--- 移动点
      if(!FiboChannelPointChange(0,InpName,1,date[d2],price[p2]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 循环计数器
   v_steps=accuracy/15;
//--- 移动第三个定位点
   for(int i=0;i&lt;v_steps ;i++)
     {
      //--- 使用下面的值
      if(p3&lt;accuracy-1)
         p3+=1;
      //--- 移动点
      if(!FiboChannelPointChange(0,InpName,2,date[d3],price[p3]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 删除图表通道
   FiboChannelDelete(0,InpName);
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br><span class="line-number">292</span><br><span class="line-number">293</span><br><span class="line-number">294</span><br><span class="line-number">295</span><br><span class="line-number">296</span><br><span class="line-number">297</span><br><span class="line-number">298</span><br><span class="line-number">299</span><br><span class="line-number">300</span><br><span class="line-number">301</span><br><span class="line-number">302</span><br><span class="line-number">303</span><br><span class="line-number">304</span><br><span class="line-number">305</span><br><span class="line-number">306</span><br><span class="line-number">307</span><br><span class="line-number">308</span><br><span class="line-number">309</span><br><span class="line-number">310</span><br><span class="line-number">311</span><br><span class="line-number">312</span><br><span class="line-number">313</span><br><span class="line-number">314</span><br><span class="line-number">315</span><br><span class="line-number">316</span><br></div></div><h4 id="_2-2-1-19-obj-expansion斐波纳契-黄金分割-扩展线"><a href="#_2-2-1-19-obj-expansion斐波纳契-黄金分割-扩展线" class="header-anchor">#</a> 2.2.1.19 OBJ_EXPANSION斐波纳契(黄金分割)扩展线</h4> <p><img src="data:image/png;base64,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" alt="Alt text"></p> <p>ObjFiboExpansion</p> <p>注意</p> <p>对于斐波纳契扩展线，可以指定它 向右 和/或 向左 延长显示的模式 (根据属性值OBJPROP_RAY_RIGHT 和 OBJPROP_RAY_LEFT 决定)。</p> <p>您也可以指定线的级别数，它们的值和颜色。</p> <p>示例</p> <p>下面的脚本创建和移动图表上的斐波纳契扩展线。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 描述
#property description &quot;Script draws \&quot;Fibonacci Expansion\&quot;graphical object.&quot;
#property description &quot;Anchor point coordinates are set in percentage of&quot;
#property description &quot;the chart window size.&quot;
//--- 启动脚本期间显示输入参数的窗口
#property script_show_inputs
//--- 脚本的输入参数
input string          InpName=&quot;FiboExpansion&quot;;   // 对象名称
input int             InpDate1=10;               // 第1个点的日期，%
input int             InpPrice1=55;              // 第1个点的价格，%
input int             InpDate2=30;               // 第2个点的日期，%
input int             InpPrice2=10;              // 第2个点的价格，%
input int             InpDate3=80;               // 第3个点的日期，%
input int             InpPrice3=75;              // 第3个点的价格，%
input color           InpColor=clrRed;           // 对象的颜色
input ENUM_LINE_STYLE InpStyle=STYLE_DASHDOTDOT; // 线的风格
input int             InpWidth=2;                // 线的宽度
input bool            InpBack=false;             // 背景对象
input bool            InpSelection=true;         // 突出移动
input bool            InpRayLeft=false;          // 对象延续向左
input bool            InpRayRight=false;         // 对象延续向右
input bool            InpHidden=true;            // 隐藏在对象列表
input long            InpZOrder=0;               // 鼠标单击优先
//+------------------------------------------------------------------+
//| 通过已给的坐标创建斐波纳契扩展线                                     |
//+------------------------------------------------------------------+
bool FiboExpansionCreate(const long            chart_ID=0,           // 图表 ID
                         const string          name=&quot;FiboExpansion&quot;, // 通道的名称
                         const int             sub_window=0,         // 子窗口指数
                         datetime              time1=0,              // 第一个点的时间
                         double                price1=0,             // 第一个点的价格
                         datetime              time2=0,              // 第二个点的时间
                         double                price2=0,             // 第二个点的价格
                         datetime              time3=0,              // 第三个点的时间
                         double                price3=0,             // 第三个点的价格
                         const color           clr=clrRed,           // 对象颜色
                         const ENUM_LINE_STYLE style=STYLE_SOLID,    // 线的风格
                         const int             width=1,              // 线的宽度
                         const bool            back=false,           // 在背景中
                         const bool            selection=true,       // 突出移动
                         const bool            ray_left=false,       // 对象延续向左
                         const bool            ray_right=false,      // 对象延续向右
                         const bool            hidden=true,          // 隐藏在对象列表
                         const long            z_order=0)            // 鼠标单击优先
  {
//--- 若未设置则设置定位点的坐标
   ChangeFiboExpansionEmptyPoints(time1,price1,time2,price2,time3,price3);
//--- 重置错误的值
   ResetLastError();
//--- 通过已给的坐标创建斐波纳契扩展线
   if(!ObjectCreate(chart_ID,name,OBJ_EXPANSION,sub_window,time1,price1,time2,price2,time3,price3))
     {
      Print(__FUNCTION__,
            &quot;: failed to create \&quot;Fibonacci Extension\&quot;! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 设置对象的颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//---设置线的风格
   ObjectSetInteger(chart_ID,name,OBJPROP_STYLE,style);
//--- 设置线的宽度
   ObjectSetInteger(chart_ID,name,OBJPROP_WIDTH,width);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 突出通道移动的模式
//--- 当使用ObjectCreate函数创建图形对象时，对象不能
//--- 默认下突出并移动。在这个方法中，默认选择参数
//--- true 可以突出移动对象
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 启用 (true) 或禁用 (false) 延续向左的对象可视化的模式
   ObjectSetInteger(chart_ID,name,OBJPROP_RAY_LEFT,ray_left);
//--- 启用 (true) 或禁用 (false) 延续向右的对象可视化的模式
   ObjectSetInteger(chart_ID,name,OBJPROP_RAY_RIGHT,ray_right);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 设置水平的数量和参数                                                |
//+------------------------------------------------------------------+
bool FiboExpansionLevelsSet(int             levels,               // 水平线的数量
                            double          &amp;values[],            // 水平线的值
                            color           &amp;colors[],            // 水平线的颜色
                            ENUM_LINE_STYLE &amp;styles[],            // 水平线的风格
                            int             &amp;widths[],            // 水平线的宽度
                            const long      chart_ID=0,           // 图表 ID
                            const string    name=&quot;FiboExpansion&quot;) // 对象名称
  {
//--- 检查数组大小
   if(levels!=ArraySize(colors) || levels!=ArraySize(styles) ||
      levels!=ArraySize(widths) || levels!=ArraySize(widths))
     {
      Print(__FUNCTION__,&quot;: array length does not correspond to the number of levels, error!&quot;);
      return(false);
     }
//--- 设置水平数量
   ObjectSetInteger(chart_ID,name,OBJPROP_LEVELS,levels);
//--- 设置循环中水平的属性
   for(int i=0;i&lt;levels ;i++)
     {
      //--- 水平的值
      ObjectSetDouble(chart_ID,name,OBJPROP_LEVELVALUE,i,values[i]);
      //--- 水平的颜色
      ObjectSetInteger(chart_ID,name,OBJPROP_LEVELCOLOR,i,colors[i]);
      //--- 水平的风格
      ObjectSetInteger(chart_ID,name,OBJPROP_LEVELSTYLE,i,styles[i]);
      //--- 水平的宽度
      ObjectSetInteger(chart_ID,name,OBJPROP_LEVELWIDTH,i,widths[i]);
      //--- 水平的描述
      ObjectSetString(chart_ID,name,OBJPROP_LEVELTEXT,i,&quot;FE &quot;+DoubleToString(100*values[i],1));
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动斐波纳契扩展线的定位点                                           |
//+------------------------------------------------------------------+
bool FiboExpansionPointChange(const long   chart_ID=0,           // 图表 ID
                              const string name=&quot;FiboExpansion&quot;, // 对象名称
                              const int    point_index=0,        // 定位点指数
                              datetime     time=0,               // 定位点时间坐标
                              double       price=0)              // 定位点价格坐标
  {
//--- 如果没有设置点的位置，则将其移动到当前的卖价柱
   if(!time)
      time=TimeCurrent();
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 重置错误的值
   ResetLastError();
//--- 移动定位点
   if(!ObjectMove(chart_ID,name,point_index,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to move the anchor point! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 删除斐波纳契扩展线                                                  |
//+------------------------------------------------------------------+
bool FiboExpansionDelete(const long   chart_ID=0,           // 图表 ID
                         const string name=&quot;FiboExpansion&quot;) // 对象名称
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除对象
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete \&quot;Fibonacci Expansion\&quot;! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 检查斐波纳契扩展线定位点的值和为空点设置                               |
//| 默认的值                                                          |
//+------------------------------------------------------------------+
void ChangeFiboExpansionEmptyPoints(datetime &amp;time1,double &amp;price1,datetime &amp;time2,
                                    double &amp;price2,datetime &amp;time3,double &amp;price3)
  {
//--- 如果第三点（右侧）的时间没有设置，它将位于当前柱
   if(!time3)
      time3=TimeCurrent();
//--- 如果第三点的价格没有设置，则它将用卖价值
   if(!price3)
      price3=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 如果第一点（左侧）的时间没有设置，它则位于第三点左侧的9个柱
//--- 接收最近10柱开盘时间的数组
   datetime temp[];
   ArrayResize(temp,10);
   if(!time1)
     {
      CopyTime(Symbol(),Period(),time3,10,temp);
      //--- 在第二点左侧9柱设置第一点
      time1=temp[0];
     }
//--- 如果第一点的价格没有设置，则它与第三点的价格相等
   if(!price1)
      price1=price3;
//--- 如果第二点的时间没有设置，它则位于第三点左侧的7个柱
   if(!time2)
      time2=temp[2];
//--- 如果第二个点的价格没有设置，则低于第一个点移动250点
   if(!price2)
      price2=price1-250*SymbolInfoDouble(Symbol(),SYMBOL_POINT);
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 检查输入参数的正确性
   if(InpDate1&lt;0 || InpDate1&gt;100 || InpPrice1&lt;0 || InpPrice1&gt;100 ||
      InpDate2&lt;0 || InpDate2&gt;100 || InpPrice2&lt;0 || InpPrice2&gt;100 ||
      InpDate3&lt;0 || InpDate3&gt;100 || InpPrice3&lt;0 || InpPrice3&gt;100)
     {
      Print(&quot;Error! Incorrect values of input parameters!&quot;);
      return;
     }
//--- 图表窗口的可见柱的数量
   int bars=(int)ChartGetInteger(0,CHART_VISIBLE_BARS);
//--- 价格数组大小
   int accuracy=1000;
//--- 存储要使用的日期和价格值的数组
//--- 设置和改变对象定位点的坐标
   datetime date[];
   double   price[];
//--- 内存分配
   ArrayResize(date,bars);
   ArrayResize(price,accuracy);
//--- 填写日期数组
   ResetLastError();
   if(CopyTime(Symbol(),Period(),0,bars,date)==-1)
     {
      Print(&quot;Failed to copy time values! Error code = &quot;,GetLastError());
      return;
     }
//--- 填写价格数组
//--- 找出图表的最高值和最低值
   double max_price=ChartGetDouble(0,CHART_PRICE_MAX);
   double min_price=ChartGetDouble(0,CHART_PRICE_MIN);
//--- 定义变化的价格并填写该数组
   double step=(max_price-min_price)/accuracy;
   for(int i=0;i&lt; accuracy;i++)
      price[i]=min_price+i*step;
//--- 定义绘制斐波纳契扩展线的点
   int d1=InpDate1*(bars-1)/100;
   int d2=InpDate2*(bars-1)/100;
   int d3=InpDate3*(bars-1)/100;
   int p1=InpPrice1*(accuracy-1)/100;
   int p2=InpPrice2*(accuracy-1)/100;
   int p3=InpPrice3*(accuracy-1)/100;
//--- 创建斐波纳契扩展线
   if(!FiboExpansionCreate(0,InpName,0,date[d1],price[p1],date[d2],price[p2],date[d3],price[p3],
      InpColor,InpStyle,InpWidth,InpBack,InpSelection,InpRayLeft,InpRayRight,InpHidden,InpZOrder))
     {
      return;
     }
//--- 重画图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- 现在，移动定位点
//--- 循环计数器
   int v_steps=accuracy/10;
//--- 移动第一个定位点
   for(int i=0;i&lt;v_steps;i++)
     {
      //--- 使用下面的值
      if(p1&gt;1)
         p1-=1;
      //--- 移动点
      if(!FiboExpansionPointChange(0,InpName,0,date[d1],price[p1]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 循环计数器
   v_steps=accuracy/2;
//--- 移动第三个定位点
   for(int i=0;i&lt;v_steps ;i++)
     {
      //--- 使用下面的值
      if(p3&gt;1)
         p3-=1;
      //--- 移动点
      if(!FiboExpansionPointChange(0,InpName,2,date[d3],price[p3]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 循环计数器
   v_steps=accuracy*4/5;
//--- 移动第二个定位点
   for(int i=0;i&lt;v_steps;i++)
     {
      //--- 使用下面的值
      if(p2&lt;accuracy-1)
         p2+=1;
      //--- 移动点
      if(!FiboExpansionPointChange(0,InpName,1,date[d2],price[p2]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 删除图表对象
   FiboExpansionDelete(0,InpName);
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br><span class="line-number">292</span><br><span class="line-number">293</span><br><span class="line-number">294</span><br><span class="line-number">295</span><br><span class="line-number">296</span><br><span class="line-number">297</span><br><span class="line-number">298</span><br><span class="line-number">299</span><br><span class="line-number">300</span><br><span class="line-number">301</span><br><span class="line-number">302</span><br><span class="line-number">303</span><br><span class="line-number">304</span><br><span class="line-number">305</span><br><span class="line-number">306</span><br><span class="line-number">307</span><br><span class="line-number">308</span><br><span class="line-number">309</span><br><span class="line-number">310</span><br><span class="line-number">311</span><br><span class="line-number">312</span><br><span class="line-number">313</span><br><span class="line-number">314</span><br><span class="line-number">315</span><br></div></div><h4 id="_2-2-1-20-obj-elliotwave5艾略特驱动浪"><a href="#_2-2-1-20-obj-elliotwave5艾略特驱动浪" class="header-anchor">#</a> 2.2.1.20 OBJ_ELLIOTWAVE5艾略特驱动浪</h4> <p><img src="/mql5yao/assets/img/sec19.27aac207.png" alt="Alt text"></p> <p>ObjElliotWave5</p> <p>注意</p> <p>对于江恩网格，可以从 ENUM_GANN_DIRECTION指定趋势类型。通过调整比例值(OBJPROP_SCALE)，可以改变网格线的倾斜角。</p> <p>示例</p> <p>下面的脚本创建和移动图表上的艾略特波浪驱动浪。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 描述
#property description &quot;Script draws \&quot;Elliott Motive Wave\&quot;.&quot;
#property description &quot;Anchor point coordinates are set in percentage of the size of&quot;
#property description &quot;the chart window.&quot;
//--- 启动脚本期间显示输入参数的窗口
#property script_show_inputs
//--- 脚本的输入参数
input string                  InpName=&quot;ElliotWave5&quot;;   // 对象名称
input int                     InpDate1=10;             // 第1个点的日期， %
input int                     InpPrice1=90;            // 第1个点的价格，%
input int                     InpDate2=20;             // 第2个点的日期，%
input int                     InpPrice2=40;            // 第2个点的价格，%
input int                     InpDate3=30;             // 第3个点的日期，%
input int                     InpPrice3=60;            // 第3个点的价格，%
input int                     InpDate4=40;             // 第4个点的日期，%
input int                     InpPrice4=10;            // 第4个点的价格，%
input int                     InpDate5=60;             // 第5个点的日期，%
input int                     InpPrice5=40;            // 第5个点的价格，%
input ENUM_ELLIOT_WAVE_DEGREE InpDegree=ELLIOTT_MINOR; // 水平
input bool                    InpDrawLines=true;       // 显示线
input color                   InpColor=clrRed;         // 线的颜色
input ENUM_LINE_STYLE         InpStyle=STYLE_DASH;     // 线的风格
input int                     InpWidth=2;              // 线的宽度
input bool                    InpBack=false;           // 背景对象
input bool                    InpSelection=true;       // 突出移动
input bool                    InpHidden=true;          // 隐藏在对象列表
input long                    InpZOrder=0;             // 鼠标单击优先
//+------------------------------------------------------------------+
//| 通过已给的坐标创建“艾略特波浪动力”                                    |
//+------------------------------------------------------------------+
bool ElliotWave5Create(const long                    chart_ID=0,              // 图表 ID
                       const string                  name=&quot;ElliotWave5&quot;,      // 波浪名称
                       const int                     sub_window=0,            // 子窗口指数
                       datetime                      time1=0,                 // 第一个点的时间
                       double                        price1=0,                // 第一个点的价格
                       datetime                      time2=0,                 // 第二个点的时间
                       double                        price2=0,                // 第二个点的价格
                       datetime                      time3=0,                 // 第三个点的时间
                       double                        price3=0,                // 第三个点的价格
                       datetime                      time4=0,                 // 第四个点的时间
                       double                        price4=0,                // 第四个点的价格
                       datetime                      time5=0,                 // 第五个点的时间
                       double                        price5=0,                // 第五个点的价格
                       const ENUM_ELLIOT_WAVE_DEGREE degree=ELLIOTT_MINUETTE, // 度数
                       const bool                    draw_lines=true,         // 显示线
                       const color                   clr=clrRed,              // 对象颜色
                       const ENUM_LINE_STYLE         style=STYLE_SOLID,       // 线的风格
                       const int                     width=1,                 // 线的宽度
                       const bool                    back=false,              // 在背景中
                       const bool                    selection=true,          // 突出移动
                       const bool                    hidden=true,             // 隐藏在对象列表
                       const long                    z_order=0)               // 鼠标单击优先
  {
//--- 若未设置则设置定位点的坐标
   ChangeElliotWave5EmptyPoints(time1,price1,time2,price2,time3,price3,time4,price4,time5,price5);
//--- 重置错误的值
   ResetLastError();
//--- 通过已给的坐标创建“艾略特波浪动力”
   if(!ObjectCreate(chart_ID,name,OBJ_ELLIOTWAVE5,sub_window,time1,price1,time2,price2,time3,
      price3,time4,price4,time5,price5))
     {
      Print(__FUNCTION__,
            &quot;: failed to create \&quot;Elliott Motive Wave\&quot;! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 设置程度（波动大小）
   ObjectSetInteger(chart_ID,name,OBJPROP_DEGREE,degree);
//--- 启用 (true) 或禁用 (false) 展示线型的模式
   ObjectSetInteger(chart_ID,name,OBJPROP_DRAWLINES,draw_lines);
//--- 设置对象的颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//---设置线的风格
   ObjectSetInteger(chart_ID,name,OBJPROP_STYLE,style);
//--- 设置线的宽度
   ObjectSetInteger(chart_ID,name,OBJPROP_WIDTH,width);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 突出通道移动的模式
//--- 当使用ObjectCreate函数创建图形对象时，对象不能
//--- 默认下突出并移动。在这个方法中，默认选择参数
//--- true 可以突出移动对象
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动艾略特波浪动力定位点                                            |
//+------------------------------------------------------------------+
bool ElliotWave5PointChange(const long   chart_ID=0,         // 图表 ID
                            const string name=&quot;ElliotWave5&quot;, // 对象名称
                            const int    point_index=0,      // 定位点指数
                            datetime     time=0,             // 定位点时间坐标
                            double       price=0)            // 定位点价格坐标
  {
//--- 如果没有设置点的位置，则将其移动到当前的卖价柱
   if(!time)
      time=TimeCurrent();
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 重置错误的值
   ResetLastError();
//--- 移动定位点
   if(!ObjectMove(chart_ID,name,point_index,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to move the anchor point! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 删除艾略特波浪动力                                                 |
//+------------------------------------------------------------------+
bool ElliotWave5Delete(const long   chart_ID=0,         // 图表 ID
                       const string name=&quot;ElliotWave5&quot;) // 对象名称
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除对象
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete \&quot;Elliott Motive Wave\&quot;! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 检查艾略特波浪动力定位点的值和                                       |
//| 为空点设置默认的值                                                 |
//+------------------------------------------------------------------+
void ChangeElliotWave5EmptyPoints(datetime &amp;time1,double &amp;price1,
                                  datetime &amp;time2,double &amp;price2,
                                  datetime &amp;time3,double &amp;price3,
                                  datetime &amp;time4,double &amp;price4,
                                  datetime &amp;time5,double &amp;price5)
  {
//--- 接收最近10柱开盘时间的数组
   datetime temp[];
   ArrayResize(temp,10);
//--- 接收数据
   CopyTime(Symbol(),Period(),TimeCurrent(),10,temp);
//--- 接收当前图表一点的值
   double point=SymbolInfoDouble(Symbol(),SYMBOL_POINT);
//--- 如果第一点的时间没有设置，它则位于最后柱左侧的9个柱
   if(!time1)
      time1=temp[0];
//--- 如果第一点的价格没有设置，则它将用卖价值
   if(!price1)
      price1=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 如果第二点的时间没有设置，它则位于最后柱左侧的7个柱
   if(!time2)
      time2=temp[2];
//--- 如果第二个点的价格没有设置，则低于第一个点移动300点
   if(!price2)
      price2=price1-300*point;
//--- 如果第三点的时间没有设置，它则位于最后柱左侧的5个柱
   if(!time3)
      time3=temp[4];
//--- 如果第三个点的价格没有设置，则低于第一个点移动250点
   if(!price3)
      price3=price1-250*point;
//--- 如果第四点的时间没有设置，它则位于最后柱左侧的3个柱
   if(!time4)
      time4=temp[6];
//--- 如果第四个点的价格没有设置，则低于第一个点移动550点
   if(!price4)
      price4=price1-550*point;
//--- 如果第四点的时间没有设置，它将位于最后的柱
   if(!time5)
      time5=temp[9];
//--- 如果第五个点的价格没有设置，则低于第一个点移动450点
   if(!price5)
      price5=price1-450*point;
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 检查输入参数的正确性
   if(InpDate1&lt;0 || InpDate1&gt;100 || InpPrice1&lt;0 || InpPrice1&gt;100 ||
      InpDate2&lt;0 || InpDate2&gt;100 || InpPrice2&lt;0 || InpPrice2&gt;100 ||
      InpDate3&lt;0 || InpDate3&gt;100 || InpPrice3&lt;0 || InpPrice3&gt;100 ||
      InpDate4&lt;0 || InpDate4&gt;100 || InpPrice4&lt;0 || InpPrice4&gt;100 ||
      InpDate5&lt;0 || InpDate5&gt;100 || InpPrice5&lt;0 || InpPrice5&gt;100)
     {
      Print(&quot;Error! Incorrect values of input parameters!&quot;);
      return;
     }
//--- 图表窗口的可见柱的数量
   int bars=(int)ChartGetInteger(0,CHART_VISIBLE_BARS);
//--- 价格数组大小
   int accuracy=1000;
//--- 存储要使用的日期和价格值的数组
//--- 设置和改变对象定位点的坐标
   datetime date[];
   double   price[];
//--- 内存分配
   ArrayResize(date,bars);
   ArrayResize(price,accuracy);
//--- 填写日期数组
   ResetLastError();
   if(CopyTime(Symbol(),Period(),0,bars,date)==-1)
     {
      Print(&quot;Failed to copy time values! Error code = &quot;,GetLastError());
      return;
     }
//--- 填写价格数组
//--- 找出图表的最高值和最低值
   double max_price=ChartGetDouble(0,CHART_PRICE_MAX);
   double min_price=ChartGetDouble(0,CHART_PRICE_MIN);
//--- 定义变化的价格并填写该数组
   double step=(max_price-min_price)/accuracy;
   for(int i=0;i&lt;accuracy;i++)
      price[i]=min_price+i*step;
//--- 定义绘制艾略特波浪动力的点
   int d1=InpDate1*(bars-1)/100;
   int d2=InpDate2*(bars-1)/100;
   int d3=InpDate3*(bars-1)/100;
   int d4=InpDate4*(bars-1)/100;
   int d5=InpDate5*(bars-1)/100;
   int p1=InpPrice1*(accuracy-1)/100;
   int p2=InpPrice2*(accuracy-1)/100;
   int p3=InpPrice3*(accuracy-1)/100;
   int p4=InpPrice4*(accuracy-1)/100;
   int p5=InpPrice5*(accuracy-1)/100;
//--- 创建艾略特波浪动力
   if(!ElliotWave5Create(0,InpName,0,date[d1],price[p1],date[d2],price[p2],date[d3],price[p3],
      date[d4],price[p4],date[d5],price[p5],InpDegree,InpDrawLines,InpColor,InpStyle,InpWidth,
      InpBack,InpSelection,InpHidden,InpZOrder))
     {
      return;
     }
//--- 重画图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- 现在，移动定位点
//--- 循环计数器
   int v_steps=accuracy/5;
//--- 移动第五个定位点
   for(int i=0;i&lt;v_steps;i++)
     {
      //--- 使用下面的值
      if(p5&lt;accuracy-1)
         p5+=1;
      //--- 移动点
      if(!ElliotWave5PointChange(0,InpName,4,date[d5],price[p5]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 循环计数器
   v_steps=accuracy/5;
//--- 移动第二个和第三个定位点
   for(int i=0;i&lt;v_steps ;i++)
     {
      //--- 使用下面的值
      if(p2&lt;accuracy-1)
         p2+=1;
      if(p3&gt;1)
         p3-=1;
      //--- 切换点
      if(!ElliotWave5PointChange(0,InpName,1,date[d2],price[p2]))
         return;
      if(!ElliotWave5PointChange(0,InpName,2,date[d3],price[p3]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 循环计数器
   v_steps=accuracy*4/5;
//--- 移动第一个和第四个定位点
   for(int i=0;i&lt;v_steps ;i++)
     {
      //--- 使用下面的值
      if(p1&gt;1)
         p1-=1;
      if(p4&lt;accuracy-1)
         p4+=1;
      //--- 切换点
      if(!ElliotWave5PointChange(0,InpName,0,date[d1],price[p1]))
         return;
      if(!ElliotWave5PointChange(0,InpName,3,date[d4],price[p4]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 删除图表对象
   ElliotWave5Delete(0,InpName);
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br><span class="line-number">292</span><br><span class="line-number">293</span><br><span class="line-number">294</span><br><span class="line-number">295</span><br><span class="line-number">296</span><br><span class="line-number">297</span><br><span class="line-number">298</span><br><span class="line-number">299</span><br><span class="line-number">300</span><br><span class="line-number">301</span><br><span class="line-number">302</span><br><span class="line-number">303</span><br><span class="line-number">304</span><br><span class="line-number">305</span><br><span class="line-number">306</span><br><span class="line-number">307</span><br><span class="line-number">308</span><br><span class="line-number">309</span><br><span class="line-number">310</span><br><span class="line-number">311</span><br><span class="line-number">312</span><br><span class="line-number">313</span><br><span class="line-number">314</span><br><span class="line-number">315</span><br><span class="line-number">316</span><br><span class="line-number">317</span><br></div></div><h4 id="_2-2-1-21-obj-elliotwave3艾略特调整浪"><a href="#_2-2-1-21-obj-elliotwave3艾略特调整浪" class="header-anchor">#</a> 2.2.1.21 OBJ_ELLIOTWAVE3艾略特调整浪</h4> <p><img src="/mql5yao/assets/img/sec20.04300328.png" alt="Alt text"></p> <p>ObjElliotWave3</p> <p>注意</p> <p>对于&quot;艾略特调整浪&quot;，可以启用/禁用通过线连接点的模式 (OBJPROP_DRAWLINES 属性)，以及设置波浪定位的水平(从 ENUM_ELLIOT_WAVE_DEGREE 枚举)。</p> <p>示例</p> <p>下面的脚本创建和移动图表上的艾略特调整浪。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>ObjectCreate函数创建图形对象时，对象不能
//--- 默认下突出并移动。在这个方法中，默认选择参数
//--- true 可以突出移动对象
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动埃利奥特纠正波定位点                                            |
//+------------------------------------------------------------------+
bool ElliotWave3PointChange(const long   chart_ID=0,         // 图表 ID
                            const string name=&quot;ElliotWave3&quot;, // 对象名称
                            const int    point_index=0,      // 定位点指数
                            datetime     time=0,             // 定位点时间坐标
                            double       price=0)            // 定位点价格坐标
  {
//--- 如果没有设置点的位置，则将其移动到当前的卖价柱
   if(!time)
      time=TimeCurrent();
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 重置错误的值
   ResetLastError();
//--- 移动定位点
   if(!ObjectMove(chart_ID,name,point_index,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to move the anchor point! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 删除埃利奥特纠正波                                                 |
//+------------------------------------------------------------------+
bool ElliotWave3Delete(const long   chart_ID=0,         // 图表ID
                       const string name=&quot;ElliotWave3&quot;) // 对象名称
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除对象
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete \&quot;Elliott Correction Wave\&quot;! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 检查埃利奥特纠正波定位点的值和                                       |
//| 为空点设置默认的值                                                  |
//+------------------------------------------------------------------+
void ChangeElliotWave3EmptyPoints(datetime &amp;time1,double &amp;price1,
                                  datetime &amp;time2,double &amp;price2,
                                  datetime &amp;time3,double &amp;price3)
  {
//--- 接收最近10柱开盘时间的数组
   datetime temp[];
   ArrayResize(temp,10);
//--- 接收数据
   CopyTime(Symbol(),Period(),TimeCurrent(),10,temp);
//--- 接收当前图表一点的值
   double point=SymbolInfoDouble(Symbol(),SYMBOL_POINT);
//--- 如果第一点的时间没有设置，它则位于最后柱左侧的9个柱
   if(!time1)
      time1=temp[0];
//--- 如果第一点的价格没有设置，则它将用卖价值
   if(!price1)
      price1=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 如果第二点的时间没有设置，它则位于最后柱左侧的5个柱
   if(!time2)
      time2=temp[4];
//--- 如果第二个点的价格没有设置，则低于第一个点移动300点
   if(!price2)
      price2=price1-300*point;
//--- 如果第三点的时间没有设置，它则位于最后柱左侧的1个柱
   if(!time3)
      time3=temp[8];
//---如果第三个点的价格没有设置，则低于第一个点移动200点
   if(!price3)
      price3=price1-200*point;
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 检查输入参数的正确性
   if(InpDate1&lt;0 || InpDate1&gt;100 || InpPrice1&lt;0 || InpPrice1&gt;100 ||
      InpDate2&lt;0 || InpDate2&gt;100 || InpPrice2&lt;0 || InpPrice2&gt;100 ||
      InpDate3&lt;0 || InpDate3&gt;100 || InpPrice3&lt;0 || InpPrice3&gt;100)
     {
      Print(&quot;Error! Incorrect values of input parameters!&quot;);
      return;
     }
//--- 图表窗口的可见柱的数量
   int bars=(int)ChartGetInteger(0,CHART_VISIBLE_BARS);
//--- 价格数组大小
   int accuracy=1000;
//--- 存储要使用的日期和价格值的数组
//--- 设置和改变对象定位点的坐标
   datetime date[];
   double   price[];
//--- 内存分配
   ArrayResize(date,bars);
   ArrayResize(price,accuracy);
//--- 填写日期数组
   ResetLastError();
   if(CopyTime(Symbol(),Period(),0,bars,date)==-1)
     {
      Print(&quot;Failed to copy time values! Error code = &quot;,GetLastError());
      return;
     }
//--- 填写价格数组
//--- 找出图表的最高值和最低值
   double max_price=ChartGetDouble(0,CHART_PRICE_MAX);
   double min_price=ChartGetDouble(0,CHART_PRICE_MIN);
//--- 定义变化的价格并填写该数组
   double step=(max_price-min_price)/accuracy;
   for(int i=0;i&lt;accuracy ;i++)
      price[i]=min_price+i*step;
//--- 定义绘制埃利奥特纠正波的点
   int d1=InpDate1*(bars-1)/100;
   int d2=InpDate2*(bars-1)/100;
   int d3=InpDate3*(bars-1)/100;
   int p1=InpPrice1*(accuracy-1)/100;
   int p2=InpPrice2*(accuracy-1)/100;
   int p3=InpPrice3*(accuracy-1)/100;
//--- 创建埃利奥特纠正波
   if(!ElliotWave3Create(0,InpName,0,date[d1],price[p1],date[d2],price[p2],date[d3],price[p3],
      InpDegree,InpDrawLines,InpColor,InpStyle,InpWidth,InpBack,InpSelection,InpHidden,InpZOrder))
     {
      return;
     }
//--- 重画图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- 现在，移动定位点
//--- 循环计数器
   int v_steps=accuracy/5;
//--- 移动第三个定位点
   for(int i=0;i&lt;v_steps;i++)
     {
      //--- 使用下面的值
      if(p3&lt;accuracy-1)
         p3+=1;
      //--- 移动点
      if(!ElliotWave3PointChange(0,InpName,2,date[d3],price[p3]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 循环计数器
   v_steps=accuracy*4/5;
//--- 移动第一个和第二个定位点
   for(int i=0;i&lt;v_steps ;i++)
     {
      //--- 使用下面的值
      if(p1&gt;1)
         p1-=1;
      if(p2&lt;accuracy-1)
         p2+=1;
      //--- 切换点
      if(!ElliotWave3PointChange(0,InpName,0,date[d1],price[p1]))
         return;
      if(!ElliotWave3PointChange(0,InpName,1,date[d2],price[p2]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 删除图表对象
   ElliotWave3Delete(0,InpName);
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br></div></div><h4 id="_2-2-1-21-obj-elliotwave3艾略特调整浪-2"><a href="#_2-2-1-21-obj-elliotwave3艾略特调整浪-2" class="header-anchor">#</a> 2.2.1.21 OBJ_ELLIOTWAVE3艾略特调整浪</h4> <p><img src="/mql5yao/assets/img/sec20.04300328.png" alt="Alt text"></p> <p>ObjElliotWave3</p> <p>注意</p> <p>对于&quot;艾略特调整浪&quot;，可以启用/禁用通过线连接点的模式 (OBJPROP_DRAWLINES 属性)，以及设置波浪定位的水平(从 ENUM_ELLIOT_WAVE_DEGREE 枚举)。</p> <p>示例</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>ObjectCreate函数创建图形对象时，对象不能
//--- 默认下突出并移动。在这个方法中，默认选择参数
//--- true 可以突出移动对象
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动埃利奥特纠正波定位点                                            |
//+------------------------------------------------------------------+
bool ElliotWave3PointChange(const long   chart_ID=0,         // 图表 ID
                            const string name=&quot;ElliotWave3&quot;, // 对象名称
                            const int    point_index=0,      // 定位点指数
                            datetime     time=0,             // 定位点时间坐标
                            double       price=0)            // 定位点价格坐标
  {
//--- 如果没有设置点的位置，则将其移动到当前的卖价柱
   if(!time)
      time=TimeCurrent();
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 重置错误的值
   ResetLastError();
//--- 移动定位点
   if(!ObjectMove(chart_ID,name,point_index,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to move the anchor point! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 删除埃利奥特纠正波                                                 |
//+------------------------------------------------------------------+
bool ElliotWave3Delete(const long   chart_ID=0,         // 图表ID
                       const string name=&quot;ElliotWave3&quot;) // 对象名称
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除对象
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete \&quot;Elliott Correction Wave\&quot;! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 检查埃利奥特纠正波定位点的值和                                       |
//| 为空点设置默认的值                                                  |
//+------------------------------------------------------------------+
void ChangeElliotWave3EmptyPoints(datetime &amp;time1,double &amp;price1,
                                  datetime &amp;time2,double &amp;price2,
                                  datetime &amp;time3,double &amp;price3)
  {
//--- 接收最近10柱开盘时间的数组
   datetime temp[];
   ArrayResize(temp,10);
//--- 接收数据
   CopyTime(Symbol(),Period(),TimeCurrent(),10,temp);
//--- 接收当前图表一点的值
   double point=SymbolInfoDouble(Symbol(),SYMBOL_POINT);
//--- 如果第一点的时间没有设置，它则位于最后柱左侧的9个柱
   if(!time1)
      time1=temp[0];
//--- 如果第一点的价格没有设置，则它将用卖价值
   if(!price1)
      price1=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 如果第二点的时间没有设置，它则位于最后柱左侧的5个柱
   if(!time2)
      time2=temp[4];
//--- 如果第二个点的价格没有设置，则低于第一个点移动300点
   if(!price2)
      price2=price1-300*point;
//--- 如果第三点的时间没有设置，它则位于最后柱左侧的1个柱
   if(!time3)
      time3=temp[8];
//---如果第三个点的价格没有设置，则低于第一个点移动200点
   if(!price3)
      price3=price1-200*point;
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 检查输入参数的正确性
   if(InpDate1&lt;0 || InpDate1&gt;100 || InpPrice1&lt;0 || InpPrice1&gt;100 ||
      InpDate2&lt;0 || InpDate2&gt;100 || InpPrice2&lt;0 || InpPrice2&gt;100 ||
      InpDate3&lt;0 || InpDate3&gt;100 || InpPrice3&lt;0 || InpPrice3&gt;100)
     {
      Print(&quot;Error! Incorrect values of input parameters!&quot;);
      return;
     }
//--- 图表窗口的可见柱的数量
   int bars=(int)ChartGetInteger(0,CHART_VISIBLE_BARS);
//--- 价格数组大小
   int accuracy=1000;
//--- 存储要使用的日期和价格值的数组
//--- 设置和改变对象定位点的坐标
   datetime date[];
   double   price[];
//--- 内存分配
   ArrayResize(date,bars);
   ArrayResize(price,accuracy);
//--- 填写日期数组
   ResetLastError();
   if(CopyTime(Symbol(),Period(),0,bars,date)==-1)
     {
      Print(&quot;Failed to copy time values! Error code = &quot;,GetLastError());
      return;
     }
//--- 填写价格数组
//--- 找出图表的最高值和最低值
   double max_price=ChartGetDouble(0,CHART_PRICE_MAX);
   double min_price=ChartGetDouble(0,CHART_PRICE_MIN);
//--- 定义变化的价格并填写该数组
   double step=(max_price-min_price)/accuracy;
   for(int i=0;i&lt;accuracy;i++)
      price[i]=min_price+i*step;
//--- 定义绘制埃利奥特纠正波的点
   int d1=InpDate1*(bars-1)/100;
   int d2=InpDate2*(bars-1)/100;
   int d3=InpDate3*(bars-1)/100;
   int p1=InpPrice1*(accuracy-1)/100;
   int p2=InpPrice2*(accuracy-1)/100;
   int p3=InpPrice3*(accuracy-1)/100;
//--- 创建埃利奥特纠正波
   if(!ElliotWave3Create(0,InpName,0,date[d1],price[p1],date[d2],price[p2],date[d3],price[p3],
      InpDegree,InpDrawLines,InpColor,InpStyle,InpWidth,InpBack,InpSelection,InpHidden,InpZOrder))
     {
      return;
     }
//--- 重画图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- 现在，移动定位点
//--- 循环计数器
   int v_steps=accuracy/5;
//--- 移动第三个定位点
   for(int i=0;i&lt;v_steps;i++)
     {
      //--- 使用下面的值
      if(p3&lt;accuracy-1)
         p3+=1;
      //--- 移动点
      if(!ElliotWave3PointChange(0,InpName,2,date[d3],price[p3]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 循环计数器
   v_steps=accuracy*4/5;
//--- 移动第一个和第二个定位点
   for(int i=0;i&lt;v_steps ;i++)
     {
      //--- 使用下面的值
      if(p1&gt;1)
         p1-=1;
      if(p2&lt;accuracy-1)
         p2+=1;
      //--- 切换点
      if(!ElliotWave3PointChange(0,InpName,0,date[d1],price[p1]))
         return;
      if(!ElliotWave3PointChange(0,InpName,1,date[d2],price[p2]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 删除图表对象
   ElliotWave3Delete(0,InpName);
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br></div></div><h4 id="_2-2-1-22-obj-rectangle矩形"><a href="#_2-2-1-22-obj-rectangle矩形" class="header-anchor">#</a> 2.2.1.22 OBJ_RECTANGLE矩形</h4> <p><img src="data:image/png;base64,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" alt="Alt text"></p> <p>ObjRectangle</p> <p>注意</p> <p>对于矩形，颜色填充模式可以使用OBJPROP_FILL属性来设置。</p> <p>示例</p> <p>下面的脚本创建和移动图表上的矩形。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 描述
#property description &quot;Script creates rectangle on the chart.&quot;
#property description &quot;Anchor point coordinates are set in&quot;
#property description &quot;percentage of the chart window size.&quot;
//--- 启动脚本期间显示输入参数的窗口
#property script_show_inputs
//--- 脚本的输入参数
input string          InpName=&quot;Rectangle&quot;; // 矩形名称
input int             InpDate1=40;         // 第1个点的日期，%
input int             InpPrice1=40;        // 第1个点的价格，%
input int             InpDate2=60;         // 第2个点的日期，%
input int             InpPrice2=60;        // 第2个点的价格，%
input color           InpColor=clrRed;     // 矩形颜色
input ENUM_LINE_STYLE InpStyle=STYLE_DASH; // 矩形线的风格
input int             InpWidth=2;          // 矩形线的宽度
input bool            InpFill=true;        // 填充矩形颜色
input bool            InpBack=false;       // 背景矩形
input bool            InpSelection=true;   // 突出移动
input bool            InpHidden=true;      // 隐藏在对象列表
input long            InpZOrder=0;         // 鼠标单击优先
//+------------------------------------------------------------------+
//| 通过已给的坐标创建矩形                                              |
//+------------------------------------------------------------------+
bool RectangleCreate(const long            chart_ID=0,        // 图表 ID
                     const string          name=&quot;Rectangle&quot;,  // 矩形名称
                     const int             sub_window=0,      // 子窗口指数
                     datetime              time1=0,           // 第一个点的时间
                     double                price1=0,          // 第一个点的价格
                     datetime              time2=0,           // 第二个点的时间
                     double                price2=0,          // 第二个点的价格
                     const color           clr=clrRed,        // 矩形颜色
                     const ENUM_LINE_STYLE style=STYLE_SOLID, // 矩形线的风格
                     const int             width=1,           // 矩形线的宽度
                     const bool            fill=false,        // 填充矩形颜色
                     const bool            back=false,        // 在背景中
                     const bool            selection=true,    // 突出移动
                     const bool            hidden=true,       // 隐藏在对象列表
                     const long            z_order=0)         // 鼠标单击优先
  {
//--- 若未设置则设置定位点的坐标
   ChangeRectangleEmptyPoints(time1,price1,time2,price2);
//--- 重置错误的值
   ResetLastError();
//--- 通过已给的坐标创建矩形
   if(!ObjectCreate(chart_ID,name,OBJ_RECTANGLE,sub_window,time1,price1,time2,price2))
     {
      Print(__FUNCTION__,
            &quot;: failed to create a rectangle! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 设置矩形颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//--- 设置矩形线的风格
   ObjectSetInteger(chart_ID,name,OBJPROP_STYLE,style);
//--- 设置矩形线的宽度
   ObjectSetInteger(chart_ID,name,OBJPROP_WIDTH,width);
//--- 启用 (true) 或禁用 (false) 填充矩形的模式
   ObjectSetInteger(chart_ID,name,OBJPROP_FILL,fill);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 突出矩形移动的模式
//--- 当使用ObjectCreate函数创建图形对象时，对象不能
//--- 默认下突出并移动。在这个方法中，默认选择参数
//--- true 可以突出移动对象
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动矩形定位点                                                     |
//+------------------------------------------------------------------+
bool RectanglePointChange(const long   chart_ID=0,       // 图表 ID
                          const string name=&quot;Rectangle&quot;, // 矩形名称
                          const int    point_index=0,    // 定位点指数
                          datetime     time=0,           // 定位点时间坐标
                          double       price=0)          // 定位点价格坐标
  {
//--- 如果没有设置点的位置，则将其移动到当前的卖价柱
   if(!time)
      time=TimeCurrent();
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 重置错误的值
   ResetLastError();
//--- 移动定位点
   if(!ObjectMove(chart_ID,name,point_index,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to move the anchor point! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 删除矩形                                                          |
//+------------------------------------------------------------------+
bool RectangleDelete(const long   chart_ID=0,       // 图表 ID
                     const string name=&quot;Rectangle&quot;) // 矩形名称
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除矩形
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete rectangle! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 检查矩形定位点的值和为空点设置                                       |
//| 默认的值                                                          |
//+------------------------------------------------------------------+
void ChangeRectangleEmptyPoints(datetime &amp;time1,double &amp;price1,
                                datetime &amp;time2,double &amp;price2)
  {
//--- 如果第一点的时间没有设置，它将位于当前柱
   if(!time1)
      time1=TimeCurrent();
//--- 如果第一点的价格没有设置，则它将用卖价值
   if(!price1)
      price1=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 如果第二点的时间没有设置，它则位于第二点左侧的9个柱
   if(!time2)
     {
      //--- 接收最近10柱开盘时间的数组
      datetime temp[10];
      CopyTime(Symbol(),Period(),time1,10,temp);
      //--- 在第一点左侧9柱设置第二点
      time2=temp[0];
     }
//--- 如果第二个点的价格没有设置，则低于第一个点移动300点
   if(!price2)
      price2=price1-300*SymbolInfoDouble(Symbol(),SYMBOL_POINT);
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 检查输入参数的正确性
   if(InpDate1&lt;0 || InpDate1&gt;100 || InpPrice1&lt;0 || InpPrice1&gt;100 ||
      InpDate2&lt;0 || InpDate2&gt;100 || InpPrice2&lt;0 || InpPrice2&gt;100)
     {
      Print(&quot;Error! Incorrect values of input parameters!&quot;);
      return;
     }
//--- 图表窗口的可见柱的数量
   int bars=(int)ChartGetInteger(0,CHART_VISIBLE_BARS);
//--- 价格数组大小
   int accuracy=1000;
//--- 存储要使用的日期和价格值的数组
//--- 设置和改变矩形定位点的坐标
   datetime date[];
   double   price[];
//--- 内存分配
   ArrayResize(date,bars);
   ArrayResize(price,accuracy);
//--- 填写日期数组
   ResetLastError();
   if(CopyTime(Symbol(),Period(),0,bars,date)==-1)
     {
      Print(&quot;Failed to copy time values! Error code = &quot;,GetLastError());
      return;
     }
//--- 填写价格数组
//--- 找出图表的最高值和最低值
   double max_price=ChartGetDouble(0,CHART_PRICE_MAX);
   double min_price=ChartGetDouble(0,CHART_PRICE_MIN);
//--- 定义变化的价格并填写该数组
   double step=(max_price-min_price)/accuracy;
   for(int i=0;i&lt;accuracy;i++)
      price[i]=min_price+i*step;
//--- 定义绘制矩形的点
   int d1=InpDate1*(bars-1)/100;
   int d2=InpDate2*(bars-1)/100;
   int p1=InpPrice1*(accuracy-1)/100;
   int p2=InpPrice2*(accuracy-1)/100;
//--- 创建矩形
   if(!RectangleCreate(0,InpName,0,date[d1],price[p1],date[d2],price[p2],InpColor,
      InpStyle,InpWidth,InpFill,InpBack,InpSelection,InpHidden,InpZOrder))
     {
      return;
     }
//--- 重画图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- 现在，移动矩形的定位点
//--- 循环计数器
   int h_steps=bars/2;
//--- 移动定位点
   for(int i=0;i&lt;h_steps;i++)
     {
      //--- 使用下面的值
      if(d1&lt;bars-1)
         d1+=1;
      if(d2&gt;1)
         d2-=1;
      //--- 切换点
      if(!RectanglePointChange(0,InpName,0,date[d1],price[p1]))
         return;
      if(!RectanglePointChange(0,InpName,1,date[d2],price[p2]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
      // 0.05 秒延迟
      Sleep(50);
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 循环计数器
   int v_steps=accuracy/2;
//--- 移动定位点
   for(int i=0;i&lt;v_steps;i++)
     {
      //--- 使用下面的值
      if(p1&lt;accuracy-1)
         p1+=1;
      if(p2&gt;1)
         p2-=1;
      //--- 切换点
      if(!RectanglePointChange(0,InpName,0,date[d1],price[p1]))
         return;
      if(!RectanglePointChange(0,InpName,1,date[d2],price[p2]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 删除图表矩形
   RectangleDelete(0,InpName);
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br></div></div><h4 id="_2-2-1-23-obj-triangle三角形"><a href="#_2-2-1-23-obj-triangle三角形" class="header-anchor">#</a> 2.2.1.23 OBJ_TRIANGLE三角形</h4> <p><img src="data:image/png;base64,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" alt="Alt text"></p> <p>ObjTriangle</p> <p>注意</p> <p>对于三角形，颜色填充模式可以使用 OBJPROP_FILL 属性来设置。</p> <p>示例</p> <p>下面的脚本创建和移动图表上的三角形。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 描述
#property description &quot;Script creates triangle on the chart.&quot;
#property description &quot;Anchor point coordinates are set in&quot;
#property description &quot;percentage of the chart window size.&quot;
//--- 启动脚本期间显示输入参数的窗口
#property script_show_inputs
//--- 脚本的输入参数
input string          InpName=&quot;Triangle&quot;;        // 三角形名称
input int             InpDate1=25;               // 第1个点的日期，%
input int             InpPrice1=50;              // 第一个点的价格，%
input int             InpDate2=70;               // 第2个点的日期， %
input int             InpPrice2=70;              // 第2个点的价格，%
input int             InpDate3=65;               // 第3个点的日期，%
input int             InpPrice3=20;              // 第3个点的价格，%
input color           InpColor=clrRed;           // 三角形颜色
input ENUM_LINE_STYLE InpStyle=STYLE_DASHDOTDOT; // 三角形线条风格
input int             InpWidth=2;                // 三角形线条宽度
input bool            InpFill=false;             // 三角形填充颜色
input bool            InpBack=false;             // 背景三角形
input bool            InpSelection=true;         // 突出移动
input bool            InpHidden=true;            // 隐藏在对象列表
input long            InpZOrder=0;               // 鼠标单击优先
//+------------------------------------------------------------------+
//|通过已给的坐标创建三角形                                             |
//+------------------------------------------------------------------+
bool TriangleCreate(const long            chart_ID=0,        //图表 ID
                    const string          name=&quot;Triangle&quot;,   //三角形名称
                    const int             sub_window=0,      // 子窗口指数
                    datetime              time1=0,           // 第一个点的时间
                    double                price1=0,          // 第一个点的价格
                    datetime              time2=0,           // 第二个点的时间
                    double                price2=0,          // 第二个点的价格
                    datetime              time3=0,           //第三个点的时间
                    double                price3=0,          // 第三个点的价格
                    const color           clr=clrRed,        //三角形颜色
                    const ENUM_LINE_STYLE style=STYLE_SOLID, // 三角形线条风格
                    const int             width=1,           // 三角形线条宽度
                    const bool            fill=false,        // 三角形填充颜色
                    const bool            back=false,        // 在背景中
                    const bool            selection=true,    // 突出移动
                    const bool            hidden=true,       // 隐藏在对象列表
                    const long            z_order=0)         // 鼠标单击优先
  {
//--- 若未设置则设置定位点的坐标
   ChangeTriangleEmptyPoints(time1,price1,time2,price2,time3,price3);
//--- 重置错误的值
   ResetLastError();
//--- 通过已给的坐标创建三角形
   if(!ObjectCreate(chart_ID,name,OBJ_TRIANGLE,sub_window,time1,price1,time2,price2,time3,price3))
     {
      Print(__FUNCTION__,
            &quot;: failed to create a triangle! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 设置三角形颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//--- 设置三角形线条风格
   ObjectSetInteger(chart_ID,name,OBJPROP_STYLE,style);
//--- 设置三角形线条宽度
   ObjectSetInteger(chart_ID,name,OBJPROP_WIDTH,width);
//--- 启用 (true) 或禁用 (false) 填充三角形的模式
   ObjectSetInteger(chart_ID,name,OBJPROP_FILL,fill);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 突出三角形移动的模式
//--- 当使用ObjectCreate函数创建图形对象时，对象不能
//--- 默认下突出并移动。在这个方法中，默认选择参数
//--- true 可以突出移动对象
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动三角形定位点                                                   |
//+------------------------------------------------------------------+
bool TrianglePointChange(const long   chart_ID=0,      // 图表 ID
                         const string name=&quot;Triangle&quot;, // 三角形名称
                         const int    point_index=0,   // 定位点指数
                         datetime     time=0,          // 定位点时间坐标
                         double       price=0)         // 定位点价格坐标
  {
//--- 如果没有设置点的位置，则将其移动到当前的卖价柱
   if(!time)
      time=TimeCurrent();
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 重置错误的值
   ResetLastError();
//--- 移动定位点
   if(!ObjectMove(chart_ID,name,point_index,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to move the anchor point! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 删除三角形                                                        |
//+------------------------------------------------------------------+
bool TriangleDelete(const long   chart_ID=0,      // 图表 ID
                    const string name=&quot;Triangle&quot;) // 三角形名称
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除三角形
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete the ellipse! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 检查三角形定位点的值和为空点设置                                     |
//| 默认的值                                                          |
//+------------------------------------------------------------------+
void ChangeTriangleEmptyPoints(datetime &amp;time1,double &amp;price1,
                               datetime &amp;time2,double &amp;price2,
                               datetime &amp;time3,double &amp;price3)
  {
//--- 如果第一点的时间没有设置，它将位于当前柱
   if(!time1)
      time1=TimeCurrent();
//--- 如果第一点的价格没有设置，则它将用卖价值
   if(!price1)
      price1=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 如果第二点的时间没有设置，它则位于第二点左侧的9个柱
   if(!time2)
     {
      //--- 接收最近10柱开盘时间的数组
      datetime temp[10];
      CopyTime(Symbol(),Period(),time1,10,temp);
      //--- 在第一点左侧9柱设置第二点
      time2=temp[0];
     }
//--- 如果第二个点的价格没有设置，则低于第一个点移动300点
   if(!price2)
      price2=price1-300*SymbolInfoDouble(Symbol(),SYMBOL_POINT);
//--- 如果第三个点的时间没有设置，则它与第二个点的日期相一致
   if(!time3)
      time3=time2;
//--- 如果第三点的价格没有设置，则它与第一点的价格相等
   if(!price3)
      price3=price1;
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 检查输入参数的正确性
   if(InpDate1&lt;0 || InpDate1&gt;100 || InpPrice1&lt;0 || InpPrice1&gt;100 ||
      InpDate2&lt;0 || InpDate2&gt;100 || InpPrice2&lt;0 || InpPrice2&gt;100 ||
      InpDate3&lt;0 || InpDate3&gt;100 || InpPrice3&lt;0 || InpPrice3&gt;100)
     {
      Print(&quot;Error! Incorrect values of input parameters!&quot;);
      return;
     }
//--- 图表窗口的可见柱的数量
   int bars=(int)ChartGetInteger(0,CHART_VISIBLE_BARS);
//--- 价格数组大小
   int accuracy=1000;
//--- 存储要使用的日期和价格值的数组
//--- 设置和改变三角形定位点的坐标
   datetime date[];
   double   price[];
//--- 内存分配
   ArrayResize(date,bars);
   ArrayResize(price,accuracy);
//--- 填写日期数组
   ResetLastError();
   if(CopyTime(Symbol(),Period(),0,bars,date)==-1)
     {
      Print(&quot;Failed to copy time values! Error code = &quot;,GetLastError());
      return;
     }
//--- 填写价格数组
//--- 找出图表的最高值和最低值
   double max_price=ChartGetDouble(0,CHART_PRICE_MAX);
   double min_price=ChartGetDouble(0,CHART_PRICE_MIN);
//--- 定义变化的价格并填写该数组
   double step=(max_price-min_price)/accuracy;
   for(int i=0;i&lt;accuracy ;i++)
      price[i]=min_price+i*step;
//--- 定义绘制三角形的点
   int d1=InpDate1*(bars-1)/100;
   int d2=InpDate2*(bars-1)/100;
   int d3=InpDate3*(bars-1)/100;
   int p1=InpPrice1*(accuracy-1)/100;
   int p2=InpPrice2*(accuracy-1)/100;
   int p3=InpPrice3*(accuracy-1)/100;
//--- 创建三角形
   if(!TriangleCreate(0,InpName,0,date[d1],price[p1],date[d2],price[p2],date[d3],price[p3],
      InpColor,InpStyle,InpWidth,InpFill,InpBack,InpSelection,InpHidden,InpZOrder))
     {
      return;
     }
//--- 重画图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- 现在，移动三角形定位点
//--- 循环计数器
   int v_steps=accuracy*3/10;
//--- 移动第一个定位点
   for(int i=0;i&lt;v_steps;i++)
     {
      //--- 使用下面的值
      if(p1&gt;1)
         p1-=1;
      //--- 移动点
      if(!TrianglePointChange(0,InpName,0,date[d1],price[p1]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 循环计数器
   int h_steps=bars*9/20-1;
//--- 移动第二个定位点
   for(int i=0;i&lt;h_steps;i++)
     {
      //--- 使用下面的值
      if(d2&gt;1)
         d2-=1;
      //--- 移动点
      if(!TrianglePointChange(0,InpName,1,date[d2],price[p2]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
      // 0.05 秒延迟
      Sleep(50);
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 循环计数器
   v_steps=accuracy/4;
//--- 移动第三个定位点
   for(int i=0;i&lt;v_steps;i++)
     {
      //--- 使用下面的值
      if(p3&lt;accuracy-1)
         p3+=1;
      //--- 移动点
      if(!TrianglePointChange(0,InpName,2,date[d3],price[p3]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 从图表删除三角形
   TriangleDelete(0,InpName);
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br></div></div><h4 id="_2-2-1-24-obj-ellipse椭圆形"><a href="#_2-2-1-24-obj-ellipse椭圆形" class="header-anchor">#</a> 2.2.1.24 OBJ_ELLIPSE椭圆形</h4> <p><img src="data:image/png;base64,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" alt="Alt text"></p> <p>ObjEllipse</p> <p>注意</p> <p>对于椭圆形，颜色填充模式可以使用 OBJPROP_FILL 属性来设置。</p> <p>示例</p> <p>下面的脚本创建和移动图表上的椭圆形。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 描述
#property description &quot;Script creates ellipse on the chart.&quot;
#property description &quot;Anchor point coordinates are set&quot;
#property description &quot;in percentage of the chart window size.&quot;
//--- 启动脚本期间显示输入参数的窗口
#property script_show_inputs
//--- 脚本的输入参数
input string          InpName=&quot;Ellipse&quot;;         // 椭圆形名称
input int             InpDate1=30;               // 第1个点的日期，%
input int             InpPrice1=20;              // 第1个点的价格，%
input int             InpDate2=70;               // 第2个点的日期， %
input int             InpPrice2=80;              // 第2个点的价格，%
input int             InpDate3=50;               // 第3个点的日期，%
input int             InpPrice3=60;              // 第3个点的价格，%
input color           InpColor=clrRed;           // 椭圆形颜色
input ENUM_LINE_STYLE InpStyle=STYLE_DASHDOTDOT; // 椭圆形线条风格
input int             InpWidth=2;                // 椭圆形线条的宽度
input bool            InpFill=false;             // 椭圆形填充颜色
input bool            InpBack=false;             // 背景椭圆形
input bool            InpSelection=true;         // 突出移动
input bool            InpHidden=true;            // 隐藏在对象列表
input long            InpZOrder=0;               // 鼠标单击优先
//+------------------------------------------------------------------+
//| 由给定坐标创建椭圆形                                                |
//+------------------------------------------------------------------+
bool EllipseCreate(const long            chart_ID=0,        // 图表ID
                   const string          name=&quot;Ellipse&quot;,    // 椭圆形名称
                   const int             sub_window=0,      // 子窗口指数
                   datetime              time1=0,           // 第一个点的时间
                   double                price1=0,          // 第一个点的价格
                   datetime              time2=0,           // 第二个点的时间
                   double                price2=0,          // 第二个点的价格
                   datetime              time3=0,           // 第三个点的时间
                   double                price3=0,          // 第三个点的价格
                   const color           clr=clrRed,        // 椭圆形颜色
                   const ENUM_LINE_STYLE style=STYLE_SOLID, // 椭圆形线条风格
                   const int             width=1,           // 椭圆形线条的宽度
                   const bool            fill=false,        // 椭圆形填充颜色
                   const bool            back=false,        // 在背景中
                   const bool            selection=true,    // 突出移动
                   const bool            hidden=true,       // 隐藏在对象列表
                   const long            z_order=0)         // 鼠标单击优先
  {
//--- 若未设置则设置定位点的坐标
   ChangeEllipseEmptyPoints(time1,price1,time2,price2,time3,price3);
//--- 重置错误的值
   ResetLastError();
//--- 由给定坐标创建椭圆形
   if(!ObjectCreate(chart_ID,name,OBJ_ELLIPSE,sub_window,time1,price1,time2,price2,time3,price3))
     {
      Print(__FUNCTION__,
            &quot;: failed to create an ellipse! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 设置椭圆形颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//--- 设置椭圆形线条风格
   ObjectSetInteger(chart_ID,name,OBJPROP_STYLE,style);
//--- 设置椭圆形线条的宽度
   ObjectSetInteger(chart_ID,name,OBJPROP_WIDTH,width);
//--- 启用 (true) 或禁用 (false) 填充椭圆形的模式
   ObjectSetInteger(chart_ID,name,OBJPROP_FILL,fill);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 突出椭圆形移动的模式
//--- 当使用ObjectCreate函数创建图形对象时，对象不能
//--- 默认下突出并移动。在这个方法中，默认选择参数
//--- true 可以突出移动对象
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动椭圆形定位点                                                   |
//+------------------------------------------------------------------+
bool EllipsePointChange(const long   chart_ID=0,     // 图表ID
                        const string name=&quot;Ellipse&quot;, // 椭圆形名称
                        const int    point_index=0,  // 定位点指数
                        datetime     time=0,         // 定位点时间坐标
                        double       price=0)        // 定位点价格坐标
  {
//--- 如果没有设置点的位置，则将其移动到当前的卖价柱
   if(!time)
      time=TimeCurrent();
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 重置错误的值
   ResetLastError();
//--- 移动定位点
   if(!ObjectMove(chart_ID,name,point_index,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to move the anchor point! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 删除椭圆形                                                        |
//+------------------------------------------------------------------+
bool EllipseDelete(const long   chart_ID=0,     // 图表 ID
                   const string name=&quot;Ellipse&quot;) // 椭圆形名称
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除椭圆形
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete an ellipse! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 检查椭圆形定位点的值和为空点设置                                      |
//| 默认的值                                                          |
//+------------------------------------------------------------------+
void ChangeEllipseEmptyPoints(datetime &amp;time1,double &amp;price1,
                              datetime &amp;time2,double &amp;price2,
                              datetime &amp;time3,double &amp;price3)
  {
//--- 如果第一点的时间没有设置，它将位于当前柱
   if(!time1)
      time1=TimeCurrent();
//--- 如果第一点的价格没有设置，则它将用卖价值
   if(!price1)
      price1=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 如果第二点的时间没有设置，它则位于第二点左侧的9个柱
   if(!time2)
     {
      //--- 接收最近10柱开盘时间的数组
      datetime temp[10];
      CopyTime(Symbol(),Period(),time1,10,temp);
      //--- 在第一点左侧9柱设置第二点
      time2=temp[0];
     }
//--- 如果第二个点的价格没有设置，则低于第一个点移动300点
   if(!price2)
      price2=price1-300*SymbolInfoDouble(Symbol(),SYMBOL_POINT);
//--- 如果第三个点的时间没有设置，则它与第二个点的日期相一致
   if(!time3)
      time3=time2;
//--- 如果第三点的价格没有设置，则它与第一点的价格相等
   if(!price3)
      price3=price1;
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 检查输入参数的正确性
   if(InpDate1&lt;0 || InpDate1&gt;100 || InpPrice1&lt;0 || InpPrice1&gt;100 ||
      InpDate2&lt;0 || InpDate2&gt;100 || InpPrice2&lt;0 || InpPrice2&gt;100 ||
      InpDate3&lt;0 || InpDate3&gt;100 || InpPrice3&lt;0 || InpPrice3&gt;100)
     {
      Print(&quot;Error! Incorrect values of input parameters!&quot;);
      return;
     }
//--- 图表窗口的可见柱的数量
   int bars=(int)ChartGetInteger(0,CHART_VISIBLE_BARS);
//--- 价格数组大小
   int accuracy=1000;
//--- 存储要使用的日期和价格值的数组
//---设置和改变椭圆形定位点的坐标
   datetime date[];
   double   price[];
//--- 内存分配
   ArrayResize(date,bars);
   ArrayResize(price,accuracy);
//--- 填写日期数组
   ResetLastError();
   if(CopyTime(Symbol(),Period(),0,bars,date)==-1)
     {
      Print(&quot;Failed to copy time values! Error code = &quot;,GetLastError());
      return;
     }
//--- 填写价格数组
//--- 找出图表的最高值和最低值
   double max_price=ChartGetDouble(0,CHART_PRICE_MAX);
   double min_price=ChartGetDouble(0,CHART_PRICE_MIN);
//--- 定义变化的价格并填写该数组
   double step=(max_price-min_price)/accuracy;
   for(int i=0;i&lt;accuracy;i++)
      price[i]=min_price+i*step;
//--- 定义绘制椭圆形的点
   int d1=InpDate1*(bars-1)/100;
   int d2=InpDate2*(bars-1)/100;
   int d3=InpDate3*(bars-1)/100;
   int p1=InpPrice1*(accuracy-1)/100;
   int p2=InpPrice2*(accuracy-1)/100;
   int p3=InpPrice3*(accuracy-1)/100;
//--- 创建椭圆形
   if(!EllipseCreate(0,InpName,0,date[d1],price[p1],date[d2],price[p2],date[d3],price[p3],
      InpColor,InpStyle,InpWidth,InpFill,InpBack,InpSelection,InpHidden,InpZOrder))
     {
      return;
     }
//--- 重画图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- 现在，移动椭圆形定位点
//--- 循环计数器
   int v_steps=accuracy/5;
//--- 移动第一个和第二个定位点
   for(int i=0;i&lt;v_steps;i++)
     {
      //--- 使用下面的值
      if(p1&lt;accuracy-1)
         p1+=1;
      if(p2&gt;1)
         p2-=1;
      //--- 切换点
      if(!EllipsePointChange(0,InpName,0,date[d1],price[p1]))
         return;
      if(!EllipsePointChange(0,InpName,1,date[d2],price[p2]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 循环计数器
   int h_steps=bars/5;
//--- 移动第三个定位点
   for(int i=0;i&lt;h_steps;i++)
     {
      //--- 使用下面的值
      if(d3&gt;1)
         d3-=1;
      //--- 移动点
      if(!EllipsePointChange(0,InpName,2,date[d3],price[p3]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
      // 0.05 秒延迟
      Sleep(50);
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 从图表删除椭圆形
   EllipseDelete(0,InpName);
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br></div></div><h4 id="_2-2-1-25-obj-arrow-thumb-up拇指向上符号"><a href="#_2-2-1-25-obj-arrow-thumb-up拇指向上符号" class="header-anchor">#</a> 2.2.1.25 OBJ_ARROW_THUMB_UP拇指向上符号</h4> <p><img src="/mql5yao/assets/img/sec24.d01f6c67.png" alt="Alt text"></p> <p>ObjArrowTumbUp</p> <p>注意</p> <p>相对于符号的定位点位置可以从ENUM_ARROW_ANCHOR 枚举 值中选择。</p> <p>在MetaEditor中编写代码时，大型符号（大于5）只能通过设置适当的OBJPROP_WIDTH属性值来创建。</p> <p>示例</p> <p>下面的脚本创建和移动图表上的椭圆形。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 描述
#property description &quot;Script draws \&quot;Thumbs Up\&quot; sign.&quot;
#property description &quot;Anchor point coordinate is set in percentage of&quot;
#property description &quot;the chart window size.&quot;
//--- 启动脚本期间显示输入参数的窗口
#property script_show_inputs
//--- 脚本的输入参数
input string            InpName=&quot;ThumbUp&quot;;    // 符号名称
input int               InpDate=75;           // 定位点日期在%
input int               InpPrice=25;          // 定位点价格在 %
input ENUM_ARROW_ANCHOR InpAnchor=ANCHOR_TOP; // 定位类型
input color             InpColor=clrRed;      // 符号颜色
input ENUM_LINE_STYLE   InpStyle=STYLE_DOT;   // 边界线条风格
input int               InpWidth=5;           // 符号大小
input bool              InpBack=false;        // 背景符号
input bool              InpSelection=true;    // 突出移动
input bool              InpHidden=true;       // 隐藏对象列表中
input long              InpZOrder=0;          // 鼠标单击优先
//+------------------------------------------------------------------+
//| 创建拇指向上符号                                                   |
//+------------------------------------------------------------------+
bool ArrowThumbUpCreate(const long              chart_ID=0,           // 图表 ID
                        const string            name=&quot;ThumbUp&quot;,       // 符号名称
                        const int               sub_window=0,         // 子窗口指数
                        datetime                time=0,               // 定位点时间
                        double                  price=0,              // 定位点价格
                        const ENUM_ARROW_ANCHOR anchor=ANCHOR_BOTTOM, // 定位类型
                        const color             clr=clrRed,           // 符号颜色
                        const ENUM_LINE_STYLE   style=STYLE_SOLID,    // 边界线条风格
                        const int               width=3,              // 符号大小
                        const bool              back=false,           // 在背景中
                        const bool              selection=true,       // 突出移动
                        const bool              hidden=true,          // 隐藏在对象列表
                        const long              z_order=0)            // 鼠标单击优先
  {
//--- 若未设置则设置定位点的坐标
   ChangeArrowEmptyPoint(time,price);
//--- 重置错误的值
   ResetLastError();
//--- 创建符号
   if(!ObjectCreate(chart_ID,name,OBJ_ARROW_THUMB_UP,sub_window,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to create \&quot;Thumbs Up\&quot; sign! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 设置定位类型
   ObjectSetInteger(chart_ID,name,OBJPROP_ANCHOR,anchor);
//--- 设置符号颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//--- 设置边界线条风格
   ObjectSetInteger(chart_ID,name,OBJPROP_STYLE,style);
//--- 设置符号大小
   ObjectSetInteger(chart_ID,name,OBJPROP_WIDTH,width);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 通过鼠标移动符号的模式
//--- 当使用ObjectCreate函数创建图形对象时，对象不能
//--- 默认下突出并移动。在这个方法中，默认选择参数
//--- true 可以突出移动对象
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动定位点                                                        |
//+------------------------------------------------------------------+
bool ArrowThumbUpMove(const long   chart_ID=0,     // 图表 ID
                      const string name=&quot;ThumbUp&quot;, // 对象名称
                      datetime     time=0,         // 定位点时间坐标
                      double       price=0)        // 定位点价格坐标
  {
//--- 如果没有设置点的位置，则将其移动到当前的卖价柱
   if(!time)
      time=TimeCurrent();
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 重置错误的值
   ResetLastError();
//--- 移动定位点
   if(!ObjectMove(chart_ID,name,0,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to move the anchor point! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 改变拇指向上符号定位类型                                            |
//+------------------------------------------------------------------+
bool ArrowThumbUpAnchorChange(const long              chart_ID=0,        // 图表 ID
                              const string            name=&quot;ThumbUp&quot;,    // 对象名称
                              const ENUM_ARROW_ANCHOR anchor=ANCHOR_TOP) // 定位类型
  {
//--- 重置错误的值
   ResetLastError();
//--- 改变定位类型
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_ANCHOR,anchor))
     {
      Print(__FUNCTION__,
            &quot;: failed to change anchor type! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 删除拇指向上符号                                                   |
//+------------------------------------------------------------------+
bool ArrowThumbUpDelete(const long   chart_ID=0,     // 图表 ID
                        const string name=&quot;ThumbUp&quot;) // 符号名称
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除符号
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete \&quot;Thumbs Up\&quot; sign! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 检查定位点的值和为空点设置                                           |
//| 默认的值                                                          |
//+------------------------------------------------------------------+
void ChangeArrowEmptyPoint(datetime &amp;time,double &amp;price)
  {
//--- 如果点的时间没有设置，它将位于当前柱
   if(!time)
      time=TimeCurrent();
//--- 如果点的价格没有设置，则它将用卖价值
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 检查输入参数的正确性
   if(InpDate&lt;0 || InpDate&gt;100 || InpPrice&lt;0 || InpPrice&gt;100)
     {
      Print(&quot;Error! Incorrect values of input parameters!&quot;);
      return;
     }
//--- 图表窗口的可见柱的数量
   int bars=(int)ChartGetInteger(0,CHART_VISIBLE_BARS);
//--- 价格数组大小
   int accuracy=1000;
//--- 存储要使用的日期和价格值的数组
//--- 设置和改变符号定位点的坐标
   datetime date[];
   double   price[];
//--- 内存分配
   ArrayResize(date,bars);
   ArrayResize(price,accuracy);
//--- 填写日期数组
   ResetLastError();
   if(CopyTime(Symbol(),Period(),0,bars,date)==-1)
     {
      Print(&quot;Failed to copy time values! Error code = &quot;,GetLastError());
      return;
     }
//--- 填写价格数组
//--- 找出图表的最高值和最低值
   double max_price=ChartGetDouble(0,CHART_PRICE_MAX);
   double min_price=ChartGetDouble(0,CHART_PRICE_MIN);
//--- 定义变化的价格并填写该数组
   double step=(max_price-min_price)/accuracy;
   for(int i=0;i&lt;accuracy;i++)
      price[i]=min_price+i*step;
//--- 定义绘制符号的点
   int d=InpDate*(bars-1)/100;
   int p=InpPrice*(accuracy-1)/100;
//--- 在图表创建拇指向上符号
   if(!ArrowThumbUpCreate(0,InpName,0,date[d],price[p],InpAnchor,InpColor,
      InpStyle,InpWidth,InpBack,InpSelection,InpHidden,InpZOrder))
     {
      return;
     }
//--- 重画图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- 现在，移动定位点和改变其相对于符号的位置
//--- 循环计数器
   int h_steps=bars/4;
//--- 移动定位点
   for(int i=0;i&lt;h_steps;i++)
     {
      //--- 使用下面的值
      if(d&gt;1)
         d-=1;
      //--- 移动点
      if(!ArrowThumbUpMove(0,InpName,date[d],price[p]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
      // 0.05 秒延迟
      Sleep(50);
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 循环计数器
   int v_steps=accuracy/4;
//--- 移动定位点
   for(int i=0;i&lt;v_steps;i++)
     {
      //--- 使用下面的值
      if(p&lt;accuracy-1)
         p+=1;
      //--- 移动点
      if(!ArrowThumbUpMove(0,InpName,date[d],price[p]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 改变定位点相对于符号的位置
   ArrowThumbUpAnchorChange(0,InpName,ANCHOR_BOTTOM);
//--- 重画图表
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//--- 删除图表符号
   ArrowThumbUpDelete(0,InpName);
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br></div></div><h4 id="_2-2-1-26-obj-arrow-thumb-down拇指向下符号"><a href="#_2-2-1-26-obj-arrow-thumb-down拇指向下符号" class="header-anchor">#</a> 2.2.1.26 OBJ_ARROW_THUMB_DOWN拇指向下符号</h4> <p><img src="/mql5yao/assets/img/sec25.a912eed0.png" alt="Alt text"></p> <p>ObjArrowTumbDown</p> <p>注意</p> <p>相对于符号的定位点位置可以从ENUM_ARROW_ANCHOR 枚举值中选择。</p> <p>在MetaEditor中编写代码时，大型符号（大于5）只能通过设置适当的OBJPROP_WIDTH属性值来创建。</p> <p>示例</p> <p>下面的脚本创建和移动图表上的拇指向下符号。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 描述
#property description &quot;Script draws \&quot;Thumbs Down\&quot; sign.&quot;
#property description &quot;Anchor point coordinate is set in percentage of&quot;
#property description &quot;the chart window size.&quot;
//--- 启动脚本期间显示输入参数的窗口
#property script_show_inputs
//--- 脚本的输入参数
input string            InpName=&quot;ThumbDown&quot;;     // 符号名称
input int               InpDate=25;              // 定位点日期在%
input int               InpPrice=75;             // 定位点价格在 %
input ENUM_ARROW_ANCHOR InpAnchor=ANCHOR_BOTTOM; // 定位类型
input color             InpColor=clrRed;         // 符号颜色
input ENUM_LINE_STYLE   InpStyle=STYLE_DOT;      // 边界线条风格
input int               InpWidth=5;              // 符号大小
input bool              InpBack=false;           // 背景符号
input bool              InpSelection=true;       // 突出移动
input bool              InpHidden=true;          // 隐藏对象列表中
input long              InpZOrder=0;             // 鼠标单击优先
//+------------------------------------------------------------------+
//| 创建拇指向下符号                                                   |
//+------------------------------------------------------------------+
bool ArrowThumbDownCreate(const long              chart_ID=0,           // 图表 ID
                          const string            name=&quot;ThumbDown&quot;,     // 符号名称
                          const int               sub_window=0,         // 子窗口指数
                          datetime                time=0,               // 定位点时间
                          double                  price=0,              // 定位点价格
                          const ENUM_ARROW_ANCHOR anchor=ANCHOR_BOTTOM, // 定位类型
                          const color             clr=clrRed,           // 符号颜色
                          const ENUM_LINE_STYLE   style=STYLE_SOLID,    // 边界线条风格
                          const int               width=3,              // 符号大小
                          const bool              back=false,           // 背景中
                          const bool              selection=true,       // 突出移动
                          const bool              hidden=true,          // 隐藏在对象列表
                          const long              z_order=0)            // 鼠标单击优先
  {
//--- 若未设置则设置定位点的坐标
   ChangeArrowEmptyPoint(time,price);
//--- 重置错误的值
   ResetLastError();
//--- 创建符号
   if(!ObjectCreate(chart_ID,name,OBJ_ARROW_THUMB_DOWN,sub_window,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to create \&quot;Thumbs Down\&quot; sign! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 设置定位类型
   ObjectSetInteger(chart_ID,name,OBJPROP_ANCHOR,anchor);
//--- 设置符号颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//--- 设置边界线条风格
   ObjectSetInteger(chart_ID,name,OBJPROP_STYLE,style);
//--- 设置符号大小
   ObjectSetInteger(chart_ID,name,OBJPROP_WIDTH,width);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 通过鼠标移动符号的模式
//--- 当使用ObjectCreate函数创建图形对象时，对象不能
//--- 默认下突出并移动。在这个方法中，默认选择参数
//--- true 可以突出移动对象
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动定位点                                                        |
//+------------------------------------------------------------------+
bool ArrowThumbDownMove(const long   chart_ID=0,       // 图表 ID
                        const string name=&quot;ThumbDown&quot;, // 对象名称
                        datetime     time=0,           // 定位点时间坐标
                        double       price=0)          // 定位点价格坐标
  {
//--- 如果没有设置点的位置，则将其移动到当前的卖价柱
   if(!time)
      time=TimeCurrent();
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 重置错误的值
   ResetLastError();
//--- 移动定位点
   if(!ObjectMove(chart_ID,name,0,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to move the anchor point! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 改变手指向下符号定位类型                                            |
//+------------------------------------------------------------------+
bool ArrowThumbDownAnchorChange(const long              chart_ID=0,        // 图表 ID
                                const string            name=&quot;ThumbDown&quot;,  // 对象名称
                                const ENUM_ARROW_ANCHOR anchor=ANCHOR_TOP) // 定位类型
  {
//--- 重置错误的值
   ResetLastError();
//--- 改变定位类型
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_ANCHOR,anchor))
     {
      Print(__FUNCTION__,
            &quot;: failed to change anchor type! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 删除拇指向下符号                                                   |
//+------------------------------------------------------------------+
bool ArrowThumbDownDelete(const long   chart_ID=0,       // 图表 ID
                          const string name=&quot;ThumbDown&quot;) // 符号名称
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除符号
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete \&quot;Thumbs Down\&quot; sign! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 检查定位点的值和为空点设置                                           |
//| 默认的值                                                          |
//+------------------------------------------------------------------+
void ChangeArrowEmptyPoint(datetime &amp;time,double &amp;price)
  {
//--- 如果点的时间没有设置，它将位于当前柱
   if(!time)
      time=TimeCurrent();
//--- 如果点的价格没有设置，则它将用卖价值
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 检查输入参数的正确性
   if(InpDate&lt;0 || InpDate&gt;100 || InpPrice&lt;0 || InpPrice&gt;100)
     {
      Print(&quot;Error! Incorrect values of input parameters!&quot;);
      return;
     }
//--- 图表窗口的可见柱的数量
   int bars=(int)ChartGetInteger(0,CHART_VISIBLE_BARS);
//--- 价格数组大小
   int accuracy=1000;
//--- 存储要使用的日期和价格值的数组
//--- 设置和改变符号定位点的坐标
   datetime date[];
   double   price[];
//--- 内存分配
   ArrayResize(date,bars);
   ArrayResize(price,accuracy);
//--- 填写日期数组
   ResetLastError();
   if(CopyTime(Symbol(),Period(),0,bars,date)==-1)
     {
      Print(&quot;Failed to copy time values! Error code = &quot;,GetLastError());
      return;
     }
//--- 填写价格数组
//--- 找出图表的最高值和最低值
   double max_price=ChartGetDouble(0,CHART_PRICE_MAX);
   double min_price=ChartGetDouble(0,CHART_PRICE_MIN);
//--- 定义变化的价格并填写该数组
   double step=(max_price-min_price)/accuracy;
   for(int i=0;i&lt;accuracy;i++)
      price[i]=min_price+i*step;
//--- 定义绘制符号的点
   int d=InpDate*(bars-1)/100;
   int p=InpPrice*(accuracy-1)/100;
//--- 在图表上创建拇指向下符号
   if(!ArrowThumbDownCreate(0,InpName,0,date[d],price[p],InpAnchor,InpColor,
      InpStyle,InpWidth,InpBack,InpSelection,InpHidden,InpZOrder))
     {
      return;
     }
//--- 重画图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- 现在，移动定位点和改变其相对于符号的位置
//--- 循环计数器
   int h_steps=bars/4;
//--- 移动定位点
   for(int i=0;i&lt;h_steps;i++)
     {
      //--- 使用下面的值
      if(d&lt;bars-1)
         d+=1;
      //--- 移动点
      if(!ArrowThumbDownMove(0,InpName,date[d],price[p]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
      // 0.05 秒延迟
      Sleep(50);
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 循环计数器
   int v_steps=accuracy/4;
//--- 移动定位点
   for(int i=0;i&lt;v_steps;i++)
     {
      //--- 使用下面的值
      if(p&gt;1)
         p-=1;
      //--- 移动点
      if(!ArrowThumbDownMove(0,InpName,date[d],price[p]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 改变定位点相对于符号的位置
   ArrowThumbDownAnchorChange(0,InpName,ANCHOR_TOP);
//--- 重画图表
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//--- 删除图表符号
   ArrowThumbDownDelete(0,InpName);
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br></div></div><h4 id="_2-2-1-27-obj-arrow-up箭头向上符号"><a href="#_2-2-1-27-obj-arrow-up箭头向上符号" class="header-anchor">#</a> 2.2.1.27 OBJ_ARROW_UP箭头向上符号</h4> <p><img src="/mql5yao/assets/img/sec26.aafb6cda.png" alt="Alt text"></p> <p>ObjArrowUp</p> <p>注意</p> <p>相对于符号的定位点位置可以从ENUM_ARROW_ANCHOR 枚举值中选择。</p> <p>在MetaEditor中编写代码时，大型符号（大于5）只能通过设置适当的OBJPROP_WIDTH属性值来创建。</p> <p>示例</p> <p>下面的脚本创建和移动图表上的箭头向上符号。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 描述
#property description &quot;Script draws \&quot;Arrow Up\&quot; sign.&quot;
#property description &quot;Anchor point coordinate is set in&quot;
#property description &quot;percentage of the chart window size.&quot;
//--- 启动脚本期间显示输入参数的窗口
#property script_show_inputs
//--- 脚本的输入参数
input string            InpName=&quot;ArrowUp&quot;;    // 符号名称
input int               InpDate=25;           // 定位点日期在%
input int               InpPrice=25;          // 定位点价格在 %
input ENUM_ARROW_ANCHOR InpAnchor=ANCHOR_TOP; // 定位类型
input color             InpColor=clrRed;      // 符号颜色
input ENUM_LINE_STYLE   InpStyle=STYLE_DOT;   // 边界线条风格
input int               InpWidth=5;           // 符号大小
input bool              InpBack=false;        // 背景符号
input bool              InpSelection=false;   // 突出移动
input bool              InpHidden=true;       // 隐藏对象列表中
input long              InpZOrder=0;          // 鼠标单击优先
//+------------------------------------------------------------------+
//| 创建箭头向上符号                                                   |
//+------------------------------------------------------------------+
bool ArrowUpCreate(const long              chart_ID=0,           // 图表 ID
                   const string            name=&quot;ArrowUp&quot;,       // 符号名称
                   const int               sub_window=0,         // 子窗口指数
                   datetime                time=0,               // 定位点时间
                   double                  price=0,              // 定位点价格
                   const ENUM_ARROW_ANCHOR anchor=ANCHOR_BOTTOM, // 定位类型
                   const color             clr=clrRed,           // 符号颜色
                   const ENUM_LINE_STYLE   style=STYLE_SOLID,    // 边界线条风格
                   const int               width=3,              // 符号大小
                   const bool              back=false,           // 在背景中
                   const bool              selection=true,       // 突出移动
                   const bool              hidden=true,          // 隐藏在对象列表
                   const long              z_order=0)            // 鼠标单击优先
  {
//--- 若未设置则设置定位点的坐标
   ChangeArrowEmptyPoint(time,price);
//--- 重置错误的值
   ResetLastError();
//--- 创建符号
   if(!ObjectCreate(chart_ID,name,OBJ_ARROW_UP,sub_window,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to create \&quot;Arrow Up\&quot; sign! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 设置定位类型
   ObjectSetInteger(chart_ID,name,OBJPROP_ANCHOR,anchor);
//--- 设置符号颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//--- 设置边界线条风格
   ObjectSetInteger(chart_ID,name,OBJPROP_STYLE,style);
//--- 设置符号大小
   ObjectSetInteger(chart_ID,name,OBJPROP_WIDTH,width);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 通过鼠标移动符号的模式
//--- 当使用ObjectCreate函数创建图形对象时，对象不能
//--- 默认下突出并移动。在这个方法中，默认选择参数
//--- true 可以突出移动对象
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动定位点                                                        |
//+------------------------------------------------------------------+
bool ArrowUpMove(const long   chart_ID=0,     // 图表 ID
                 const string name=&quot;ArrowUp&quot;, // 对象名称
                 datetime     time=0,         // 定位点时间坐标
                 double       price=0)        // 定位点价格坐标
  {
//--- 如果没有设置点的位置，则将其移动到当前的卖价柱
   if(!time)
      time=TimeCurrent();
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 重置错误的值
   ResetLastError();
//--- 移动定位点
   if(!ObjectMove(chart_ID,name,0,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to move the anchor point! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 改变箭头向下符号定位类型                                            |
//+------------------------------------------------------------------+
bool ArrowUpAnchorChange(const long              chart_ID=0,        // 图表 ID
                         const string            name=&quot;ArrowUp&quot;,    // 对象名称
                         const ENUM_ARROW_ANCHOR anchor=ANCHOR_TOP) // 定位类型
  {
//--- 重置错误的值
   ResetLastError();
//--- 改变定位点位置
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_ANCHOR,anchor))
     {
      Print(__FUNCTION__,
            &quot;: failed to change anchor type! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 删除箭头向上符号                                                   |
//+------------------------------------------------------------------+
bool ArrowUpDelete(const long   chart_ID=0,     // 图表 ID
                   const string name=&quot;ArrowUp&quot;) // 符号名称
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除符号
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete \&quot;Arrow Up\&quot; sign! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 检查定位点的值和为空点设置                                           |
//| 默认的值                                                          |
//+------------------------------------------------------------------+
void ChangeArrowEmptyPoint(datetime &amp;time,double &amp;price)
  {
//--- 如果点的时间没有设置，它将位于当前柱
   if(!time)
      time=TimeCurrent();
//--- 如果点的价格没有设置，则它将用卖价值
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 检查输入参数的正确性
   if(InpDate&lt;0 || InpDate&gt;100 || InpPrice&lt;0 || InpPrice&gt;100)
     {
      Print(&quot;Error! Incorrect values of input parameters!&quot;);
      return;
     }
//--- 图表窗口的可见柱的数量
   int bars=(int)ChartGetInteger(0,CHART_VISIBLE_BARS);
//--- 价格数组大小
   int accuracy=1000;
//--- 存储要使用的日期和价格值的数组
//--- 设置和改变符号定位点的坐标
   datetime date[];
   double   price[];
//--- 内存分配
   ArrayResize(date,bars);
   ArrayResize(price,accuracy);
//--- 填写日期数组
   ResetLastError();
   if(CopyTime(Symbol(),Period(),0,bars,date)==-1)
     {
      Print(&quot;Failed to copy time values! Error code = &quot;,GetLastError());
      return;
     }
//--- 填写价格数组
//--- 找出图表的最高值和最低值
   double max_price=ChartGetDouble(0,CHART_PRICE_MAX);
   double min_price=ChartGetDouble(0,CHART_PRICE_MIN);
//--- 定义变化的价格并填写该数组
   double step=(max_price-min_price)/accuracy;
   for(int i=0;i&lt;accuracy;i++)
      price[i]=min_price+i*step;
//--- 定义绘制符号的点
   int d=InpDate*(bars-1)/100;
   int p=InpPrice*(accuracy-1)/100;
//--- 在图表创建箭头向上符号
   if(!ArrowUpCreate(0,InpName,0,date[d],price[p],InpAnchor,InpColor,
      InpStyle,InpWidth,InpBack,InpSelection,InpHidden,InpZOrder))
     {
      return;
     }
//--- 重画图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- 现在，移动定位点和改变其相对于符号的位置
//--- 循环计数器
   int v_steps=accuracy/2;
//--- 移动定位点
   for(int i=0;i&lt;v_steps;i++)
     {
      //--- 使用下面的值
      if(p&lt;accuracy-1)
         p+=1;
      //--- 移动点
      if(!ArrowUpMove(0,InpName,date[d],price[p]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 改变定位点相对于符号的位置
   ArrowUpAnchorChange(0,InpName,ANCHOR_BOTTOM);
//--- 重画图表
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//--- 删除图表符号
   ArrowUpDelete(0,InpName);
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br></div></div><h4 id="_2-2-1-28-obj-arrow-down箭头向下符号"><a href="#_2-2-1-28-obj-arrow-down箭头向下符号" class="header-anchor">#</a> 2.2.1.28 OBJ_ARROW_DOWN箭头向下符号</h4> <p><img src="/mql5yao/assets/img/sec27.a065da03.png" alt="Alt text"></p> <p>ObjArrowDown</p> <p>注意</p> <p>相对于符号的定位点位置可以从ENUM_ARROW_ANCHOR 枚举值中选择。</p> <p>在MetaEditor中编写代码时，大型符号（大于5）只能通过设置适当的OBJPROP_WIDTH属性值来创建。</p> <p>示例</p> <p>下面的脚本创建和移动图表上的箭头向下符号。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 描述
#property description &quot;Script draws \&quot;Arrow Down\&quot; sign.&quot;
#property description &quot;Anchor point coordinate is set in&quot;
#property description &quot;percentage of the chart window size.&quot;
//--- 启动脚本期间显示输入参数的窗口
#property script_show_inputs
//--- 脚本的输入参数
input string            InpName=&quot;ArrowDown&quot;;     // 符号名称
input int               InpDate=75;              // 定位点日期在 %
input int               InpPrice=75;             // 定位点价格在 %
input ENUM_ARROW_ANCHOR InpAnchor=ANCHOR_BOTTOM; // 定位类型
input color             InpColor=clrRed;         // 符号颜色
input ENUM_LINE_STYLE   InpStyle=STYLE_DOT;      // 边界线条风格
input int               InpWidth=5;              // 符号大小
input bool              InpBack=false;           // 背景符号
input bool              InpSelection=false;      // 突出移动
input bool              InpHidden=true;          // 隐藏对象列表中
input long              InpZOrder=0;             // 鼠标单击优先
//+------------------------------------------------------------------+
//| 创建箭头向下符号                                                   |
//+------------------------------------------------------------------+
bool ArrowDownCreate(const long              chart_ID=0,           // 图表 ID
                     const string            name=&quot;ArrowDown&quot;,     // 符号名称
                     const int               sub_window=0,         // 子窗口指数
                     datetime                time=0,               // 定位点时间
                     double                  price=0,              // 定位点价格
                     const ENUM_ARROW_ANCHOR anchor=ANCHOR_BOTTOM, // 定位类型
                     const color             clr=clrRed,           // 符号颜色
                     const ENUM_LINE_STYLE   style=STYLE_SOLID,    // 边界线条风格
                     const int               width=3,              // 符号大小
                     const bool              back=false,           // 在背景中
                     const bool              selection=true,       // 突出移动
                     const bool              hidden=true,          // 隐藏在对象列表
                     const long              z_order=0)            // 鼠标单击优先
  {
//--- 若未设置则设置定位点的坐标
   ChangeArrowEmptyPoint(time,price);
//--- 重置错误的值
   ResetLastError();
//--- 创建符号
   if(!ObjectCreate(chart_ID,name,OBJ_ARROW_DOWN,sub_window,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to create \&quot;Arrow Down\&quot; sign! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 定位类型
   ObjectSetInteger(chart_ID,name,OBJPROP_ANCHOR,anchor);
//--- 设置符号颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//--- 设置边界线条风格
   ObjectSetInteger(chart_ID,name,OBJPROP_STYLE,style);
//--- 设置符号大小
   ObjectSetInteger(chart_ID,name,OBJPROP_WIDTH,width);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 通过鼠标移动符号的模式
//--- 当使用ObjectCreate函数创建图形对象时，对象不能
//--- 默认下突出并移动。在这个方法中，默认选择参数
//--- true 可以突出移动对象
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动定位点                                                        |
//+------------------------------------------------------------------+
bool ArrowDownMove(const long   chart_ID=0,       // 图表 ID
                   const string name=&quot;ArrowDown&quot;, // 对象名称
                   datetime     time=0,           // 定位点时间坐标
                   double       price=0)          // 定位点价格坐标
  {
//--- 如果没有设置点的位置，则将其移动到当前的卖价柱
   if(!time)
      time=TimeCurrent();
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 重置错误的值
   ResetLastError();
//--- 移动定位点
   if(!ObjectMove(chart_ID,name,0,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to move the anchor point! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 改变箭头向下符号定位类型                                            |
//+------------------------------------------------------------------+
bool ArrowDownAnchorChange(const long              chart_ID=0,        // 图表 ID
                           const string            name=&quot;ArrowDown&quot;,  // 对象名称
                           const ENUM_ARROW_ANCHOR anchor=ANCHOR_TOP) // 定位类型
  {
//--- 重置错误的值
   ResetLastError();
//--- 改变定位点位置
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_ANCHOR,anchor))
     {
      Print(__FUNCTION__,
            &quot;: failed to change anchor type! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 删除箭头向下符号                                                   |
//+------------------------------------------------------------------+
bool ArrowDownDelete(const long   chart_ID=0,       // 图表 ID
                     const string name=&quot;ArrowDown&quot;) // 符号名称
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除符号
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete \&quot;Arrow Down\&quot; sign! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 检查定位点的值和为空点设置                                          |
//| 默认的值                                                          |
//+------------------------------------------------------------------+
void ChangeArrowEmptyPoint(datetime &amp;time,double &amp;price)
  {
//--- 如果点的时间没有设置，它将位于当前柱
   if(!time)
      time=TimeCurrent();
//--- 如果点的价格没有设置，则它将用卖价值
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 检查输入参数的正确性
   if(InpDate&lt;0 || InpDate&gt;100 || InpPrice&lt;0 || InpPrice&gt;100)
     {
      Print(&quot;Error! Incorrect values of input parameters!&quot;);
      return;
     }
//--- 图表窗口的可见柱的数量
   int bars=(int)ChartGetInteger(0,CHART_VISIBLE_BARS);
//--- 价格数组大小
   int accuracy=1000;
//--- 存储要使用的日期和价格值的数组
//--- 设置和改变符号定位点的坐标
   datetime date[];
   double   price[];
//--- 内存分配
   ArrayResize(date,bars);
   ArrayResize(price,accuracy);
//--- 填写日期数组
   ResetLastError();
   if(CopyTime(Symbol(),Period(),0,bars,date)==-1)
     {
      Print(&quot;Failed to copy time values! Error code = &quot;,GetLastError());
      return;
     }
//--- 填写价格数组
//--- 找出图表的最高值和最低值
   double max_price=ChartGetDouble(0,CHART_PRICE_MAX);
   double min_price=ChartGetDouble(0,CHART_PRICE_MIN);
//--- 定义变化的价格并填写该数组
   double step=(max_price-min_price)/accuracy;
   for(int i=0;i&lt;accuracy;i++)
      price[i]=min_price+i*step;
//--- 定义绘制符号的点
   int d=InpDate*(bars-1)/100;
   int p=InpPrice*(accuracy-1)/100;
//--- 在图表创建箭头向下符号
   if(!ArrowDownCreate(0,InpName,0,date[d],price[p],InpAnchor,InpColor,
      InpStyle,InpWidth,InpBack,InpSelection,InpHidden,InpZOrder))
     {
      return;
     }
//--- 重画图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- 现在，移动定位点和改变其相对于符号的位置
//--- 循环计数器
   int v_steps=accuracy/2;
//--- 移动定位点
   for(int i=0;i&lt;v_steps ;i++)
     {
      //--- 使用下面的值
      if(p&gt;1)
         p-=1;
      //--- 移动点
      if(!ArrowDownMove(0,InpName,date[d],price[p]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 改变定位点相对于符号的位置
   ArrowDownAnchorChange(0,InpName,ANCHOR_TOP);
//--- 重画图表
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//--- 删除图表符号
   ArrowDownDelete(0,InpName);
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br></div></div><h4 id="_2-2-1-29-obj-arrow-stop停止符号"><a href="#_2-2-1-29-obj-arrow-stop停止符号" class="header-anchor">#</a> 2.2.1.29 OBJ_ARROW_STOP停止符号</h4> <p><img src="/mql5yao/assets/img/sec28.b408e598.png" alt="Alt text"></p> <p>ObjArrowStop</p> <p>注意</p> <p>相对于符号的定位点位置可以从ENUM_ARROW_ANCHOR 枚举值中选择。</p> <p>在MetaEditor中编写代码时，大型符号（大于5）只能通过设置适当的OBJPROP_WIDTH属性值来创建。</p> <p>示例</p> <p>下面的脚本创建和移动图表上的停止符号。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 描述
#property description &quot;Script draws \&quot;Stop\&quot; sign.&quot;
#property description &quot;Anchor point coordinate is set in&quot;
#property description &quot;percentage of the chart window size.&quot;
//--- 启动脚本期间显示输入参数的窗口
#property script_show_inputs
//--- 脚本的输入参数
input string            InpName=&quot;ArrowStop&quot;;     // 符号名称
input int               InpDate=10;              // 定位点日期在 %
input int               InpPrice=50;             // 定位点价格在 %
input ENUM_ARROW_ANCHOR InpAnchor=ANCHOR_BOTTOM; // 定位类型
input color             InpColor=clrRed;         // 符号颜色
input ENUM_LINE_STYLE   InpStyle=STYLE_DOT;      // 边界线条风格
input int               InpWidth=5;              // 符号大小
input bool              InpBack=false;           // 背景符号
input bool              InpSelection=false;      // 突出移动
input bool              InpHidden=true;          // 隐藏对象列表中
input long              InpZOrder=0;             // 鼠标单击优先
//+------------------------------------------------------------------+
//| Create Stop sign                                                 |
//+------------------------------------------------------------------+
bool ArrowStopCreate(const long              chart_ID=0,           // 图表 ID
                     const string            name=&quot;ArrowStop&quot;,     // 符号名称
                     const int               sub_window=0,         // 子窗口指数
                     datetime                time=0,               // 定位点时间
                     double                  price=0,              // 定位点价格
                     const ENUM_ARROW_ANCHOR anchor=ANCHOR_BOTTOM, // 定位类型
                     const color             clr=clrRed,           // 符号颜色
                     const ENUM_LINE_STYLE   style=STYLE_SOLID,    // 边界线条风格
                     const int               width=3,              // 符号大小
                     const bool              back=false,           // 在背景中
                     const bool              selection=true,       // 突出移动
                     const bool              hidden=true,          // 隐藏在对象列表
                     const long              z_order=0)            // 鼠标单击优先
  {
//--- 若未设置则设置定位点的坐标
   ChangeArrowEmptyPoint(time,price);
//--- 重置错误的值
   ResetLastError();
//--- 创建符号
   if(!ObjectCreate(chart_ID,name,OBJ_ARROW_STOP,sub_window,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to create \&quot;Stop\&quot; sign! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 设置定位类型
   ObjectSetInteger(chart_ID,name,OBJPROP_ANCHOR,anchor);
//--- 设置符号颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//--- 设置边界线条风格
   ObjectSetInteger(chart_ID,name,OBJPROP_STYLE,style);
//--- 设置符号大小
   ObjectSetInteger(chart_ID,name,OBJPROP_WIDTH,width);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 通过鼠标移动符号的模式
//--- 当使用ObjectCreate函数创建图形对象时，对象不能
//--- 默认下突出并移动。在这个方法中，默认选择参数
//--- true 可以突出移动对象
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动定位点                                                        |
//+------------------------------------------------------------------+
bool ArrowStopMove(const long   chart_ID=0,       // 图表 ID
                   const string name=&quot;ArrowStop&quot;, // 对象名称
                   datetime     time=0,           // 定位点时间坐标
                   double       price=0)          // 定位点价格坐标
  {
//--- 如果没有设置点的位置，则将其移动到当前的卖价柱
   if(!time)
      time=TimeCurrent();
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 重置错误的值
   ResetLastError();
//--- 移动定位点
   if(!ObjectMove(chart_ID,name,0,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to move the anchor point! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 改变停止符号定位类型                                                |
//+------------------------------------------------------------------+
bool ArrowStopAnchorChange(const long              chart_ID=0,        // 图表 ID
                           const string            name=&quot;ArrowStop&quot;,  // 对象名称
                           const ENUM_ARROW_ANCHOR anchor=ANCHOR_TOP) // 定位点位置
  {
//--- 重置错误的值
   ResetLastError();
//--- 改变定位类型
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_ANCHOR,anchor))
     {
      Print(__FUNCTION__,
            &quot;: failed to change anchor type! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 删除停止符号                                                       |
//+------------------------------------------------------------------+
bool ArrowStopDelete(const long   chart_ID=0,       // 图表 ID
                     const string name=&quot;ArrowStop&quot;) // 标签名称
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除符号
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete \&quot;Stop\&quot; sign! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 检查定位点的值和为空点设置                                           |
//| 默认的值                                                          |
//+------------------------------------------------------------------+
void ChangeArrowEmptyPoint(datetime &amp;time,double &amp;price)
  {
//--- 如果点的时间没有设置，它将位于当前柱
   if(!time)
      time=TimeCurrent();
//--- 如果点的价格没有设置，则它将用卖价值
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 检查输入参数的正确性
   if(InpDate&lt;0 || InpDate&gt;100 || InpPrice&lt;0 || InpPrice&gt;100)
     {
      Print(&quot;Error! Incorrect values of input parameters!&quot;);
      return;
     }
//--- 图表窗口的可见柱的数量
   int bars=(int)ChartGetInteger(0,CHART_VISIBLE_BARS);
//--- 价格数组大小
   int accuracy=1000;
//--- 存储要使用的日期和价格值的数组
//--- 设置和改变符号定位点的坐标
   datetime date[];
   double   price[];
//--- 内存分配
   ArrayResize(date,bars);
   ArrayResize(price,accuracy);
//--- 填写日期数组
   ResetLastError();
   if(CopyTime(Symbol(),Period(),0,bars,date)==-1)
     {
      Print(&quot;Failed to copy time values! Error code = &quot;,GetLastError());
      return;
     }
//--- 填写价格数组
//--- 找出图表的最高值和最低值
   double max_price=ChartGetDouble(0,CHART_PRICE_MAX);
   double min_price=ChartGetDouble(0,CHART_PRICE_MIN);
//--- 定义变化的价格并填写该数组
   double step=(max_price-min_price)/accuracy;
   for(int i=0;i&lt;accuracy;i++)
      price[i]=min_price+i*step;
//--- 定义绘制符号的点
   int d=InpDate*(bars-1)/100;
   int p=InpPrice*(accuracy-1)/100;
//--- 在图表上创建停止符号
   if(!ArrowStopCreate(0,InpName,0,date[d],price[p],InpAnchor,InpColor,
      InpStyle,InpWidth,InpBack,InpSelection,InpHidden,InpZOrder))
     {
      return;
     }
//--- 重画图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- 现在，移动定位点和改变其相对于符号的位置
//--- 循环计数器
   int h_steps=bars*2/5;
//--- 移动定位点
   for(int i=0;i&lt;h_steps;i++)
     {
      //--- 使用下面的值
      if(d&lt;bars-1)
         d+=1;
      //--- 移动点
      if(!ArrowStopMove(0,InpName,date[d],price[p]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
      // 0.025 秒延迟
      Sleep(25);
     }
//--- 改变定位点相对于符号的位置
   ArrowStopAnchorChange(0,InpName,ANCHOR_TOP);
//--- 重画图表
   ChartRedraw();
//--- 循环计数器
   h_steps=bars*2/5;
//--- 移动定位点
   for(int i=0;i&lt;h_steps;i++)
     {
      //--- 使用下面的值
      if(d&lt;bars-1)
         d+=1;
      //--- 移动点
      if(!ArrowStopMove(0,InpName,date[d],price[p]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
      // 0.025 秒延迟
      Sleep(25);
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 删除图表符号
   ArrowStopDelete(0,InpName);
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br></div></div><h4 id="_2-2-1-30-obj-arrow-check查验符号"><a href="#_2-2-1-30-obj-arrow-check查验符号" class="header-anchor">#</a> 2.2.1.30 OBJ_ARROW_CHECK查验符号</h4> <p><img src="/mql5yao/assets/img/sec29.6b337809.png" alt="Alt text"></p> <p>ObjArrowCheck</p> <p>注意</p> <p>相对于符号的定位点位置可以从ENUM_ARROW_ANCHOR 枚举值中选择。</p> <p>在MetaEditor中编写代码时，大型符号（大于5）只能通过设置适当的OBJPROP_WIDTH属性值来创建。</p> <p>示例</p> <p>下面的脚本创建和移动图表上的查验符号。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 描述
#property description &quot;Script draws \&quot;Check\&quot; sign.&quot;
#property description &quot;Anchor point coordinate is set in&quot;
#property description &quot;percentage of the chart window size.&quot;
//--- 启动脚本期间显示输入参数的窗口
#property script_show_inputs
//--- 脚本的输入参数
input string            InpName=&quot;ArrowCheck&quot;; // 符号名称
input int               InpDate=10;           // 定位点日期在 %
input int               InpPrice=50;          // 定位点价格在 %
input ENUM_ARROW_ANCHOR InpAnchor=ANCHOR_TOP; // 定位类型
input color             InpColor=clrRed;      // 符号颜色
input ENUM_LINE_STYLE   InpStyle=STYLE_DOT;   // 边界线条风格
input int               InpWidth=5;           // 符号大小
input bool              InpBack=false;        // 背景符号
input bool              InpSelection=false;   // 突出移动
input bool              InpHidden=true;       // 隐藏对象列表中
input long              InpZOrder=0;          // 鼠标单击优先
//+------------------------------------------------------------------+
//| 创建检查符号                                                       |
//+------------------------------------------------------------------+
bool ArrowCheckCreate(const long              chart_ID=0,           // 图表标ID
                      const string            name=&quot;ArrowCheck&quot;,    // 符号名称
                      const int               sub_window=0,         // 子窗口指数
                      datetime                time=0,               // 定位点时间
                      double                  price=0,              // 定位点价格
                      const ENUM_ARROW_ANCHOR anchor=ANCHOR_BOTTOM, // 定位类型
                      const color             clr=clrRed,           // 符号颜色
                      const ENUM_LINE_STYLE   style=STYLE_SOLID,    // 边界线条风格
                      const int               width=3,              // 符号大小
                      const bool              back=false,           // 在背景中
                      const bool              selection=true,       // 突出移动
                      const bool              hidden=true,          // 隐藏在对象列表
                      const long              z_order=0)            // 鼠标单击优先
  {
//--- 若未设置则设置定位点的坐标
   ChangeArrowEmptyPoint(time,price);
//--- 重置错误的值
   ResetLastError();
//--- 创建符号
   if(!ObjectCreate(chart_ID,name,OBJ_ARROW_CHECK,sub_window,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to create \&quot;Check\&quot; sign! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 设置定位类型
   ObjectSetInteger(chart_ID,name,OBJPROP_ANCHOR,anchor);
//--- 设置符号颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//--- 设置边界线条风格
   ObjectSetInteger(chart_ID,name,OBJPROP_STYLE,style);
//--- 设置符号大小
   ObjectSetInteger(chart_ID,name,OBJPROP_WIDTH,width);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 通过鼠标移动符号的模式
//--- 当使用ObjectCreate函数创建图形对象时，对象不能
//--- 默认下突出并移动。在这个方法中，默认选择参数
//--- true 可以突出移动对象
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动定位点                                                        |
//+------------------------------------------------------------------+
bool ArrowCheckMove(const long   chart_ID=0,        // 图表 ID
                    const string name=&quot;ArrowCheck&quot;, // 对象名称
                    datetime     time=0,            // 定位点时间坐标
                    double       price=0)           // 定位点价格坐标
  {
//--- 如果没有设置点的位置，则将其移动到当前的卖价柱
   if(!time)
      time=TimeCurrent();
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 重置错误的值
   ResetLastError();
//--- 移动定位点
   if(!ObjectMove(chart_ID,name,0,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to move the anchor point! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 更改检查定位类型                                                   |
//+------------------------------------------------------------------+
bool ArrowCheckAnchorChange(const long              chart_ID=0,        // 图表 ID
                            const string            name=&quot;ArrowCheck&quot;, // 对象名称
                            const ENUM_ARROW_ANCHOR anchor=ANCHOR_TOP) // 定位类型
  {
//--- 重置错误的值
   ResetLastError();
//--- 改变定位类型
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_ANCHOR,anchor))
     {
      Print(__FUNCTION__,
            &quot;: failed to change anchor type! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 删除检查符号                                                       |
//+------------------------------------------------------------------+
bool ArrowCheckDelete(const long   chart_ID=0,        // 图表 ID
                      const string name=&quot;ArrowCheck&quot;) // 符号名称
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除符号
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete \&quot;Check\&quot; sign! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 检查定位点的值和为空点设置                                           |
//| 默认的值                                                          |
//+------------------------------------------------------------------+
void ChangeArrowEmptyPoint(datetime &amp;time,double &amp;price)
  {
//--- 如果点的时间没有设置，它将位于当前柱
   if(!time)
      time=TimeCurrent();
//--- 如果点的价格没有设置，则它将用卖价值
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 检查输入参数的正确性
   if(InpDate&lt;0 || InpDate&gt;100 || InpPrice&lt;0 || InpPrice&gt;100)
     {
      Print(&quot;Error! Incorrect values of input parameters!&quot;);
      return;
     }
//--- 图表窗口的可见柱的数量
   int bars=(int)ChartGetInteger(0,CHART_VISIBLE_BARS);
//--- 价格数组大小
   int accuracy=1000;
//--- 存储要使用的日期和价格值的数组
//--- 设置和改变符号定位点的坐标
   datetime date[];
   double   price[];
//--- 内存分配
   ArrayResize(date,bars);
   ArrayResize(price,accuracy);
//--- 填写日期数组
   ResetLastError();
   if(CopyTime(Symbol(),Period(),0,bars,date)==-1)
     {
      Print(&quot;Failed to copy time values! Error code = &quot;,GetLastError());
      return;
     }
//--- 填写价格数组
//--- 找出图表的最高值和最低值
   double max_price=ChartGetDouble(0,CHART_PRICE_MAX);
   double min_price=ChartGetDouble(0,CHART_PRICE_MIN);
//--- 定义变化的价格并填写该数组
   double step=(max_price-min_price)/accuracy;
   for(int i=0;i&lt;accuracy ;i++)
      price[i]=min_price+i*step;
//--- 定义绘制符号的点
   int d=InpDate*(bars-1)/100;
   int p=InpPrice*(accuracy-1)/100;
//--- 在图表上创建检查符号
   if(!ArrowCheckCreate(0,InpName,0,date[d],price[p],InpAnchor,InpColor,
      InpStyle,InpWidth,InpBack,InpSelection,InpHidden,InpZOrder))
     {
      return;
     }
//--- 重画图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- 现在，移动定位点和改变其相对于符号的位置
//--- 循环计数器
   int h_steps=bars*2/5;
//--- 移动定位点
   for(int i=0;i&lt;h_steps ;i++)
     {
      //--- 使用下面的值
      if(d&lt;bars-1)
         d+=1;
      //--- 移动点
      if(!ArrowCheckMove(0,InpName,date[d],price[p]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
      // 0.025 秒延迟
      Sleep(25);
     }
//--- 改变定位点相对于符号的位置
   ArrowCheckAnchorChange(0,InpName,ANCHOR_BOTTOM);
//--- 重画图表
   ChartRedraw();
//--- 循环计数器
   h_steps=bars*2/5;
//--- 移动定位点
   for(int i=0;i&lt;h_steps;i++)
     {
      //--- 使用下面的值
      if(d&lt;bars-1)
         d+=1;
      //--- 移动点
      if(!ArrowCheckMove(0,InpName,date[d],price[p]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
      // 0.025 秒延迟
      Sleep(25);
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 删除图表符号
   ArrowCheckDelete(0,InpName);
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br></div></div><h4 id="_2-2-1-31-obj-arrow-left-price向左价格标签"><a href="#_2-2-1-31-obj-arrow-left-price向左价格标签" class="header-anchor">#</a> 2.2.1.31 OBJ_ARROW_LEFT_PRICE向左价格标签</h4> <p><img src="/mql5yao/assets/img/sec30.30554a29.png" alt="Alt text"></p> <p>ObjArrowLeftPrice</p> <p>示例</p> <p>下面的脚本创建和移动图表上的向左价格标签。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 描述
#property description &quot;Script creates the left price label on the chart.&quot;
#property description &quot;Anchor point coordinate is set in&quot;
#property description &quot;percentage of the chart window size.&quot;
//--- 启动脚本期间显示输入参数的窗口
#property script_show_inputs
//--- 脚本的输入参数
input string            InpName=&quot;LeftPrice&quot;;  // 价格标签名称
input int               InpDate=100;          // 定位点日期在%
input int               InpPrice=10;          // 定位点价格在 %
input color             InpColor=clrRed;      // 价格标签颜色
input ENUM_LINE_STYLE   InpStyle=STYLE_SOLID; // 边界线条风格
input int               InpWidth=2;           // 价格标签大小
input bool              InpBack=false;        // 背景标签
input bool              InpSelection=true;    // 突出移动
input bool              InpHidden=true;       // 隐藏对象列表中
input long              InpZOrder=0;          // 鼠标单击优先
//+------------------------------------------------------------------+
//| 创建向左价格标签                                                   |
//+------------------------------------------------------------------+
bool ArrowLeftPriceCreate(const long            chart_ID=0,        // 图表 ID
                          const string          name=&quot;LeftPrice&quot;,  // 价格标签名称
                          const int             sub_window=0,      // 子窗口指数
                          datetime              time=0,            // 定位点时间
                          double                price=0,           // 定位点价格
                          const color           clr=clrRed,        // 价格标签颜色
                          const ENUM_LINE_STYLE style=STYLE_SOLID, // 边界线条风格
                          const int             width=1,           // 价格标签大小
                          const bool            back=false,        // 在背景中
                          const bool            selection=true,    // 突出移动
                          const bool            hidden=true,       // 隐藏在对象列表
                          const long            z_order=0)         // 鼠标单击优先
  {
//--- 若未设置则设置定位点的坐标
   ChangeArrowEmptyPoint(time,price);
//--- 重置错误的值
   ResetLastError();
//--- 创建价格标签
   if(!ObjectCreate(chart_ID,name,OBJ_ARROW_LEFT_PRICE,sub_window,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to create the left price label! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 设置标签颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//--- 设置边界线条风格
   ObjectSetInteger(chart_ID,name,OBJPROP_STYLE,style);
//--- 设置标签大小
   ObjectSetInteger(chart_ID,name,OBJPROP_WIDTH,width);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 通过鼠标移动标签的模式
//--- 当使用ObjectCreate函数创建图形对象时，对象不能
//--- 默认下突出并移动。在这个方法中，默认选择参数
//--- true 可以突出移动对象
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动定位点                                                        |
//+------------------------------------------------------------------+
bool ArrowLeftPriceMove(const long   chart_ID=0,       // 图表 ID
                        const string name=&quot;LeftPrice&quot;, // 标签名称
                        datetime     time=0,           // 定位点时间坐标
                        double       price=0)          // 定位点价格坐标
  {
//--- 如果没有设置点的位置，则将其移动到当前的卖价柱
   if(!time)
      time=TimeCurrent();
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 重置错误的值
   ResetLastError();
//--- 移动定位点
   if(!ObjectMove(chart_ID,name,0,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to move the anchor point! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 从图表删除向左价格标签                                              |
//+------------------------------------------------------------------+
bool ArrowLeftPriceDelete(const long   chart_ID=0,       // 图表 ID
                          const string name=&quot;LeftPrice&quot;) // 标签名称
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除标签
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete the left price label! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 检查定位点的值和为空点设置                                           |
//| 默认的值                                                          |
//+------------------------------------------------------------------+
void ChangeArrowEmptyPoint(datetime &amp;time,double &amp;price)
  {
//--- 如果点的时间没有设置，它将位于当前柱
   if(!time)
      time=TimeCurrent();
//--- 如果点的价格没有设置，则它将用卖价值
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 检查输入参数的正确性
   if(InpDate&lt;0 || InpDate&gt;100 || InpPrice&lt;0 || InpPrice&gt;100)
     {
      Print(&quot;Error! Incorrect values of input parameters!&quot;);
      return;
     }
//--- 图表窗口的可见柱的数量
   int bars=(int)ChartGetInteger(0,CHART_VISIBLE_BARS);
//--- 价格数组大小
   int accuracy=1000;
//--- 存储要使用的日期和价格值的数组
//--- 用于设置和改变标签定位点坐标
   datetime date[];
   double   price[];
//--- 内存分配
   ArrayResize(date,bars);
   ArrayResize(price,accuracy);
//--- 填写日期数组
   ResetLastError();
   if(CopyTime(Symbol(),Period(),0,bars,date)==-1)
     {
      Print(&quot;Failed to copy time values! Error code = &quot;,GetLastError());
      return;
     }
//--- 填写价格数组
//--- 找出图表的最高值和最低值
   double max_price=ChartGetDouble(0,CHART_PRICE_MAX);
   double min_price=ChartGetDouble(0,CHART_PRICE_MIN);
//--- 定义变化的价格并填写该数组
   double step=(max_price-min_price)/accuracy;
   for(int i=0;i&lt;accuracy;i++)
      price[i]=min_price+i*step;
//--- 定义绘制标签的点
   int d=InpDate*(bars-1)/100;
   int p=InpPrice*(accuracy-1)/100;
//--- 在图表上创建向左价格标签
   if(!ArrowLeftPriceCreate(0,InpName,0,date[d],price[p],InpColor,
      InpStyle,InpWidth,InpBack,InpSelection,InpHidden,InpZOrder))
     {
      return;
     }
//--- 重画图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- 现在，移动定位点
//--- 循环计数器
   int v_steps=accuracy*4/5;
//--- 移动定位点
   for(int i=0;i&lt;v_steps;i++)
     {
      //--- 使用下面的值
      if(p&lt;accuracy-1)
         p+=1;
      //--- 移动点
      if(!ArrowLeftPriceMove(0,InpName,date[d],price[p]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 从图表删除标签
   ArrowLeftPriceDelete(0,InpName);
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br></div></div><h4 id="_2-2-1-32-obj-arrow-right-price向右价格标签"><a href="#_2-2-1-32-obj-arrow-right-price向右价格标签" class="header-anchor">#</a> 2.2.1.32 OBJ_ARROW_RIGHT_PRICE向右价格标签</h4> <p><img src="/mql5yao/assets/img/sec31.a4ee490e.png" alt="Alt text"></p> <p>ObjArrowRightPrice</p> <p>示例</p> <p>下面的脚本创建和移动图表上的向右价格标签。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 描述
#property description &quot;Script creates the right price label on the chart.&quot;
#property description &quot;Anchor point coordinate is set in&quot;
#property description &quot;percentage of the chart window size.&quot;
//--- 启动脚本期间显示输入参数的窗口
#property script_show_inputs
//--- 脚本的输入参数
input string            InpName=&quot;RightPrice&quot;; // 价格标签名称
input int               InpDate=0;            // 定位点日期在%
input int               InpPrice=90;          // 定位点价格在 %
input color             InpColor=clrRed;      // 价格标签颜色
input ENUM_LINE_STYLE   InpStyle=STYLE_SOLID; // 边界线条风格
input int               InpWidth=2;           // 价格标签大小
input bool              InpBack=false;        // 背景标签
input bool              InpSelection=true;    // 突出移动
input bool              InpHidden=true;       // 隐藏对象列表中
input long              InpZOrder=0;          // 鼠标单击优先
//+------------------------------------------------------------------+
//| 创建向右价格标签                                                   |
//+------------------------------------------------------------------+
bool ArrowRightPriceCreate(const long            chart_ID=0,        // 图表 ID
                           const string          name=&quot;RightPrice&quot;, // 价格标签名称
                           const int             sub_window=0,      // 子窗口指数
                           datetime              time=0,            // 定位点时间
                           double                price=0,           // 定位点价格
                           const color           clr=clrRed,        // 价格标签颜色
                           const ENUM_LINE_STYLE style=STYLE_SOLID, // 边界线条风格
                           const int             width=1,           // 价格标签大小
                           const bool            back=false,        // 在背景中
                           const bool            selection=true,    // 突出移动
                           const bool            hidden=true,       // 隐藏在对象列表
                           const long            z_order=0)         // 鼠标单击优先
  {
//--- 若未设置则设置定位点的坐标
   ChangeArrowEmptyPoint(time,price);
//--- 重置错误的值
   ResetLastError();
//--- 创建价格标签
   if(!ObjectCreate(chart_ID,name,OBJ_ARROW_RIGHT_PRICE,sub_window,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to create the right price label! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 设置标签颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//--- 设置边界线条风格
   ObjectSetInteger(chart_ID,name,OBJPROP_STYLE,style);
//--- 设置标签大小
   ObjectSetInteger(chart_ID,name,OBJPROP_WIDTH,width);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 通过鼠标移动标签的模式
//--- 当使用ObjectCreate函数创建图形对象时，对象不能
//--- 默认下突出并移动。在这个方法中，默认选择参数
//--- true 可以突出移动对象
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动定位点                                                        |
//+------------------------------------------------------------------+
bool ArrowRightPriceMove(const long   chart_ID=0,        // 图表 ID
                         const string name=&quot;RightPrice&quot;, // 标签名称
                         datetime     time=0,            // 定位点时间坐标
                         double       price=0)           // 定位点价格坐标
  {
//--- 如果没有设置点的位置，则将其移动到当前的卖价柱
   if(!time)
      time=TimeCurrent();
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 重置错误的值
   ResetLastError();
//--- 移动定位点
   if(!ObjectMove(chart_ID,name,0,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to move the anchor point! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 从图表删除向右价格标签                                              |
//+------------------------------------------------------------------+
bool ArrowRightPriceDelete(const long   chart_ID=0,        // 图表 ID
                           const string name=&quot;RightPrice&quot;) // 标签名称
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除标签
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete the right price label! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 检查定位点的值和为空点设置                                           |
//| 默认的值                                                          |
//+------------------------------------------------------------------+
void ChangeArrowEmptyPoint(datetime &amp;time,double &amp;price)
  {
//--- 如果点的时间没有设置，它将位于当前柱
   if(!time)
      time=TimeCurrent();
//--- 如果点的价格没有设置，则它将用卖价值
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 检查输入参数的正确性
   if(InpDate&lt;0 || InpDate&gt;100 || InpPrice&lt;0 || InpPrice&gt;100)
     {
      Print(&quot;Error! Incorrect values of input parameters!&quot;);
      return;
     }
//--- 图表窗口的可见柱的数量
   int bars=(int)ChartGetInteger(0,CHART_VISIBLE_BARS);
//--- 价格数组大小
   int accuracy=1000;
//--- 存储要使用的日期和价格值的数组
//--- 用于设置和改变标签定位点坐标
   datetime date[];
   double   price[];
//--- 内存分配
   ArrayResize(date,bars);
   ArrayResize(price,accuracy);
//--- 填写日期数组
   ResetLastError();
   if(CopyTime(Symbol(),Period(),0,bars,date)==-1)
     {
      Print(&quot;Failed to copy time values! Error code = &quot;,GetLastError());
      return;
     }
//--- 填写价格数组
//--- 找出图表的最高值和最低值
   double max_price=ChartGetDouble(0,CHART_PRICE_MAX);
   double min_price=ChartGetDouble(0,CHART_PRICE_MIN);
//--- 定义变化的价格并填写该数组
   double step=(max_price-min_price)/accuracy;
   for(int i=0;i&lt;accuracy;i++)
      price[i]=min_price+i*step;
//--- 定义绘制标签的点
   int d=InpDate*(bars-1)/100;
   int p=InpPrice*(accuracy-1)/100;
//--- 在图表上创建向右价格标签
   if(!ArrowRightPriceCreate(0,InpName,0,date[d],price[p],InpColor,
      InpStyle,InpWidth,InpBack,InpSelection,InpHidden,InpZOrder))
     {
      return;
     }
//--- 重画图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- 现在，移动定位点
//--- 循环计数器
   int v_steps=accuracy*4/5;
//--- 移动定位点
   for(int i=0;i&lt;v_steps;i++)
     {
      //--- 使用下面的值
      if(p&gt;1)
         p-=1;
      //--- 移动点
      if(!ArrowRightPriceMove(0,InpName,date[d],price[p]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 从图表删除标签
   ArrowRightPriceDelete(0,InpName);
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br></div></div><h4 id="_2-2-1-33-obj-arrow-buy买入符号"><a href="#_2-2-1-33-obj-arrow-buy买入符号" class="header-anchor">#</a> 2.2.1.33 OBJ_ARROW_BUY买入符号</h4> <p><img src="/mql5yao/assets/img/sec32.915bc203.png" alt="Alt text"></p> <p>ObjArrowBuy</p> <p>示例</p> <p>下面的脚本创建和移动图表上的买入符号。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 描述
#property description &quot;Script draws \&quot;Buy\&quot; signs in the chart window.&quot;
//--- 启动脚本期间显示输入参数的窗口
#property script_show_inputs
//--- 脚本的输入参数
input color InpColor=C'3,95,172'; // 颜色符号
//+------------------------------------------------------------------+
//| 创建买入符号                                                       |
//+------------------------------------------------------------------+
bool ArrowBuyCreate(const long            chart_ID=0,        // 图表 ID
                    const string          name=&quot;ArrowBuy&quot;,   // 符号名称
                    const int             sub_window=0,      // 子窗口指数
                    datetime              time=0,            // 定位点时间
                    double                price=0,           // 定位点价格
                    const color           clr=C'3,95,172',   // 符号颜色
                    const ENUM_LINE_STYLE style=STYLE_SOLID, // 线条风格（当高亮显示时）
                    const int             width=1,           // 线条大小（当高亮显示时）
                    const bool            back=false,        // 在背景中
                    const bool            selection=false,   // 突出移动
                    const bool            hidden=true,       // 隐藏在对象列表
                    const long            z_order=0)         // 鼠标单击优先
  {
//--- 若未设置则设置定位点的坐标
   ChangeArrowEmptyPoint(time,price);
//--- 重置错误的值
   ResetLastError();
//--- 创建符号
   if(!ObjectCreate(chart_ID,name,OBJ_ARROW_BUY,sub_window,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to create \&quot;Buy\&quot; sign! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 设置符号颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//--- 设置线条风格（当高亮显示时）
   ObjectSetInteger(chart_ID,name,OBJPROP_STYLE,style);
//--- 设置线条大小（当高亮显示时）
   ObjectSetInteger(chart_ID,name,OBJPROP_WIDTH,width);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 通过鼠标移动符号的模式
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动定位点                                                        |
//+------------------------------------------------------------------+
bool ArrowBuyMove(const long   chart_ID=0,      // 图表 ID
                  const string name=&quot;ArrowBuy&quot;, // 对象名称
                  datetime     time=0,          // 定位点时间坐标
                  double       price=0)         // 定位点价格坐标
  {
//--- 如果没有设置点的位置，则将其移动到当前的卖价柱
   if(!time)
      time=TimeCurrent();
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 重置错误的值
   ResetLastError();
//--- 移动定位点
   if(!ObjectMove(chart_ID,name,0,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to move the anchor point! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 删除买入符号                                                       |
//+------------------------------------------------------------------+
bool ArrowBuyDelete(const long   chart_ID=0,      // 图表ID
                    const string name=&quot;ArrowBuy&quot;) // 符号名称
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除符号
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete \&quot;Buy\&quot; sign! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 检查定位点的值和为空点设置                                           |
//| 默认的值                                                          |
//+------------------------------------------------------------------+
void ChangeArrowEmptyPoint(datetime &amp;time,double &amp;price)
  {
//--- 如果点的时间没有设置，它将位于当前柱
   if(!time)
      time=TimeCurrent();
//--- 如果点的价格没有设置，则它将用卖价值
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
   datetime date[]; // 存储可见柱日期的数组
   double   low[];  // 存储可见柱最低价格的数组
   double   high[]; // 存储可见柱最高价格的数组
//--- 图表窗口的可见柱的数量
   int bars=(int)ChartGetInteger(0,CHART_VISIBLE_BARS);
//--- 内存分配
   ArrayResize(date,bars);
   ArrayResize(low,bars);
   ArrayResize(high,bars);
//--- 填写日期数组
   ResetLastError();
   if(CopyTime(Symbol(),Period(),0,bars,date)==-1)
     {
      Print(&quot;Failed to copy time values! Error code = &quot;,GetLastError());
      return;
     }
//--- 填写最低价格的数组
   if(CopyLow(Symbol(),Period(),0,bars,low)==-1)
     {
      Print(&quot;Failed to copy the values of Low prices! Error code = &quot;,GetLastError());
      return;
     }
//--- 填写最高价格的数组
   if(CopyHigh(Symbol(),Period(),0,bars,high)==-1)
     {
      Print(&quot;Failed to copy the values of High prices! Error code = &quot;,GetLastError());
      return;
     }
//--- 为每个可见柱创建最低点的买入符号
   for(int i=0;i&lt;bars;i++)
     {
      if(!ArrowBuyCreate(0,&quot;ArrowBuy_&quot;+(string)i,0,date[i],low[i],InpColor))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
      // 0.05 秒延迟
      Sleep(50);
     }
//--- 为每个可见柱移动买入符号到最高点
   for(int i=0;i&lt;bars;i++)
     {
      if(!ArrowBuyMove(0,&quot;ArrowBuy_&quot;+(string)i,date[i],high[i]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
      // 0.05 秒延迟
      Sleep(50);
     }
//--- 删除买入符号
   for(int i=0;i&lt;bars;i++)
     {
      if(!ArrowBuyDelete(0,&quot;ArrowBuy_&quot;+(string)i))
         return;
      //--- 重画图表
      ChartRedraw();
      // 0.05 秒延迟
      Sleep(50);
     }
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br></div></div><h4 id="_2-2-1-34-obj-arrow-sell卖出符号"><a href="#_2-2-1-34-obj-arrow-sell卖出符号" class="header-anchor">#</a> 2.2.1.34 OBJ_ARROW_SELL卖出符号</h4> <p><img src="/mql5yao/assets/img/sec33.e446a987.png" alt="Alt text"></p> <p>ObjArrowSell</p> <p>示例</p> <p>下面的脚本创建和移动图表上的卖出符号。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 描述
#property description &quot;Script draws \&quot;Sell\&quot; signs in the chart window.&quot;
//--- 启动脚本期间显示输入参数的窗口
#property script_show_inputs
//--- 脚本的输入参数
input color InpColor=C'225,68,29'; // 颜色符号
//+------------------------------------------------------------------+
//| 创建卖出符号                                                       |
//+------------------------------------------------------------------+
bool ArrowSellCreate(const long            chart_ID=0,        // 图表 ID
                     const string          name=&quot;ArrowSell&quot;,  // 符号名称
                     const int             sub_window=0,      // 子窗口指数
                     datetime              time=0,            // 定位点时间
                     double                price=0,           // 定位点价格
                     const color           clr=C'225,68,29',  // 符号颜色
                     const ENUM_LINE_STYLE style=STYLE_SOLID, // 线条风格（当高亮显示时）
                     const int             width=1,           // 线条大小（当高亮显示时）
                     const bool            back=false,        // 在背景中
                     const bool            selection=false,   // 突出移动
                     const bool            hidden=true,       // 隐藏在对象列表
                     const long            z_order=0)         // 鼠标单击优先
  {
//--- 若未设置则设置定位点的坐标
   ChangeArrowEmptyPoint(time,price);
//--- 重置错误的值
   ResetLastError();
//--- 创建符号
   if(!ObjectCreate(chart_ID,name,OBJ_ARROW_SELL,sub_window,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to create \&quot;Sell\&quot; sign! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 设置符号颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//--- 设置线条风格（当高亮显示时）
   ObjectSetInteger(chart_ID,name,OBJPROP_STYLE,style);
//--- 设置线条大小（当高亮显示时）
   ObjectSetInteger(chart_ID,name,OBJPROP_WIDTH,width);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 通过鼠标移动符号的模式
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动定位点                                                        |
//+------------------------------------------------------------------+
bool ArrowSellMove(const long   chart_ID=0,       // 图表 ID
                   const string name=&quot;ArrowSell&quot;, // 对象名称
                   datetime     time=0,           // 定位点时间坐标
                   double       price=0)          // 定位点价格坐标
  {
//--- 如果没有设置点的位置，则将其移动到当前的卖价柱
   if(!time)
      time=TimeCurrent();
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 重置错误的值
   ResetLastError();
//--- 移动定位点
   if(!ObjectMove(chart_ID,name,0,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to move the anchor point! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 删除卖出符号                                                       |
//+------------------------------------------------------------------+
bool ArrowSellDelete(const long   chart_ID=0,       // 图表 ID
                     const string name=&quot;ArrowSell&quot;) // 符号名称
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除符号
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete \&quot;Sell\&quot; sign! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 检查定位点的值和为空点设置                                           |
//| 默认的值                                                          |
//+------------------------------------------------------------------+
void ChangeArrowEmptyPoint(datetime &amp;time,double &amp;price)
  {
//--- 如果点的时间没有设置，它将位于当前柱
   if(!time)
      time=TimeCurrent();
//--- 如果点的价格没有设置，则它将用卖价值
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
   datetime date[]; // 存储可见柱日期的数组
   double   low[];  // 存储可见柱最低价格的数组
   double   high[]; // 存储可见柱最高价格的数组
//--- 图表窗口的可见柱的数量
   int bars=(int)ChartGetInteger(0,CHART_VISIBLE_BARS);
//--- 内存分配
   ArrayResize(date,bars);
   ArrayResize(low,bars);
   ArrayResize(high,bars);
//--- 填写日期数组
   ResetLastError();
   if(CopyTime(Symbol(),Period(),0,bars,date)==-1)
     {
      Print(&quot;Failed to copy time values! Error code = &quot;,GetLastError());
      return;
     }
//--- 填写最低价格的数组
   if(CopyLow(Symbol(),Period(),0,bars,low)==-1)
     {
      Print(&quot;Failed to copy the values of Low prices! Error code = &quot;,GetLastError());
      return;
     }
//--- 填写最高价格的数组
   if(CopyHigh(Symbol(),Period(),0,bars,high)==-1)
     {
      Print(&quot;Failed to copy the values of High prices! Error code = &quot;,GetLastError());
      return;
     }
//--- 为每个可见柱创建最高点的卖出符号
   for(int i=0;i&lt;bars;i++)
     {
      if(!ArrowSellCreate(0,&quot;ArrowSell_&quot;+(string)i,0,date[i],high[i],InpColor))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
      // 0.05 秒延迟
      Sleep(50);
     }
//--- 为每个可见柱移动卖出符号到最低点
   for(int i=0;i&lt;bars;i++)
     {
      if(!ArrowSellMove(0,&quot;ArrowSell_&quot;+(string)i,date[i],low[i]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
      // 0.05 秒延迟
      Sleep(50);
     }
//--- 删除卖出符号
   for(int i=0;i&lt;bars;i++)
     {
      if(!ArrowSellDelete(0,&quot;ArrowSell_&quot;+(string)i))
         return;
      //--- 重画图表
      ChartRedraw();
      // 0.05 秒延迟
      Sleep(50);
     }
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br></div></div><h4 id="_2-2-1-35-obj-arrow箭头对象"><a href="#_2-2-1-35-obj-arrow箭头对象" class="header-anchor">#</a> 2.2.1.35 OBJ_ARROW箭头对象</h4> <p><img src="/mql5yao/assets/img/sec34.b2bf530a.png" alt="Alt text"></p> <p>ObjArrow</p> <p>注意</p> <p>相对于符号的定位点位置可以从ENUM_ARROW_ANCHOR 枚举值中选择。</p> <p>在MetaEditor中编写代码时，大型符号（大于5）只能通过设置适当的OBJPROP_WIDTH属性值来创建。</p> <p>示例</p> <p>下面的脚本创建图表上的箭头对象和改变其类型。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//--- 描述</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">description </span><span class="token string">&quot;Script creates a random arrow in the chart window.&quot;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">description </span><span class="token string">&quot;Anchor point coordinate is set in&quot;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">description </span><span class="token string">&quot;percentage of the chart window size.&quot;</span></span>
<span class="token comment">//--- 启动脚本期间显示输入参数的窗口</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">script_show_inputs</span></span>
<span class="token comment">//--- 脚本的输入参数</span>
input string            InpName<span class="token operator">=</span><span class="token string">&quot;Arrow&quot;</span><span class="token punctuation">;</span>        <span class="token comment">// 箭头名称</span>
input <span class="token keyword">int</span>               InpDate<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">;</span>             <span class="token comment">// 定位点日期在 %</span>
input <span class="token keyword">int</span>               InpPrice<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">;</span>            <span class="token comment">// 定位点价格在 %</span>
input ENUM_ARROW_ANCHOR InpAnchor<span class="token operator">=</span>ANCHOR_TOP<span class="token punctuation">;</span>   <span class="token comment">// 定位类型</span>
input color             InpColor<span class="token operator">=</span>clrDodgerBlue<span class="token punctuation">;</span> <span class="token comment">// 箭头颜色</span>
input ENUM_LINE_STYLE   InpStyle<span class="token operator">=</span>STYLE_SOLID<span class="token punctuation">;</span>   <span class="token comment">// 边界线条风格</span>
input <span class="token keyword">int</span>               InpWidth<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span>            <span class="token comment">// 箭头大小</span>
input <span class="token keyword">bool</span>              InpBack<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>          <span class="token comment">// 背景箭头</span>
input <span class="token keyword">bool</span>              InpSelection<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>     <span class="token comment">// 突出移动</span>
input <span class="token keyword">bool</span>              InpHidden<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>         <span class="token comment">// 隐藏对象列表中</span>
input <span class="token keyword">long</span>              InpZOrder<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>            <span class="token comment">// 鼠标单击优先</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 创建箭头                                                          |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">bool</span> <span class="token function">ArrowCreate</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">long</span>              chart_ID<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>           <span class="token comment">// 图表 ID</span>
                 <span class="token keyword">const</span> string            name<span class="token operator">=</span><span class="token string">&quot;Arrow&quot;</span><span class="token punctuation">,</span>         <span class="token comment">// 箭头名称</span>
                 <span class="token keyword">const</span> <span class="token keyword">int</span>               sub_window<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>         <span class="token comment">// 子窗口指数</span>
                 datetime                time<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>               <span class="token comment">// 定位点时间</span>
                 <span class="token keyword">double</span>                  price<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>              <span class="token comment">// 定位点价格</span>
                 <span class="token keyword">const</span> uchar             arrow_code<span class="token operator">=</span><span class="token number">252</span><span class="token punctuation">,</span>       <span class="token comment">// 箭头代码</span>
                 <span class="token keyword">const</span> ENUM_ARROW_ANCHOR anchor<span class="token operator">=</span>ANCHOR_BOTTOM<span class="token punctuation">,</span> <span class="token comment">// 定位点位置</span>
                 <span class="token keyword">const</span> color             clr<span class="token operator">=</span>clrRed<span class="token punctuation">,</span>           <span class="token comment">// 箭头颜色</span>
                 <span class="token keyword">const</span> ENUM_LINE_STYLE   style<span class="token operator">=</span>STYLE_SOLID<span class="token punctuation">,</span>    <span class="token comment">// 边界线条风格</span>
                 <span class="token keyword">const</span> <span class="token keyword">int</span>               width<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>              <span class="token comment">// 箭头大小</span>
                 <span class="token keyword">const</span> <span class="token keyword">bool</span>              back<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">,</span>           <span class="token comment">// 在背景中</span>
                 <span class="token keyword">const</span> <span class="token keyword">bool</span>              selection<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">,</span>       <span class="token comment">// 突出移动</span>
                 <span class="token keyword">const</span> <span class="token keyword">bool</span>              hidden<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">,</span>          <span class="token comment">// 隐藏在对象列表</span>
                 <span class="token keyword">const</span> <span class="token keyword">long</span>              z_order<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>            <span class="token comment">// 鼠标单击优先</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 若未设置则设置定位点的坐标</span>
   <span class="token function">ChangeArrowEmptyPoint</span><span class="token punctuation">(</span>time<span class="token punctuation">,</span>price<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 重置错误的值</span>
   <span class="token function">ResetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 创建箭头</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ObjectCreate</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJ_ARROW<span class="token punctuation">,</span>sub_window<span class="token punctuation">,</span>time<span class="token punctuation">,</span>price<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span>__FUNCTION__<span class="token punctuation">,</span>
            <span class="token string">&quot;: failed to create an arrow! Error code = &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 设置箭头代码</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_ARROWCODE<span class="token punctuation">,</span>arrow_code<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 设置定位类型</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_ANCHOR<span class="token punctuation">,</span>anchor<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 设置箭头颜色</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_COLOR<span class="token punctuation">,</span>clr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 设置边界线条风格</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_STYLE<span class="token punctuation">,</span>style<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 设置箭头大小</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_WIDTH<span class="token punctuation">,</span>width<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 显示前景 (false) 或背景 (true)</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_BACK<span class="token punctuation">,</span>back<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 启用 (true) 或禁用 (false) 通过鼠标移动箭头的模式</span>
<span class="token comment">//--- 当使用ObjectCreate函数创建图形对象时，对象不能</span>
<span class="token comment">//--- 默认下突出并移动。在这个方法中，默认选择参数</span>
<span class="token comment">//--- true 可以突出移动对象</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_SELECTABLE<span class="token punctuation">,</span>selection<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_SELECTED<span class="token punctuation">,</span>selection<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_HIDDEN<span class="token punctuation">,</span>hidden<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 设置在图表中优先接收鼠标点击事件</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_ZORDER<span class="token punctuation">,</span>z_order<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 成功执行</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 移动定位点                                                        |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">bool</span> <span class="token function">ArrowMove</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">long</span>   chart_ID<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>   <span class="token comment">// 图表 ID</span>
               <span class="token keyword">const</span> string name<span class="token operator">=</span><span class="token string">&quot;Arrow&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 对象名称</span>
               datetime     time<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>       <span class="token comment">// 定位点时间坐标</span>
               <span class="token keyword">double</span>       price<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>      <span class="token comment">// 定位点价格坐标</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 如果没有设置点的位置，则将其移动到当前的卖价柱</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>time<span class="token punctuation">)</span>
      time<span class="token operator">=</span><span class="token function">TimeCurrent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>price<span class="token punctuation">)</span>
      price<span class="token operator">=</span><span class="token function">SymbolInfoDouble</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>SYMBOL_BID<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 重置错误的值</span>
   <span class="token function">ResetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 移动定位点</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ObjectMove</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>time<span class="token punctuation">,</span>price<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span>__FUNCTION__<span class="token punctuation">,</span>
            <span class="token string">&quot;: failed to move the anchor point! Error code = &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 成功执行</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 改变箭头代码                                                       |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">bool</span> <span class="token function">ArrowCodeChange</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">long</span>   chart_ID<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>   <span class="token comment">// 图表 ID</span>
                     <span class="token keyword">const</span> string name<span class="token operator">=</span><span class="token string">&quot;Arrow&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 对象名称</span>
                     <span class="token keyword">const</span> uchar  code<span class="token operator">=</span><span class="token number">252</span><span class="token punctuation">)</span>     <span class="token comment">// 箭头代码</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 重置错误的值</span>
   <span class="token function">ResetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 改变箭头代码</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_ARROWCODE<span class="token punctuation">,</span>code<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span>__FUNCTION__<span class="token punctuation">,</span>
            <span class="token string">&quot;: failed to change the arrow code! Error code = &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 成功执行</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 改变定向类型                                                       |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">bool</span> <span class="token function">ArrowAnchorChange</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">long</span>              chart_ID<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>        <span class="token comment">// 图表 ID</span>
                       <span class="token keyword">const</span> string            name<span class="token operator">=</span><span class="token string">&quot;Arrow&quot;</span><span class="token punctuation">,</span>      <span class="token comment">// 对象名称</span>
                       <span class="token keyword">const</span> ENUM_ARROW_ANCHOR anchor<span class="token operator">=</span>ANCHOR_TOP<span class="token punctuation">)</span> <span class="token comment">// 定位类型</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 重置错误的值</span>
   <span class="token function">ResetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 改变定位类型</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_ANCHOR<span class="token punctuation">,</span>anchor<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span>__FUNCTION__<span class="token punctuation">,</span>
            <span class="token string">&quot;: failed to change anchor type! Error code = &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 成功执行</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 删除箭头                                                          |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">bool</span> <span class="token function">ArrowDelete</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">long</span>   chart_ID<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>   <span class="token comment">// 图表 ID</span>
                 <span class="token keyword">const</span> string name<span class="token operator">=</span><span class="token string">&quot;Arrow&quot;</span><span class="token punctuation">)</span> <span class="token comment">// 箭头名称</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 重置错误的值</span>
   <span class="token function">ResetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 删除箭头</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ObjectDelete</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span>__FUNCTION__<span class="token punctuation">,</span>
            <span class="token string">&quot;: failed to delete an arrow! Error code = &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 成功执行</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 检查定位点的值和为空点设置                                           |</span>
<span class="token comment">//| 默认的值                                                          |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">ChangeArrowEmptyPoint</span><span class="token punctuation">(</span>datetime <span class="token operator">&amp;</span>time<span class="token punctuation">,</span><span class="token keyword">double</span> <span class="token operator">&amp;</span>price<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 如果点的时间没有设置，它将位于当前柱</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>time<span class="token punctuation">)</span>
      time<span class="token operator">=</span><span class="token function">TimeCurrent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 如果点的价格没有设置，则它将用卖价值</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>price<span class="token punctuation">)</span>
      price<span class="token operator">=</span><span class="token function">SymbolInfoDouble</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>SYMBOL_BID<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 脚本程序起始函数                                                   |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 检查输入参数的正确性</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>InpDate<span class="token operator">&lt;</span><span class="token number">0</span> <span class="token operator">||</span> InpDate<span class="token operator">&gt;</span><span class="token number">100</span> <span class="token operator">||</span> InpPrice<span class="token operator">&lt;</span><span class="token number">0</span> <span class="token operator">||</span> InpPrice<span class="token operator">&gt;</span><span class="token number">100</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Error! Incorrect values of input parameters!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 图表窗口的可见柱的数量</span>
   <span class="token keyword">int</span> bars<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token function">ChartGetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_VISIBLE_BARS<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 价格数组大小</span>
   <span class="token keyword">int</span> accuracy<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">;</span>
<span class="token comment">//--- 存储要使用的日期和价格值的数组</span>
<span class="token comment">//--- 设置和改变符号定位点的坐标</span>
   datetime date<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token keyword">double</span>   price<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">//--- 内存分配</span>
   <span class="token function">ArrayResize</span><span class="token punctuation">(</span>date<span class="token punctuation">,</span>bars<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">ArrayResize</span><span class="token punctuation">(</span>price<span class="token punctuation">,</span>accuracy<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 填写日期数组</span>
   <span class="token function">ResetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">CopyTime</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">Period</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>bars<span class="token punctuation">,</span>date<span class="token punctuation">)</span><span class="token operator">==</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to copy time values! Error code = &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 填写价格数组</span>
<span class="token comment">//--- 找出图表的最高值和最低值</span>
   <span class="token keyword">double</span> max_price<span class="token operator">=</span><span class="token function">ChartGetDouble</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_PRICE_MAX<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">double</span> min_price<span class="token operator">=</span><span class="token function">ChartGetDouble</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_PRICE_MIN<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 定义变化的价格并填写该数组</span>
   <span class="token keyword">double</span> step<span class="token operator">=</span><span class="token punctuation">(</span>max_price<span class="token operator">-</span>min_price<span class="token punctuation">)</span><span class="token operator">/</span>accuracy<span class="token punctuation">;</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>accuracy<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
      price<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>min_price<span class="token operator">+</span>i<span class="token operator">*</span>step<span class="token punctuation">;</span>
<span class="token comment">//--- 定义绘制箭头的点</span>
   <span class="token keyword">int</span> d<span class="token operator">=</span>InpDate<span class="token operator">*</span><span class="token punctuation">(</span>bars<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span> p<span class="token operator">=</span>InpPrice<span class="token operator">*</span><span class="token punctuation">(</span>accuracy<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">;</span>
<span class="token comment">//--- 在图表上创建箭头</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ArrowCreate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>InpName<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>date<span class="token punctuation">[</span>d<span class="token punctuation">]</span><span class="token punctuation">,</span>price<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span>InpAnchor<span class="token punctuation">,</span>InpColor<span class="token punctuation">,</span>
      InpStyle<span class="token punctuation">,</span>InpWidth<span class="token punctuation">,</span>InpBack<span class="token punctuation">,</span>InpSelection<span class="token punctuation">,</span>InpHidden<span class="token punctuation">,</span>InpZOrder<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 重画图表</span>
   <span class="token function">ChartRedraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 考虑循环中创建箭头的所有情况</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">33</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">256</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ArrowCodeChange</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>InpName<span class="token punctuation">,</span><span class="token punctuation">(</span>uchar<span class="token punctuation">)</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 检查脚本操作是否已经强制禁用</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">IsStopped</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 重画图表</span>
      <span class="token function">ChartRedraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 延迟半秒</span>
      <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 1 秒延迟</span>
   <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 从图表删除箭头</span>
   <span class="token function">ArrowDelete</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>InpName<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">ChartRedraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 1 秒延迟</span>
   <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//---</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br></div></div><h4 id="_2-2-1-36-obj-text文本对象"><a href="#_2-2-1-36-obj-text文本对象" class="header-anchor">#</a> 2.2.1.36 OBJ_TEXT文本对象</h4> <p><img src="/mql5yao/assets/img/sec35.4fdac8ca.png" alt="Alt text"></p> <p>ObjText</p> <p>注意</p> <p>相对于文本的定位点位置可以从 ENUM_ANCHOR_POINT 枚举值中选择。您也可以使用 OBJPROP_ANGLE 属性来改变文本定位角。</p> <p>示例</p> <p>下面的脚本创建图表上的多个文本对象。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//--- 描述</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">description </span><span class="token string">&quot;Script creates \&quot;Text\&quot; graphical object.&quot;</span></span>
<span class="token comment">//--- 启动脚本期间显示输入参数的窗口</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">script_show_inputs</span></span>
<span class="token comment">//--- 脚本的输入参数</span>
input string            InpFont<span class="token operator">=</span><span class="token string">&quot;Arial&quot;</span><span class="token punctuation">;</span>         <span class="token comment">// 字体</span>
input <span class="token keyword">int</span>               InpFontSize<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span>          <span class="token comment">// 字体大小</span>
input color             InpColor<span class="token operator">=</span>clrRed<span class="token punctuation">;</span>         <span class="token comment">// 颜色</span>
input <span class="token keyword">double</span>            InpAngle<span class="token operator">=</span><span class="token number">90.0</span><span class="token punctuation">;</span>           <span class="token comment">// 倾斜角度</span>
input ENUM_ANCHOR_POINT InpAnchor<span class="token operator">=</span>ANCHOR_BOTTOM<span class="token punctuation">;</span> <span class="token comment">// 定位类型</span>
input <span class="token keyword">bool</span>              InpBack<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>           <span class="token comment">// 背景对象</span>
input <span class="token keyword">bool</span>              InpSelection<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>      <span class="token comment">// 突出移动</span>
input <span class="token keyword">bool</span>              InpHidden<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>          <span class="token comment">// 隐藏对象列表中</span>
input <span class="token keyword">long</span>              InpZOrder<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>             <span class="token comment">// 鼠标单击优先</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 创建文本对象                                                       |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">bool</span> <span class="token function">TextCreate</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">long</span>              chart_ID<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>               <span class="token comment">// 图表 ID</span>
                <span class="token keyword">const</span> string            name<span class="token operator">=</span><span class="token string">&quot;Text&quot;</span><span class="token punctuation">,</span>              <span class="token comment">// 对象名称</span>
                <span class="token keyword">const</span> <span class="token keyword">int</span>               sub_window<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>             <span class="token comment">// 子窗口指数</span>
                datetime                time<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>                   <span class="token comment">// 定位点时间</span>
                <span class="token keyword">double</span>                  price<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>                  <span class="token comment">// 定位点价格</span>
                <span class="token keyword">const</span> string            text<span class="token operator">=</span><span class="token string">&quot;Text&quot;</span><span class="token punctuation">,</span>              <span class="token comment">// 文本本身</span>
                <span class="token keyword">const</span> string            font<span class="token operator">=</span><span class="token string">&quot;Arial&quot;</span><span class="token punctuation">,</span>             <span class="token comment">// 字体</span>
                <span class="token keyword">const</span> <span class="token keyword">int</span>               font_size<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>             <span class="token comment">// 字体大小</span>
                <span class="token keyword">const</span> color             clr<span class="token operator">=</span>clrRed<span class="token punctuation">,</span>               <span class="token comment">// 颜色</span>
                <span class="token keyword">const</span> <span class="token keyword">double</span>            angle<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">,</span>                <span class="token comment">// 文本倾斜</span>
                <span class="token keyword">const</span> ENUM_ANCHOR_POINT anchor<span class="token operator">=</span>ANCHOR_LEFT_UPPER<span class="token punctuation">,</span> <span class="token comment">// 定位类型</span>
                <span class="token keyword">const</span> <span class="token keyword">bool</span>              back<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">,</span>               <span class="token comment">// 在背景中</span>
                <span class="token keyword">const</span> <span class="token keyword">bool</span>              selection<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">,</span>          <span class="token comment">// 突出移动</span>
                <span class="token keyword">const</span> <span class="token keyword">bool</span>              hidden<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">,</span>              <span class="token comment">// 隐藏在对象列表</span>
                <span class="token keyword">const</span> <span class="token keyword">long</span>              z_order<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>                <span class="token comment">// 鼠标单击优先</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 若未设置则设置定位点的坐标</span>
   <span class="token function">ChangeTextEmptyPoint</span><span class="token punctuation">(</span>time<span class="token punctuation">,</span>price<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 重置错误的值</span>
   <span class="token function">ResetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 创建文本对象</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ObjectCreate</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJ_TEXT<span class="token punctuation">,</span>sub_window<span class="token punctuation">,</span>time<span class="token punctuation">,</span>price<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span>__FUNCTION__<span class="token punctuation">,</span>
            <span class="token string">&quot;: failed to create \&quot;Text\&quot; object! Error code = &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 设置文本</span>
   <span class="token function">ObjectSetString</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_TEXT<span class="token punctuation">,</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 设置文本字体</span>
   <span class="token function">ObjectSetString</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_FONT<span class="token punctuation">,</span>font<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 设置字体大小</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_FONTSIZE<span class="token punctuation">,</span>font_size<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 设置文本的倾斜角</span>
   <span class="token function">ObjectSetDouble</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_ANGLE<span class="token punctuation">,</span>angle<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 设置定位类型</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_ANCHOR<span class="token punctuation">,</span>anchor<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 设置颜色</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_COLOR<span class="token punctuation">,</span>clr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 显示前景 (false) 或背景 (true)</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_BACK<span class="token punctuation">,</span>back<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 启用 (true) 或禁用 (false) 通过鼠标移动对象的模式</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_SELECTABLE<span class="token punctuation">,</span>selection<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_SELECTED<span class="token punctuation">,</span>selection<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_HIDDEN<span class="token punctuation">,</span>hidden<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 设置在图表中优先接收鼠标点击事件</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_ZORDER<span class="token punctuation">,</span>z_order<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 成功执行</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 移动定位点                                                        |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">bool</span> <span class="token function">TextMove</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">long</span>   chart_ID<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>  <span class="token comment">// 图表 ID</span>
              <span class="token keyword">const</span> string name<span class="token operator">=</span><span class="token string">&quot;Text&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 对象名称</span>
              datetime     time<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>      <span class="token comment">// 定位点时间坐标</span>
              <span class="token keyword">double</span>       price<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>     <span class="token comment">// 定位点价格坐标</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 如果没有设置点的位置，则将其移动到当前的卖价柱</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>time<span class="token punctuation">)</span>
      time<span class="token operator">=</span><span class="token function">TimeCurrent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>price<span class="token punctuation">)</span>
      price<span class="token operator">=</span><span class="token function">SymbolInfoDouble</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>SYMBOL_BID<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 重置错误的值</span>
   <span class="token function">ResetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 移动定位点</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ObjectMove</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>time<span class="token punctuation">,</span>price<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span>__FUNCTION__<span class="token punctuation">,</span>
            <span class="token string">&quot;: failed to move the anchor point! Error code = &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 成功执行</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 改变对象文本                                                       |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">bool</span> <span class="token function">TextChange</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">long</span>   chart_ID<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>  <span class="token comment">// 图表 ID</span>
                <span class="token keyword">const</span> string name<span class="token operator">=</span><span class="token string">&quot;Text&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 对象名称</span>
                <span class="token keyword">const</span> string text<span class="token operator">=</span><span class="token string">&quot;Text&quot;</span><span class="token punctuation">)</span> <span class="token comment">// 文本</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 重置错误的值</span>
   <span class="token function">ResetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 改变对象文本</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ObjectSetString</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_TEXT<span class="token punctuation">,</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span>__FUNCTION__<span class="token punctuation">,</span>
            <span class="token string">&quot;: failed to change the text! Error code = &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 成功执行</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 删除文本对象                                                       |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">bool</span> <span class="token function">TextDelete</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">long</span>   chart_ID<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>  <span class="token comment">// 图表 ID</span>
                <span class="token keyword">const</span> string name<span class="token operator">=</span><span class="token string">&quot;Text&quot;</span><span class="token punctuation">)</span> <span class="token comment">// 对象名称</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 重置错误的值</span>
   <span class="token function">ResetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 删除对象</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ObjectDelete</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span>__FUNCTION__<span class="token punctuation">,</span>
            <span class="token string">&quot;: failed to delete \&quot;Text\&quot; object! Error code = &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 成功执行</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 检查定位点的值和为空点设置                                           |</span>
<span class="token comment">//| 默认的值                                                          |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">ChangeTextEmptyPoint</span><span class="token punctuation">(</span>datetime <span class="token operator">&amp;</span>time<span class="token punctuation">,</span><span class="token keyword">double</span> <span class="token operator">&amp;</span>price<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 如果点的时间没有设置，它将位于当前柱</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>time<span class="token punctuation">)</span>
      time<span class="token operator">=</span><span class="token function">TimeCurrent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 如果点的价格没有设置，则它将用卖价值</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>price<span class="token punctuation">)</span>
      price<span class="token operator">=</span><span class="token function">SymbolInfoDouble</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>SYMBOL_BID<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 脚本程序起始函数                                                   |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   datetime date<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 存储可见柱日期的数组</span>
   <span class="token keyword">double</span>   low<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// 存储可见柱最低价格的数组</span>
   <span class="token keyword">double</span>   high<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 存储可见柱最高价格的数组</span>
<span class="token comment">//--- 图表窗口的可见柱的数量</span>
   <span class="token keyword">int</span> bars<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token function">ChartGetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_VISIBLE_BARS<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 内存分配</span>
   <span class="token function">ArrayResize</span><span class="token punctuation">(</span>date<span class="token punctuation">,</span>bars<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">ArrayResize</span><span class="token punctuation">(</span>low<span class="token punctuation">,</span>bars<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">ArrayResize</span><span class="token punctuation">(</span>high<span class="token punctuation">,</span>bars<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 填写日期数组</span>
   <span class="token function">ResetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">CopyTime</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">Period</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>bars<span class="token punctuation">,</span>date<span class="token punctuation">)</span><span class="token operator">==</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to copy time values! Error code = &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 填写最低价格的数组</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">CopyLow</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">Period</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>bars<span class="token punctuation">,</span>low<span class="token punctuation">)</span><span class="token operator">==</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to copy the values of Low prices! Error code = &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 填写最高价格的数组</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">CopyHigh</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">Period</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>bars<span class="token punctuation">,</span>high<span class="token punctuation">)</span><span class="token operator">==</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to copy the values of High prices! Error code = &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 定义文本显示的频率</span>
   <span class="token keyword">int</span> scale<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token function">ChartGetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_SCALE<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 定义步骤</span>
   <span class="token keyword">int</span> step<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
   <span class="token keyword">switch</span><span class="token punctuation">(</span>scale<span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>
         step<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">;</span>
         <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
         step<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">;</span>
         <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
         step<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">;</span>
         <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span>
         step<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>
         <span class="token keyword">break</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 创建最高和最低柱的值的文本（间隔）。</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>bars<span class="token punctuation">;</span>i<span class="token operator">+=</span>step<span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token comment">//--- 创建文本</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">TextCreate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">&quot;TextHigh_&quot;</span><span class="token operator">+</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span>i<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>date<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>high<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token function">DoubleToString</span><span class="token punctuation">(</span>high<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>InpFont<span class="token punctuation">,</span>InpFontSize<span class="token punctuation">,</span>
         InpColor<span class="token punctuation">,</span>InpAngle<span class="token punctuation">,</span>InpAnchor<span class="token punctuation">,</span>InpBack<span class="token punctuation">,</span>InpSelection<span class="token punctuation">,</span>InpHidden<span class="token punctuation">,</span>InpZOrder<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
         <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">TextCreate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">&quot;TextLow_&quot;</span><span class="token operator">+</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span>i<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>date<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>low<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token function">DoubleToString</span><span class="token punctuation">(</span>low<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>InpFont<span class="token punctuation">,</span>InpFontSize<span class="token punctuation">,</span>
         InpColor<span class="token punctuation">,</span><span class="token operator">-</span>InpAngle<span class="token punctuation">,</span>InpAnchor<span class="token punctuation">,</span>InpBack<span class="token punctuation">,</span>InpSelection<span class="token punctuation">,</span>InpHidden<span class="token punctuation">,</span>InpZOrder<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
         <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token comment">//--- 检查脚本操作是否已经强制禁用</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">IsStopped</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 重画图表</span>
      <span class="token function">ChartRedraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 0.05 秒延迟</span>
      <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 半秒延迟</span>
   <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 删除文本</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>bars<span class="token punctuation">;</span>i<span class="token operator">+=</span>step<span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">TextDelete</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">&quot;TextHigh_&quot;</span><span class="token operator">+</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">TextDelete</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">&quot;TextLow_&quot;</span><span class="token operator">+</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 重画图表</span>
      <span class="token function">ChartRedraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 0.05 秒延迟</span>
      <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//---</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br></div></div><h4 id="_2-2-1-37-obj-label标签对象"><a href="#_2-2-1-37-obj-label标签对象" class="header-anchor">#</a> 2.2.1.37 OBJ_LABEL标签对象</h4> <p><img src="/mql5yao/assets/img/sec36.4f145c9c.png" alt="Alt text"></p> <p>ObjTextLabel</p> <p>注意</p> <p>相对于标签的定位点位置可以从 ENUM_ANCHOR_POINT 枚举值中选择。定位点坐标用像素设置。</p> <p>您也可以从 ENUM_BASE_CORNER 枚举选择文本标签定位角。</p> <p>示例</p> <p>下面的脚本创建和移动图表上的编辑对象。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//--- 描述</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">description </span><span class="token string">&quot;Script creates \&quot;Label\&quot; graphical object.&quot;</span></span>
<span class="token comment">//--- 启动脚本期间显示输入参数的窗口</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">script_show_inputs</span></span>
<span class="token comment">//--- 脚本的输入参数</span>
input string            InpName<span class="token operator">=</span><span class="token string">&quot;Label&quot;</span><span class="token punctuation">;</span>         <span class="token comment">// 标签名称</span>
input <span class="token keyword">int</span>               InpX<span class="token operator">=</span><span class="token number">150</span><span class="token punctuation">;</span>                <span class="token comment">// X-轴距离</span>
input <span class="token keyword">int</span>               InpY<span class="token operator">=</span><span class="token number">150</span><span class="token punctuation">;</span>                <span class="token comment">// Y-轴距离</span>
input string            InpFont<span class="token operator">=</span><span class="token string">&quot;Arial&quot;</span><span class="token punctuation">;</span>         <span class="token comment">// 字体</span>
input <span class="token keyword">int</span>               InpFontSize<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">;</span>          <span class="token comment">// 字体大小</span>
input color             InpColor<span class="token operator">=</span>clrRed<span class="token punctuation">;</span>         <span class="token comment">// 颜色</span>
input <span class="token keyword">double</span>            InpAngle<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">;</span>            <span class="token comment">// 倾斜角度</span>
input ENUM_ANCHOR_POINT InpAnchor<span class="token operator">=</span>ANCHOR_CENTER<span class="token punctuation">;</span> <span class="token comment">// 定位类型</span>
input <span class="token keyword">bool</span>              InpBack<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>           <span class="token comment">// 背景对象</span>
input <span class="token keyword">bool</span>              InpSelection<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>       <span class="token comment">// 突出移动</span>
input <span class="token keyword">bool</span>              InpHidden<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>          <span class="token comment">// 隐藏对象列表中</span>
input <span class="token keyword">long</span>              InpZOrder<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>             <span class="token comment">// 鼠标单击优先</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 创建文本标签                                                       |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">bool</span> <span class="token function">LabelCreate</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">long</span>              chart_ID<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>               <span class="token comment">// 图表 ID</span>
                 <span class="token keyword">const</span> string            name<span class="token operator">=</span><span class="token string">&quot;Label&quot;</span><span class="token punctuation">,</span>             <span class="token comment">// 标签名称</span>
                 <span class="token keyword">const</span> <span class="token keyword">int</span>               sub_window<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>             <span class="token comment">// 子窗口指数</span>
                 <span class="token keyword">const</span> <span class="token keyword">int</span>               x<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>                      <span class="token comment">// X 坐标</span>
                 <span class="token keyword">const</span> <span class="token keyword">int</span>               y<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>                      <span class="token comment">// Y 坐标</span>
                 <span class="token keyword">const</span> ENUM_BASE_CORNER  corner<span class="token operator">=</span>CORNER_LEFT_UPPER<span class="token punctuation">,</span> <span class="token comment">// 图表定位角</span>
                 <span class="token keyword">const</span> string            text<span class="token operator">=</span><span class="token string">&quot;Label&quot;</span><span class="token punctuation">,</span>             <span class="token comment">// 文本</span>
                 <span class="token keyword">const</span> string            font<span class="token operator">=</span><span class="token string">&quot;Arial&quot;</span><span class="token punctuation">,</span>             <span class="token comment">// 字体</span>
                 <span class="token keyword">const</span> <span class="token keyword">int</span>               font_size<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>             <span class="token comment">// 字体大小</span>
                 <span class="token keyword">const</span> color             clr<span class="token operator">=</span>clrRed<span class="token punctuation">,</span>               <span class="token comment">// 颜色</span>
                 <span class="token keyword">const</span> <span class="token keyword">double</span>            angle<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">,</span>                <span class="token comment">// 文本倾斜</span>
                 <span class="token keyword">const</span> ENUM_ANCHOR_POINT anchor<span class="token operator">=</span>ANCHOR_LEFT_UPPER<span class="token punctuation">,</span> <span class="token comment">// 定位类型</span>
                 <span class="token keyword">const</span> <span class="token keyword">bool</span>              back<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">,</span>               <span class="token comment">// 在背景中</span>
                 <span class="token keyword">const</span> <span class="token keyword">bool</span>              selection<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">,</span>          <span class="token comment">// 突出移动</span>
                 <span class="token keyword">const</span> <span class="token keyword">bool</span>              hidden<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">,</span>              <span class="token comment">// 隐藏在对象列表</span>
                 <span class="token keyword">const</span> <span class="token keyword">long</span>              z_order<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>                <span class="token comment">// 鼠标单击优先</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 重置错误的值</span>
   <span class="token function">ResetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 创建文本标签</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ObjectCreate</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJ_LABEL<span class="token punctuation">,</span>sub_window<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span>__FUNCTION__<span class="token punctuation">,</span>
            <span class="token string">&quot;: failed to create text label! Error code = &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 设置标签坐标</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_XDISTANCE<span class="token punctuation">,</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_YDISTANCE<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 设置相对于定义点坐标的图表的角</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_CORNER<span class="token punctuation">,</span>corner<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 设置文本</span>
   <span class="token function">ObjectSetString</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_TEXT<span class="token punctuation">,</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 设置文本字体</span>
   <span class="token function">ObjectSetString</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_FONT<span class="token punctuation">,</span>font<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 设置字体大小</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_FONTSIZE<span class="token punctuation">,</span>font_size<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 设置文本的倾斜角</span>
   <span class="token function">ObjectSetDouble</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_ANGLE<span class="token punctuation">,</span>angle<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 设置定位类型</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_ANCHOR<span class="token punctuation">,</span>anchor<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 设置颜色</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_COLOR<span class="token punctuation">,</span>clr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 显示前景 (false) 或背景 (true)</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_BACK<span class="token punctuation">,</span>back<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 启用 (true) 或禁用 (false) 通过鼠标移动标签的模式</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_SELECTABLE<span class="token punctuation">,</span>selection<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_SELECTED<span class="token punctuation">,</span>selection<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_HIDDEN<span class="token punctuation">,</span>hidden<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 设置在图表中优先接收鼠标点击事件</span>
   <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_ZORDER<span class="token punctuation">,</span>z_order<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 成功执行</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 移动文本标签                                                       |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">bool</span> <span class="token function">LabelMove</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">long</span>   chart_ID<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>   <span class="token comment">// 图表 ID</span>
               <span class="token keyword">const</span> string name<span class="token operator">=</span><span class="token string">&quot;Label&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 标签名称</span>
               <span class="token keyword">const</span> <span class="token keyword">int</span>    x<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>          <span class="token comment">// X 坐标</span>
               <span class="token keyword">const</span> <span class="token keyword">int</span>    y<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>          <span class="token comment">// Y 坐标</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 重置错误的值</span>
   <span class="token function">ResetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 移动文本标签</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_XDISTANCE<span class="token punctuation">,</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span>__FUNCTION__<span class="token punctuation">,</span>
            <span class="token string">&quot;: failed to move X coordinate of the label! Error code = &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_YDISTANCE<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span>__FUNCTION__<span class="token punctuation">,</span>
            <span class="token string">&quot;: failed to move Y coordinate of the label! Error code = &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 成功执行</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 改变绑定标签的图表角落                                              |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">bool</span> <span class="token function">LabelChangeCorner</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">long</span>             chart_ID<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>               <span class="token comment">// 图表 ID</span>
                       <span class="token keyword">const</span> string           name<span class="token operator">=</span><span class="token string">&quot;Label&quot;</span><span class="token punctuation">,</span>             <span class="token comment">// 标签名称</span>
                       <span class="token keyword">const</span> ENUM_BASE_CORNER corner<span class="token operator">=</span>CORNER_LEFT_UPPER<span class="token punctuation">)</span> <span class="token comment">// 图表定位角</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 重置错误的值</span>
   <span class="token function">ResetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 改变定位角</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_CORNER<span class="token punctuation">,</span>corner<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span>__FUNCTION__<span class="token punctuation">,</span>
            <span class="token string">&quot;: failed to change the anchor corner! Error code = &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 成功执行</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 改变标签文本                                                       |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">bool</span> <span class="token function">LabelTextChange</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">long</span>   chart_ID<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>   <span class="token comment">// 图表 ID</span>
                     <span class="token keyword">const</span> string name<span class="token operator">=</span><span class="token string">&quot;Label&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 对象名称</span>
                     <span class="token keyword">const</span> string text<span class="token operator">=</span><span class="token string">&quot;Text&quot;</span><span class="token punctuation">)</span>  <span class="token comment">// 文本</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 重置错误的值</span>
   <span class="token function">ResetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 改变对象文本</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ObjectSetString</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">,</span>OBJPROP_TEXT<span class="token punctuation">,</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span>__FUNCTION__<span class="token punctuation">,</span>
            <span class="token string">&quot;: failed to change the text! Error code = &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 成功执行</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 删除文本标签                                                       |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">bool</span> <span class="token function">LabelDelete</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">long</span>   chart_ID<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>   <span class="token comment">// 图表 ID</span>
                 <span class="token keyword">const</span> string name<span class="token operator">=</span><span class="token string">&quot;Label&quot;</span><span class="token punctuation">)</span> <span class="token comment">// 标签名称</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 重置错误的值</span>
   <span class="token function">ResetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 删除标签</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ObjectDelete</span><span class="token punctuation">(</span>chart_ID<span class="token punctuation">,</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span>__FUNCTION__<span class="token punctuation">,</span>
            <span class="token string">&quot;: failed to delete a text label! Error code = &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 成功执行</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 脚本程序起始函数                                                   |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 在本地变量存储标签坐标</span>
   <span class="token keyword">int</span> x<span class="token operator">=</span>InpX<span class="token punctuation">;</span>
   <span class="token keyword">int</span> y<span class="token operator">=</span>InpY<span class="token punctuation">;</span>
<span class="token comment">//--- 图表窗口大小</span>
   <span class="token keyword">long</span> x_distance<span class="token punctuation">;</span>
   <span class="token keyword">long</span> y_distance<span class="token punctuation">;</span>
<span class="token comment">//--- 设置窗口大小</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ChartGetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_WIDTH_IN_PIXELS<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>x_distance<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to get the chart width! Error code = &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ChartGetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_HEIGHT_IN_PIXELS<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>y_distance<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to get the chart height! Error code = &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 检查输入参数的正确性</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>InpX<span class="token operator">&lt;</span><span class="token number">0</span> <span class="token operator">||</span> InpX<span class="token operator">&gt;</span>x_distance<span class="token operator">-</span><span class="token number">1</span> <span class="token operator">||</span> InpY<span class="token operator">&lt;</span><span class="token number">0</span> <span class="token operator">||</span> InpY<span class="token operator">&gt;</span>y_distance<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Error! Incorrect values of input parameters!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 准备标签的初始文本</span>
   string text<span class="token punctuation">;</span>
   <span class="token function">StringConcatenate</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span><span class="token string">&quot;Upper left corner: &quot;</span><span class="token punctuation">,</span>x<span class="token punctuation">,</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 在图表上创建文本标签</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">LabelCreate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>InpName<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>InpX<span class="token punctuation">,</span>InpY<span class="token punctuation">,</span>CORNER_LEFT_UPPER<span class="token punctuation">,</span>text<span class="token punctuation">,</span>InpFont<span class="token punctuation">,</span>InpFontSize<span class="token punctuation">,</span>
      InpColor<span class="token punctuation">,</span>InpAngle<span class="token punctuation">,</span>InpAnchor<span class="token punctuation">,</span>InpBack<span class="token punctuation">,</span>InpSelection<span class="token punctuation">,</span>InpHidden<span class="token punctuation">,</span>InpZOrder<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 重画图表并等待0.5秒</span>
   <span class="token function">ChartRedraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 同时移动标签和改变其文本</span>
<span class="token comment">//--- 轴的迭代次数</span>
   <span class="token keyword">int</span> h_steps<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>x_distance<span class="token operator">/</span><span class="token number">2</span><span class="token operator">-</span>InpX<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span> v_steps<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>y_distance<span class="token operator">/</span><span class="token number">2</span><span class="token operator">-</span>InpY<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 向下移动标签</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span> v_steps<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token comment">//--- 改变坐标</span>
      y<span class="token operator">+=</span><span class="token number">2</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 移动标签并更改其文本</span>
      <span class="token function">MoveAndTextChange</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token string">&quot;Upper left corner: &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 半秒延迟</span>
   <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 向右移动标签</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>h_steps <span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token comment">//--- 改变坐标</span>
      x<span class="token operator">+=</span><span class="token number">2</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 移动标签并更改其文本</span>
      <span class="token function">MoveAndTextChange</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token string">&quot;Upper left corner: &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 半秒延迟</span>
   <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 向上移动标签</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>v_steps<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token comment">//--- 改变坐标</span>
      y<span class="token operator">-=</span><span class="token number">2</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 移动标签并更改其文本</span>
      <span class="token function">MoveAndTextChange</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token string">&quot;Upper left corner: &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 半秒延迟</span>
   <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 向左移动标签</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>h_steps<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token comment">//--- 改变坐标</span>
      x<span class="token operator">-=</span><span class="token number">2</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 移动标签并更改其文本</span>
      <span class="token function">MoveAndTextChange</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token string">&quot;Upper left corner: &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 半秒延迟</span>
   <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 现在，通过改变定位角来移动点的位置</span>
<span class="token comment">//--- 移动到左下角</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">LabelChangeCorner</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>InpName<span class="token punctuation">,</span>CORNER_LEFT_LOWER<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token comment">//--- 改变标签文本</span>
   <span class="token function">StringConcatenate</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span><span class="token string">&quot;Lower left corner: &quot;</span><span class="token punctuation">,</span>x<span class="token punctuation">,</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">LabelTextChange</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>InpName<span class="token punctuation">,</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token comment">//--- 重绘图表并等待2秒</span>
   <span class="token function">ChartRedraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 移动到右下角</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">LabelChangeCorner</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>InpName<span class="token punctuation">,</span>CORNER_RIGHT_LOWER<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token comment">//--- 改变标签文本</span>
   <span class="token function">StringConcatenate</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span><span class="token string">&quot;Lower right corner: &quot;</span><span class="token punctuation">,</span>x<span class="token punctuation">,</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">LabelTextChange</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>InpName<span class="token punctuation">,</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token comment">//--- 重绘图表并等待2秒</span>
   <span class="token function">ChartRedraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 移动到右上角</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">LabelChangeCorner</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>InpName<span class="token punctuation">,</span>CORNER_RIGHT_UPPER<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token comment">//--- 改变标签文本</span>
   <span class="token function">StringConcatenate</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span><span class="token string">&quot;Upper right corner: &quot;</span><span class="token punctuation">,</span>x<span class="token punctuation">,</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">LabelTextChange</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>InpName<span class="token punctuation">,</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token comment">//--- 重绘图表并等待2秒</span>
   <span class="token function">ChartRedraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 移动到左上角</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">LabelChangeCorner</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>InpName<span class="token punctuation">,</span>CORNER_LEFT_UPPER<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token comment">//--- 改变标签文本</span>
   <span class="token function">StringConcatenate</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span><span class="token string">&quot;Upper left corner: &quot;</span><span class="token punctuation">,</span>x<span class="token punctuation">,</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">LabelTextChange</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>InpName<span class="token punctuation">,</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token comment">//--- 重绘图表并等待2秒</span>
   <span class="token function">ChartRedraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 删除标签</span>
   <span class="token function">LabelDelete</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>InpName<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 重画图表并等待0.5秒</span>
   <span class="token function">ChartRedraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//---</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 函数移动对象并改变其文本                                            |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">bool</span> <span class="token function">MoveAndTextChange</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> x<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">int</span> y<span class="token punctuation">,</span>string text<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 移动标签</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">LabelMove</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>InpName<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 改变标签文本</span>
   <span class="token function">StringConcatenate</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span>text<span class="token punctuation">,</span>x<span class="token punctuation">,</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">LabelTextChange</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>InpName<span class="token punctuation">,</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 检查脚本操作是否已经强制禁用</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">IsStopped</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 重画图表</span>
   <span class="token function">ChartRedraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 0.01 秒延迟</span>
   <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 推出函数</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br><span class="line-number">292</span><br><span class="line-number">293</span><br><span class="line-number">294</span><br><span class="line-number">295</span><br><span class="line-number">296</span><br><span class="line-number">297</span><br><span class="line-number">298</span><br><span class="line-number">299</span><br><span class="line-number">300</span><br><span class="line-number">301</span><br><span class="line-number">302</span><br><span class="line-number">303</span><br><span class="line-number">304</span><br><span class="line-number">305</span><br><span class="line-number">306</span><br><span class="line-number">307</span><br><span class="line-number">308</span><br><span class="line-number">309</span><br><span class="line-number">310</span><br><span class="line-number">311</span><br></div></div><h4 id="_2-2-1-38-obj-button按钮对象"><a href="#_2-2-1-38-obj-button按钮对象" class="header-anchor">#</a> 2.2.1.38 OBJ_BUTTON按钮对象</h4> <p><img src="/mql5yao/assets/img/sec37.35fdaac2.png" alt="Alt text"></p> <p>ObjButton</p> <p>注意</p> <p>定位点坐标用像素设置。您可以从 ENUM_BASE_CORNER选择按钮定位角。</p> <p>示例</p> <p>下面的脚本创建和移动图表上的按钮对象。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 描述
#property description &quot;Script creates the button on the chart.&quot;
//--- 启动脚本期间显示输入参数的窗口
#property script_show_inputs
//--- 脚本的输入参数
input string           InpName=&quot;Button&quot;;            // 按钮名称
input ENUM_BASE_CORNER InpCorner=CORNER_LEFT_UPPER; // 图表定位角
input string           InpFont=&quot;Arial&quot;;             // 字体
input int              InpFontSize=14;              // 字体大小
input color            InpColor=clrBlack;           // 文本颜色
input color            InpBackColor=C'236,233,216'; // 背景色
input color            InpBorderColor=clrNONE;      // 边界颜色
input bool             InpState=false;              // 出版/发布
input bool             InpBack=false;               // 背景对象
input bool             InpSelection=false;          // 突出移动
input bool             InpHidden=true;              // 隐藏在对象列表
input long             InpZOrder=0;                 // 鼠标单击优先
//+------------------------------------------------------------------+
//| 创建按钮                                                          |
//+------------------------------------------------------------------+
bool ButtonCreate(const long              chart_ID=0,               // 图表 ID
                  const string            name=&quot;Button&quot;,            // 按钮名称
                  const int               sub_window=0,             // 子窗口指数
                  const int               x=0,                      // X 坐标
                  const int               y=0,                      // Y 坐标
                  const int               width=50,                 // 按钮宽度
                  const int               height=18,                // 按钮高度
                  const ENUM_BASE_CORNER  corner=CORNER_LEFT_UPPER, // 图表定位角
                  const string            text=&quot;Button&quot;,            // 文本
                  const string            font=&quot;Arial&quot;,             // 字体
                  const int               font_size=10,             // 字体大小
                  const color             clr=clrBlack,             // 文本颜色
                  const color             back_clr=C'236,233,216',  // 背景色
                  const color             border_clr=clrNONE,       // 边界颜色
                  const bool              state=false,              // 出版/发布
                  const bool              back=false,               // 在背景中
                  const bool              selection=false,          // 突出移动
                  const bool              hidden=true,              // 隐藏在对象列表
                  const long              z_order=0)                // 鼠标单击优先
  {
//--- 重置错误的值
   ResetLastError();
//--- 创建按钮
   if(!ObjectCreate(chart_ID,name,OBJ_BUTTON,sub_window,0,0))
     {
      Print(__FUNCTION__,
            &quot;: failed to create the button! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 设置按钮坐标
   ObjectSetInteger(chart_ID,name,OBJPROP_XDISTANCE,x);
   ObjectSetInteger(chart_ID,name,OBJPROP_YDISTANCE,y);
//--- 设置按钮大小
   ObjectSetInteger(chart_ID,name,OBJPROP_XSIZE,width);
   ObjectSetInteger(chart_ID,name,OBJPROP_YSIZE,height);
//--- 设置相对于定义点坐标的图表的角
   ObjectSetInteger(chart_ID,name,OBJPROP_CORNER,corner);
//--- 设置文本
   ObjectSetString(chart_ID,name,OBJPROP_TEXT,text);
//--- 设置文本字体
   ObjectSetString(chart_ID,name,OBJPROP_FONT,font);
//--- 设置字体大小
   ObjectSetInteger(chart_ID,name,OBJPROP_FONTSIZE,font_size);
//--- 设置文本颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//--- 设置背景颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_BGCOLOR,back_clr);
//--- 设置边界颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_BORDER_COLOR,border_clr);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 通过鼠标移动按钮的模式
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动按钮                                                          |
//+------------------------------------------------------------------+
bool ButtonMove(const long   chart_ID=0,    // 图表 ID
                const string name=&quot;Button&quot;, // 按钮名称
                const int    x=0,           // X 坐标
                const int    y=0)           // Y 坐标
  {
//--- 重置错误的值
   ResetLastError();
//--- 移动按钮
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_XDISTANCE,x))
     {
      Print(__FUNCTION__,
            &quot;: failed to move X coordinate of the button! Error code = &quot;,GetLastError());
      return(false);
     }
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_YDISTANCE,y))
     {
      Print(__FUNCTION__,
            &quot;: failed to move Y coordinate of the button! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 改变按钮大小                                                       |
//+------------------------------------------------------------------+
bool ButtonChangeSize(const long   chart_ID=0,    // 图表 ID
                      const string name=&quot;Button&quot;, // 按钮名称
                      const int    width=50,      // 按钮宽度
                      const int    height=18)     // 按钮高度
  {
//--- 重置错误的值
   ResetLastError();
//--- 改变按钮大小
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_XSIZE,width))
     {
      Print(__FUNCTION__,
            &quot;: failed to change the button width! Error code = &quot;,GetLastError());
      return(false);
     }
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_YSIZE,height))
     {
      Print(__FUNCTION__,
            &quot;: failed to change the button height! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 改变绑定按钮的图表角落                                              |
//+------------------------------------------------------------------+
bool ButtonChangeCorner(const long             chart_ID=0,               // 图表 ID
                        const string           name=&quot;Button&quot;,            // 按钮名称
                        const ENUM_BASE_CORNER corner=CORNER_LEFT_UPPER) // 图表定位角
  {
//--- 重置错误的值
   ResetLastError();
//--- 改变定位角
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_CORNER,corner))
     {
      Print(__FUNCTION__,
            &quot;: failed to change the anchor corner! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 改变按钮文本                                                       |
//+------------------------------------------------------------------+
bool ButtonTextChange(const long   chart_ID=0,    // 图表 ID
                      const string name=&quot;Button&quot;, // 按钮名称
                      const string text=&quot;Text&quot;)   // 文本
  {
//--- 重置错误的值
   ResetLastError();
//--- 改变对象文本
   if(!ObjectSetString(chart_ID,name,OBJPROP_TEXT,text))
     {
      Print(__FUNCTION__,
            &quot;: failed to change the text! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 删除按钮                                                          |
//+------------------------------------------------------------------+
bool ButtonDelete(const long   chart_ID=0,    // 图表 ID
                  const string name=&quot;Button&quot;) // 按钮名称
  {
//--- 重置错误的值
   ResetLastError();
//---删除按钮
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete the button! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 图表窗口大小
   long x_distance;
   long y_distance;
//--- 设置窗口大小
   if(!ChartGetInteger(0,CHART_WIDTH_IN_PIXELS,0,x_distance))
     {
      Print(&quot;Failed to get the chart width! Error code = &quot;,GetLastError());
      return;
     }
   if(!ChartGetInteger(0,CHART_HEIGHT_IN_PIXELS,0,y_distance))
     {
      Print(&quot;Failed to get the chart height! Error code = &quot;,GetLastError());
      return;
     }
//--- 定义改变按钮大小的步骤
   int x_step=(int)x_distance/32;
   int y_step=(int)y_distance/32;
//--- 设置按钮坐标及其大小
   int x=(int)x_distance/32;
   int y=(int)y_distance/32;
   int x_size=(int)x_distance*15/16;
   int y_size=(int)y_distance*15/16;
//--- 创建按钮
   if(!ButtonCreate(0,InpName,0,x,y,x_size,y_size,InpCorner,&quot;Press&quot;,InpFont,InpFontSize,
      InpColor,InpBackColor,InpBorderColor,InpState,InpBack,InpSelection,InpHidden,InpZOrder))
     {
      return;
     }
//--- 重画图表
   ChartRedraw();
//--- 减少循环中的按钮
   int i=0;
   while(i &lt; 13)
     {
      //--- 延迟半秒
      Sleep(500);
      //--- 转换按钮到出版状态
      ObjectSetInteger(0,InpName,OBJPROP_STATE,true);
      //--- 重绘图表，等候0.2 秒
      ChartRedraw();
      Sleep(200);
      //--- 重新定义坐标和按钮大小
      x+=x_step;
      y+=y_step;
      x_size-=x_step*2;
      y_size-=y_step*2;
      //--- 减少按钮
      ButtonMove(0,InpName,x,y);
      ButtonChangeSize(0,InpName,x_size,y_size);
      //--- 按钮返回发布状态
      ObjectSetInteger(0,InpName,OBJPROP_STATE,false);
      //--- 重画图表
      ChartRedraw();
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 增加循环计数器
      i++;
     }
//--- 半秒延迟
   Sleep(500);
//---删除按钮
   ButtonDelete(0,InpName);
   ChartRedraw();
//--- 等待1秒
   Sleep(1000);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br></div></div><h4 id="_2-2-1-39-obj-chart图表对象"><a href="#_2-2-1-39-obj-chart图表对象" class="header-anchor">#</a> 2.2.1.39 OBJ_CHART图表对象</h4> <p><img src="data:image/png;base64,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" alt="Alt text"></p> <p>ObjChart</p> <p>注意</p> <p>定位点坐标用像素设置。您可以从 ENUM_BASE_CORNER 枚举值中选择定位角。</p> <p>可以为图表对象选择交易品种，周期和比例尺。也可以 启用/禁用 价格比例和日期展示模式。</p> <p>示例</p> <p>下面的脚本创建和移动图表上的图表对象。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 描述
#property description &quot;Script creates \&quot;Chart\&quot; object.&quot;
//--- 启动脚本期间显示输入参数的窗口
#property script_show_inputs
//--- 脚本的输入参数
input string           InpName=&quot;Chart&quot;;             // 对象名称
input string           InpSymbol=&quot;EURUSD&quot;;          // 交易品种
input ENUM_TIMEFRAMES  InpPeriod=PERIOD_H1;         // 周期
input ENUM_BASE_CORNER InpCorner=CORNER_LEFT_UPPER; // 定位角
input int              InpScale=2;                  // 比例
input bool             InpDateScale=true;           // 时间比例显示
input bool             InpPriceScale=true;          // 价格比例显示
input color            InpColor=clrRed;             // 高亮显示时的边界颜色
input ENUM_LINE_STYLE  InpStyle=STYLE_DASHDOTDOT;   // 高亮显示时的线条风格
input int              InpPointWidth=1;             // 移动点大小
input bool             InpBack=false;               // 背景对象
input bool             InpSelection=true;           // 突出移动
input bool             InpHidden=true;              // 隐藏在对象列表
input long             InpZOrder=0;                 // 鼠标单击优先
//+------------------------------------------------------------------+
//| 创建图表对象                                                       |
//+------------------------------------------------------------------+
bool ObjectChartCreate(const long              chart_ID=0,               // 图表 ID
                       const string            name=&quot;Chart&quot;,             // 对象名称
                       const int               sub_window=0,             // 子窗口指数
                       const string            symbol=&quot;EURUSD&quot;,          // 交易品种
                       const ENUM_TIMEFRAMES   period=PERIOD_H1,         // 周期
                       const int               x=0,                      // X 坐标
                       const int               y=0,                      // Y 坐标
                       const int               width=300,                // 宽度
                       const int               height=200,               // 高度
                       const ENUM_BASE_CORNER  corner=CORNER_LEFT_UPPER, // 定位角
                       const int               scale=2,                  // 比例
                       const bool              date_scale=true,          // 时间比例显示
                       const bool              price_scale=true,         // 价格比例显示
                       const color             clr=clrRed,               // 高亮显示时的边界颜色
                       const ENUM_LINE_STYLE   style=STYLE_SOLID,        // 高亮显示时的线条风格
                       const int               point_width=1,            // 移动点大小
                       const bool              back=false,               // 在背景中
                       const bool              selection=false,          // 突出移动
                       const bool              hidden=true,              // 隐藏在对象列表
                       const long              z_order=0)                // 鼠标单击优先
  {
//--- 重置错误的值
   ResetLastError();
//--- 创建图表对象
   if(!ObjectCreate(chart_ID,name,OBJ_CHART,sub_window,0,0))
     {
      Print(__FUNCTION__,
            &quot;: failed to create \&quot;Chart\&quot; object! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 设置对象坐标
   ObjectSetInteger(chart_ID,name,OBJPROP_XDISTANCE,x);
   ObjectSetInteger(chart_ID,name,OBJPROP_YDISTANCE,y);
//--- 设置对象大小
   ObjectSetInteger(chart_ID,name,OBJPROP_XSIZE,width);
   ObjectSetInteger(chart_ID,name,OBJPROP_YSIZE,height);
//--- 设置相对于定义点坐标的图表的角
   ObjectSetInteger(chart_ID,name,OBJPROP_CORNER,corner);
//--- 设置交易品种
   ObjectSetString(chart_ID,name,OBJPROP_SYMBOL,symbol);
//--- 设置周期
   ObjectSetInteger(chart_ID,name,OBJPROP_PERIOD,period);
//--- 设置比例
   ObjectSetInteger(chart_ID,name,OBJPROP_CHART_SCALE,scale);
//--- 显示 (true) 或隐藏 (false) 时间比例
   ObjectSetInteger(chart_ID,name,OBJPROP_DATE_SCALE,date_scale);
//--- 显示 (true) 或隐藏 (false) 价格比例
   ObjectSetInteger(chart_ID,name,OBJPROP_PRICE_SCALE,price_scale);
//--- 设置对象高亮模式启动时的边界颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//--- 设置对象高亮模式启动时的边界线条风格
   ObjectSetInteger(chart_ID,name,OBJPROP_STYLE,style);
//--- 设置移动对象的定位点大小
   ObjectSetInteger(chart_ID,name,OBJPROP_WIDTH,point_width);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 通过鼠标移动标签的模式
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 设置交易品种和图表对象时间帧                                         |
//+------------------------------------------------------------------+
bool ObjectChartSetSymbolAndPeriod(const long            chart_ID=0,       // 图表 ID (非图表对象)
                                   const string          name=&quot;Chart&quot;,     // 对象名称
                                   const string          symbol=&quot;EURUSD&quot;,  // 交易品种
                                   const ENUM_TIMEFRAMES period=PERIOD_H1) // 时间帧
  {
//--- 重置错误的值
   ResetLastError();
//--- 设置图表对象交易品种和时间帧
   if(!ObjectSetString(chart_ID,name,OBJPROP_SYMBOL,symbol))
     {
      Print(__FUNCTION__,
            &quot;: failed to set a symbol for \&quot;Chart\&quot; object! Error code = &quot;,GetLastError());
      return(false);
     }
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_PERIOD,period))
     {
      Print(__FUNCTION__,
            &quot;: failed to set a period for \&quot;Chart\&quot; object! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动图表对象                                                       |
//+------------------------------------------------------------------+
bool ObjectChartMove(const long   chart_ID=0,   // 图表 ID (非图表对象)
                     const string name=&quot;Chart&quot;, // 对象名称
                     const int    x=0,          // X 坐标
                     const int    y=0)          // Y 坐标
  {
//--- 重置错误的值
   ResetLastError();
//--- 移动对象
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_XDISTANCE,x))
     {
      Print(__FUNCTION__,
            &quot;: failed to move X coordinate of \&quot;Chart\&quot; object! Error code = &quot;,GetLastError());
      return(false);
     }
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_YDISTANCE,y))
     {
      Print(__FUNCTION__,
            &quot;: failed to move Y coordinate of \&quot;Chart\&quot; object! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 改变图表对象大小                                                   |
//+------------------------------------------------------------------+
bool ObjectChartChangeSize(const long   chart_ID=0,   // 图表 ID (非图表对象)
                           const string name=&quot;Chart&quot;, // 对象名称
                           const int    width=300,    // 宽度
                           const int    height=200)   // 高度
  {
//--- 重置错误的值
   ResetLastError();
//--- 改变对象大小
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_XSIZE,width))
     {
      Print(__FUNCTION__,
            &quot;: failed to change the width of \&quot;Chart\&quot; object! Error code = &quot;,GetLastError());
      return(false);
     }
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_YSIZE,height))
     {
      Print(__FUNCTION__,
            &quot;: failed to change the height of \&quot;Chart\&quot; object! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 返回图表对象 ID                                                    |
//+------------------------------------------------------------------+
long ObjectChartGetID(const long   chart_ID=0,   // 图表 ID (非图表对象)
                      const string name=&quot;Chart&quot;) // 对象名称
  {
//--- 准备变量获得图表对象 ID
   long id=-1;
//--- 重置错误的值
   ResetLastError();
//--- 获得ID
   if(!ObjectGetInteger(chart_ID,name,OBJPROP_CHART_ID,0,id))
     {
      Print(__FUNCTION__,
            &quot;: failed to get \&quot;Chart\&quot; object's ID! Error code = &quot;,GetLastError());
     }
//--- 返回结果
   return(id);
  }
//+------------------------------------------------------------------+
//| 删除图表对象                                                       |
//+------------------------------------------------------------------+
bool ObjectChartDelete(const long   chart_ID=0,   // 图表 ID (非图表对象)
                       const string name=&quot;Chart&quot;) // 对象名称
  {
//--- 重置错误的值
   ResetLastError();
//---删除按钮
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete \&quot;Chart\&quot; object! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 获得市场报价交易品种的数量
   int  symbols=SymbolsTotal(true);
//--- 检查交易品种列表中是否存在指定名称的交易品种
   bool exist=false;
   for(int i=0;i&lt; symbols;i++)
      if(InpSymbol==SymbolName(i,true))
        {
         exist=true;
         break;
        }
   if(!exist)
     {
      Print(&quot;Error! &quot;,InpSymbol,&quot; symbol is not present in \&quot;Market Watch\&quot;!&quot;);
      return;
     }
//--- 检查导入参数的正确性
   if(InpScale&lt;0 || InpScale&gt;5)
     {
      Print(&quot;Error! Incorrect values of input parameters!&quot;);
      return;
     }

//--- 图表窗口大小
   long x_distance;
   long y_distance;
//--- 设置窗口大小
   if(!ChartGetInteger(0,CHART_WIDTH_IN_PIXELS,0,x_distance))
     {
      Print(&quot;Failed to get the chart width! Error code = &quot;,GetLastError());
      return;
     }
   if(!ChartGetInteger(0,CHART_HEIGHT_IN_PIXELS,0,y_distance))
     {
      Print(&quot;Failed to get the chart height! Error code = &quot;,GetLastError());
      return;
     }
//--- 设置图表对象坐标及其大小
   int x=(int)x_distance/16;
   int y=(int)y_distance/16;
   int x_size=(int)x_distance*7/16;
   int y_size=(int)y_distance*7/16;
//--- 创建图表对象
   if(!ObjectChartCreate(0,InpName,0,InpSymbol,InpPeriod,x,y,x_size,y_size,InpCorner,InpScale,InpDateScale,
      InpPriceScale,InpColor,InpStyle,InpPointWidth,InpBack,InpSelection,InpHidden,InpZOrder))
     {
      return;
     }
//--- 重画图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- 拉伸图表对象
   int steps=(int)MathMin(x_distance*7/16,y_distance*7/16);
   for(int i=0;i&lt;steps;i++)
     {
      //--- resize
      x_size+=1;
      y_size+=1;
      if(!ObjectChartChangeSize(0,InpName,x_size,y_size))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重绘图表并等待0.01秒
      ChartRedraw();
      Sleep(10);
     }
//--- 半秒延迟
   Sleep(500);
//--- 改变图表时间帧
   if(!ObjectChartSetSymbolAndPeriod(0,InpName,InpSymbol,PERIOD_M1))
      return;
   ChartRedraw();
//--- 3秒延迟
   Sleep(3000);
//--- 删除对象
   ObjectChartDelete(0,InpName);
   ChartRedraw();
//--- 等待1秒
   Sleep(1000);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br></div></div><h4 id="_2-2-1-40-obj-bitmap位图对象"><a href="#_2-2-1-40-obj-bitmap位图对象" class="header-anchor">#</a> 2.2.1.40 OBJ_BITMAP位图对象</h4> <p><img src="/mql5yao/assets/img/sec39.792806a7.png" alt="Alt text"></p> <p>ObjBitmap</p> <p>注意</p> <p>对于位图对象，您可以选择图像的可视范围 。</p> <p>示例</p> <p>下面的脚本创建图表上的多个位图。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 描述
#property description &quot;Script creates a bitmap in the chart window.&quot;
//--- 启动脚本期间显示输入参数的窗口
#property script_show_inputs
//--- 脚本的输入参数
input string          InpFile=&quot;\\Images\\dollar.bmp&quot;; // 位图文件名称
input int             InpWidth=24;                    // 可见范围 X 坐标
input int             InpHeight=24;                   // 可见范围 Y 坐标
input int             InpXOffset=4;                   // 可见范围沿着 X 轴移动
input int             InpYOffset=4;                   // 可见范围沿着 Y 轴移动
input color           InpColor=clrRed;                // 高亮显示时的边界颜色
input ENUM_LINE_STYLE InpStyle=STYLE_SOLID;           // 高亮显示时的线条风格
input int             InpPointWidth=1;                // 移动点大小
input bool            InpBack=false;                  // 背景对象
input bool            InpSelection=false;             // 突出移动
input bool            InpHidden=true;                 // 隐藏在对象列表
input long            InpZOrder=0;                    // 鼠标单击优先
//+------------------------------------------------------------------+
//| 在图表窗口创建位图                                                  |
//+------------------------------------------------------------------+
bool BitmapCreate(const long            chart_ID=0,        // 图表 ID
                  const string          name=&quot;Bitmap&quot;,     // 位图名称
                  const int             sub_window=0,      // 子窗口指数
                  datetime              time=0,            // 定位点时间
                  double                price=0,           // 定位点价格
                  const string          file=&quot;&quot;,           // 位图文件名称
                  const int             width=10,          // 可见范围 X 坐标
                  const int             height=10,         // 可见范围 Y 坐标
                  const int             x_offset=0,        // 可见范围沿着 X 轴移动
                  const int             y_offset=0,        // 可见范围沿着 Y 轴移动
                  const color           clr=clrRed,        // 高亮显示时的边界颜色
                  const ENUM_LINE_STYLE style=STYLE_SOLID, // 高亮显示时的线条风格
                  const int             point_width=1,     // 移动点大小
                  const bool            back=false,        // 在背景中
                  const bool            selection=false,   // 突出移动
                  const bool            hidden=true,       // 隐藏在对象列表
                  const long            z_order=0)         // 鼠标单击优先
  {
//--- 若未设置则设置定位点的坐标
   ChangeBitmapEmptyPoint(time,price);
//--- 重置错误的值
   ResetLastError();
//--- 创建位图
   if(!ObjectCreate(chart_ID,name,OBJ_BITMAP,sub_window,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to create a bitmap in the chart window! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 设置图像文件路径
   if(!ObjectSetString(chart_ID,name,OBJPROP_BMPFILE,file))
     {
      Print(__FUNCTION__,
            &quot;: failed to download the image! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 设置图形的可见范围；如果有宽度或高度的值
//--- 分别超出源图像的宽度和高度，
//--- 则不绘制；相反，
//--- 只有对应这些值的部分才可绘制
   ObjectSetInteger(chart_ID,name,OBJPROP_XSIZE,width);
   ObjectSetInteger(chart_ID,name,OBJPROP_YSIZE,height);
//--- 设置将会显示在可见范围内的图像部分
//--- 默认显示图像的左上区域；该值允许
//--- 执行从该区域移动显示图像的另一个区域
   ObjectSetInteger(chart_ID,name,OBJPROP_XOFFSET,x_offset);
   ObjectSetInteger(chart_ID,name,OBJPROP_YOFFSET,y_offset);
//--- 设置对象高亮模式启动时的边界颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//--- 设置对象高亮模式启动时的边界线条风格
   ObjectSetInteger(chart_ID,name,OBJPROP_STYLE,style);
//--- 设置移动对象的定位点大小
   ObjectSetInteger(chart_ID,name,OBJPROP_WIDTH,point_width);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 通过鼠标移动标签的模式
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 为位图设置新图形                                                   |
//+------------------------------------------------------------------+
bool BitmapSetImage(const long   chart_ID=0,    // 图表 ID
                    const string name=&quot;Bitmap&quot;, // 位图名称
                    const string file=&quot;&quot;)       // 文件路径
  {
//--- 重置错误的值
   ResetLastError();
//--- 设置图像文件路径
   if(!ObjectSetString(chart_ID,name,OBJPROP_BMPFILE,file))
     {
      Print(__FUNCTION__,
            &quot;: failed to download the image! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 在图表窗口移动位图                                                 |
//+------------------------------------------------------------------+
bool BitmapMove(const long   chart_ID=0,    // 图表 ID
                const string name=&quot;Bitmap&quot;, // 位图名称
                datetime     time=0,        // 定位点时间
                double       price=0)       // 定位点价格
  {
//--- 如果没有设置点的位置，则将其移动到当前的卖价柱
   if(!time)
      time=TimeCurrent();
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
//--- 重置错误的值
   ResetLastError();
//--- 移动定位点
   if(!ObjectMove(chart_ID,name,0,time,price))
     {
      Print(__FUNCTION__,
            &quot;: failed to move the anchor point! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 改变可见范围（位图）大小                                              |
//+------------------------------------------------------------------+
bool BitmapChangeSize(const long   chart_ID=0,    // 图表 ID
                      const string name=&quot;Bitmap&quot;, // 位图名称
                      const int    width=0,       // 位图宽度
                      const int    height=0)      // 位图高度
  {
//--- 重置错误的值
   ResetLastError();
//--- 改变位图大小
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_XSIZE,width))
     {
      Print(__FUNCTION__,
            &quot;: failed to change the bitmap width! Error code = &quot;,GetLastError());
      return(false);
     }
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_YSIZE,height))
     {
      Print(__FUNCTION__,
            &quot;: failed to change the bitmap height! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+--------------------------------------------------------------------+
//| 改变可见范围左上角的坐标                                               |
//+--------------------------------------------------------------------+
bool BitmapMoveVisibleArea(const long   chart_ID=0,    // 图表 ID
                           const string name=&quot;Bitmap&quot;, // 位图名称
                           const int    x_offset=0,    // 可见范围 X 坐标
                           const int    y_offset=0)    // 可见范围 Y 坐标
  {
//--- 重置错误的值
   ResetLastError();
//--- 改变位图可见范围的坐标
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_XOFFSET,x_offset))
     {
      Print(__FUNCTION__,
            &quot;: failed to change X coordinate of the visibility scope! Error code = &quot;,GetLastError());
      return(false);
     }
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_YOFFSET,y_offset))
     {
      Print(__FUNCTION__,
            &quot;: failed to change Y coordinate of the visibility scope! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 删除位图                                                          |
//+------------------------------------------------------------------+
bool BitmapDelete(const long   chart_ID=0,    // 图表 ID
                  const string name=&quot;Bitmap&quot;) // 位图名称
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除标签
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete a bitmap! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 检查定位点的值和为空点设置                                           |
//| 默认的值                                                          |
//+------------------------------------------------------------------+
void ChangeBitmapEmptyPoint(datetime &amp;time,double &amp;price)
  {
//--- 如果点的时间没有设置，它将位于当前柱
   if(!time)
      time=TimeCurrent();
//--- 如果点的价格没有设置，则它将用卖价值
   if(!price)
      price=SymbolInfoDouble(Symbol(),SYMBOL_BID);
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
   datetime date[];  // 存储可见柱日期的数组
   double   close[]; // 存储收盘价的数组
//--- 位图文件名称
   string   file=&quot;\\Images\\dollar.bmp&quot;;
//--- 图表窗口的可见柱的数量
   int bars=(int)ChartGetInteger(0,CHART_VISIBLE_BARS);
//--- 内存分配
   ArrayResize(date,bars);
   ArrayResize(close,bars);
//--- 填写日期数组
   ResetLastError();
   if(CopyTime(Symbol(),Period(),0,bars,date)==-1)
     {
      Print(&quot;Failed to copy time values! Error code = &quot;,GetLastError());
      return;
     }
//--- 填写收盘价的数组
   if(CopyClose(Symbol(),Period(),0,bars,close)==-1)
     {
      Print(&quot;Failed to copy the values of Close prices! Error code = &quot;,GetLastError());
      return;
     }
//--- 定义图像显示的频率
   int scale=(int)ChartGetInteger(0,CHART_SCALE);
//--- 定义步骤
   int step=1;
   switch(scale)
     {
      case 0:
         step=27;
         break;
      case 1:
         step=14;
         break;
      case 2:
         step=7;
         break;
      case 3:
         step=4;
         break;
      case 4:
         step=2;
         break;
     }
//--- 创建最高和最低柱的值的位图（间隔）。
   for(int i=0;i&lt;bars ;i+=step)
     {
      //--- 创建位图
      if(!BitmapCreate(0,&quot;Bitmap_&quot;+(string)i,0,date[i],close[i],InpFile,InpWidth,InpHeight,InpXOffset,
         InpYOffset,InpColor,InpStyle,InpPointWidth,InpBack,InpSelection,InpHidden,InpZOrder))
        {
         return;
        }
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
      // 0.05 秒延迟
      Sleep(50);
     }
//--- 半秒延迟
   Sleep(500);
//--- 删除卖出符号
   for(int i=0;i&lt;bars ;i+=step)
     {
      if(!BitmapDelete(0,&quot;Bitmap_&quot;+(string)i))
         return;
      if(!BitmapDelete(0,&quot;Bitmap_&quot;+(string)i))
         return;
      //--- 重画图表
      ChartRedraw();
      // 0.05 秒延迟
      Sleep(50);
     }
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br><span class="line-number">292</span><br><span class="line-number">293</span><br><span class="line-number">294</span><br></div></div><h4 id="_2-2-1-41-obj-bitmap-label位图对象标签"><a href="#_2-2-1-41-obj-bitmap-label位图对象标签" class="header-anchor">#</a> 2.2.1.41 OBJ_BITMAP_LABEL位图对象标签</h4> <p><img src="/mql5yao/assets/img/sec40.4cdfbf01.png" alt="Alt text"></p> <p>ObjBitmapLabel</p> <p>注意</p> <p>相对于标签的定位点位置可以从 ENUM_ANCHOR_POINT 枚举值中选择。定位点坐标用像素设置。</p> <p>您也可以从 ENUM_BASE_CORNER 枚举选择位图定位角。针对位图标签，您可以选择图像的 可视范围 。</p> <p>示例</p> <p>下面的脚本创建图表上的多个位图。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>FUNCTION__,
            &quot;: failed to download the image for Off mode! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 设置标签坐标
   ObjectSetInteger(chart_ID,name,OBJPROP_XDISTANCE,x);
   ObjectSetInteger(chart_ID,name,OBJPROP_YDISTANCE,y);
//--- 设置图形的可见范围；如果有宽度或高度的值
//--- 分别超出源图像的宽度和高度，
//--- 则不绘制；相反，
//--- 只有对应这些值的部分才可绘制
   ObjectSetInteger(chart_ID,name,OBJPROP_XSIZE,width);
   ObjectSetInteger(chart_ID,name,OBJPROP_YSIZE,height);
//--- 设置将会显示在可见范围内的图像部分
//--- 默认显示图像的左上区域；该值允许
//--- 执行从该区域移动显示图像的另一个区域
   ObjectSetInteger(chart_ID,name,OBJPROP_XOFFSET,x_offset);
   ObjectSetInteger(chart_ID,name,OBJPROP_YOFFSET,y_offset);
//--- 定义标签状态（出版或发布）
   ObjectSetInteger(chart_ID,name,OBJPROP_STATE,state);
//--- 设置相对于定义点坐标的图表的角
   ObjectSetInteger(chart_ID,name,OBJPROP_CORNER,corner);
//--- 设置定位类型
   ObjectSetInteger(chart_ID,name,OBJPROP_ANCHOR,anchor);
//--- 设置对象高亮模式启动时的边界颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//--- 设置对象高亮模式启动时的边界线条风格
   ObjectSetInteger(chart_ID,name,OBJPROP_STYLE,style);
//--- 设置移动对象的定位点大小
   ObjectSetInteger(chart_ID,name,OBJPROP_WIDTH,point_width);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 通过鼠标移动标签的模式
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 为位图标签对象设置新图形                                            |
//+------------------------------------------------------------------+
bool BitmapLabelSetImage(const long   chart_ID=0,      // 图表 ID
                         const string name=&quot;BmpLabel&quot;, // 标签名称
                         const int    on_off=0,        // 修饰符 (On 或 Off)
                         const string file=&quot;&quot;)         // 文件路径
  {
//--- 重置错误的值
   ResetLastError();
//--- 设置图像文件路径
   if(!ObjectSetString(chart_ID,name,OBJPROP_BMPFILE,on_off,file))
     {
      Print(__FUNCTION__,
            &quot;: failed to download the image! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动位图标签对象                                                   |
//+------------------------------------------------------------------+
bool BitmapLabelMove(const long   chart_ID=0,      // 图表 ID
                     const string name=&quot;BmpLabel&quot;, // 标签名称
                     const int    x=0,             // X 坐标
                     const int    y=0)             // Y 坐标
  {
//--- 重置错误的值
   ResetLastError();
//--- 移动对象
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_XDISTANCE,x))
     {
      Print(__FUNCTION__,
            &quot;: failed to move X coordinate of the object! Error code = &quot;,GetLastError());
      return(false);
     }
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_YDISTANCE,y))
     {
      Print(__FUNCTION__,
            &quot;: failed to move Y coordinate of the object! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 改变可见范围（对象）大小                                              |
//+------------------------------------------------------------------+
bool BitmapLabelChangeSize(const long   chart_ID=0,      // 图表 ID
                           const string name=&quot;BmpLabel&quot;, // 标签名称
                           const int    width=0,         // 标签宽度
                           const int    height=0)        // 标签高度
  {
//--- 重置错误的值
   ResetLastError();
//--- 改变对象大小
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_XSIZE,width))
     {
      Print(__FUNCTION__,
            &quot;: failed to change the object width! Error code = &quot;,GetLastError());
      return(false);
     }
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_YSIZE,height))
     {
      Print(__FUNCTION__,
            &quot;: failed to change the object height! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+--------------------------------------------------------------------+
//| 改变可见范围左上角的坐标                                              |
//+--------------------------------------------------------------------+
bool BitmapLabelMoveVisibleArea(const long   chart_ID=0,      // 图表 ID
                                const string name=&quot;BmpLabel&quot;, // 标签名称
                                const int    x_offset=0,      // 可见范围 X 坐标
                                const int    y_offset=0)      // 可见范围Y坐标
  {
//--- 重置错误的值
   ResetLastError();
//--- 改变对象可见范围的坐标
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_XOFFSET,x_offset))
     {
      Print(__FUNCTION__,
            &quot;: failed to change X coordinate of the visibility scope! Error code = &quot;,GetLastError());
      return(false);
     }
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_YOFFSET,y_offset))
     {
      Print(__FUNCTION__,
            &quot;: failed to change Y coordinate of the visibility scope! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 删除“位图标签”对象                                                 |
//+------------------------------------------------------------------+
bool BitmapLabelDelete(const long   chart_ID=0,      // 图表 ID
                       const string name=&quot;BmpLabel&quot;) // 标签名称
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除标签
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete \&quot;Bitmap label\&quot; object! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 图表窗口大小
   long x_distance;
   long y_distance;
//--- 设置窗口大小
   if(!ChartGetInteger(0,CHART_WIDTH_IN_PIXELS,0,x_distance))
     {
      Print(&quot;Failed to get the chart width! Error code = &quot;,GetLastError());
      return;
     }
   if(!ChartGetInteger(0,CHART_HEIGHT_IN_PIXELS,0,y_distance))
     {
      Print(&quot;Failed to get the chart height! Error code = &quot;,GetLastError());
      return;
     }
//--- 定义位图标签坐标
   int x=(int)x_distance/2;
   int y=(int)y_distance/2;
//--- 设置标签大小和可见范围坐标
   int width=32;
   int height=32;
   int x_offset=0;
   int y_offset=0;
//--- 将位图标签置于窗口中心
   if(!BitmapLabelCreate(0,InpName,0,x,y,InpFileOn,InpFileOff,width,height,x_offset,y_offset,InpState,
      InpCorner,InpAnchor,InpColor,InpStyle,InpPointWidth,InpBack,InpSelection,InpHidden,InpZOrder))
     {
      return;
     }
//--- 重绘图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- 改变循环中标签可见范围的大小
   for(int i=0;i &lt; 6;i++)
     {
      //--- 改变可见范围大小
      width--;
      height--;
      if(!BitmapLabelChangeSize(0,InpName,width,height))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
      // 0.3 秒延迟
      Sleep(300);
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 改变循环中标签可见范围的坐标
   for(int i=0;i &lt; 2;i++)
     {
      //--- 改变可见范围的坐标
      x_offset++;
      y_offset++;
      if(!BitmapLabelMoveVisibleArea(0,InpName,x_offset,y_offset))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
      // 0.3 秒延迟
      Sleep(300);
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 删除标签
   BitmapLabelDelete(0,InpName);
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br></div></div><h4 id="_2-2-1-42-obj-edit编辑对象"><a href="#_2-2-1-42-obj-edit编辑对象" class="header-anchor">#</a> 2.2.1.42 OBJ_EDIT编辑对象</h4> <p><img src="/mql5yao/assets/img/sec41.38a886bb.png" alt="Alt text"></p> <p>ObjEdit</p> <p>注意</p> <p>定位点坐标用像素设置。您可以从ENUM_BASE_CORNER枚举值中选择编辑定位角。</p> <p>您也可以从 ENUM_ALIGN_MODE 枚举在编辑中选择一种文本对齐类型。</p> <p>示例</p> <p>下面的脚本创建和移动图表上的编辑对象。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 描述
#property description &quot;Script creates \&quot;Edit\&quot; object.&quot;
//--- 启动脚本期间显示输入参数的窗口
#property script_show_inputs
//--- 脚本的输入参数
input string           InpName=&quot;Edit&quot;;              // 对象名称
input string           InpText=&quot;Text&quot;;              // 对象文本
input string           InpFont=&quot;Arial&quot;;             // 字体
input int              InpFontSize=14;              // 字体大小
input ENUM_ALIGN_MODE  InpAlign=ALIGN_CENTER;       // 文本对齐类型
input bool             InpReadOnly=false;           // 编辑能力
input ENUM_BASE_CORNER InpCorner=CORNER_LEFT_UPPER; // 图表定位角
input color            InpColor=clrBlack;           // 文本颜色
input color            InpBackColor=clrWhite;       // 背景色
input color            InpBorderColor=clrBlack;     // 边框颜色
input bool             InpBack=false;               // 背景对象
input bool             InpSelection=false;          // 突出移动
input bool             InpHidden=true;              // 隐藏在对象列表
input long             InpZOrder=0;                 // 鼠标单击优先
//+------------------------------------------------------------------+
//| 创建编辑对象                                                       |
//+------------------------------------------------------------------+
bool EditCreate(const long             chart_ID=0,               // 图表 ID
                const string           name=&quot;Edit&quot;,              // 对象名称
                const int              sub_window=0,             // 子窗口指数
                const int              x=0,                      // X 坐标
                const int              y=0,                      // Y 坐标
                const int              width=50,                 // 宽度
                const int              height=18,                // 高度
                const string           text=&quot;Text&quot;,              // 文本
                const string           font=&quot;Arial&quot;,             // 字体
                const int              font_size=10,             // 字体大小
                const ENUM_ALIGN_MODE  align=ALIGN_CENTER,       // 对齐类型
                const bool             read_only=false,          // 编辑能力
                const ENUM_BASE_CORNER corner=CORNER_LEFT_UPPER, // 图表定位角
                const color            clr=clrBlack,             // 文本颜色
                const color            back_clr=clrWhite,        // 背景色
                const color            border_clr=clrNONE,       // 边框颜色
                const bool             back=false,               // 在背景中
                const bool             selection=false,          // 突出移动
                const bool             hidden=true,              // 隐藏在对象列表
                const long             z_order=0)                // 鼠标单击优先
  {
//--- 重置错误的值
   ResetLastError();
//--- 创建编辑字段
   if(!ObjectCreate(chart_ID,name,OBJ_EDIT,sub_window,0,0))
     {
      Print(__FUNCTION__,
            &quot;: failed to create \&quot;Edit\&quot; object! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 设置对象坐标
   ObjectSetInteger(chart_ID,name,OBJPROP_XDISTANCE,x);
   ObjectSetInteger(chart_ID,name,OBJPROP_YDISTANCE,y);
//--- 设置对象大小
   ObjectSetInteger(chart_ID,name,OBJPROP_XSIZE,width);
   ObjectSetInteger(chart_ID,name,OBJPROP_YSIZE,height);
//--- 设置文本
   ObjectSetString(chart_ID,name,OBJPROP_TEXT,text);
//--- 设置文本字体
   ObjectSetString(chart_ID,name,OBJPROP_FONT,font);
//--- 设置字体大小
   ObjectSetInteger(chart_ID,name,OBJPROP_FONTSIZE,font_size);
//--- 设置对象文本算法的类型
   ObjectSetInteger(chart_ID,name,OBJPROP_ALIGN,align);
//--- 启用 (true) 或禁用 (false) 只读模式
   ObjectSetInteger(chart_ID,name,OBJPROP_READONLY,read_only);
//--- 设置相对于定义对象坐标的图表的角
   ObjectSetInteger(chart_ID,name,OBJPROP_CORNER,corner);
//--- 设置文本颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//--- 设置背景颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_BGCOLOR,back_clr);
//--- 设置边界颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_BORDER_COLOR,border_clr);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 通过鼠标移动标签的模式
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动编辑对象                                                       |
//+------------------------------------------------------------------+
bool EditMove(const long   chart_ID=0,  // 图表ID
              const string name=&quot;Edit&quot;, // 对象名称
              const int    x=0,         // X 坐标
              const int    y=0)         // Y 坐标
  {
//--- 重置错误的值
   ResetLastError();
//--- 移动对象
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_XDISTANCE,x))
     {
      Print(__FUNCTION__,
            &quot;: failed to move X coordinate of the object! Error code = &quot;,GetLastError());
      return(false);
     }
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_YDISTANCE,y))
     {
      Print(__FUNCTION__,
            &quot;: failed to move Y coordinate of the object! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 调整编辑对象                                                       |
//+------------------------------------------------------------------+
bool EditChangeSize(const long   chart_ID=0,  // 图表 ID
                    const string name=&quot;Edit&quot;, // 对象名称
                    const int    width=0,     // 宽度
                    const int    height=0)    // 高度
  {
//--- 重置错误的值
   ResetLastError();
//--- 改变对象大小
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_XSIZE,width))
     {
      Print(__FUNCTION__,
            &quot;: failed to change the object width! Error code = &quot;,GetLastError());
      return(false);
     }
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_YSIZE,height))
     {
      Print(__FUNCTION__,
            &quot;: failed to change the object height! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 改变编辑对象文本                                                   |
//+------------------------------------------------------------------+
bool EditTextChange(const long   chart_ID=0,  // 图表 ID
                    const string name=&quot;Edit&quot;, // 对象名称
                    const string text=&quot;Text&quot;) // 文本
  {
//--- 重置错误的值
   ResetLastError();
//--- 改变对象文本
   if(!ObjectSetString(chart_ID,name,OBJPROP_TEXT,text))
     {
      Print(__FUNCTION__,
            &quot;: failed to change the text! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 返回编辑对象文本                                                   |
//+------------------------------------------------------------------+
bool EditTextGet(string      &amp;text,        // 文本
                 const long   chart_ID=0,  // 图表's ID
                 const string name=&quot;Edit&quot;) // 对象名称
  {
//--- 重置错误的值
   ResetLastError();
//--- 获得对象文本
   if(!ObjectGetString(chart_ID,name,OBJPROP_TEXT,0,text))
     {
      Print(__FUNCTION__,
            &quot;: failed to get the text! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 删除编辑对象                                                       |
//+------------------------------------------------------------------+
bool EditDelete(const long   chart_ID=0,  // 图表 ID
                const string name=&quot;Edit&quot;) // 对象名称
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除标签
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete \&quot;Edit\&quot; object! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 图表窗口大小
   long x_distance;
   long y_distance;
//--- 设置窗口大小
   if(!ChartGetInteger(0,CHART_WIDTH_IN_PIXELS,0,x_distance))
     {
      Print(&quot;Failed to get the chart width! Error code = &quot;,GetLastError());
      return;
     }
   if(!ChartGetInteger(0,CHART_HEIGHT_IN_PIXELS,0,y_distance))
     {
      Print(&quot;Failed to get the chart height! Error code = &quot;,GetLastError());
      return;
     }
//--- 定义改变编辑字段的步骤
   int x_step=(int)x_distance/64;
//--- 设置编辑字段坐标和其大小
   int x=(int)x_distance/8;
   int y=(int)y_distance/2;
   int x_size=(int)x_distance/8;
   int y_size=InpFontSize*2;
//--- 在本地变量存储文本
   string text=InpText;
//--- 创建编辑字段
   if(!EditCreate(0,InpName,0,x,y,x_size,y_size,InpText,InpFont,InpFontSize,InpAlign,InpReadOnly,
      InpCorner,InpColor,InpBackColor,InpBorderColor,InpBack,InpSelection,InpHidden,InpZOrder))
     {
      return;
     }
//--- 重画图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- 延伸编辑字段
   while(x_size-x&lt;x_distance*5/8)
     {
      //--- increase edit field's width
      x_size+=x_step;
      if(!EditChangeSize(0,InpName,x_size,y_size))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重绘图表并等待0.05 秒
      ChartRedraw();
      Sleep(50);
     }
//--- 半秒延迟
   Sleep(500);
//--- 改变文本
   for(int i=0;i &lt; 20;i++)
     {
      //--- 在开始和结束添加 &quot;+&quot;
      text=&quot;+&quot;+text+&quot;+&quot;;
      if(!EditTextChange(0,InpName,text))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重绘图表并等待 0.1 秒
      ChartRedraw();
      Sleep(100);
     }
//--- 半秒延迟
   Sleep(500);
//--- 删除编辑字段
   EditDelete(0,InpName);
   ChartRedraw();
//--- 等待1秒
   Sleep(1000);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br></div></div><h4 id="_2-2-1-43-obj-event事件对象"><a href="#_2-2-1-43-obj-event事件对象" class="header-anchor">#</a> 2.2.1.43 OBJ_EVENT事件对象</h4> <p><img src="/mql5yao/assets/img/sec42.5bee24c6.png" alt="Alt text"></p> <p>ObjEvent</p> <p>注意</p> <p>当鼠标悬挂在事件上时，会显示其文本。</p> <p>示例</p> <p>下面的脚本创建和移动图表上的事件对象。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 描述
#property description &quot;Script draws \&quot;Event\&quot; graphical object.&quot;
#property description &quot;Anchor point date is set in percentage of&quot;
#property description &quot;the chart window width in bars.&quot;
//--- 启动脚本期间显示输入参数的窗口
#property script_show_inputs
//--- 脚本的输入参数
input string          InpName=&quot;Event&quot;;    // 事件名称
input int             InpDate=25;         // 事件日期，%
input string          InpText=&quot;Text&quot;;     // 事件文本
input color           InpColor=clrRed;    // 事件颜色
input int             InpWidth=1;         // 高亮显示时的点大小
input bool            InpBack=false;      // 背景事件
input bool            InpSelection=false; // 突出移动
input bool            InpHidden=true;     // 隐藏在对象列表
input long            InpZOrder=0;        // 鼠标单击优先
//+------------------------------------------------------------------+
//| 在图表上创建事件对象                                                |
//+------------------------------------------------------------------+
bool EventCreate(const long            chart_ID=0,      // 图表 ID
                 const string          name=&quot;Event&quot;,    // 事件名称
                 const int             sub_window=0,    // 子窗口指数
                 const string          text=&quot;Text&quot;,     // 事件文本
                 datetime              time=0,          // 时间
                 const color           clr=clrRed,      // 颜色
                 const int             width=1,         // 高亮显示时的点宽度
                 const bool            back=false,      // 在背景中
                 const bool            selection=false, // 突出移动
                 const bool            hidden=true,     // 隐藏在对象列表
                 const long            z_order=0)       // 鼠标单击优先
  {
//--- 如果没有设置时间，请在最近的柱创建对象。
   if(!time)
      time=TimeCurrent();
//--- 重置错误的值
   ResetLastError();
//--- 创建事件对象
   if(!ObjectCreate(chart_ID,name,OBJ_EVENT,sub_window,time,0))
     {
      Print(__FUNCTION__,
            &quot;: failed to create \&quot;Event\&quot; object! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 设置事件文本
   ObjectSetString(chart_ID,name,OBJPROP_TEXT,text);
//--- 设置颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//--- 如果对象突出显示则设置定位点宽度
   ObjectSetInteger(chart_ID,name,OBJPROP_WIDTH,width);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 通过鼠标移动事件的模式
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 改变事件对象文本                                                   |
//+------------------------------------------------------------------+
bool EventTextChange(const long   chart_ID=0,   // 图表 ID
                     const string name=&quot;Event&quot;, // 事件名称
                     const string text=&quot;Text&quot;)  // 文本
  {
//--- 重置错误的值
   ResetLastError();
//--- 改变对象文本
   if(!ObjectSetString(chart_ID,name,OBJPROP_TEXT,text))
     {
      Print(__FUNCTION__,
            &quot;: failed to change the text! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动事件对象                                                       |
//+------------------------------------------------------------------+
bool EventMove(const long   chart_ID=0,   // 图表 ID
               const string name=&quot;Event&quot;, // 事件名称
               datetime     time=0)       // 时间
  {
//--- 如果没有设置线的时间，将事件移动到收盘柱
   if(!time)
      time=TimeCurrent();
//--- 重置错误的值
   ResetLastError();
//--- 移动对象
   if(!ObjectMove(chart_ID,name,0,time,0))
     {
      Print(__FUNCTION__,
            &quot;: failed to move \&quot;Event\&quot; object! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 删除事件对象                                                       |
//+------------------------------------------------------------------+
bool EventDelete(const long   chart_ID=0,   // 图表 ID
                 const string name=&quot;Event&quot;) // 事件名称
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除对象
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete \&quot;Event\&quot; object! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 检查输入参数的正确性
   if(InpDate&lt;0 || InpDate&gt;100)
     {
      Print(&quot;Error! Incorrect values of input parameters!&quot;);
      return;
     }
//--- 图表窗口的可见柱的数量
   int bars=(int)ChartGetInteger(0,CHART_VISIBLE_BARS);
//--- 存储要使用的日期值的数组
//--- 设置和改变事件定位点的坐标
   datetime date[];
//--- 内存分配
   ArrayResize(date,bars);
//--- 填写日期数组
   ResetLastError();
   if(CopyTime(Symbol(),Period(),0,bars,date)==-1)
     {
      Print(&quot;Failed to copy time values! Error code = &quot;,GetLastError());
      return;
     }
//--- 定义创建对象的点
   int d=InpDate*(bars-1)/100;
//--- 创建事件对象
   if(!EventCreate(0,InpName,0,InpText,date[d],InpColor,InpWidth,
      InpBack,InpSelection,InpHidden,InpZOrder))
     {
      return;
     }
//--- 重画图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- 现在，移动对象
//--- 循环计数器
   int h_steps=bars/2;
//--- 移动对象
   for(int i=0;i&lt;h_steps;i++)
     {
      //--- 使用下面的值
      if(d&lt; bars-1)
         d+=1;
      //--- 移动点
      if(!EventMove(0,InpName,date[d]))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重画图表
      ChartRedraw();
      // 0.05 秒延迟
      Sleep(50);
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 删除图表通道
   EventDelete(0,InpName);
   ChartRedraw();
//--- 1 秒延迟
   Sleep(1000);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br></div></div><h4 id="_2-2-1-44-obj-rectangle-label矩形标签对象"><a href="#_2-2-1-44-obj-rectangle-label矩形标签对象" class="header-anchor">#</a> 2.2.1.44 OBJ_RECTANGLE_LABEL矩形标签对象</h4> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkQAAAFzBAMAAAFaXjt3AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAYUExURf///wAAAMDAwB6Q/4fO6/X19a/u7gAAAJDTqMgAAAAIdFJOU/////////8A3oO9WQAAAAlwSFlzAAAOwwAADsMBx2+oZAAAGIFJREFUeNrtXVuW5CquRXE6+1s6a+X9dmRP4KxVPYQzgMqP6O/b859Em6cFBiPb+BVpVVSGww+x2SAQAttKJgD9f9R/FKo58scvJn+VzvrH30yEZ2lIrXQ1PYtuXLPOwmvhOlxuXPPkrLjeWj5er2ZnMTGNvv6jGzNdsOC+Cex2a4E+tT4tNLpn1CTe7f0qncTbm7+FJ+Vb8SWaGp6UJebGdF1MxwremGRyY5LJekz/fP1udBIT1NXK9lpoOzM037hFT5aTr8y+vnclANDY+j+gyG/AFiUb+dyR/NVUE87wDvbCdEZNN08yTQQ3TxJNePMk0jTH7qKY2i9RgO1thBSoW+py8ySTOe3TTxakmyeJ4LvZ3X9e3/AR73o0U65nk/SwAvphjxlkgJtqUm4b+3bMHFdmiKT3m/P6/Wqt5W4+UNUJdCv/W6E+7535r7DrGejADh6fszVhr6sf3BGQIr1FvcZ+Q5mNFbnDQrq/BL6KTNO/BZ4YjhDmRKppLaYhaLxOE9jSTvJDzXIHKxlvp2kQOF/uemNplDuEQixlsha4EGSCCbBV7lZqCgJLcpfFpJrlzmjCNjUT8i3lXExP3ayvwhSuQF015mpyjQrPC9iAZIvceU3rc2dbPmpQduQ0rc+d1kG9D/Jcnbun0QQrNPFMUu+lw5rckfUwTHxL+1gL65PW9OypdprM2GFW7njNBB8k7/XQmtz17Xfv+BjWcQGmVJNvWYjWlB0o8jUSiNaUXV9gAROuqplaE7ore024TJOZ0UCkUDvHa8cq9Ym8Jo2ptzcMVoPzMKHV5LxnYq3JWJPIYzVdQJKfRTOEfZHhyEfBkpeY/881JUepoAkmNUEmK1TI3eQgjNUjASacwCTVhEVNoX0S5s5UmUJfHzSRBJNpH2yVKeUOlEgTuP1U1pQbGMB4QhFcHsvFpyt4powoi8lpKmKCvl9Jjvaj2Kjeg9dE05rGBZKu/SEX1COq5G6ESfcO3NMgM83zdNGvQn0qaNLRirDfjrgLmhTThDTOHYa0erGadJ9YyZ3uTEaYemYGrFpTn2NEmqxPZgFUUnZ9Y8x9c3KaKBuRYJpGviXpfDDrA6NJzzqXp5u9prQ8bDjDUqW9j76dN239E6cwjfNuJ8Bp0KT7HrLbWNaU9Sw1T2GtGgzd/bgR4uO7XEthJuVtuEw9Ta10JeAwRT7zeKSYanLz+ZYby5tpcZJ2ashdTvRAFqOBhCs1RN9JplcUMGmT1T2zzZHZh92ACfKYuux/MOXOjg+aqKSpJLpyYnqOZouI5LkzrCurKa5vfe0ku1+aO60B3XKRSBM+kfeRvqGcyh0wTWyv7iIzl01h0i2cv4RhQMTYK5FporEmKmsqi+kpk1OA8p36JCYbNzWwOCaYn7uSJoo9AEnurM+XZg+znfo0pr4dIFvkbJ/xGqL6RBJNHdmawDWNrV2SO914prkrnFjD5DRNnSPVZO1KpmlSKHcO0OdoTXSd8dw5fT+K398zc6fymvDj4/fM3GUFCm3mmm+myc0iaTF9LjmnEu236ZTsVJL5551l2wJGVUtXUEJXUU1fBq6Pc9+IPgnz5dVhIXwmkP3mDfuacbgkiJStG6TAfhlWjR+m/Qu9ofyG8ZzMHoW0kIH6DKbxQPsSfbgVkA+yiB62CsBDWRfVVS/6U2/0nusjSWHtN0fUVnM7RDmZW5vLa5ompJhqDjuoeXn94+/5clpEbLzYtNRWcERhVDvJEZyu1A5FlJWZxbY9R+p0paZOWGrzFrBszZG+0w1m9V+NEHVfD/75CttP1X+ez9H+0vlfj38tQdRfSHZaF+L2KCNgaFJy2bxmR4hOY2sHIsrK2UotIJL6AHsgsg3SMYjyB+yoTFpym7ZHrhkCswF7tEcqbY+SUgDvz7lFkycoNRi+xb3btjXbowAl99x2RgR7IyodAHATaYKS26E9Yoj25+jhfj3cHlZ6g8Gp/f2jJ+jP1+PZ8T2Pp/l0X5XPmvZIjyCz7RE4jiDmCEJIbedSM16sLaSQErgW6Rhbc9UY0sVZAKJWcpOabTmCjA9wkK2ZegQ5RIe1kAAqU0KuTaoV3DYcgSuiEQdQ99xatkehVYKnaZKeYz/oGZymTfwjs5TCtUdDpwXOj83aFcBupWYRPXyRqZL3AbOjgHO+I0TgEfHaeyCi4G7UBObe6TM3jBnSsTWknheAmRyBUks5ylr7cYikndaCUltWbODaIN2gqMlxGTxr7ZHzp/x+0flf4/bI1iNoVWpDjzyM0JWaV2oKZCEQYanBsAFqSdG51lrKUfU85tkBRzSLI/MlsZ2ZiBQvtvmIJA1atXSTcZ248R0p0V8PiEdFue/AUWnU7ZzicL7QPy8gUgJEYBGV4gDAEcFiRLZReH6pp2mPpj5PG05yDc3Ih4Jnpz/OjXLhcPX8qg70bHsEcfzI+NcSjsBdlOHUN22mNj3cQG95qUFDRLZ03dBzOSJBA+iTVAV30jmgrvZAbuQnkGD9IOEIAiIoHA8cuQJ8LG+PQBBvDHVjIDQdpYPvlsDZpKBVySOSOSTuk0Hka1igybeWszs2iBTWOFIKhmhJdL3jwpdWgPEAmX/OEHVRALsat+6HcsAammFkp1siP/TTDVPY/4xarpJ/ZHIaxY+k3DpLg6HVyCiIDNdvgzAdqUf1iBCB75qZzbEaHPnt3tOLZzSqNVuOaOjSIR7fiRCBHNEsgQhZ/oRhO5QaiCxvLke89FjXPnF+4AiYiTYsNYZIcURlPT5mB8C7qsalpgbnDASKooa8rlkwnsruh64zDZP7mfpB/HwzHjTe01MV2iO7OLy6/qjyDTmOSv2h807k/doSEZfDgF3YeRpZzFGSSIGjMCsu52gBoqHRZrDaIVoiEJrJ2jgOIBpOTp/svpdzFFenEkfeY9q21EJiqtp2V0cWDFFXH09Nf3Qr4yNQxc+zEA7n7RGsbo/cdxylK3FU08M4aoJIbYBouXhnqZU04Cjx3Ca+hyX825YaiPXA93+/v1+fL/rYutSkehyiD3pV9a3haMa3rNToeMlzdNTvnJC9B8ePKc1/eyeOuRptYxMygvY2zjhj7iFy7npz4w55BO62z/B8blDDTT850TfLkblNyD3cSd8SpG9lAf9ob9sCor+5Ec2B8NveD0z2epuwuQMpnGDPH/TZ87nGW95Azmf9O8vjqxvtyzQIgOZ2an1bJzNyZxx8wz77Av2dzksk85T8UZNlQNibTEGFm3INOkg2LGJAaPqM3pEqA4FwQBSephMjQnebtLmNbVNEyjy8wjx9Moy9yTxJ3aBDv+GeT0C2scNNESXSMDGRwHaql9xQ99dPQ7Rgtc+N6LKI7H3EGzzJegUi2zqfCxFt8baj5YjALKw5UanJhW5EVUA3ohvRjehGdCMqAFInRDSPpVXeiPIPlXuorvQxiLqJE9LPIkQP9SS7jKXqH5HajyMYnkt0DkRCuRHdiO5S+9GIZnVtN6JTIFLzBpE/DhGp/RDZAH7NP3KeEe3kHyn+0P8TcCTyj/ZEJJHQWt+IRIjEvdu2iNiGuOG+Ed2IbkTvhYjOh0idC5EJtG2NyM5mqUn/aHCLdAhJf+jY+BGNOJL0bav8o8LrNohs0qR2RTQh10CkDkWkxogGrOdCJGol9+XoIER0I7ououzg40BEik6HKN/4HIsof+wgRHQEomi1TxozKvpBG/tH9v0c83igDTmyBXciRAsTFSBqvkKTViJaKLA0zRtRPc0bUT3N/RARydL8wYjofIgGkk6DSJ0QkWPpMESg7F175qfxiTpyC466yeVIc9Yizfik/hEN+a9wtNVtXd4/cj4kMDC1FOciEp4P2Z/NECXROYlAObF3R0TnQ6TOiUhA1I3oxyGq62+JiM6GiH4GIjocEcWISIgo9o985Iio6gGRiy5NxJg0iOBP6eXdghXe1j+C5P61WRxNxOFoGUdg/m6MiGYgKibWFpFaj4hWIiIaI6JVbfZMRCRCpBYjooaIKCBSamNExMkcI3KoApLzIIoOrUEkEgEi2huRt58sooFIuea9EamFiMRCoZUpIBqB2AsRVRAV4OVkLSLyDd9ZEKkiIoo2ZyGy82v1+9eKgSTXg5Yn4Ijf+EYy/4gULb6/n/J9OudoVoM0uf5IJJT3n8suSkXWP2ggj6iY8D6IQsEIKvD5EFX7g0aPhzgvopDaRLI3onqy+yDyiV0fUea0dohi31yGiDZGRNGgunwiOz9zeCtEk2e689XZEKkSInP/GqrF/lFwfIj5QTQdeHJ/iUr+EWCDp8415Eg/MxBh/ROZZiEiKiNqJmdENCC5ERUSEiPyY4XTIAqt4w9FNHJvS6fuhYg1f5VT90DkEmN/yyedEVFRtkAkCc6X5RhEU3JGRPb+flztHw2eERGt0ODvX2v2xEpSilYpsP4RtXuGJtFqRI2FaKWCG1FdbkR1aY5ohuj32ZjhQmTnRyL6+OfHx0vLN997NKJPfOHrk5N0NKIP+MaPT773cES/vz8/TsWRrka/p+rRQ+0oIlt7dOpoSVf60vGibpkpenWUfUmFf5WH9S7RrZkCtO/MGBZ1mQXn4bd5VwSOr2dv3rEL1CGkA9EJY0G7hiz4gWDf/cNDcPxlQw7F8JtU/Lohs0qOnWDeW8SWhNHodUMpR/oR6PrtHMARMUa0EoyuR2AIzQo0nYPherBubkCEFt+ASD/FawIRmoJB//ohMHD0A/YhtBrakw6lhObegOE3xS9AMtcDsFIz+4I+SF+AdBY5E5ZbbtlF0krfvdXvr146wfmTTqOkXbhw2/H1JXL/RBTZd1K5BzWi679diGl4kZaygSfz9CRge8z78qI99g454nvMO1/2dvJlDnKFIvALZXTWdadpenaXR+i0Y8IeUIDmFYL2j/7VGeeoP4OUfQ8aO0fv6cIecw6c07Brtcg7VbZ2gN1GGzi1b34LFNnXwnn/yVYzX4vCnuEcFe/Z5j00LWRpWwSis95CZlEkrag48/xz/17do7W8Tih//NpJ/jLJXZOiv3eRJRSdxNDOTJFUfnAtksptaNXf72doJgyH7rW3wIj5s1NfSz74tfBC2edf+1Gkk3sSOZrIBA2RU3QbmhY7erSDBjPCmKLo7tFGsrwWbVqP3oIi2HTO6Q16NCBH0W1oJdHzvWpDuSmqyjsYGtyGVpHb0KpyG1r1921oVTEUbeg8Xp8idBRtRtLVDQ214+goug0tf415thUFD3sDOWSkb5Yq9ZnS7zFkOVtD0Ybt0TEU2bl6SEJqCwzN1p4CRdc1NDcpbdcmrgyp2evfrhaRWXRgFjWsNrQ3pagoSwxtiqK7RzP6fngtEshtaNXfdrXRbWgTMklRI7kpqsobGVoYgjSeV3ubWsSmihrXppuiqryFoZlQCN6Glr0i3FuFt6FlJW6i34giGy+yy/Mnh7FVQ2BxghxFVw+GgFk4syIYgszMOEX4HrWozwiZG0FvirIU2XiRfaHCckMz98JMU/TTezTjT79rLSrKGoqUp8hNGTWUy7qO0ajM7rEUDX72bWipSY0oaiQ3RVW5sKFlKMLE0FCuT72loakMRW52donGktwUVeXKhpYcH1F0G9pozw83NDait5KnyM+rCTSK5SqG5pdYBapyhmYDtL5vGw1FLhUMMcseVPrOvelaFGcax7XIrFibomihHLh4xj4jShgMWUBRq8XGx1IkXoJlxmPdMEA116WGEVOEI4quY2h+fZEi+foicCEm+/i0JBQnpWihXKNHQxFFyi8u/jkUdeyIHnd1CUVjw3BtlY0ZXdjQijJRi+zQNFCE+VrEvCdst9D4uhRNa4rnZ1fJJQzNmA03NEtR2VDyFL2zofkY0F2LpihyE7iuz7opcjIYGvhBakRRzdC6n2Vowzgex9NDGU2u85/WK5PLUWSb7gpF6qdQlDE038qYc6cMxRxPKHozQ4uj0nmKqnLZWsTiRao4jB1RNAxSfwZFIRhSfH5RZEhutgNZ1KhmaOa3G4Jcz9DcEiyb15SiUYy6QJFMMKJooRwXLyLzQP7U0HIUIaNIqQMoOtejLzlFXchonqK6oWAbQzsvRU5C4EMW5Y6kRS3aWRpRJE/v7SjixhQqeqBogaG0MLSdf8+iyEkhwiiSd69F/hpYkd6mTxMx0lp7jaKwmDM2NCvLDA03NjRsrK9KETCKnNy1iCd2U1SjyMeD4jHY6Q2trf46RYGkIKevRW31yyiKJwl/IEVuOiOzvsjHhdzY6myGll/StYWhuXgRjuNFYbiqTlmL8powG51YLpwilT7vmjhFA0lrKFLYcC3/fhTZeJEJFWH0HnO+/M5MULtrVhhaRNEWhoaZRyioVekJwvsDRU7OUouy65X4Ep02Jn1TVE9m6iAfwJ7Q0HJLupKnTOAa/XJDc9uNatGgaXUJ52qRn+Ez222WfMlnYy9IEexPUQtDG2ZBcCNDK1O0saG1q0UqULRSJmsRHlOL3L4WFCXtxFy6ioZ0NEW2R1praMP6ti5JSa6PUxRFGRlFeIihuSfItqhFsLIWYYYiVaFomcykCBpRFMOf2y5hnSKgYyjqEoqWGxpGhoYzDa1EURc9bbulofF4Ufk2mZ1qkaQ+YURB7OBaiqBxLeLxovLNVhtQ5PQndNUEfUz9jBR1Pmm3a62hpRR1SZrF8D2jiEeHugpFyw2NxYumDQ0TihZK01oUBdAgegjwEc31WSnya+VOQVG8xvoQQ3ML4XMUdZwigEa35cyjyEZ7mtYijHumuu4Jilgt8ljVeplDUZhVW02R/6diilBG0VBUlqJAdkyRUup4ihYbWpjlnaaoYGgpRUFTN9RM893tbmihjNaWDUYZY/cjLatFbJEpRhQdVItaRHo8HTWKsun4uT1mrkOQjk9IKKWgxYPuVlG0PGoYKLKNr5Aib2isHoYp9RxFXdJg72Boo5VGiyWYwSyKvE/ktsK0YkrRcGWLPk1OUQRhrXiK0FMUeicpRaEmKRWtgUrOh/XLT1dRtMbQFOv8B0cPK4YWU9TFFI2a+jZ3C8ygSLWvRYMLKKJIRTP2wxklitrVIhsvMk/gnX4MbyuCgj4/oAlk1YL+6VMlQs/lHieVS6ERRcq9LH76edfZHmbFb9ev8SFFlHrG0KIzOkYRZM+fvltAlp+EIjWLorUSKBrG7unR9IqkprBalG8GJmuRLD8sXlQ3tNaSpwj50fSKQieOpf52RF1puyyzmuuu8W9OEbmtKYq6pCWKXdGSocWuLkYpSPDOoqi1MIrC1mA8mZtxoHSDTrmvxWQQMkVRXg6mSDGvnVOEDSkaT2pi5Zok0amD2xua/5ulaNTulA3NXpVLD5MlX1MUndLQ/N+YIixQNBUqKfdauGct2k7ehqJus98ctA905A2tpE9uaHglQxunN03RkumpcS3i/yRyPoq8p9yUonhYEwpBpOEkhubT822QjCKJfmTh2WBoQCr3mMWrGFoUZIsEFt7ZzV7WEiLlM6a6fgJFzNRQ4ezZwCheBJXnXXeb/55HkVS/p6hLKJJHHX0wxNxotfJl8Stlr1qk5tcic5WpTsdSpFwEsS1F7JaHhRSZeJF5ByESHmtoJtXmhuYpYo9XnGloRTmkFoUALWYoWigFioQXTx08nqIIwUqKcA+KdjS0yOVzkpknE/4e5v/fw9DUkI2461ixrsl38/gehnZpivYxtJgiFrhYbmgFit7B0MLs7JyReU7ezdDUMEOBV6NoJ0MTU7TA0CLTva6hJRTh0Gmv0RgtQOap1OSUFHnBYVlMsiRigQB/vIfVLrxw6uBRhjakP03RPH2Dic27nseLwN2UxpQeLu1qUYYiIQTF4kUGzdHBkFjC+jP5jEVJll4/xIssOSh8P9pev8O4qrDyY8bvpY9O4PEi/YdOZ2gw8/n+RVl69al7NMWX1lyDomMMrUzRfoZWlLPUItWkFi2VC1GkrkDRQT2aKlG0Vr8SnX/2WhTaIaVa4kH1f//fa/4YpEzERSjy2820/u4p+o2vzxe9Xv3/789XUfnZDW2SouX6PUX4/YHf8IH99/fFDc1vN9PqKXr9/nx9e4rycnqKuLSm6PObXvTx/dH/xwsb2ja/fS0a5FstMrQ/a73kZaXZWsc/v96Vo92Wg777cYHcFO0noN5WwK6ADDk0k3UY6Ae003aFw+YIDmfo2C9xvvS5ZpGlyh+3U9TsNsJC+iG9RIM+zPRn8JmlizxeP8ZQEfvsMGXvCvW/cVBgZwLBRb794eh5TTSsnVNmOSWw6q3h9tJDLRx3TzvQKVAmAXd3sLkrMqMBgv7+K3M5uGejGf22OMYYKgyZ/36ZqN02Qe6IQlMWdnLARb8CRMeCV4B2OWVMkbtpOXfcp2/vbM4kEBfhSAOC15+/3NUid9tpHsPbSLXUoYGOW2655QBR6n9bNcGJRzt9HgAAAABJRU5ErkJggg==" alt="Alt text"></p> <p>ObjRectangleLabel</p> <p>注意</p> <p>定位点坐标用像素设置。您可以选择矩形标签定位角从 ENUM_BASE_CORNER 枚举。矩形标签边框类型可以从 ENUM_BORDER_TYPE 枚举来选择。</p> <p>该对象被用于创建和设计自定义的图形界面。</p> <p>示例</p> <p>下面的脚本创建和移动图表上的矩形标签对象。开发了特殊函数来创建和更改图形对象的属性。您可以在自己的应用程序中使用这些函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- 描述
#property description &quot;Script creates \&quot;Rectangle Label\&quot; graphical object.&quot;
//--- 启动脚本期间显示输入参数的窗口
#property script_show_inputs
//--- 脚本的输入参数
input string           InpName=&quot;RectLabel&quot;;         // 标签名称
input color            InpBackColor=clrSkyBlue;     // 背景色
input ENUM_BORDER_TYPE InpBorder=BORDER_FLAT;       // 边框类型
input ENUM_BASE_CORNER InpCorner=CORNER_LEFT_UPPER; // 图表定位角
input color            InpColor=clrDarkBlue;        // 平面边框颜色 (Flat)
input ENUM_LINE_STYLE  InpStyle=STYLE_SOLID;        // 平面边框风格 (Flat)
input int              InpLineWidth=3;              // 平面边框宽度(Flat)
input bool             InpBack=false;               // 背景对象
input bool             InpSelection=true;           // 突出移动
input bool             InpHidden=true;              // 隐藏在对象列表
input long             InpZOrder=0;                 // 鼠标单击优先
//+------------------------------------------------------------------+
//| 创建矩形标签                                                       |
//+------------------------------------------------------------------+
bool RectLabelCreate(const long             chart_ID=0,               // 图表 ID
                     const string           name=&quot;RectLabel&quot;,         // 标签名称
                     const int              sub_window=0,             // 子窗口指数
                     const int              x=0,                      // X 坐标
                     const int              y=0,                      // Y 坐标
                     const int              width=50,                 // 宽度
                     const int              height=18,                // 高度
                     const color            back_clr=C'236,233,216',  // 背景色
                     const ENUM_BORDER_TYPE border=BORDER_SUNKEN,     // 边框类型
                     const ENUM_BASE_CORNER corner=CORNER_LEFT_UPPER, // 图表定位角
                     const color            clr=clrRed,               // 平面边框颜色 (Flat)
                     const ENUM_LINE_STYLE  style=STYLE_SOLID,        // 平面边框风格
                     const int              line_width=1,             // 平面边框宽度
                     const bool             back=false,               // 在背景中
                     const bool             selection=false,          // 突出移动
                     const bool             hidden=true,              // 隐藏在对象列表
                     const long             z_order=0)                // 鼠标单击优先
  {
//--- 重置错误的值
   ResetLastError();
//--- 创建矩形标签
   if(!ObjectCreate(chart_ID,name,OBJ_RECTANGLE_LABEL,sub_window,0,0))
     {
      Print(__FUNCTION__,
            &quot;: failed to create a rectangle label! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 设置标签坐标
   ObjectSetInteger(chart_ID,name,OBJPROP_XDISTANCE,x);
   ObjectSetInteger(chart_ID,name,OBJPROP_YDISTANCE,y);
//--- 设置标签大小
   ObjectSetInteger(chart_ID,name,OBJPROP_XSIZE,width);
   ObjectSetInteger(chart_ID,name,OBJPROP_YSIZE,height);
//--- 设置背景颜色
   ObjectSetInteger(chart_ID,name,OBJPROP_BGCOLOR,back_clr);
//--- 设置边框类型
   ObjectSetInteger(chart_ID,name,OBJPROP_BORDER_TYPE,border);
//--- 设置相对于定义点坐标的图表的角
   ObjectSetInteger(chart_ID,name,OBJPROP_CORNER,corner);
//--- 设置平面边框颜色 (在平面模式下)
   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr);
//--- 设置平面边框线型风格
   ObjectSetInteger(chart_ID,name,OBJPROP_STYLE,style);
//--- 设置平面边框宽度
   ObjectSetInteger(chart_ID,name,OBJPROP_WIDTH,line_width);
//--- 显示前景 (false) 或背景 (true)
   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back);
//--- 启用 (true) 或禁用 (false) 通过鼠标移动标签的模式
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection);
   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection);
//--- 在对象列表隐藏(true) 或显示 (false) 图形对象名称
   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden);
//--- 设置在图表中优先接收鼠标点击事件
   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order);
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 移动矩形标签                                                       |
//+------------------------------------------------------------------+
bool RectLabelMove(const long   chart_ID=0,       // 图表 ID
                   const string name=&quot;RectLabel&quot;, // 标签名称
                   const int    x=0,              // X 坐标
                   const int    y=0)              // Y 坐标
  {
//--- 重置错误的值
   ResetLastError();
//--- 移动矩形标签
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_XDISTANCE,x))
     {
      Print(__FUNCTION__,
            &quot;: failed to move X coordinate of the label! Error code = &quot;,GetLastError());
      return(false);
     }
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_YDISTANCE,y))
     {
      Print(__FUNCTION__,
            &quot;: failed to move Y coordinate of the label! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 改变矩形标签的大小                                                  |
//+------------------------------------------------------------------+
bool RectLabelChangeSize(const long   chart_ID=0,       // 图表 ID
                         const string name=&quot;RectLabel&quot;, // 标签名称
                         const int    width=50,         // 标签宽度
                         const int    height=18)        // 标签高度
  {
//--- 重置错误的值
   ResetLastError();
//--- 改变标签大小
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_XSIZE,width))
     {
      Print(__FUNCTION__,
            &quot;: failed to change the label's width! Error code = &quot;,GetLastError());
      return(false);
     }
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_YSIZE,height))
     {
      Print(__FUNCTION__,
            &quot;: failed to change the label's height! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 改变矩形标签边框类型                                                |
//+------------------------------------------------------------------+
bool RectLabelChangeBorderType(const long             chart_ID=0,           // 图表 ID
                               const string           name=&quot;RectLabel&quot;,     // 标签名称
                               const ENUM_BORDER_TYPE border=BORDER_SUNKEN) // 边框类型
  {
//--- 重置错误的值
   ResetLastError();
//--- 改变边框类型
   if(!ObjectSetInteger(chart_ID,name,OBJPROP_BORDER_TYPE,border))
     {
      Print(__FUNCTION__,
            &quot;: failed to change the border type! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 删除矩形标签                                                       |
//+------------------------------------------------------------------+
bool RectLabelDelete(const long   chart_ID=0,       // 图表 ID
                     const string name=&quot;RectLabel&quot;) // 标签名称
  {
//--- 重置错误的值
   ResetLastError();
//--- 删除标签
   if(!ObjectDelete(chart_ID,name))
     {
      Print(__FUNCTION__,
            &quot;: failed to delete a rectangle label! Error code = &quot;,GetLastError());
      return(false);
     }
//--- 成功执行
   return(true);
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 图表窗口大小
   long x_distance;
   long y_distance;
//--- 设置窗口大小
   if(!ChartGetInteger(0,CHART_WIDTH_IN_PIXELS,0,x_distance))
     {
      Print(&quot;Failed to get the chart width! Error code = &quot;,GetLastError());
      return;
     }
   if(!ChartGetInteger(0,CHART_HEIGHT_IN_PIXELS,0,y_distance))
     {
      Print(&quot;Failed to get the chart height! Error code = &quot;,GetLastError());
      return;
     }
//--- 定义矩形标签坐标
   int x=(int)x_distance/4;
   int y=(int)y_distance/4;
//--- 设置标签大小
   int width=(int)x_distance/4;
   int height=(int)y_distance/4;
//--- 创建矩形标签
   if(!RectLabelCreate(0,InpName,0,x,y,width,height,InpBackColor,InpBorder,InpCorner,
      InpColor,InpStyle,InpLineWidth,InpBack,InpSelection,InpHidden,InpZOrder))
     {
      return;
     }
//--- 重绘图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- 改变矩形标签的大小
   int steps=(int)MathMin(x_distance/4,y_distance/4);
   for(int i=0;i&lt;steps ;i++)
     {
      //--- resize
      width+=1;
      height+=1;
      if(!RectLabelChangeSize(0,InpName,width,height))
         return;
      //--- 检查脚本操作是否已经强制禁用
      if(IsStopped())
         return;
      //--- 重绘图表并等待0.01秒
      ChartRedraw();
      Sleep(10);
     }
//--- 1 秒延迟
   Sleep(1000);
//--- 改变边框类型
   if(!RectLabelChangeBorderType(0,InpName,BORDER_RAISED))
      return;
//--- 重画图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- 改变边框类型
   if(!RectLabelChangeBorderType(0,InpName,BORDER_SUNKEN))
      return;
//--- 重画图表并等待1秒
   ChartRedraw();
   Sleep(1000);
//--- 删除标签
   RectLabelDelete(0,InpName);
   ChartRedraw();
//--- 等待1秒
   Sleep(1000);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br></div></div><h3 id="_2-2-2-对象属性"><a href="#_2-2-2-对象属性" class="header-anchor">#</a> 2.2.2 对象属性</h3> <p>图形对象可以有不同的属性，这取决于对象类型。对象属性的值是通过与图形对象一起工作的相应函数来设置和接收的。</p> <p>技术分析中使用的全部对象绑定时间和价格坐标：趋势线，通道，斐波纳契工具等等。但是有许多辅助对象，意在改善绑定图表始终可见部分的用户界面（主图表窗口或指标子窗口）：</p> <p>技术分析中使用的所有对象都绑定到时间和价格坐标:趋势线、通道、斐波那契工具等。但是，有一些辅助对象用于改进用户界面，这些对象绑定到图表的始终可见部分(主图表窗口或副图指标窗口):</p> <table><thead><tr><th>对象</th> <th>ID</th> <th>X/Y</th> <th>宽度/高度</th> <th>日期/价格</th> <th>OBJPROP_CORNER</th> <th>OBJPROP_ANCHOR</th> <th>OBJPROP_ANGLE</th></tr></thead> <tbody><tr><td>文本</td> <td>OBJ_TEXT</td> <td>—</td> <td>—</td> <td>Yes</td> <td>—</td> <td>Yes</td> <td>Yes</td></tr> <tr><td>标签</td> <td>OBJ_LABEL</td> <td>Yes</td> <td>Yes(只读</td> <td>—</td> <td>Yes</td> <td>Yes</td> <td>Yes</td></tr> <tr><td>按钮</td> <td>OBJ_BUTTON</td> <td>Yes</td> <td>Yes</td> <td>—</td> <td>Yes</td> <td>—</td> <td>—</td></tr> <tr><td>位图</td> <td>OBJ_BITMAP</td> <td>—</td> <td>Yes(只读)</td> <td>Yes</td> <td>—</td> <td>Yes</td> <td></td></tr> <tr><td>位图标签</td> <td>OBJ_BITMAP_LABEL</td> <td>Yes</td> <td>Yes(只读)</td> <td>—</td> <td>Yes</td> <td>Yes</td> <td>—</td></tr> <tr><td>编辑</td> <td>OBJ_EDIT</td> <td>Yes</td> <td>Yes</td> <td>—</td> <td>Yes</td> <td>—</td> <td>—</td></tr> <tr><td>矩形标签</td> <td>OBJ_RECTANGLE_LABEL</td> <td>Yes</td> <td>Yes</td> <td>—</td> <td>Yes</td> <td>—</td> <td>—</td></tr></tbody></table> <p>表中使用了下列字段名:</p> <p>• X/Y —— 相对于图表角落，以像素指定的定位点(锚点)坐标；
• 宽度/高度 —— 对象有宽度和高度。对于“只读”，只有对象呈现在图表上时才会计算宽度和高度值；
• 日期/价格 —— 使用日期和价格值指定(锚点)定位点坐标；
• OBJPROP_CORNER —— 定义了指定(锚点)定位点坐标相对的图表角落。可以是4个ENUM_BASE_CORNER 枚举值中的一个；
• OBJPROP_ANCHOR —— 定义了对象本身的(锚点)定位点，可以是9个 ENUM_ANCHOR_POINT 枚举值中的一个。从这个点到选定的图表角指定像素坐标；
• OBJPROP_ANGLE —— 定义逆时针对象旋转角度。</p> <p>定义图形对象属性的函数，以及ObjectCreate()和ObjectMove()操作用于在图表中创建和移动对象，实际上是用来向图表发送命令。如果这些函数成功执行，则该命令将包含在图表公共事件的队列中。在处理图表事件的队列时，才会实施图形对象属性的视觉变化。</p> <p>因此，不要期望在调用这些函数后 图形对象会立即发生视觉上的变化更新。通常情况下，图表上的图形对象会在发生了一个图表事件之后自动更新——例如：客户端收到一个新的报价，调整图表窗口的大小等等。使用ChartRedraw()函数可以强制更新图形对象。</p> <p>函数 ObjectSetInteger() 和 ObjectGetInteger()</p> <p>ENUM_OBJECT_PROPERTY_INTEGER</p> <table><thead><tr><th>标识符</th> <th>描述</th> <th>属性类型</th></tr></thead> <tbody><tr><td>OBJPROP_COLOR</td> <td>颜色</td> <td>color</td></tr> <tr><td>OBJPROP_STYLE</td> <td>类型</td> <td>ENUM_LINE_STYLE</td></tr> <tr><td>OBJPROP_WIDTH</td> <td>线条的宽(厚)度</td> <td>int</td></tr> <tr><td>OBJPROP_BACK</td> <td>显示背景上的对象</td> <td>bool</td></tr> <tr><td>OBJPROP_ZORDER</td> <td>图形对象优先接收点击图表事件(CHARTEVENT_CLICK)。创建对象时默认设置零值；若需要可以提高优先级。当一个接一个地应用对象时，只有级别最高的那个可以收到CHARTEVENT_CLICK 事件。</td> <td>long</td></tr> <tr><td>OBJPROP_FILL</td> <td>颜色填充对象 (针对以下对象 OBJ_RECTANGLE，矩形 OBJ_TRIANGLE，三角形 OBJ_ELLIPSE， 椭圆形 OBJ_CHANNEL，等距通道 OBJ_STDDEVCHANNEL，标准偏差通道 OBJ_REGRESSION 线性回归通道 )</td> <td>bool</td></tr> <tr><td>OBJPROP_HIDDEN</td> <td>当在客户终端文件菜单中顺序点击“图表”--&gt;“对象”--&gt;“对象列表”时，在显示出来的对象列表中隐藏该图形对象的名称。true表示将对象隐藏，即在列表中不显示该对象的名称。在MT5客户端中，默认情况下，下列对象的值被设置为true： 显示日历事件、交易历史和从MQL5程序创建的对象。要查看这些图形对象并访问其属性，请单击“对象列表”窗口中的“所有”按钮。</td> <td>bool</td></tr> <tr><td>OBJPROP_SELECTED</td> <td>对象是否被选中</td> <td>bool</td></tr> <tr><td>OBJPROP_READONLY</td> <td>是否可以在编辑对象中修改文本(是否只读)</td> <td>bool</td></tr> <tr><td>OBJPROP_TYPE</td> <td>对象类型</td> <td>ENUM_OBJECT r/o</td></tr> <tr><td>OBJPROP_TIME</td> <td>时间坐标</td> <td>修改时间 = 修改(锚点)定位点</td></tr> <tr><td>OBJPROP_SELECTABLE</td> <td>对象是否可用</td> <td>bool</td></tr> <tr><td>OBJPROP_CREATETIME</td> <td>创建对象时间</td> <td>datetime r/o</td></tr> <tr><td>OBJPROP_LEVELS</td> <td>水平线数量</td> <td>int</td></tr> <tr><td>OBJPROP_LEVELCOLOR</td> <td>水平线颜色</td> <td>修改颜色 = 水平线的数量</td></tr> <tr><td>OBJPROP_LEVELSTYLE</td> <td>水平线风格</td> <td>修改 ENUM_LINE_STYLE = 水平线的数量平线的数量</td></tr> <tr><td>OBJPROP_LEVELWIDTH</td> <td>水平线宽度(粗细)</td> <td>修改 int = 水平线的数量</td></tr> <tr><td>OBJPROP_ALIGN</td> <td>“编辑”对象中的水平文本对齐 (OBJ_EDIT)</td> <td>ENUM_ALIGN_MODE</td></tr> <tr><td>OBJPROP_FONTSIZE</td> <td>字体大小</td> <td>int</td></tr> <tr><td>OBJPROP_RAY_LEFT</td> <td>向左延长为射线</td> <td>bool</td></tr> <tr><td>OBJPROP_RAY_RIGHT</td> <td>向右延长为射线</td> <td>bool</td></tr> <tr><td>OBJPROP_RAY</td> <td>垂直线通过图表的全部窗口(包含副图指标窗口)</td> <td>bool</td></tr> <tr><td>OBJPROP_ELLIPSE</td> <td>显示裴波那契弧形对象的完整椭圆 (OBJ_FIBOARC)</td> <td>bool</td></tr> <tr><td>OBJPROP_ARROWCODE</td> <td>箭头对象代码</td> <td>char</td></tr> <tr><td>OBJPROP_TIMEFRAMES</td> <td>时间框架图表上的对象可见性</td> <td>设置标识 flags 勾选框</td></tr> <tr><td>OBJPROP_ANCHOR</td> <td>图解对象的(锚点)定位点</td> <td>ENUM_ARROW_ANCHOR (用于 OBJ_ARROW), ENUM_ANCHOR_POINT (用于 OBJ_LABEL, OBJ_BITMAP_LABEL, OBJ_TEXT)</td></tr> <tr><td>OBJPROP_XDISTANCE</td> <td>X轴定位点像素距离 (请参考下面的注意)</td> <td>int</td></tr> <tr><td>OBJPROP_YDISTANCE</td> <td>Y轴定位点像素距离 (请参考下面的注意)</td> <td>int</td></tr> <tr><td>OBJPROP_DIRECTION</td> <td>江恩对象趋势线</td> <td>ENUM_GANN_DIRECTION</td></tr> <tr><td>OBJPROP_DEGREE</td> <td>艾略特波浪标记级别</td> <td>ENUM_ELLIOT_WAVE_DEGREE</td></tr> <tr><td>OBJPROP_DRAWLINES</td> <td>显示用于标记艾略特波浪的线</td> <td>bool</td></tr> <tr><td>OBJPROP_STATE</td> <td>按钮状态（按下/弹起）</td> <td>bool</td></tr> <tr><td>OBJPROP_CHART_ID</td> <td>“图表”对象的ID (OBJ_CHART)。它允许使用图表操作中描述的函数来处理该对象的属性，比如使用正常的图表，但也有一些例外。</td> <td>long r/o</td></tr> <tr><td>OBJPROP_XSIZE</td> <td>X轴向上对象的宽度，单位:像素。用于以下对象 OBJ_LABEL(只读) 标签对象 OBJ_BUTTON、按钮对象 OBJ_CHART、 图表对象 OBJ_BITMAP、位图对象 OBJ_BITMAP_LABEL、 位图对象标签 OBJ_EDIT、 编辑对象 OBJ_RECTANGLE_LABEL 矩形标签对象</td> <td>int</td></tr> <tr><td>OBJPROP_YSIZE</td> <td>Y轴向上对象的高度，单位:像素。用于以下对象 OBJ_LABEL(只读) 标签对象 OBJ_BUTTON、按钮对象 OBJ_CHART、 图表对象 OBJ_BITMAP、位图对象 OBJ_BITMAP_LABEL、 位图对象标签 OBJ_EDIT、 编辑对象 OBJ_RECTANGLE_LABEL 矩形标签对象</td> <td>int</td></tr> <tr><td>OBJPROP_XOFFSET</td> <td>用于图形对象“位图标签”(OBJ_BITMAP_LABEL)和“位图”(OBJ_BITMAP) 中的矩形可见区域左上角的X坐标。该值由原始图片左上角对应的像素设置。</td> <td>int</td></tr> <tr><td>OBJPROP_YOFFSET</td> <td>用于图形对象“位图标签”(OBJ_BITMAP_LABEL)和“位图”(OBJ_BITMAP) 中的矩形可见区域左上角的Y坐标。该值由原始图片左上角对应的像素设置。</td> <td>int</td></tr> <tr><td>OBJPROP_PERIOD</td> <td>图解对象时间框架</td> <td>ENUM_TIMEFRAMES</td></tr> <tr><td>OBJPROP_DATE_SCALE</td> <td>显示图解对象时间刻度标尺</td> <td>bool</td></tr> <tr><td>OBJPROP_PRICE_SCALE</td> <td>显示图解对象价格刻度标尺</td> <td>bool</td></tr> <tr><td>OBJPROP_CHART_SCALE</td> <td>图表对象的刻度标尺</td> <td>0-5的整数值</td></tr> <tr><td>OBJPROP_BGCOLOR</td> <td>编辑对象背景颜色 OBJ_EDIT, OBJ_BUTTON, OBJ_RECTANGLE_LABEL</td> <td>color</td></tr> <tr><td>OBJPROP_CORNER</td> <td>图表连接到图解对象</td> <td>ENUM_BASE_CORNER</td></tr> <tr><td>OBJPROP_BORDER_TYPE</td> <td>“矩形标签”对象的边框类型</td> <td>ENUM_BORDER_TYPE</td></tr> <tr><td>OBJPROP_BORDER_COLOR</td> <td>OBJ_EDIT 和 OBJ_BUTTON 对象的边框色</td> <td>color</td></tr></tbody></table> <p>当使用“图表”对象(OBJ_CHART)的 图表操作 时，会有以下限制：</p> <p>• 不能使用 ChartClose()关闭；
• 不能使用 ChartSetSymbolPeriod() 函数改变交易品种/周期；
• 以下属性无效
CHART_SCALE,
CHART_BRING_TO_TOP,
CHART_SHOW_DATE_SCALE
CHART_SHOW_PRICE_SCALE (ENUM_CHART_PROPERTY_INTEGER)</p> <p>您可以为OBJ_BITMAP_LABEL和OBJ_BITMAP对象设置一个特殊的图像显示模式。在这种模式下，只显示原始图像的一部分(在这个图像中应用一个矩形的可见区域)，而图像的其余部分则是不可见的。应该使用OBJPROP_XSIZE和OBJPROP_YSIZE的属性设置该区域的大小。可以使用OBJPROP_XOFFSET和OBJPROP_YOFFSET属性在原始图像中“移动”可见区域。</p> <p>对于固定大小的对象:OBJ_BUTTON, OBJ_RECTANGLE_LABEL, OBJ_EDIT和OBJ_CHART, 属性 OBJPROP_XDISTANCE和OBJPROP_YDISTANCE设置对象的左上角的位置相对于图角(OBJPROP_CORNER)，其中X和Y坐标将以像素计算。</p> <p>函数 ObjectSetDouble() 和 ObjectGetDouble()</p> <p>ENUM_OBJECT_PROPERTY_DOUBLE</p> <table><thead><tr><th>标识符</th> <th>描述</th> <th>属性类型</th></tr></thead> <tbody><tr><td>OBJPROP_PRICE</td> <td>价格坐标</td> <td>double 修饰符=定位点号</td></tr> <tr><td>OBJPROP_LEVELVALUE</td> <td>水平线的值</td> <td>double 修饰符=水平号</td></tr> <tr><td>OBJPROP_SCALE</td> <td>比例（江恩对象和斐波纳契 弧线）</td> <td>double</td></tr> <tr><td>OBJPROP_ANGLE</td> <td>角度。对于程序创建的，无指定角度的对象来说，它的值等同于 EMPTY_VALUE</td> <td>double</td></tr> <tr><td>OBJPROP_DEVIATION</td> <td>标准偏差通道误差</td> <td>double</td></tr></tbody></table> <p>函数 ObjectSetString() 和 ObjectGetString()</p> <p>nbsp;</p> <p>ENUM_OBJECT_PROPERTY_STRING</p> <table><thead><tr><th>标识符</th> <th>描述</th> <th>属性类型</th></tr></thead> <tbody><tr><td>OBJPROP_NAME</td> <td>物件名称</td> <td>string</td></tr> <tr><td>OBJPROP_TEXT</td> <td>物件描述（物件中包含的文本）</td> <td>string</td></tr> <tr><td>OBJPROP_TOOLTIP</td> <td>提示信息文本。如果没有设置属性，那么将显示程序端自动生成的提示信息。提示信息可以通过设置&quot;\n&quot; (line feed) 值来禁用</td> <td>string</td></tr> <tr><td>OBJPROP_LEVELTEXT</td> <td>水平描述</td> <td>string 修饰符=水平号</td></tr> <tr><td>OBJPROP_FONT</td> <td>字体</td> <td>string</td></tr> <tr><td>OBJPROP_BMPFILE</td> <td>文件的位图标签名称 相关参考 Resources</td> <td>string 修饰符: 0-state ON, 1-state OFF</td></tr> <tr><td>OBJPROP_SYMBOL</td> <td>图表对象的交易品种</td> <td>string</td></tr></tbody></table> <p>对于 OBJ_RECTANGLE_LABEL 对象 (&quot;矩形标签&quot;) 可以设置三个设计模式中的一种，与ENUM_BORDER_TYPE 以下值相对应。</p> <table><thead><tr><th>标识符</th> <th>描述</th></tr></thead> <tbody><tr><td>BORDER_FLAT</td> <td>平面造型</td></tr> <tr><td>BORDER_RAISED</td> <td>突出造型</td></tr> <tr><td>BORDER_SUNKEN</td> <td>凹陷造型</td></tr></tbody></table> <p>对于 OBJ_EDIT 对象 (&quot;编辑&quot;) 和对于 ChartScreenShot() 函数，您可以使用ENUM_ALIGN_MODE枚举值来指定水平对齐类型。</p> <table><thead><tr><th>标识符</th> <th>描述</th></tr></thead> <tbody><tr><td>ALIGN_LEFT</td> <td>左对齐</td></tr> <tr><td>ALIGN_CENTER</td> <td>集中(仅用于编辑对象)</td></tr> <tr><td>ALIGN_RIGHT</td> <td>右对齐</td></tr></tbody></table> <p>示例</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#define  UP          &quot;\x0431&quot;
//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+
void OnStart()
  {
//---
   string label_name=&quot;my_OBJ_LABEL_object&quot;;
   if(ObjectFind(0,label_name)&lt;0)
     {
      Print(&quot;Object &quot;,label_name,&quot; not found. Error code = &quot;,GetLastError());
      //--- create Label object
      ObjectCreate(0,label_name,OBJ_LABEL,0,0,0);
      //--- set X coordinate
      ObjectSetInteger(0,label_name,OBJPROP_XDISTANCE,200);
      //--- set Y coordinate
      ObjectSetInteger(0,label_name,OBJPROP_YDISTANCE,300);
      //--- define text color
      ObjectSetInteger(0,label_name,OBJPROP_COLOR,clrWhite);
      //--- define text for object Label
      ObjectSetString(0,label_name,OBJPROP_TEXT,UP);
      //--- define font
      ObjectSetString(0,label_name,OBJPROP_FONT,&quot;Wingdings&quot;);
      //--- define font size
      ObjectSetInteger(0,label_name,OBJPROP_FONTSIZE,10);
      //--- 45 degrees rotation clockwise
      ObjectSetDouble(0,label_name,OBJPROP_ANGLE,-45);
      //--- disable for mouse selecting
      ObjectSetInteger(0,label_name,OBJPROP_SELECTABLE,false);
      //--- draw it on the chart
      ChartRedraw(0);
     }
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><h3 id="_2-2-3-对象定位方法"><a href="#_2-2-3-对象定位方法" class="header-anchor">#</a> 2.2.3 对象定位方法</h3> <p>图形对象文本 OBJ_TEXT、标签 OBJ_LABEL、位图 OBJ_BITMAP 位图标签 OBJ_BITMAP_LABEL) 。可以使用OBJPROP_ANCHOR属性定义的9种不同的坐标绑定方法中的一种。</p> <table><thead><tr><th>对象</th> <th>ID</th> <th>X/Y</th> <th>宽度/高度</th> <th>日期/价格</th> <th>OBJPROP_CORNER</th> <th>OBJPROP_ANCHOR</th> <th>OBJPROP_ANGLE</th></tr></thead> <tbody><tr><td>文本</td> <td>OBJ_TEXT</td> <td>—</td> <td>—</td> <td>Yes</td> <td>—</td> <td>Yes</td> <td>Yes</td></tr> <tr><td>标签</td> <td>OBJ_LABEL</td> <td>Yes</td> <td>Yes(只读</td> <td>—</td> <td>Yes</td> <td>Yes</td> <td>Yes</td></tr> <tr><td>按钮</td> <td>OBJ_BUTTON</td> <td>Yes</td> <td>Yes</td> <td>—</td> <td>Yes</td> <td>—</td> <td>—</td></tr> <tr><td>位图</td> <td>OBJ_BITMAP</td> <td>—</td> <td>Yes(只读)</td> <td>Yes</td> <td>—</td> <td>Yes</td> <td></td></tr> <tr><td>位图标签</td> <td>OBJ_BITMAP_LABEL</td> <td>Yes</td> <td>Yes(只读)</td> <td>—</td> <td>Yes</td> <td>Yes</td> <td>—</td></tr> <tr><td>编辑</td> <td>OBJ_EDIT</td> <td>Yes</td> <td>Yes</td> <td>—</td> <td>Yes</td> <td>—</td> <td>—</td></tr> <tr><td>矩形标签</td> <td>OBJ_RECTANGLE_LABEL</td> <td>Yes</td> <td>Yes</td> <td>—</td> <td>Yes</td> <td>—</td> <td>—</td></tr></tbody></table> <p>表中使用了下列字段名:</p> <p>• X/Y —— 相对于图表角落，以像素指定的定位点(锚点)坐标；
• 宽度/高度 —— 对象有宽度和高度。对于“只读”，只有对象呈现在图表上时才会计算宽度和高度值；
• 日期/价格 —— 使用日期和价格值指定(锚点)定位点坐标；
• OBJPROP_CORNER —— 定义了指定(锚点)定位点坐标相对的图表角落。可以是4个ENUM_BASE_CORNER 枚举值中的一个；
• OBJPROP_ANCHOR —— 定义了对象本身的(锚点)定位点，可以是9个 ENUM_ANCHOR_POINT 枚举值中的一个。从这个点到选定的图表角指定像素坐标；
• OBJPROP_ANGLE —— 定义逆时针对象旋转角度。</p> <p>可以使用函数</p> <p>ObjectSetInteger(chart_handle、object_name、OBJPROP_ANCHOR、anchor_point_mode) 来指定必要的形式参数变量，其中形式参数 anchor_point_mode 的取值范围是ENUM_ANCHOR_POINT 的枚举值之一。</p> <p>ENUM_ANCHOR_POINT</p> <table><thead><tr><th>ID</th> <th>描述</th></tr></thead> <tbody><tr><td>ANCHOR_LEFT_UPPER</td> <td>左上角定位点</td></tr> <tr><td>ANCHOR_LEFT</td> <td>左侧定位点</td></tr> <tr><td>ANCHOR_LEFT_LOWER</td> <td>左下角定位点</td></tr> <tr><td>ANCHOR_LOWER</td> <td>下方定位点</td></tr> <tr><td>ANCHOR_RIGHT_LOWER</td> <td>右下方定位点</td></tr> <tr><td>ANCHOR_RIGHT</td> <td>右侧定位点</td></tr> <tr><td>ANCHOR_RIGHT_UPPER</td> <td>右上角定位点</td></tr> <tr><td>ANCHOR_UPPER</td> <td>上方定位点</td></tr> <tr><td>ANCHOR_CENTER</td> <td>对象中间严格定位点</td></tr></tbody></table> <p>按钮 OBJ_BUTTON，矩形标签 OBJ_RECTANGLE_LABEL，编辑 OBJ_EDIT， 图表 OBJ_CHART 对象 在左上角(ANCHOR_LEFT_UPPER)有一个修正的定位点(锚点)。</p> <p>示例</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>   string text_name=&quot;my_OBJ_TEXT_object&quot;;
   if(ObjectFind(0,text_name)&lt;0)
     {
      Print(&quot;Object &quot;,text_name,&quot; not found. Error code = &quot;,GetLastError());
      //--- 获得图表最大价格
      double chart_max_price=ChartGetDouble(0,CHART_PRICE_MAX,0);
      //--- 创建物件标签
      ObjectCreate(0,text_name,OBJ_TEXT,0,TimeCurrent(),chart_max_price);
      //--- 设置文本颜色
      ObjectSetInteger(0,text_name,OBJPROP_COLOR,clrWhite);
      //--- 设置背景色
      ObjectSetInteger(0,text_name,OBJPROP_BGCOLOR,clrGreen);
      //--- 设置标签物件文本
      ObjectSetString(0,text_name,OBJPROP_TEXT,TimeToString(TimeCurrent()));
      //--- 设置文本字体
      ObjectSetString(0,text_name,OBJPROP_FONT,&quot;Trebuchet MS&quot;);
      //--- 设置字体大小
      ObjectSetInteger(0,text_name,OBJPROP_FONTSIZE,10);
      //--- 定位右上角
      ObjectSetInteger(0,text_name,OBJPROP_ANCHOR,ANCHOR_RIGHT_UPPER);
      //--- 顺时针方向旋转90度
      ObjectSetDouble(0,text_name,OBJPROP_ANGLE,90);
      //--- 禁止鼠标选择物件
      ObjectSetInteger(0,text_name,OBJPROP_SELECTABLE,false);
      //--- 重画物件
      ChartRedraw(0);
     }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>图解对象箭头(OBJ_ARROW)连接到坐标有两种方式，标识符连接到ENUM_ARROW_ANCHOR。 图形对象箭头(OBJ_ARROW)只有两种连接它们的坐标的方法。标识符列在ENUM_ARROW_ANCHOR中。</p> <p>ENUM_ARROW_ANCHOR</p> <table><thead><tr><th>标识符</th> <th>描述</th></tr></thead> <tbody><tr><td>ANCHOR_TOP</td> <td>上部定位点</td></tr> <tr><td>ANCHOR_BOTTOM</td> <td>下部定位点</td></tr></tbody></table> <div class="language- line-numbers-mode"><pre class="language-text"><code>void OnStart()
  {
//--- 辅助数组
   double Ups[],Downs[];
   datetime Time[];
//--- 设置数组为时间序列
   ArraySetAsSeries(Ups,true);
   ArraySetAsSeries(Downs,true);
   ArraySetAsSeries(Time,true);
//--- 创建指标iFractals句柄
   int FractalsHandle=iFractals(NULL,0);
   Print(&quot;FractalsHandle = &quot;,FractalsHandle);
//--- 设置最近的错误值到零
   ResetLastError();
//--- 复制指标值
   int copied=CopyBuffer(FractalsHandle,0,0,1000,Ups);
   if(copied &lt;= 0)
     {
      Print(&quot;Unable to copy the upper fractals. Error = &quot;,GetLastError());
      return;
     }

   ResetLastError();
//--- 复制指标值
   copied=CopyBuffer(FractalsHandle,1,0,1000,Downs);
   if(copied&lt;=0)
     {
      Print(&quot;Unable to copy the bottom fractals. Error = &quot;,GetLastError());
      return;
     }

   ResetLastError();
//--- 复制包括最近1000开盘柱的时间序列
   copied=CopyTime(NULL,0,0,1000,Time);
   if(copied&lt;=0)
     {
      Print(&quot;Unable to copy the Opening Time of the last 1000 bars&quot;);
      return;
     }

   int upcounter=0,downcounter=0; // 数箭头数
   bool created;// 接收尝试结果去创建物件
   for(int i=2;i&lt;copied;i++)// 运行通过指标iFractals值
     {
      if(Ups[i]!=EMPTY_VALUE)// 找到上面的分数据
        {
         if(upcounter &lt; 10)// 创建少于10个“向上”箭头
           {
            //--- 创建 &quot;向上&quot; 物件
            created=ObjectCreate(0,string(Time[i]),OBJ_ARROW_THUMB_UP,0,Time[i],Ups[i]);
            if(created)// 若设置 - 调节它
              {
               //--- 定位点在下面为了不覆盖柱
               ObjectSetInteger(0,string(Time[i]),OBJPROP_ANCHOR,ANCHOR_BOTTOM);
               //--- 最后接触-绘画
               ObjectSetInteger(0,string(Time[i]),OBJPROP_COLOR,clrBlue);
               upcounter++;
              }
           }
        }
      if(Downs[i]!=EMPTY_VALUE)// 发现较低的分数据
        {
         if(downcounter &lt; 10)// 创建少于10个“向下”箭头
           {
            //--- 创建 &quot;向下&quot; 物件
            created=ObjectCreate(0,string(Time[i]),OBJ_ARROW_THUMB_DOWN,0,Time[i],Downs[i]);
            if(created)// 若设置 - 调节它
              {
               //--- 定位点在上面为了不覆盖柱
               ObjectSetInteger(0,string(Time[i]),OBJPROP_ANCHOR,ANCHOR_TOP);
               //--- 最后接触-绘画
               ObjectSetInteger(0,string(Time[i]),OBJPROP_COLOR,clrRed);
               downcounter++;
              }
           }
        }
     }
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br></div></div><p>在脚本执行完毕后，图表看起来像这样。</p> <p><img src="data:image/png;base64,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" alt="Alt text"></p> <h3 id="_2-2-4-附加物件的图表角落"><a href="#_2-2-4-附加物件的图表角落" class="header-anchor">#</a> 2.2.4 附加物件的图表角落</h3> <p>这里有大量的图形对象 ，为此您可以设置一个图表角落，相对于它指定像素坐标。以下是对象类型（括号中是指定的对象类型标识符）：</p> <p>• 标签 (OBJ_LABEL)；
• 按键 (OBJ_BUTTON)；
• 位图标签 (OBJ_BITMAP_LABEL)；
• 编辑(OBJ_EDIT)。
• 矩形标签(OBJ_RECTANGLE_LABEL)；</p> <h3 id="_2-2-3-对象定位方法-2"><a href="#_2-2-3-对象定位方法-2" class="header-anchor">#</a> 2.2.3 对象定位方法</h3> <p>图形对象文本 OBJ_TEXT、标签 OBJ_LABEL、位图 OBJ_BITMAP 位图标签 OBJ_BITMAP_LABEL) 。可以使用OBJPROP_ANCHOR属性定义的9种不同的坐标绑定方法中的一种。</p> <table><thead><tr><th>对象</th> <th>ID</th> <th>X/Y</th> <th>宽度/高度</th> <th>日期/价格</th> <th>OBJPROP_CORNER</th> <th>OBJPROP_ANCHOR</th> <th>OBJPROP_ANGLE</th></tr></thead> <tbody><tr><td>文本</td> <td>OBJ_TEXT</td> <td>—</td> <td>—</td> <td>Yes</td> <td>—</td> <td>Yes</td> <td>Yes</td></tr> <tr><td>标签</td> <td>OBJ_LABEL</td> <td>Yes</td> <td>Yes(只读</td> <td>—</td> <td>Yes</td> <td>Yes</td> <td>Yes</td></tr> <tr><td>按钮</td> <td>OBJ_BUTTON</td> <td>Yes</td> <td>Yes</td> <td>—</td> <td>Yes</td> <td>—</td> <td>—</td></tr> <tr><td>位图</td> <td>OBJ_BITMAP</td> <td>—</td> <td>Yes(只读)</td> <td>Yes</td> <td>—</td> <td>Yes</td> <td></td></tr> <tr><td>位图标签</td> <td>OBJ_BITMAP_LABEL</td> <td>Yes</td> <td>Yes(只读)</td> <td>—</td> <td>Yes</td> <td>Yes</td> <td>—</td></tr> <tr><td>编辑</td> <td>OBJ_EDIT</td> <td>Yes</td> <td>Yes</td> <td>—</td> <td>Yes</td> <td>—</td> <td>—</td></tr> <tr><td>矩形标签</td> <td>OBJ_RECTANGLE_LABEL</td> <td>Yes</td> <td>Yes</td> <td>—</td> <td>Yes</td> <td>—</td> <td>—</td></tr></tbody></table> <p>表中使用了下列字段名:</p> <p>• X/Y —— 相对于图表角落，以像素指定的定位点(锚点)坐标；
• 宽度/高度 —— 对象有宽度和高度。对于“只读”，只有对象呈现在图表上时才会计算宽度和高度值；
• 日期/价格 —— 使用日期和价格值指定(锚点)定位点坐标；
• OBJPROP_CORNER —— 定义了指定(锚点)定位点坐标相对的图表角落。可以是4个ENUM_BASE_CORNER 枚举值中的一个；
• OBJPROP_ANCHOR —— 定义了对象本身的(锚点)定位点，可以是9个 ENUM_ANCHOR_POINT 枚举值中的一个。从这个点到选定的图表角指定像素坐标；
• OBJPROP_ANGLE —— 定义逆时针对象旋转角度。</p> <p>为了指定图表内角，X和Y坐标都要测量像素，使用ObjectSetInteger(chartID,name,OBJPROP_CORNER,chart_corner)：</p> <p>为了指定图表的角，X和Y坐标将以像素为单位进行测量，使用函数 ObjectSetInteger(chartID, name, OBJPROP_CORNER, chart_corner)，</p> <p>其中形式参数的说明如下:</p> <p>• chartID —— 图表标识符编号；
• name —— 图解对象的名称；
• OBJPROP_CORNER —— 指定捆绑一个角落的标识符编号ID ；
• chart_corner —— 目标图表，可以是 ENUM_BASE_CORNER 枚具值中的一个。</p> <p>ENUM_BASE_CORNER</p> <table><thead><tr><th>ID</th> <th>描述</th></tr></thead> <tbody><tr><td>CORNER_LEFT_UPPER</td> <td>中央坐标在图表左上角</td></tr> <tr><td>CORNER_LEFT_LOWER</td> <td>中央左边在图表左下角</td></tr> <tr><td>CORNER_RIGHT_LOWER</td> <td>中央坐标在图表右下角</td></tr> <tr><td>CORNER_RIGHT_UPPER</td> <td>中央左边在图表右上角</td></tr></tbody></table> <p>示例</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>void CreateLabel(long   chart_id,
                 string name,
                 int    chart_corner,
                 int    anchor_point,
                 string text_label,
                 int    x_ord,
                 int    y_ord)
  {
//---
   if(ObjectCreate(chart_id,name,OBJ_LABEL,0,0,0))
     {
      ObjectSetInteger(chart_id,name,OBJPROP_CORNER,chart_corner);
      ObjectSetInteger(chart_id,name,OBJPROP_ANCHOR,anchor_point);
      ObjectSetInteger(chart_id,name,OBJPROP_XDISTANCE,x_ord);
      ObjectSetInteger(chart_id,name,OBJPROP_YDISTANCE,y_ord);
      ObjectSetString(chart_id,name,OBJPROP_TEXT,text_label);
     }
   else
      Print(&quot;Failed to create the object OBJ_LABEL &quot;,name,&quot;, Error code = &quot;, GetLastError());
  }
//+------------------------------------------------------------------+
//| 脚本程序起始函数                                    |
//+------------------------------------------------------------------+
void OnStart()
  {
//---
   int height=(int)ChartGetInteger(0,CHART_HEIGHT_IN_PIXELS,0);
   int width=(int)ChartGetInteger(0,CHART_WIDTH_IN_PIXELS,0);
   string arrows[4]={&quot;LEFT_UPPER&quot;,&quot;RIGHT_UPPER&quot;,&quot;RIGHT_LOWER&quot;,&quot;LEFT_LOWER&quot;};
   CreateLabel(0,arrows[0],CORNER_LEFT_UPPER,ANCHOR_LEFT_UPPER,arrows[0],50,50);
   CreateLabel(0,arrows[1],CORNER_RIGHT_UPPER,ANCHOR_RIGHT_UPPER,arrows[1],50,50);
   CreateLabel(0,arrows[2],CORNER_RIGHT_LOWER,ANCHOR_RIGHT_LOWER,arrows[2],50,50);
   CreateLabel(0,arrows[3],CORNER_LEFT_LOWER,ANCHOR_LEFT_LOWER,arrows[3],50,50);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><h3 id="_2-2-5-对象可见性"><a href="#_2-2-5-对象可见性" class="header-anchor">#</a> 2.2.5 对象可见性</h3> <p>对象可见性标志的组合决定了在哪些时间框架的图表上，对象是可见的(显示的)，在哪些时间框架的图表上，对象是不可见的(隐藏的)。</p> <p>要 设置 objprop_timeframe 属性的值，使用函数ObjectSetInteger()，</p> <p>要 获取 objprop_timeframe 属性的值，使用函数 ObjectGetInteger()。</p> <table><thead><tr><th>ID</th> <th>值</th> <th>描述</th></tr></thead> <tbody><tr><td>OBJ_NO_PERIODS</td> <td>0</td> <td>所有时间图表中都不显示</td></tr> <tr><td>OBJ_PERIOD_M1</td> <td>0x00000001</td> <td>1分钟图表显示</td></tr> <tr><td>OBJ_PERIOD_M2</td> <td>0x00000002</td> <td>2分钟图表显示</td></tr> <tr><td>OBJ_PERIOD_M3</td> <td>0x00000004</td> <td>3分钟图表显示</td></tr> <tr><td>OBJ_PERIOD_M4</td> <td>0x00000008</td> <td>4分钟图表显示</td></tr> <tr><td>OBJ_PERIOD_M5</td> <td>0x00000010</td> <td>5分钟图表显示</td></tr> <tr><td>OBJ_PERIOD_M6</td> <td>0x00000020</td> <td>6分钟图表显示</td></tr> <tr><td>OBJ_PERIOD_M10</td> <td>0x00000040</td> <td>10分钟图表显示</td></tr> <tr><td>OBJ_PERIOD_M12</td> <td>0x00000080</td> <td>12分钟图表显示</td></tr> <tr><td>OBJ_PERIOD_M15</td> <td>0x00000100</td> <td>15分钟图表显示</td></tr> <tr><td>OBJ_PERIOD_M20</td> <td>0x00000200</td> <td>20分钟图表显示</td></tr> <tr><td>OBJ_PERIOD_M30</td> <td>0x00000400</td> <td>30分钟图表显示</td></tr> <tr><td>OBJ_PERIOD_H1</td> <td>0x00000800</td> <td>1小时图表显示</td></tr> <tr><td>OBJ_PERIOD_H2</td> <td>0x00001000</td> <td>2小时图表显示</td></tr> <tr><td>OBJ_PERIOD_H3</td> <td>0x00002000</td> <td>3小时图表显示</td></tr> <tr><td>OBJ_PERIOD_H4</td> <td>0x00004000</td> <td>4小时图表显示</td></tr> <tr><td>OBJ_PERIOD_H6</td> <td>0x00008000</td> <td>6小时图表显示</td></tr> <tr><td>OBJ_PERIOD_H8</td> <td>0x00010000</td> <td>8小时图表显示</td></tr> <tr><td>OBJ_PERIOD_H12</td> <td>0x00020000</td> <td>12小时图表显示</td></tr> <tr><td>OBJ_PERIOD_D1</td> <td>0x00040000</td> <td>日线图表上显示</td></tr> <tr><td>OBJ_PERIOD_W1</td> <td>0x00080000</td> <td>周线图表上显示</td></tr> <tr><td>OBJ_PERIOD_MN1</td> <td>0x00100000</td> <td>月线图表上显示</td></tr> <tr><td>OBJ_ALL_PERIODS</td> <td>0x001fffff</td> <td>所有时间图表上都显示</td></tr></tbody></table> <p>可以使用符号“|”将可见标志组合在一起，例如，OBJ_PERIOD_M10|OBJ_PERIOD_H4的组合表示将在10分钟和4小时的时间图表上显示该对象。</p> <p>示例:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>void OnStart()
  {
//---
   string highlevel=&quot;PreviousDayHigh&quot;;
   string lowlevel=&quot;PreviousDayLow&quot;;
   double prevHigh;           // 前一天最高价
   double prevLow;            // 前一天最低价
   double highs[],lows[];     // 最高和最低价数组

//--- 重置上一个错误
   ResetLastError();
//--- 获得日常时间表最近的2个最高值
   int highsgot=CopyHigh(Symbol(),PERIOD_D1,0,2,highs);
   if(highsgot&gt;0) // 如果复制成功
     {
      Print(&quot;High prices for the last 2 days were obtained successfully&quot;);
      prevHigh=highs[0]; // 前一天最高价
      Print(&quot;prevHigh = &quot;,prevHigh);
      if(ObjectFind(0,highlevel)&lt;0) // 没有找到名为highlevel物件
        {
         ObjectCreate(0,highlevel,OBJ_HLINE,0,0,0); // 创建水平线物件
        }
      //--- 为高位线价格平面设置值
      ObjectSetDouble(0,highlevel,OBJPROP_PRICE,0,prevHigh);
      //--- 仅设置PERIOD_M10和PERIOD_H4的可见性
      ObjectSetInteger(0,highlevel,OBJPROP_TIMEFRAMES,OBJ_PERIOD_M10|OBJ_PERIOD_H4);
     }
   else
     {
      Print(&quot;Could not get High prices over the past 2 days, Error = &quot;,GetLastError());
     }

//--- 重置上一个错误
   ResetLastError();
//--- 获得日常时间表最近的2个最低值
   int lowsgot=CopyLow(Symbol(),PERIOD_D1,0,2,lows);
   if(lowsgot&gt;0) // 如果复制成功
     {
      Print(&quot;Low prices for the last 2 days were obtained successfully&quot;);
      prevLow=lows[0]; // 前一天最低价
      Print(&quot;prevLow = &quot;,prevLow);
      if(ObjectFind(0,lowlevel)&lt;0) // 没有找到名为lowlevel物件
        {
         ObjectCreate(0,lowlevel,OBJ_HLINE,0,0,0); // 创建水平线物件
        }
      //--- 为低位线价格平面设置值
      ObjectSetDouble(0,lowlevel,OBJPROP_PRICE,0,prevLow);
      //--- 仅设置PERIOD_M10和PERIOD_H4的可见性
      ObjectSetInteger(0,lowlevel,OBJPROP_TIMEFRAMES,OBJ_PERIOD_M10|OBJ_PERIOD_H4);
     }
   else Print(&quot;Could not get Low prices for the last 2 days, Error = &quot;,GetLastError());

   ChartRedraw(0); // 强制重画图表
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br></div></div><h3 id="_2-2-6-艾略特波浪级别"><a href="#_2-2-6-艾略特波浪级别" class="header-anchor">#</a> 2.2.6 艾略特波浪级别</h3> <p>艾略特波由两种类型的图解对象(OBJ_ELLIOTWAVE5和OBJ_ELLIOTWAVE3)表示。为了设置波浪的大小(标记波浪的方法)，使用OBJPROP_DEGREE属性，可以指定ENUM_ELLIOT_WAVE_DEGREE枚举型数据的一个值。</p> <p>ENUM_ELLIOT_WAVE_DEGREE</p> <table><thead><tr><th>ELLIOTT_GRAND_SUPERCYCLE</th> <th>特大超级循环级</th></tr></thead> <tbody><tr><td>ELLIOTT_SUPERCYCLE</td> <td>超级循环级</td></tr> <tr><td>ELLIOTT_CYCLE</td> <td>循环级</td></tr> <tr><td>ELLIOTT_PRIMARY</td> <td>主级</td></tr> <tr><td>ELLIOTT_INTERMEDIATE</td> <td>中级</td></tr> <tr><td>ELLIOTT_MINOR</td> <td>次级</td></tr> <tr><td>ELLIOTT_MINUTE</td> <td>小级</td></tr> <tr><td>ELLIOTT_MINUETTE</td> <td>微级</td></tr> <tr><td>ELLIOTT_SUBMINUETTE</td> <td>超微级</td></tr></tbody></table> <p>示例:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>for(int i=0;i&lt; ObjectsTotal(0);i++)
     {
      string currobj=ObjectName(0,i);
      if((ObjectGetInteger(0,currobj,OBJPROP_TYPE)==OBJ_ELLIOTWAVE3) ||
         ((ObjectGetInteger(0,currobj,OBJPROP_TYPE)==OBJ_ELLIOTWAVE5)))
        {
         //--- 在INTERMEDIATE设置标记水平
         ObjectSetInteger(0,currobj,OBJPROP_DEGREE,ELLIOTT_INTERMEDIATE);
         //--- 显示波峰间的线
         ObjectSetInteger(0,currobj,OBJPROP_DRAWLINES,true);
         //--- 设置线颜色
         ObjectSetInteger(0,currobj,OBJPROP_COLOR,clrBlue);
         //--- 设置线宽
         ObjectSetInteger(0,currobj,OBJPROP_WIDTH,5);
         //--- 设置描述
         ObjectSetString(0,currobj,OBJPROP_TEXT,&quot;test script&quot;);
        }
     }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="_2-2-7-江恩对象"><a href="#_2-2-7-江恩对象" class="header-anchor">#</a> 2.2.7 江恩对象</h3> <p>对于 江恩角度线 (OBJ_GANNFAN) 和 江恩网格 (OBJ_GANNGRID)来说，您可以指定两个用于设置趋势方向的ENUM_GANN_DIRECTION枚举值。</p> <p>ENUM_GANN_DIRECTION</p> <table><thead><tr><th>ID</th> <th>描述</th></tr></thead> <tbody><tr><td>GANN_UP_TREND</td> <td>与上升趋势一致的线</td></tr> <tr><td>GANN_DOWN_TREND</td> <td>与下降趋势一致的线</td></tr></tbody></table> <p>建立主干线1x1规模，使用 ObjectSetDouble 函数(chart_handle, gann_object_name, OBJPROP_SCALE, scale)：</p> <p>要将主线程设置为1x1，使用函数 ObjectSetDouble(chart_handle, gann_object_name, OBJPROP_SCALE, scale)，</p> <p>其中形式参数的说明如下:</p> <p>• chart_handle —— 对象加载的图表窗口；
• gann_object_name —— 对象名称；
• OBJPROP_SCALE —— “Scale”属性标识符；
• scale —— 需要以Pips/Bar为单位。</p> <p><img src="/mql5yao/assets/img/sec46.e6306a03.png" alt="江恩对象设置面板"></p> <p>创建江恩角度线示例：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//---</span>
   string my_gann<span class="token operator">=</span><span class="token string">&quot;OBJ_GANNFAN object&quot;</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">ObjectFind</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>my_gann<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token comment">//物件没找到</span>
     <span class="token punctuation">{</span>
      <span class="token comment">//--- 通知失败</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Object &quot;</span><span class="token punctuation">,</span>my_gann<span class="token punctuation">,</span><span class="token string">&quot; not found. Error code = &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 获得图表最大价格</span>
      <span class="token keyword">double</span> chart_max_price<span class="token operator">=</span><span class="token function">ChartGetDouble</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_PRICE_MAX<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 获得图表最小价格</span>
      <span class="token keyword">double</span> chart_min_price<span class="token operator">=</span><span class="token function">ChartGetDouble</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_PRICE_MIN<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 多少柱显示在图表上？</span>
      <span class="token keyword">int</span> bars_on_chart<span class="token operator">=</span><span class="token function">ChartGetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>CHART_VISIBLE_BARS<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 创建一个数组，写下每个柱的开盘时间</span>
      datetime Time<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 像时间序列一样访问数组</span>
      <span class="token function">ArraySetAsSeries</span><span class="token punctuation">(</span>Time<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 现在复制图表中可见的柱数据到数组中</span>
      <span class="token keyword">int</span> times<span class="token operator">=</span><span class="token function">CopyTime</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>bars_on_chart<span class="token punctuation">,</span>Time<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>times<span class="token operator">&lt;=</span><span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
         <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Could not copy the array with the open time!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token comment">//--- 完成预备</span>

      <span class="token comment">//--- 图表中心柱指数</span>
      <span class="token keyword">int</span> center_bar<span class="token operator">=</span>bars_on_chart<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 图表赤道 - 最大和最小值之间</span>
      <span class="token keyword">double</span> mean<span class="token operator">=</span><span class="token punctuation">(</span>chart_max_price<span class="token operator">+</span>chart_min_price<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2.0</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 设置第一定位点坐标到中心</span>
      <span class="token function">ObjectCreate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>my_gann<span class="token punctuation">,</span>OBJ_GANNFAN<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>Time<span class="token punctuation">[</span>center_bar<span class="token punctuation">]</span><span class="token punctuation">,</span>mean<span class="token punctuation">,</span>
                   <span class="token comment">//--- 第二定位点到右边</span>
                   Time<span class="token punctuation">[</span>center_bar<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">(</span>mean<span class="token operator">+</span>chart_min_price<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Time[center_bar] = &quot;</span><span class="token operator">+</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span>Time<span class="token punctuation">[</span>center_bar<span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">&quot;  Time[center_bar/2] = &quot;</span><span class="token operator">+</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span>Time<span class="token punctuation">[</span>center_bar<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//Print(&quot;Time[center_bar]/=&quot;+Time[center_bar]+&quot;  Time[center_bar/2]=&quot;+Time[center_bar/2]);</span>
      <span class="token comment">//--- 设置 Pips / Bar单元比例</span>
      <span class="token function">ObjectSetDouble</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>my_gann<span class="token punctuation">,</span>OBJPROP_SCALE<span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 设置趋向线</span>
      <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>my_gann<span class="token punctuation">,</span>OBJPROP_DIRECTION<span class="token punctuation">,</span>GANN_UP_TREND<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 设置线宽</span>
      <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>my_gann<span class="token punctuation">,</span>OBJPROP_WIDTH<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 定义线型</span>
      <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>my_gann<span class="token punctuation">,</span>OBJPROP_STYLE<span class="token punctuation">,</span>STYLE_DASHDOT<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 设置线的颜色</span>
      <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>my_gann<span class="token punctuation">,</span>OBJPROP_COLOR<span class="token punctuation">,</span>clrYellowGreen<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 允许用户选择物件</span>
      <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>my_gann<span class="token punctuation">,</span>OBJPROP_SELECTABLE<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 自动选择</span>
      <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>my_gann<span class="token punctuation">,</span>OBJPROP_SELECTED<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 图表上绘画</span>
      <span class="token function">ChartRedraw</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br></div></div><h3 id="_2-2-8-网页颜色"><a href="#_2-2-8-网页颜色" class="header-anchor">#</a> 2.2.8 网页颜色</h3> <p>以下颜色参量是由颜色类型定义的：</p> <p><img src="/mql5yao/assets/img/sec47.4e9b18cf.png" alt="颜色图示"></p> <p>通过使用 ObjectSetInteger() 函数，颜色可以建立一个对象，使用 PlotIndexSetInteger() 函数，可以设置颜色到常规指标中。为了得到颜色值，还可以使用简单函数 ObjectGetInteger() 和 PlotIndexGetInteger().</p> <p>示例:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//---- 指标设置
#property indicator_chart_window
#property indicator_buffers 3
#property indicator_plots   3
#property indicator_type1   DRAW_LINE
#property indicator_type2   DRAW_LINE
#property indicator_type3   DRAW_LINE
#property indicator_color1  clrBlue
#property indicator_color2  clrRed
#property indicator_color3  clrLime
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="_2-2-9-wingding"><a href="#_2-2-9-wingding" class="header-anchor">#</a> 2.2.9 Wingding</h3> <p>该字符使用 OBJ_ARROW 对象：</p> <p><img src="/mql5yao/assets/img/sec48.3a691e31.png" alt="箭头对象图示"></p> <p>示例:</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//---</span>
   string up_arrow<span class="token operator">=</span><span class="token string">&quot;up_arrow&quot;</span><span class="token punctuation">;</span>
   datetime time<span class="token operator">=</span><span class="token function">TimeCurrent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">double</span> lastClose<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span> close<span class="token operator">=</span><span class="token function">CopyClose</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">Period</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>lastClose<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 获得收盘价</span>
<span class="token comment">//--- 如果获得价格</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>close<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">ObjectCreate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>up_arrow<span class="token punctuation">,</span>OBJ_ARROW<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// 创建一个箭头</span>
      <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>up_arrow<span class="token punctuation">,</span>OBJPROP_ARROWCODE<span class="token punctuation">,</span><span class="token number">241</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 设置箭头代码</span>
      <span class="token function">ObjectSetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>up_arrow<span class="token punctuation">,</span>OBJPROP_TIME<span class="token punctuation">,</span>time<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 设置时间</span>
      <span class="token function">ObjectSetDouble</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>up_arrow<span class="token punctuation">,</span>OBJPROP_PRICE<span class="token punctuation">,</span>lastClose<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 预定价格</span>
      <span class="token function">ChartRedraw</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                        <span class="token comment">// 现在绘制箭头</span>
     <span class="token punctuation">}</span>
   <span class="token keyword">else</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Unable to get the latest Close price!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h2 id="_2-3-指标常量"><a href="#_2-3-指标常量" class="header-anchor">#</a> 2 .3 指标常量</h2> <p>在MQL5语言程序中有37个预定义的技术指标可以使用。此外，还有机会使用iCustom()函数创建自定义的指标。所有指标中需要的常量被分成7 (5)组:</p> <p>• 价格常量 —— 选择 价格 或 数量 的类型，用以计算指标;
• 平滑方式常量 —— 指标中使用的内置过滤平滑方式；
• 指标线常量 —— 当使用CopyBuffer()访问 指标 值时，指标数组的标识符;
• 绘画样式常量 —— 用于绘画指标线条样式18种类型之一，并用于设置线条绘画风格;
• 自定义指标属性常量 —— 用于处理自定义指标的函数;
• 指标类型常量 ——在使用IndicatorCreate()创建句柄时， 用于指定技术指标类型;
• 数据类型标识符常量 —— 当把MqlParam数组传到IndicatorCreate()函数中时用来指明数据类型。</p> <h3 id="_2-3-1-价格常数"><a href="#_2-3-1-价格常数" class="header-anchor">#</a> 2.3.1 价格常数</h3> <p>技术指标的计算通常 需要 价格值 和/或 交易量的值，之后才能执行计算。ENUM_APPLIED_PRICE枚举值中有7个预定义的标识符，用于指定所需的价格计算基数。</p> <p>ENUM_APPLIED_PRICE</p> <table><thead><tr><th>ID</th> <th>描述</th></tr></thead> <tbody><tr><td>PRICE_CLOSE</td> <td>收盘价格</td></tr> <tr><td>PRICE_OPEN</td> <td>开盘价格</td></tr> <tr><td>PRICE_HIGH</td> <td>一段行情的最高价格</td></tr> <tr><td>PRICE_LOW</td> <td>一段行情的最低价格</td></tr> <tr><td>PRICE_MEDIAN</td> <td>中间价（最高价 + 最低价）/2</td></tr> <tr><td>PRICE_TYPICAL</td> <td>典型价格（最高价 + 最低价 + 收盘价）/3</td></tr> <tr><td>PRICE_WEIGHTED</td> <td>平均价格（最高价 + 最低价 + 收盘价 +开盘价）/4</td></tr></tbody></table> <p>如果在计算中需要使用交易量，则需要从枚举型常量ENUM_APPLIED_VOLUME的两个值中指定一个。</p> <p>ENUM_APPLIED_VOLUME</p> <table><thead><tr><th>ID</th> <th>描述</th></tr></thead> <tbody><tr><td>STO_LOWHIGH</td> <td>基于最低价/最高价的计算</td></tr> <tr><td>STO_CLOSECLOSE</td> <td>基于开盘价/收盘价的计算</td></tr></tbody></table> <p>如果一个 技术指标 用于计算价格的数据，它的类型是由ENUM_APPLIED_PRICE设置的，那么任何指标的句柄都可以作为输入价格序列(终端内置的 或 由用户编写)。在这种情况下，指标零缓冲值将用于计算。这使得用另一个指标的值更容易构建一个指标的值。自定义指标的句柄是通过调用iCustom()函数创建的。</p> <p>示例:</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">indicator_separate_window</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">indicator_buffers <span class="token number">2</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">indicator_plots   <span class="token number">2</span></span></span>
<span class="token comment">//--- 输入参数</span>
input <span class="token keyword">int</span>      RSIperiod<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">;</span>         <span class="token comment">// RSI的计算周期</span>
input <span class="token keyword">int</span>      Smooth<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">;</span>             <span class="token comment">// RSI平滑周期</span>
input ENUM_MA_METHOD meth<span class="token operator">=</span>MODE_SMMA<span class="token punctuation">;</span> <span class="token comment">// 平滑方式</span>
<span class="token comment">//----  RSI绘图样式</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">indicator_label1  </span><span class="token string">&quot;RSI&quot;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">indicator_type1   DRAW_LINE</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">indicator_color1  clrRed</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">indicator_style1  STYLE_SOLID</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">indicator_width1  <span class="token number">1</span></span></span>
<span class="token comment">//----  RSI_Smoothed 绘图样式</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">indicator_label2  </span><span class="token string">&quot;RSI_Smoothed&quot;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">indicator_type2   DRAW_LINE</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">indicator_color2  clrNavy</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">indicator_style2  STYLE_SOLID</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">indicator_width2  <span class="token number">1</span></span></span>
<span class="token comment">//--- 指标缓冲数组区</span>
<span class="token keyword">double</span>    RSIBuffer<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>          <span class="token comment">// 这里存储 RSI值</span>
<span class="token keyword">double</span>    RSI_SmoothedBuffer<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//  RSI平滑值</span>
<span class="token keyword">int</span>       RSIhandle<span class="token punctuation">;</span>            <span class="token comment">// 处理 RSI 指标</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 自定义指标初始化函数                                                |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">OnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 指标缓冲区绘图indicator buffers mapping</span>
   <span class="token function">SetIndexBuffer</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>RSIBuffer<span class="token punctuation">,</span>INDICATOR_DATA<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">SetIndexBuffer</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>RSI_SmoothedBuffer<span class="token punctuation">,</span>INDICATOR_DATA<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">IndicatorSetString</span><span class="token punctuation">(</span>INDICATOR_SHORTNAME<span class="token punctuation">,</span><span class="token string">&quot;iRSI&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">IndicatorSetInteger</span><span class="token punctuation">(</span>INDICATOR_DIGITS<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//---</span>
   RSIhandle<span class="token operator">=</span><span class="token function">iRSI</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>RSIperiod<span class="token punctuation">,</span>PRICE_CLOSE<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//---</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 自定义指标循环函数                                                  |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">int</span> <span class="token function">OnCalculate</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> rates_total<span class="token punctuation">,</span>
                 <span class="token keyword">const</span> <span class="token keyword">int</span> prev_calculated<span class="token punctuation">,</span>
                 <span class="token keyword">const</span> <span class="token keyword">int</span> begin<span class="token punctuation">,</span>
                 <span class="token keyword">const</span> <span class="token keyword">double</span> <span class="token operator">&amp;</span>price<span class="token punctuation">[</span><span class="token punctuation">]</span>
                 <span class="token punctuation">)</span>

  <span class="token punctuation">{</span>
<span class="token comment">//---  重置上一个错误值</span>
   <span class="token function">ResetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 数组RSIBuffer []中获得 RSI 指标数据</span>
   <span class="token keyword">int</span> copied<span class="token operator">=</span><span class="token function">CopyBuffer</span><span class="token punctuation">(</span>RSIhandle<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>rates_total<span class="token punctuation">,</span>RSIBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>copied<span class="token operator">&lt;=</span><span class="token number">0</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Unable to copy the values of the indicator RSI. Error = &quot;</span><span class="token punctuation">,</span>
            <span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&quot;,  copied =&quot;</span><span class="token punctuation">,</span>copied<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 创建使用RSI值的平均值的指标</span>
   <span class="token keyword">int</span> RSI_MA_handle<span class="token operator">=</span><span class="token function">iMA</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>Smooth<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>meth<span class="token punctuation">,</span>RSIhandle<span class="token punctuation">)</span><span class="token punctuation">;</span>
   copied<span class="token operator">=</span><span class="token function">CopyBuffer</span><span class="token punctuation">(</span>RSI_MA_handle<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>rates_total<span class="token punctuation">,</span>RSI_SmoothedBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>copied<span class="token operator">&lt;=</span><span class="token number">0</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Unable to copy the smoothed indicator of RSI. Error = &quot;</span><span class="token punctuation">,</span>
            <span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&quot;,  copied =&quot;</span><span class="token punctuation">,</span>copied<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 为下次调用返回prev_calculated值</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span>rates_total<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br></div></div><h3 id="_2-3-2-平滑方式"><a href="#_2-3-2-平滑方式" class="header-anchor">#</a> 2.3.2 平滑方式</h3> <p>许多技术指标都是基于各种价格序列的平滑(均)方法来计算的。一些标准技术指标要求将平滑(均)类型设置为输入参数。为了指定所需的平滑(均)类型，可以使用枚举常量ENUM_MA_METHOD中列出的标识符。</p> <p>ENUM_MA_METHOD</p> <table><thead><tr><th>ID</th> <th>描述</th></tr></thead> <tbody><tr><td>MODE_SMA</td> <td>简单平均数</td></tr> <tr><td>MODE_EMA</td> <td>指数平均数</td></tr> <tr><td>MODE_SMMA</td> <td>平滑平均数</td></tr> <tr><td>MODE_LWMA</td> <td>线性平均数</td></tr></tbody></table> <p><strong>示例：</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>double ExtJaws[];
double ExtTeeth[];
double ExtLips[];
//---- 移动平均数句柄
int    ExtJawsHandle;
int    ExtTeethHandle;
int    ExtLipsHandle;
//--- 获得 MA's 句柄
ExtJawsHandle=iMA(NULL,0,JawsPeriod,0,MODE_SMMA,PRICE_MEDIAN);
ExtTeethHandle=iMA(NULL,0,TeethPeriod,0,MODE_SMMA,PRICE_MEDIAN);
ExtLipsHandle=iMA(NULL,0,LipsPeriod,0,MODE_SMMA,PRICE_MEDIAN);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="_2-3-3-指标线"><a href="#_2-3-3-指标线" class="header-anchor">#</a> 2.3.3 指标线</h3> <p>有一些技术指标，在图表中会显示几种不同的线(每种线对应一个缓冲区)，指标缓冲区的编号起始数字是0，当使用CopyBuffer() 函数复制指标的值 到 双精度类型数组 时，对于一些指标来说，可以指定复制 缓冲区的标识符(线条的名称)，而不是它的编号。</p> <p>当复制指标 iMACD(), iRVI() 和 iStochastic() 的值时，可用的指标线标识符</p> <table><thead><tr><th>常量</th> <th>值</th> <th>描述</th></tr></thead> <tbody><tr><td>MAIN_LINE</td> <td>0</td> <td>主线</td></tr> <tr><td>SIGNAL_LINE</td> <td>1</td> <td>信号线</td></tr></tbody></table> <p>当复制指标 ADX() 和 ADXW() 的值时，可用的指标线标识符。</p> <table><thead><tr><th>常量</th> <th>值</th> <th>描述</th></tr></thead> <tbody><tr><td>MAIN_LINE</td> <td>0</td> <td>主线</td></tr> <tr><td>PLUSDI_LINE</td> <td>1</td> <td>+DI</td></tr> <tr><td>MINUSDI_LINE</td> <td>2</td> <td>-DI</td></tr></tbody></table> <p>当复制指标 iBands() 的值时，可用的指标线标识符</p> <table><thead><tr><th>常量</th> <th>值</th> <th>描述</th></tr></thead> <tbody><tr><td>BASE_LINE</td> <td>0</td> <td>主线</td></tr> <tr><td>UPPER_BAND</td> <td>1</td> <td>上轨线</td></tr> <tr><td>LOWER_BAND</td> <td>2</td> <td>下轨线</td></tr></tbody></table> <p>当复制指标 iEnvelopes() 和 iFractals()的值时，可用的指标线标识符</p> <table><thead><tr><th>常量</th> <th>值</th> <th>描述</th></tr></thead> <tbody><tr><td>UPPER_LINE</td> <td>0</td> <td>上轨线</td></tr> <tr><td>LOWER_LINE</td> <td>1</td> <td>下轨线</td></tr></tbody></table> <p>当复制指标 iGator()的值时，可用的指标线标识符。</p> <table><thead><tr><th>常量</th> <th>值</th> <th>描述</th></tr></thead> <tbody><tr><td>UPPER_HISTOGRAM</td> <td>0</td> <td>上柱</td></tr> <tr><td>LOWER_LINE</td> <td>1</td> <td>下柱</td></tr></tbody></table> <p>当复制指标 iAlligator()的值时，可用的指标线标识符。</p> <table><thead><tr><th>常量</th> <th>值</th> <th>描述</th></tr></thead> <tbody><tr><td>GATORJAW_LINE</td> <td>0</td> <td>爪线</td></tr> <tr><td>GATORTEETH_LINE</td> <td>1</td> <td>牙线</td></tr> <tr><td>GATORLIPS_LINE</td> <td>2</td> <td>唇线</td></tr></tbody></table> <p>当复制iIchimoku()值时可用的指标线标识符。</p> <table><thead><tr><th>常量</th> <th>值</th> <th>描述</th></tr></thead> <tbody><tr><td>TENKANSEN_LINE</td> <td>0</td> <td>转换线</td></tr> <tr><td>KIJUNSEN_LINE</td> <td>1</td> <td>基准线</td></tr> <tr><td>SENKOUSPANA_LINE</td> <td>2</td> <td>通道跨度线A</td></tr> <tr><td>SENKOUSPANB_LINE</td> <td>3</td> <td>通道跨度线B</td></tr> <tr><td>CHIKOUSPAN_LINE</td> <td>4</td> <td>延迟线</td></tr></tbody></table> <h3 id="_2-3-4-绘画风格"><a href="#_2-3-4-绘画风格" class="header-anchor">#</a> 2.3.4 绘画风格</h3> <p>当创建一个自定义指标时，您可以指定18种图解测绘方式中的任意一种（显示在主图表窗口 或 副图表子窗口），其值在枚举型常值 ENUM_DRAW_TYPE中指定。</p> <p>在一个自定义指标中，可以 新建/绘画 ，任意绘画风格的线条类型。为存储绘图所需的数据，每个线条都要求对应1 -- 5个全局数组。通过使用SetIndexBuffer()函数将这些数据数组 与 指标缓冲区(即对应的一个线条)绑定在一起，应该为每个缓冲区指定来自ENUM_INDEXBUFFER_TYPE的数据类型。</p> <p>根据绘图样式，您可能需要 1--4个缓冲区(标记为INDICATOR_DATA)。如果一个线条样式允许动态改变颜色(所有样式在名称中都包含颜色)，那么您将需要多一个颜色缓冲区(指示类型为INDICATOR_COLOR_INDEX)。颜色缓冲区总是绑定到与样式对应的值的(数组)缓冲区。</p> <p>ENUM_DRAW_TYPE</p> <table><thead><tr><th>ID</th> <th>描述</th> <th>数据缓冲</th> <th>颜色缓冲</th></tr></thead> <tbody><tr><td>DRAW_NONE</td> <td>什么也不画</td> <td>1</td> <td>0</td></tr> <tr><td>DRAW_LINE</td> <td>画线</td> <td>1</td> <td>0</td></tr> <tr><td>DRAW_SECTION</td> <td>线段</td> <td>1</td> <td>0</td></tr> <tr><td>DRAW_HISTOGRAM</td> <td>从0值开始画柱状图</td> <td>1</td> <td>0</td></tr> <tr><td>DRAW_HISTOGRAM2</td> <td>两个指标值之间画柱状图</td> <td>2</td> <td>0</td></tr> <tr><td>DRAW_ARROW</td> <td>画箭头</td> <td>1</td> <td>0</td></tr> <tr><td>DRAW_ZIGZAG</td> <td>ZigZag 样式允许K线的垂直部分</td> <td>2</td> <td>0</td></tr> <tr><td>DRAW_FILLING</td> <td>两层间的颜色</td> <td>2</td> <td>0</td></tr> <tr><td>DRAW_BARS</td> <td>显示一串棒线</td> <td>4</td> <td>0</td></tr> <tr><td>DRAW_COLOR_LINE</td> <td>彩色线</td> <td>1</td> <td>1</td></tr> <tr><td>DRAW_COLOR_SECTION</td> <td>彩色线段</td> <td>1</td> <td>1</td></tr> <tr><td>DRAW_COLOR_HISTOGRAM</td> <td>从0线开始画彩色柱状图</td> <td>1</td> <td>1</td></tr> <tr><td>DRAW_COLOR_HISTOGRAM2</td> <td>两个指标值之间的彩色柱状图</td> <td>2</td> <td>1</td></tr> <tr><td>DRAW_COLOR_ARROW</td> <td>描绘彩色箭头</td> <td>1</td> <td>1</td></tr> <tr><td>DRAW_COLOR_ZIGZAG</td> <td>彩色ZigZag</td> <td>2</td> <td>1</td></tr> <tr><td>DRAW_COLOR_BARS</td> <td>彩色棒线</td> <td>4</td> <td>1</td></tr> <tr><td>DRAW_COLOR_CANDLES</td> <td>彩色K线蜡烛图</td> <td>4</td> <td>1</td></tr></tbody></table> <p>为了优化所选的绘制类型标识符的显示，请使用ENUM_PLOT_PROPERTY中列出的标识符。 对于函数 PlotIndexSetInteger() 和 PlotIndexGetInteger()</p> <p>ENUM_PLOT_PROPERTY_INTEGER</p> <table><thead><tr><th>ID</th> <th>描述</th> <th>属性类型</th></tr></thead> <tbody><tr><td>PLOT_ARROW</td> <td>DRAW_ARROW的箭头样式代码</td> <td>uchar</td></tr> <tr><td>PLOT_ARROW_SHIFT</td> <td>DRAW_ARROW箭头样式在垂直方向上的偏移</td> <td>int</td></tr> <tr><td>PLOT_DRAW_BEGIN</td> <td>在 数据窗口 中没有绘图和值的初始K线数量</td> <td>int</td></tr> <tr><td>PLOT_DRAW_TYPE</td> <td>图解的类型</td> <td>ENUM_DRAW_TYPE</td></tr> <tr><td>PLOT_SHOW_DATA</td> <td>在 数据窗口 中显示构造值的标记</td> <td>bool</td></tr> <tr><td>PLOT_SHIFT</td> <td>在K线的时间轴(x轴)上描绘的指标的偏移</td> <td>int</td></tr> <tr><td>PLOT_LINE_STYLE</td> <td>画线的线型</td> <td>ENUM_LINE_STYLE</td></tr> <tr><td>PLOT_LINE_WIDTH</td> <td>画线粗细</td> <td>int</td></tr> <tr><td>PLOT_COLOR_INDEXES</td> <td>颜色数量</td> <td>int</td></tr> <tr><td>PLOT_LINE_COLOR</td> <td>包含绘图颜色的缓冲区的索引</td> <td>color modifier=index number of colors</td></tr></tbody></table> <p>函数 PlotIndexSetDouble()</p> <p>ENUM_PLOT_PROPERTY_DOUBLE</p> <table><thead><tr><th>ID</th> <th>描述</th> <th>属性类型</th></tr></thead> <tbody><tr><td>PLOT_EMPTY_VALUE</td> <td>绘画值为空，表示没有绘图</td> <td>double</td></tr></tbody></table> <p>函数 PlotIndexSetString()</p> <p>ENUM_PLOT_PROPERTY_STRING</p> <table><thead><tr><th>ID</th> <th>描述</th> <th>属性类型</th></tr></thead> <tbody><tr><td>PLOT_LABEL</td> <td>显示在 数据窗口 中的指标图解系列的名称. 当使用复杂的需要多个指标缓冲区来显示的图形风格时，可以使用 &quot;,&quot; 作为分隔符来指定每个缓冲区的名称。示例代码请参考 DRAW_CANDLES</td> <td>string</td></tr></tbody></table> <p>在自定义的指标中，绘制线条可以使用5种样式。它们只适用于画线，并且粗细值为0或1。</p> <p>ENUM_LINE_STYLE</p> <table><thead><tr><th>ID</th> <th>描述</th></tr></thead> <tbody><tr><td>STYLE_SOLID</td> <td>实线</td></tr> <tr><td>STYLE_DASH</td> <td>折线</td></tr> <tr><td>STYLE_DOT</td> <td>虚线</td></tr> <tr><td>STYLE_DASHDOT</td> <td>折点线</td></tr> <tr><td>STYLE_DASHDOTDOT</td> <td>双折点线</td></tr></tbody></table> <p>为了设置绘图样式和绘图类型，可以使用PlotIndexSetInteger()函数。对于斐波纳契(Fibonacci)扩展，可以使用ObjectSetInteger()函数来表示层级线的厚度和绘制风格。</p> <p>示例</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">indicator_chart_window</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">indicator_buffers <span class="token number">1</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">indicator_plots   <span class="token number">1</span></span></span>
<span class="token comment">//--- 指标缓冲区</span>
<span class="token keyword">double</span>         MABuffer<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 自定义指标初始化函数                                                |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">OnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 绑定数组和索引序号为0的指标缓冲区</span>
   <span class="token function">SetIndexBuffer</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>MABuffer<span class="token punctuation">,</span>INDICATOR_DATA<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 设置绘画的样式为 画线</span>
   <span class="token function">PlotIndexSetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>PLOT_DRAW_TYPE<span class="token punctuation">,</span>DRAW_LINE<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 设置线型</span>
   <span class="token function">PlotIndexSetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>PLOT_LINE_STYLE<span class="token punctuation">,</span>STYLE_DOT<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 设置线颜色</span>
   <span class="token function">PlotIndexSetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>PLOT_LINE_COLOR<span class="token punctuation">,</span>clrRed<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 设置线粗细</span>
   <span class="token function">PlotIndexSetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>PLOT_LINE_WIDTH<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 为线设置标签</span>
   <span class="token function">PlotIndexSetString</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>PLOT_LABEL<span class="token punctuation">,</span><span class="token string">&quot;Moving Average&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//---</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 自定义指标重复函数                                                 |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">int</span> <span class="token function">OnCalculate</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> rates_total<span class="token punctuation">,</span>
                 <span class="token keyword">const</span> <span class="token keyword">int</span> prev_calculated<span class="token punctuation">,</span>
                 <span class="token keyword">const</span> datetime <span class="token operator">&amp;</span>time<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                 <span class="token keyword">const</span> <span class="token keyword">double</span> <span class="token operator">&amp;</span>open<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                 <span class="token keyword">const</span> <span class="token keyword">double</span> <span class="token operator">&amp;</span>high<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                 <span class="token keyword">const</span> <span class="token keyword">double</span> <span class="token operator">&amp;</span>low<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                 <span class="token keyword">const</span> <span class="token keyword">double</span> <span class="token operator">&amp;</span>close<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                 <span class="token keyword">const</span> <span class="token keyword">long</span> <span class="token operator">&amp;</span>tick_volume<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                 <span class="token keyword">const</span> <span class="token keyword">long</span> <span class="token operator">&amp;</span>volume<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                 <span class="token keyword">const</span> <span class="token keyword">int</span> <span class="token operator">&amp;</span>spread<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//---</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span>prev_calculated<span class="token punctuation">;</span>i<span class="token operator">&lt;</span>rates_total<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      MABuffer<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>close<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 为下次调用返回prev_calculated值</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span>rates_total<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><h3 id="_2-3-5-自定义指标属性"><a href="#_2-3-5-自定义指标属性" class="header-anchor">#</a> 2.3.5 自定义指标属性</h3> <p>用在自定义指标中的指标缓冲区的数量是受限的，使用SetIndexBuffer()函数可以设计成自定义缓冲区，因为要存储，所有指定数据类型是有必要的，也可能是ENUM_INDEXBUFFER_TYPE其中一个值。</p> <p>在自定义指标中使用的指标缓冲区(数组)的数量是无限的。但是对于每一个被指定为使用SetIndexBuffer()函数的指标缓冲区的数组，必须指定它存储的数据类型。取值范围可以是枚举型常量 ENUM_INDEXBUFFER_TYPE 的一个值。</p> <p>ENUM_INDEXBUFFER_TYPE</p> <table><thead><tr><th>ID</th> <th>描述</th></tr></thead> <tbody><tr><td>INDICATOR_DATA</td> <td>描绘数据</td></tr> <tr><td>INDICATOR_COLOR_INDEX</td> <td>颜色</td></tr> <tr><td>INDICATOR_CALCULATIONS</td> <td>计算中的辅助缓冲区数组</td></tr></tbody></table> <p>自定义指标提供许多设置提供方便演绎，这些设置通过使用IndicatorSetDouble(),IndicatorSetInteger()和 IndicatorSetString() 函数来分别相应指标性质，指标属性的标识符列表在ENUM_CUSTOMIND_PROPERTY中。</p> <p>自定义指标有许多设置，以提供方便的显示。这些设置是通过使用函数IndicatorSetDouble()、IndicatorSetInteger()和IndicatorSetString()来分别指定到对应的指标属性值来完成的。指标属性的标识符在ENUM_CUSTOMIND_PROPERTY枚举中列出。</p> <table><thead><tr><th>ID</th> <th>描述</th> <th>属性类型</th></tr></thead> <tbody><tr><td>INDICATOR_DIGITS</td> <td>显示指标值的精确度(即，小数点后显示几位)</td> <td>int</td></tr> <tr><td>INDICATOR_HEIGHT</td> <td>修正指标窗口的高度 (预处理命令 #property indicator_height)</td> <td>int</td></tr> <tr><td>INDICATOR_LEVELS</td> <td>指标窗口中的水平线数量</td> <td>int</td></tr> <tr><td>INDICATOR_LEVELCOLOR</td> <td>水平线的颜色</td> <td>color modifier = level number</td></tr> <tr><td>INDICATOR_LEVELSTYLE</td> <td>水平线的类型</td> <td>ENUM_LINE_STYLE modifier = level number</td></tr> <tr><td>INDICATOR_LEVELWIDTH</td> <td>水平线的厚度</td> <td>int modifier = level number</td></tr></tbody></table> <p>ENUM_CUSTOMIND_PROPERTY_DOUBLE</p> <table><thead><tr><th>ID</th> <th>描述</th> <th>属性类型</th></tr></thead> <tbody><tr><td>INDICATOR_MINIMUM</td> <td>指标窗口最小化</td> <td>double</td></tr> <tr><td>INDICATOR_MAXIMUM</td> <td>指标窗口最大化</td> <td>double</td></tr> <tr><td>INDICATOR_LEVELVALUE</td> <td>水平线的值</td> <td>double modifier = level number</td></tr></tbody></table> <p>ENUM_CUSTOMIND_PROPERTY_STRING</p> <table><thead><tr><th>ID</th> <th>描述</th> <th>属性描述</th></tr></thead> <tbody><tr><td>INDICATOR_SHORTNAME</td> <td>指标短名称</td> <td>string</td></tr> <tr><td>INDICATOR_LEVELTEXT</td> <td>水平线说明</td> <td>string modifier = level number</td></tr></tbody></table> <p>示例</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//--- 指标设置</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">indicator_separate_window</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">indicator_buffers <span class="token number">4</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">indicator_plots   <span class="token number">2</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">indicator_type1   DRAW_LINE</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">indicator_type2   DRAW_LINE</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">indicator_color1  clrLightSeaGreen</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">property</span> <span class="token expression">indicator_color2  clrRed</span></span>
<span class="token comment">//--- 输入参数</span>
<span class="token keyword">extern</span> <span class="token keyword">int</span> KPeriod<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span>
<span class="token keyword">extern</span> <span class="token keyword">int</span> DPeriod<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">extern</span> <span class="token keyword">int</span> Slowing<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span>
<span class="token comment">//--- 指标缓冲区</span>
<span class="token keyword">double</span> MainBuffer<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">double</span> SignalBuffer<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">double</span> HighesBuffer<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">double</span> LowesBuffer<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 自定义指标初始化函数                                                |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">OnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 指标缓冲区绘图</span>
   <span class="token function">SetIndexBuffer</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>MainBuffer<span class="token punctuation">,</span>INDICATOR_DATA<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">SetIndexBuffer</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>SignalBuffer<span class="token punctuation">,</span>INDICATOR_DATA<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">SetIndexBuffer</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>HighesBuffer<span class="token punctuation">,</span>INDICATOR_CALCULATIONS<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">SetIndexBuffer</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span>LowesBuffer<span class="token punctuation">,</span>INDICATOR_CALCULATIONS<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 设置精确度</span>
   <span class="token function">IndicatorSetInteger</span><span class="token punctuation">(</span>INDICATOR_DIGITS<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 设置水平</span>
   <span class="token function">IndicatorSetInteger</span><span class="token punctuation">(</span>INDICATOR_LEVELS<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">IndicatorSetDouble</span><span class="token punctuation">(</span>INDICATOR_LEVELVALUE<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">IndicatorSetDouble</span><span class="token punctuation">(</span>INDICATOR_LEVELVALUE<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 为子窗口设置最大最小值</span>
   <span class="token function">IndicatorSetDouble</span><span class="token punctuation">(</span>INDICATOR_MINIMUM<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">IndicatorSetDouble</span><span class="token punctuation">(</span>INDICATOR_MAXIMUM<span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 设置第一条画指数的柱</span>
   <span class="token function">PlotIndexSetInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>PLOT_DRAW_BEGIN<span class="token punctuation">,</span>KPeriod<span class="token operator">+</span>Slowing<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">PlotIndexSetInteger</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>PLOT_DRAW_BEGIN<span class="token punctuation">,</span>KPeriod<span class="token operator">+</span>Slowing<span class="token operator">+</span>DPeriod<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 为第二行设置STYLE_DOT类型</span>
   <span class="token function">PlotIndexSetInteger</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>PLOT_LINE_STYLE<span class="token punctuation">,</span>STYLE_DOT<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 为DataWindow和指标子窗口标签命名</span>
   <span class="token function">IndicatorSetString</span><span class="token punctuation">(</span>INDICATOR_SHORTNAME<span class="token punctuation">,</span><span class="token string">&quot;Stoch(&quot;</span><span class="token operator">+</span>KPeriod<span class="token operator">+</span><span class="token string">&quot;,&quot;</span><span class="token operator">+</span>DPeriod<span class="token operator">+</span><span class="token string">&quot;,&quot;</span><span class="token operator">+</span>Slowing<span class="token operator">+</span><span class="token string">&quot;)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">PlotIndexSetString</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>PLOT_LABEL<span class="token punctuation">,</span><span class="token string">&quot;Main&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">PlotIndexSetString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>PLOT_LABEL<span class="token punctuation">,</span><span class="token string">&quot;Signal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 设置画线空值</span>
   <span class="token function">PlotIndexSetDouble</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>PLOT_EMPTY_VALUE<span class="token punctuation">,</span><span class="token number">0.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">PlotIndexSetDouble</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>PLOT_EMPTY_VALUE<span class="token punctuation">,</span><span class="token number">0.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 完成初始化</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br></div></div><h3 id="_2-3-6-技术指标类型"><a href="#_2-3-6-技术指标类型" class="header-anchor">#</a> 2.3.6 技术指标类型</h3> <p>有两种方法可以创建指标句柄，以便用于进一步访问其值。第一种方法是直接从技术指标列表中指定一个函数名。第二个方法是使用IndicatorCreate()，通过从ENUM_INDICATOR枚举值中分配一个标识符来统一地创建任何指标的句柄。两种句柄的创建方法都是相同的，您可以使用在MQL5中编写程序时选择最方便的方法。</p> <p>当创建指标IND_CUSTOM类型时，输入参数 MqlParam 数组中第一个元素的字段 type(类型) 必须有TYPE_STRING 值，并且该值为 ENUM_DATATYPE 枚举中的其中之一，同时而第一个元素中的string_value一定包括自定义指标的名称。</p> <p>ENUM_INDICATOR</p> <table><thead><tr><th>标识符</th> <th>指标</th></tr></thead> <tbody><tr><td>IND_AC</td> <td>加速振荡器</td></tr> <tr><td>IND_AD</td> <td>聚集/分散</td></tr> <tr><td>IND_ADX</td> <td>均定向指标</td></tr> <tr><td>IND_ADXW</td> <td>亚当理论的ADX</td></tr> <tr><td>IND_ALLIGATOR</td> <td>鳄鱼指标</td></tr> <tr><td>IND_AMA</td> <td>相应的移动平均数</td></tr> <tr><td>IND_AO</td> <td>动量振荡指标-AO指标</td></tr> <tr><td>IND_ATR</td> <td>真实波动幅度均值</td></tr> <tr><td>IND_BANDS</td> <td>布林线指标（AO指标）</td></tr> <tr><td>IND_BEARS</td> <td>熊市</td></tr> <tr><td>IND_BULLS</td> <td>牛市</td></tr> <tr><td>IND_BWMFI</td> <td>市场便利指标</td></tr> <tr><td>IND_CCI</td> <td>顺势指标</td></tr> <tr><td>IND_CHAIKIN</td> <td>佳庆指标</td></tr> <tr><td>IND_CUSTOM</td> <td>自定义指标</td></tr> <tr><td>IND_DEMA</td> <td>双精度移动平均线</td></tr> <tr><td>IND_DEMARKER</td> <td>DEM指标</td></tr> <tr><td>IND_ENVELOPES</td> <td>轨道线指标</td></tr> <tr><td>IND_FORCE</td> <td>强力指数</td></tr> <tr><td>IND_FRACTALS</td> <td>拼图</td></tr> <tr><td>IND_FRAMA</td> <td>自适拼图移动平均数</td></tr> <tr><td>IND_GATOR</td> <td>振荡器</td></tr> <tr><td>IND_ICHIMOKU</td> <td>一目均衡图</td></tr> <tr><td>IND_MA</td> <td>平均移动</td></tr> <tr><td>IND_MACD</td> <td>MACD</td></tr> <tr><td>IND_MFI</td> <td>货币流量索引</td></tr> <tr><td>IND_MOMENTUM</td> <td>动量</td></tr> <tr><td>IND_OBV</td> <td>平衡成交量</td></tr> <tr><td>IND_OsMA</td> <td>OSMA</td></tr> <tr><td>IND_RSI</td> <td>相对强势索引</td></tr> <tr><td>IND_RVI</td> <td>相对活力索引</td></tr> <tr><td>IND_SAR</td> <td>抛物线SAR</td></tr> <tr><td>IND_STDDEV</td> <td>标准偏差</td></tr> <tr><td>IND_STOCHASTIC</td> <td>随机振荡器</td></tr> <tr><td>IND_TEMA</td> <td>三倍指数移动平均值</td></tr> <tr><td>IND_TRIX</td> <td>三倍指数移动平均值振荡器</td></tr> <tr><td>IND_VIDYA</td> <td>索引变量平均值</td></tr> <tr><td>IND_VOLUMES</td> <td>成交量</td></tr> <tr><td>IND_WPR</td> <td>威廉姆斯百分比幅度</td></tr></tbody></table> <h3 id="_2-3-7-数据类型标识符"><a href="#_2-3-7-数据类型标识符" class="header-anchor">#</a> 2.3.7 数据类型标识符</h3> <p>当使用IndicatorCreate()函数创建自定义指标句柄时，必须将一个MqlParam类型的数组指定为最后一个参数。相应地，MqlParam结构，指标描述，包含一个特殊的字段 type。这个字段包含了数据类型的信息(实数型、整数型 或 字符串型)，这些信息是由数组的特定元素传递的。MqlParam结构的这个字段的值可能是ENUM_DATATYPE枚举值之一。</p> <p>ENUM_DATATYPE</p> <table><thead><tr><th>标识符</th> <th>数据类型</th></tr></thead> <tbody><tr><td>TYPE_BOOL</td> <td>bool</td></tr> <tr><td>TYPE_CHAR</td> <td>char</td></tr> <tr><td>TYPE_UCHAR</td> <td>uchar</td></tr> <tr><td>TYPE_SHORT</td> <td>short</td></tr> <tr><td>TYPE_USHORT</td> <td>ushort</td></tr> <tr><td>TYPE_COLOR</td> <td>color</td></tr> <tr><td>TYPE_INT</td> <td>int</td></tr> <tr><td>TYPE_UINT</td> <td>uint</td></tr> <tr><td>TYPE_DATETIME</td> <td>datetime</td></tr> <tr><td>TYPE_LONG</td> <td>long</td></tr> <tr><td>TYPE_ULONG</td> <td>ulong</td></tr> <tr><td>TYPE_FLOAT</td> <td>float</td></tr> <tr><td>TYPE_DOUBLE</td> <td>double</td></tr> <tr><td>TYPE_STRING</td> <td>string</td></tr></tbody></table> <p>数组的每个元素都描述了一个创建的技术指标的对应输入参数，因此，数组中元素的类型和顺序必须与描述保持严格一致。</p> <h2 id="_2-4-环境状态"><a href="#_2-4-环境状态" class="header-anchor">#</a> 2 .4 环境状态</h2> <p>描述MQL5程序当前运行环境的常量分为如下几组:</p> <p>•客户端属性 —— 客户端信息；
•运行MQL5程序属性 —— MQL5程序特征，它帮助控制执行命令；
•交易品种属性 —— 获得有关交易品种的信息；
•账户属性 —— 有关账户的信息；
•测试统计 —— EA交易的测试结果。</p> <h3 id="_2-4-1-客户端属性"><a href="#_2-4-1-客户端属性" class="header-anchor">#</a> 2.4.1 客户端属性</h3> <p>关于客户端的信息可以通过两个函数来获得:TerminalInfoInteger()和TerminalInfoString()。关于于参数，这些函数分别接受来自ENUM_TERMINAL_INFO_INTEGER和ENUM_TERMINAL_INFO_STRING的枚举值。</p> <p>ENUM_TERMINAL_INFO_INTEGER</p> <table><thead><tr><th>标识符</th> <th>描述</th> <th>类型</th></tr></thead> <tbody><tr><td>TERMINAL_BUILD</td> <td>客户端版本建设号</td> <td>int</td></tr> <tr><td>TERMINAL_COMMUNITY_ACCOUNT</td> <td>该标帜指示在终端中存在MQL5.community授权数据</td> <td>bool</td></tr> <tr><td>TERMINAL_COMMUNITY_CONNECTION</td> <td>连接 MQL5.community</td> <td>bool</td></tr> <tr><td>TERMINAL_CONNECTED</td> <td>连接交易服务器</td> <td>bool</td></tr> <tr><td>TERMINAL_DLLS_ALLOWED</td> <td>允许使用DLL</td> <td>bool</td></tr> <tr><td>TERMINAL_TRADE_ALLOWED</td> <td>允许交易</td> <td>bool</td></tr> <tr><td>TERMINAL_EMAIL_ENABLED</td> <td>在终端设置允许使用SMTP-服务器 并 登录，发送邮件</td> <td>bool</td></tr> <tr><td>TERMINAL_FTP_ENABLED</td> <td>在终端设置中允许使用FTP-服务器 并 登录，发送报告</td> <td>bool</td></tr> <tr><td>TERMINAL_NOTIFICATIONS_ENABLED</td> <td>允许向智能手机发送通知消息</td> <td>bool</td></tr> <tr><td>TERMINAL_MAXBARS</td> <td>图表中的最大K线数量</td> <td>int</td></tr> <tr><td>TERMINAL_MQID</td> <td>该标帜指示MetaQuotes ID数据用于推送通知。</td> <td>bool</td></tr> <tr><td>TERMINAL_CODEPAGE</td> <td>在客户端中安装的 语言代码页 的编号数字</td> <td>int</td></tr> <tr><td>TERMINAL_CPU_CORES</td> <td>系统的CPU 内核数量</td> <td>int</td></tr> <tr><td>TERMINAL_DISK_SPACE</td> <td>客户端 MQL5\Files 文件夹(代理)中的空闲磁盘空间，单位:MB</td> <td>int</td></tr> <tr><td>TERMINAL_MEMORY_PHYSICAL</td> <td>系统的物理内存，单位MB</td> <td>int</td></tr> <tr><td>TERMINAL_MEMORY_TOTAL</td> <td>客户端(代理)进程的可用内存总数，MB</td> <td>int</td></tr> <tr><td>TERMINAL_MEMORY_AVAILABLE</td> <td>客户端(代理)进程的空闲内存，MB</td> <td>int</td></tr> <tr><td>TERMINAL_MEMORY_USED</td> <td>客户端(代理)已使用的内存，MB</td> <td>int</td></tr> <tr><td>TERMINAL_X64</td> <td>“64位终端”的指示</td> <td>bool</td></tr> <tr><td>TERMINAL_OPENCL_SUPPORT</td> <td>支持OpenCL 的版本，格式为 0x00010002 = 1.2。 &quot;0&quot; 表示OpenCL 不被支持</td> <td>int</td></tr> <tr><td>TERMINAL_SCREEN_DPI</td> <td>屏幕上信息显示的分辨率是以每英寸的点数(DPI)来衡量的。 知道参数值后，您可以设置图形对象的大小，以便它们在具有不同分辨率特征的监视器上看起来相同。</td> <td>int</td></tr> <tr><td>TERMINAL_PING_LAST</td> <td>最后获得的交易服务器ping值(微秒). 一秒 = 一百万微秒</td> <td>int</td></tr></tbody></table> <table><thead><tr><th>按键标识符</th> <th>描述</th> <th>类型</th></tr></thead> <tbody><tr><td>TERMINAL_KEYSTATE_LEFT</td> <td>“左箭头”键状态</td> <td>int</td></tr> <tr><td>TERMINAL_KEYSTATE_UP</td> <td>“上箭头”键状态</td> <td>int</td></tr> <tr><td>TERMINAL_KEYSTATE_RIGHT</td> <td>“右箭头”键状态</td> <td>int</td></tr> <tr><td>TERMINAL_KEYSTATE_DOWN</td> <td>“下箭头”键状态</td> <td>int</td></tr> <tr><td>TERMINAL_KEYSTATE_SHIFT</td> <td>“Shift”键状态</td> <td>int</td></tr> <tr><td>TERMINAL_KEYSTATE_CONTROL</td> <td>“Ctrl”键状态</td> <td>int</td></tr> <tr><td>TERMINAL_KEYSTATE_MENU</td> <td>“Windows”键状态</td> <td>int</td></tr> <tr><td>TERMINAL_KEYSTATE_CAPSLOCK/td&gt;</td> <td>“CapsLock”键状态</td> <td>int</td></tr> <tr><td>TERMINAL_KEYSTATE_NUMLOCK</td> <td>“NumLock”键状态</td> <td>int</td></tr> <tr><td>TERMINAL_KEYSTATE_SCRLOCK</td> <td>“ScrollLock”键状态</td> <td>int</td></tr> <tr><td>TERMINAL_KEYSTATE_ENTER</td> <td>“Enter”键状态</td> <td>int</td></tr> <tr><td>TERMINAL_KEYSTATE_INSERT</td> <td>“Insert”键状态</td> <td>int</td></tr> <tr><td>TERMINAL_KEYSTATE_DELETE</td> <td>“Delete”键状态</td> <td>int</td></tr> <tr><td>TERMINAL_KEYSTATE_HOME</td> <td>“Home”键状态</td> <td>int</td></tr> <tr><td>TERMINAL_KEYSTATE_END</td> <td>“End”键状态</td> <td>int</td></tr> <tr><td>TERMINAL_KEYSTATE_TAB</td> <td>“Tab”键状态</td> <td>int</td></tr> <tr><td>TERMINAL_KEYSTATE_PAGEUP</td> <td>“PageUp”键状态</td> <td>int</td></tr> <tr><td>TERMINAL_KEYSTATE_PAGEDOWN</td> <td>“PageDown”键状态</td> <td>int</td></tr> <tr><td>TERMINAL_KEYSTATE_ESCAPE</td> <td>“Escape”键状态</td> <td>int</td></tr></tbody></table> <p>调用TerminalInfoInteger(TERMINAL_KEYSTATE_XXX)返回一个按键的状态代码，与 在MSDN中的调用GetKeyState()函数的结果是一样的。</p> <p>显示缩放比例系数计算示例 ：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code> //--- 在屏幕上创建 1.5 英寸宽的按键
int screen_dpi = TerminalInfoInteger(TERMINAL_SCREEN_DPI); // 获得用户显示器的DPI
int base_width = 144;  // DPI=96标准显示器的屏幕点的基本宽度
int width = (button_width * screen_dpi) / 96;  // 为用户显示器（特别DPI）计算按键宽度
...

//--- 按百分比计算比例系数
int scale_factor=(TerminalInfoInteger(TERMINAL_SCREEN_DPI) * 100) / 96;
//--- 使用比例系数
width=(base_width * scale_factor) / 100;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>在上例中，图形资源在具有不同分辨率的监视器上看起来是相同的。控件元素的大小(按钮、对话框窗口等)对应于个性化设置。</p> <p>ENUM_TERMINAL_INFO_DOUBLE</p> <table><thead><tr><th>标识符</th> <th>描述</th> <th>类型</th></tr></thead> <tbody><tr><td>TERMINAL_COMMUNITY_BALANCE</td> <td>MQL5.community的余额</td> <td>double</td></tr></tbody></table> <p>文件操作只能在两个目录中执行;可以通过使用TERMINAL_DATA_PATH和TERMINAL_COMMONDATA_PATH属性来获得相应的路径。</p> <p>ENUM_TERMINAL_INFO_STRING</p> <table><thead><tr><th>TERMINAL_LANGUAGE</th> <th>客户端语言</th> <th></th></tr></thead> <tbody><tr><td>TERMINAL_COMPANY</td> <td>公司名称</td> <td>string</td></tr> <tr><td>TERMINAL_NAME</td> <td>客户端名称</td> <td>string</td></tr> <tr><td>TERMINAL_PATH</td> <td>客户端启动文件夹</td> <td>string</td></tr> <tr><td>TERMINAL_DATA_PATH</td> <td>客户端数据文件夹</td> <td>string</td></tr> <tr><td>TERMINAL_COMMONDATA_PATH</td> <td>电脑中所有客户端的共用文件夹</td> <td>string</td></tr></tbody></table> <p>为了更好地理解文件夹路径，存储在参数TERMINAL_PATH、TERMINAL_DATA_PATH和TERMINAL_COMMONDATA_PATH中的属性，建议执行下面的脚本，该脚本将返回在您的计算机上安装的客户端的当前副本的这些路径值。</p> <p>示例：脚本返回的有关客户端路径的信息</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+
//|                                          Check_TerminalPaths.mq5 |
//|                        Copyright 2009, MetaQuotes Software Corp. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright &quot;2009, MetaQuotes Software Corp.&quot;
#property link      &quot;https://www.mql5.com&quot;
#property version   &quot;1.00&quot;
//+------------------------------------------------------------------+
//| 脚本程序启动函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//---
   Print(&quot;TERMINAL_PATH = &quot;,TerminalInfoString(TERMINAL_PATH));
   Print(&quot;TERMINAL_DATA_PATH = &quot;,TerminalInfoString(TERMINAL_DATA_PATH));
   Print(&quot;TERMINAL_COMMONDATA_PATH = &quot;,TerminalInfoString(TERMINAL_COMMONDATA_PATH));
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>脚本执行的结果，会在 EA 日志中，看到如下的信息:</p> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAjIAAABZBAMAAAGhSeNMAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAhUExURevq28fFsv///wAAAOLezdbSwsvHuMjIyOvr6zFqxQAAAF4W6K4AAAALdFJOU/////////////8ASk8B8gAAAAlwSFlzAAAOxAAADsQBlSsOGwAACMJJREFUaN7tW7GO5DYMNTA/cLgvWEhF4G4gNi5T3CdkUwcp7gPSJOkOcBGXCzeB/zZ8j5TtmbVnZ++0WV3iNzO2JNMciqIlmaKau/ChOZ+bIggv46EJMaYQInMp8ShJ81qqiWREw8v40gz9oF89DNKJp54T3cNpehlPzTSO7dhO06jfdmq3ie5TwT1Ed0Hk32o4pdFW0vaRkKzxRFNsw6gFaMFwj7K11WTO9IP0XbdBcwefO9pMaVo0V9u2SIVNmvvq/jLNh6YMlM+pBJ9QBDRWidq4MYpEbWdtbjytMUmIoh+1CZGEazSFBGOIuKakaiywjHin0d8lz1AE7Bg6GB96jVXP0S322Hf38JmK4Al8woi+BX3MNIY2BDXeNqjZhjG8ik8ReUq1V204nU+lxrtaUKapCrJhRxHQLXCgj34JAwj6C3Qcgb0EegjRgSSgO0EvguFFMEFo7L4UbZbAkca4kCfZoisyCpYzr3yCkD+KUqlKDUVQkI30Q4dPjx6s16PoLEjHUy0ZtsbUHTba84G251Qq93i99K+UpgAKdVwF2YRxmeXpzI8TiYD+GMn72eA+ZjShvTrnIuOoRjW2r2FTAPV1FCXY1AWdvlU0vHAyKSf9NY00740PTU14fPz5cy34pdDDUAZ4ScconDCJx+w9MGNjN97/MObyzJEXo7A854Kr9j7PV35/489zAbKd3w/ICDyi33kpDcuSvX0YF//Mw79NNHyWkIKYj0GYN9l0NoI6Cd9SbO6Q8pwi4kKkJwJ1U1Kdm7BMrKqgi2mRphQuKhpvUMTt+x8qs5uhIsBB1MG/0EtnExybH/mZUxy5eMsTyXOhVbF0paQh147zNnvp7HzO1Q35LbT3vxUSCWZ0Hed2FBWnktLUgtqkmSoC/I6tThXbEe4A+h5HJAGdia4cA0wqnc0zJ5t1huLSTBChxdS4pTR6nuexYRzpseAEmZdGTJhVbHNnTG8hzR5skt5eF7wZniqzm1ARahunDuyjLu086AtMPe9TKo2cz6fTuQonInQjctbDWd7/7Y7SnPQ983SWU/PeWFnxf8zb++14fPzpUy34sfkt1IOHQ5pdqDQCX30iAv3vzOhR8uI93Pf2vk13wXxzzCdZStLy/mvu/JzJTgOecin+w7LRpYHfgDxSDBev0nAGRF95iHH5Q32hh3R0bWChgOsOcAeI+SfgN4gpl8AjgDWFYEmeyN3WPgOXPVNcScPSOEvjIszSyKU0rBMXSXDN/yJfozRcVU3QIxdGciW4vBKzX4OL8jEKvDV6utaNE3mkRTIhoit41jBTyXwedNfIyuHgFeIlulYkN6IxiOuM6Zy+o5iyNOF1SPdfjS8QP/OcHE/4Ph6aP4Z68OWQZhcqDfpiRCtYwIIMPVft+q7vZfYhLZE29B0N8D717tLqcmERafp+gBzu2ur8w9TsseqEvrjOvGwqnEgPhxh+XVdIliwNHHxdfyENlkUXafS/KYP54jrzt6EU0WSFnH7DpW68DeYYEz9TRkrTm8CDyQ4JrbikNHdQmQzddUFxHE/4Pr40f0714OmQZhcqDQZPRBky0JABAhYgihX+xQMLX+g0ubs0zIXFpRnHyQIe6YZt7cgfiuGgHVuUBqMLjDijk7m4i9Sk0T/0AAomszTZez3SZ00VkpbSTB5qW16aVTCoBXKYi3jxYlOa9lmI71hemqkeHNLs4/Cl7+OQZh/Hqsf3gl+bA9s4NLOHjziczhXE1dUG2swJ0KOtv1jy/ZeF3hlmM80ZaqHtnFwz/3u4ZrCGeD6JHrC3Dd///erdx63CQy2KTwe20Xw+sI3mh3BgE4dm9vDWmonfQLXeR7/CKn+be/oK0ZZCaCbacjVXv5Otgfu+AF+styt2lWlbDLdlbl/TT5aPlxEB8zL+bbHmu9JVvbkDYc00hLDaq7BsS1zuiXNBotg5F6+p45ZynmlGWGcPkuDO6MzONirMYDrahseUNz56bAP3Wwu2YnCrZMrlqFyyzdgB9/rXJMlpbrIEoVPPEROuGd/M7W2YnIut5c93ZCXSzjzqI3kuXdAZ+5iZpuhSbNqMyWFUIulSM64wS1MzqL1rwtrR8vzDWTNhSzMeB+I712ctuS5m4bGlBXLMwSBuRdgRIivNpGvN5MrHkOKa65qOsTHL02KaiRua8a30wSJqbFsKTRa7cSTldvC02Eb7uDw9SwusTFv459zPg735gZElWi97Jhk2wiqCEL/I55WtHBHmQjlppwhFSXajmP3AyhkIY+dkG3tTsH9DQIy4NoyrVYN3Mcsc+4S0aMYk9Ef6Vg/s9vAiROQGk/A1sGibnXstAugOzlfSx+v8zZuPUXsPze8HttH8NRzYxKGZPRTTzK1Qku4mxRsFoXwroBlGVeEg8+ZC29bnl2TwnX6DRSOJl+cQmz5TbtUxB2sNxlUy/ULcrygrgmtGGHSGOLWeAWjcATlQ6s73QFrUU5fz2PiIg+TKg0PPg+2Q7MkF+zW7zmK6OoZK2d7N3hRl1HaDyFATVjZjle5ZAdQHl6ER1N41QS14HulFM6Y51te+WTNdDi4T553Nq19RP4/zen9km0EsI9sVKmGGTYjYxi4/Ka6Zizwh3OVrFdQbyAyHWTM94v6cAgRDVq4w6TGB9dnMHvrrgEW5ZfBLJ7MX5lhpV7uDY9TewzEH3kPz93RgE4dm9vDVmrmx8X28TVF8y/zbAJpB1KSFTjKgE4GeHgXL0tEiUpeQztYO7VYdx2mlGYsIzVGaF7e/+Z7+b4ZrJjDEtWXYLX/johkEobYMf8Wh9cqDoA0Ws8s4Wd6GGOJxHBmLavwsqJdqNKp8g/7nVDNWNsNIZX5HrV/rmkFd22wzs2aM3gzHvlkziNCl7pxZpsqf1oum2q0m20wYLSq5hUqYYQA5VTa1l08TLcwrOAZkWx5mzUxKEJxi5COalYsLKGLoev02swdayy6W4O7wEsV3iWPU3sMxB95DVdHJVeHQzB4Ozezh0Mw2QvgHklaHUpUzsN4AAAAASUVORK5CYII=" alt="Alt text"></p> <h3 id="_2-4-2-运行mql程序属性"><a href="#_2-4-2-运行mql程序属性" class="header-anchor">#</a> 2.4.2 运行MQL程序属性</h3> <p>为了获取当前运行的MQL5程序的信息，可以使用ENUM_MQL_INFO_INTEGER 和 ENUM_MQL_INFO_STRING常量。 使用函数 MQLInfoInteger</p> <p>ENUM_MQL_INFO_INTEGER</p> <table><thead><tr><th>标识符</th> <th>描述</th> <th>类型</th></tr></thead> <tbody><tr><td>MQL_MEMORY_LIMIT</td> <td>MQL5程序可用的最大动态内存，单位:MB</td> <td>int</td></tr> <tr><td>MQL_MEMORY_USED</td> <td>MQL5程序已使用的内存大小，MB</td> <td>int</td></tr> <tr><td>MQL_PROGRAM_TYPE</td> <td>MQL5程序类型</td> <td>ENUM_PROGRAM_TYPE</td></tr> <tr><td>MQL_DLLS_ALLOWED</td> <td>允许为给定的执行程序使用DLL</td> <td>bool</td></tr> <tr><td>MQL_TRADE_ALLOWED</td> <td>允许已生效执行的程序进行交易</td> <td>bool</td></tr> <tr><td>MQL_SIGNALS_ALLOWED</td> <td>允许为给定的执行程序更改信号的权限</td> <td>bool</td></tr> <tr><td>MQL_DEBUG</td> <td>此标帜表示调试模式</td> <td>bool</td></tr> <tr><td>MQL_PROFILER</td> <td>此标帜表示以 代码分析模式 运行程序</td> <td>bool</td></tr> <tr><td>MQL_TESTER</td> <td>此标帜表示测试程序</td> <td>bool</td></tr> <tr><td>MQL_OPTIMIZATION</td> <td>此标帜表示优化程序</td> <td>bool</td></tr> <tr><td>MQL_VISUAL_MODE</td> <td>此标帜表示 可视化测试过程</td> <td>bool</td></tr> <tr><td>MQL_FRAME_MODE</td> <td>此标帜表示以收集优化结果框架模式执行EA</td> <td>bool</td></tr> <tr><td>MQL_LICENSE_TYPE</td> <td>EX5模块的许可类型。许可 是指使用MQLInfoInteger(MQL_LICENSE_TYPE)进行请求的EX5模块。</td> <td>ENUM</td></tr></tbody></table> <p>函数 MQLInfoString</p> <p>ENUM_MQL_INFO_STRING</p> <table><thead><tr><th>标识符</th> <th>描述</th> <th>类型</th></tr></thead> <tbody><tr><td>MQL_PROGRAM_NAME</td> <td>mql5已执行的程序名称</td> <td>string</td></tr> <tr><td>MQL_PROGRAM_PATH</td> <td>给定的执行程序的路径</td> <td>string</td></tr></tbody></table> <p>有关运行程序类型的信息，使用ENUM_PROGRAM_TYPE的值。</p> <p>ENUM_PROGRAM_TYPE</p> <table><thead><tr><th>标识符</th> <th>描述</th></tr></thead> <tbody><tr><td>PROGRAM_SCRIPT</td> <td>脚本</td></tr> <tr><td>PROGRAM_EXPERT</td> <td>专家</td></tr> <tr><td>PROGRAM_INDICATOR</td> <td>指标</td></tr></tbody></table> <p>ENUM_LICENSE_TYPE</p> <table><thead><tr><th>标识符</th> <th>描述</th></tr></thead> <tbody><tr><td>LICENSE_FREE</td> <td>免费无限使用版</td></tr> <tr><td>LICENSE_DEMO</td> <td>市场付费产品的试用版仅在策略测试中工作</td></tr> <tr><td>LICENSE_FULL</td> <td>购买的授权版允许至少5次激活。激活次数由卖家设定。卖家可以提高允许的激活次数</td></tr> <tr><td>LICENSE_TIME</td> <td>有时间期限的授权版</td></tr></tbody></table> <p>示例</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>ENUM_PROGRAM_TYPE mql_program=(ENUM_PROGRAM_TYPE)MQLInfoInteger(MQL_PROGRAM_TYPE);
   switch(mql_program)
     {
      case PROGRAM_SCRIPT:
        {
         Print(__FILE__+&quot; is script这是个脚本&quot;);
         break;
        }
      case PROGRAM_EXPERT:
        {
         Print(__FILE__+&quot; is Expert Advisor这是个EA&quot;);
         break;
        }
      case PROGRAM_INDICATOR:
        {
         Print(__FILE__+&quot; is custom indicator这是个自定义指标&quot;);
         break;
        }
      default:Print(&quot;MQL5 program type value is程序的类型值是 &quot;,mql_program);
     }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="_2-4-3-交易品种属性"><a href="#_2-4-3-交易品种属性" class="header-anchor">#</a> 2.4.3 交易品种属性</h3> <p>为了获得当前的市场信息，可以使用以下几个函数:SymbolInfoInteger()、SymbolInfoDouble()和SymbolInfoString()。第一个参数是 交易品种的代码符号名称，第二个函数的参数值可以是ENUM_SYMBOL_INFO_INTEGER、ENUM_SYMBOL_INFO_DOUBLE和ENUM_SYMBOL_INFO_STRING的枚举值之一。</p> <p>函数 SymbolInfoInteger()</p> <p>ENUM_SYMBOL_INFO_INTEGER</p> <table><thead><tr><th>标识符</th> <th>描述</th> <th>类型</th></tr></thead> <tbody><tr><td>SYMBOL_CUSTOM</td> <td>这是一个自定义的 交易品种 代码——该交易品种是基于来自市场报价 和/或 外部数据源的另一个交易品种而综合创建的。</td> <td>bool</td></tr> <tr><td>SYMBOL_BACKGROUND_COLOR</td> <td>交易品种 在 市场报价 窗口中的 的背景色</td> <td>color</td></tr> <tr><td>SYMBOL_CHART_MODE</td> <td>用于生成 交易品种 K线柱的价格类型，例如 Bid 或 最新价格。</td> <td>ENUM_SYMBOL_CHART_MODE</td></tr> <tr><td>SYMBOL_SELECT</td> <td>在 市场报价 窗口选中的 交易品种</td> <td>bool</td></tr> <tr><td>SYMBOL_VISIBLE</td> <td>交易品种 在 市场报价 窗口中可见。 一些 交易品种(主要是用于计算保证金要求 或 存款货币利润的交叉汇率)是自动选择的，但在 市场报价 窗口中可能是不可见的。要显示这些交易品种，必须显式地选择。</td> <td>bool</td></tr> <tr><td>SYMBOL_SESSION_DEALS</td> <td>当前会话的交易数量</td> <td>long</td></tr> <tr><td>SYMBOL_SESSION_BUY_ORDERS</td> <td>当时的 做多 订单数量</td> <td>long</td></tr> <tr><td>SYMBOL_SESSION_SELL_ORDERS</td> <td>当时的 做空 订单数量</td> <td>long</td></tr> <tr><td>SYMBOL_VOLUME</td> <td>最后订单的交易成量</td> <td>long</td></tr> <tr><td>SYMBOL_VOLUMEHIGH</td> <td>当天最大订单的交易量</td> <td>long</td></tr> <tr><td>SYMBOL_VOLUMELOW</td> <td>当天最小订单交易量</td> <td>long</td></tr> <tr><td>SYMBOL_TIME</td> <td>最后的报价时间</td> <td>datetime</td></tr> <tr><td>SYMBOL_DIGITS</td> <td>小数点后数字位数</td> <td>int</td></tr> <tr><td>SYMBOL_SPREAD_FLOAT</td> <td>显示浮动点差</td> <td>bool</td></tr> <tr><td>SYMBOL_SPREAD</td> <td>点差值，以 点 为单位</td> <td>int</td></tr> <tr><td>SYMBOL_TICKS_BOOKDEPTH</td> <td>市场深度 窗口中显示的最大请求数。对于没有请求队列的 交易品种 ，值为0。</td> <td>int</td></tr> <tr><td>SYMBOL_TRADE_CALC_MODE</td> <td>合约价格计算方式</td> <td>ENUM_SYMBOL_CALC_MODE</td></tr> <tr><td>SYMBOL_TRADE_MODE</td> <td>订单执行类型</td> <td>ENUM_SYMBOL_TRADE_MODE</td></tr> <tr><td>SYMBOL_START_TIME</td> <td>交易品种 交易开始日期（通常用于期货产品）</td> <td>datetime</td></tr> <tr><td>SYMBOL_EXPIRATION_TIME</td> <td>交易品种 交易结束日期（通常用于期货产品）</td> <td>datetime</td></tr> <tr><td>SYMBOL_TRADE_STOPS_LEVEL</td> <td>当前 价格 到 止损价 之间的最小距离(停止位)。</td> <td>int</td></tr> <tr><td>SYMBOL_TRADE_FREEZE_LEVEL</td> <td>冻结交易操作的价格距离</td> <td>int</td></tr> <tr><td>SYMBOL_TRADE_EXEMODE</td> <td>交易执行方式</td> <td>ENUM_SYMBOL_TRADE_EXECUTION</td></tr> <tr><td>SYMBOL_SWAP_MODE</td> <td>隔夜利息计算模式</td> <td>ENUM_SYMBOL_SWAP_MODE</td></tr> <tr><td>SYMBOL_SWAP_ROLLOVER3DAYS</td> <td>三日翻转利息</td> <td>ENUM_DAY_OF_WEEK</td></tr> <tr><td>SYMBOL_MARGIN_HEDGED_USE_LEG</td> <td>计算锁仓保证金只收取单边交易手数最大值（做多 或 做空）</td> <td>bool</td></tr> <tr><td>SYMBOL_EXPIRATION_MODE</td> <td>订单到期模式 权限标帜</td> <td>int</td></tr> <tr><td>SYMBOL_FILLING_MODE</td> <td>订单填充模式 权限标志</td> <td>int</td></tr> <tr><td>SYMBOL_ORDER_MODE</td> <td>订单类型 的 权限标识</td> <td>int</td></tr> <tr><td>SYMBOL_ORDER_GTC_MODE</td> <td>止损 和 止盈 订单到期模式，如果SYMBOL_EXPIRATION_MODE=SYMBOL_EXPIRATION_GTC（有效直至被取消）</td> <td>ENUM_SYMBOL_ORDER_GTC_MODE</td></tr> <tr><td>SYMBOL_OPTION_MODE</td> <td>期权类型</td> <td>ENUM_SYMBOL_OPTION_MODE</td></tr> <tr><td>SYMBOL_OPTION_RIGHT</td> <td>期权（看涨/看跌）</td> <td>ENUM_SYMBOL_OPTION_RIGHT</td></tr></tbody></table> <p>函数 SymbolInfoDouble()</p> <p>ENUM_SYMBOL_INFO_DOUBLE</p> <table><thead><tr><th>标识符</th> <th>描述</th> <th>类型</th></tr></thead> <tbody><tr><td>SYMBOL_BID</td> <td>Bid市场买入价 —— 最佳卖出报价信息</td> <td>double</td></tr> <tr><td>SYMBOL_BIDHIGH</td> <td>一天中市场的最高买入价Bid</td> <td>double</td></tr> <tr><td>SYMBOL_BIDLOW</td> <td>一天中市场的最低买入价Bid</td> <td>double</td></tr> <tr><td>SYMBOL_ASK</td> <td>Ask市场卖出价—— 最佳买入报价信息</td> <td>double</td></tr> <tr><td>SYMBOL_ASKHIGH</td> <td>一天中市场的最高卖出价</td> <td>double</td></tr> <tr><td>SYMBOL_ASKLOW</td> <td>一天中市场的最低卖出价</td> <td>double</td></tr> <tr><td>SYMBOL_LAST</td> <td>最新的交易价格</td> <td>double</td></tr> <tr><td>SYMBOL_LASTHIGH</td> <td>一天中最新的最高价</td> <td>double</td></tr> <tr><td>SYMBOL_LASTLOW</td> <td>一天中最新的最低价</td> <td>double</td></tr> <tr><td>SYMBOL_OPTION_STRIKE</td> <td>期权的执行价格。期权购买者可以购买(在看涨期权中)或卖出(看跌期权)标的资产的价格，而期权卖方有义务出售或购买适当数量的标的资产。</td> <td>double</td></tr> <tr><td>SYMBOL_POINT</td> <td>交易品种点值</td> <td>double</td></tr> <tr><td>SYMBOL_TRADE_TICK_VALUE</td> <td>交易品种每一点对应的金额</td> <td>double</td></tr> <tr><td>SYMBOL_TRADE_TICK_VALUE_PROFIT</td> <td>计算获利单的价格</td> <td>double</td></tr> <tr><td>SYMBOL_TRADE_TICK_VALUE_LOSS</td> <td>计算浮亏单的价格</td> <td>double</td></tr> <tr><td>SYMBOL_TRADE_TICK_SIZE</td> <td>最小报价跳动</td> <td>double</td></tr> <tr><td>SYMBOL_TRADE_CONTRACT_SIZE</td> <td>交易合约大小</td> <td>double</td></tr> <tr><td>SYMBOL_TRADE_ACCRUED_INTEREST</td> <td>应计利息 —— 累积息票利息，即息票利息的一部分，按息票债券发行或息票息后的天数计算。</td> <td>double</td></tr> <tr><td>SYMBOL_TRADE_FACE_VALUE</td> <td>票面价值 —— 发行人设定的初始债券价值。</td> <td>double</td></tr> <tr><td>SYMBOL_TRADE_LIQUIDITY_RATE</td> <td>流动性比率指的是可用于保证金的资产的份额。它被用来作为抵押品的象征。</td> <td>double</td></tr> <tr><td>SYMBOL_VOLUME_MIN</td> <td>一笔交易中的最小成交量(最小手数)</td> <td>double</td></tr> <tr><td>SYMBOL_VOLUME_MAX</td> <td>一笔交易中的最大成交量(最大手数)</td> <td>double</td></tr> <tr><td>SYMBOL_VOLUME_STEP</td> <td>执行交易的最小成交量(手数)变更单位</td> <td>double</td></tr> <tr><td>SYMBOL_VOLUME_LIMIT</td> <td>交易品种 单向（做多 或 做空）持仓 和 挂单允许的最大交易量(总手数)。例如，限定范围为5手内，即表示您可以拥有5手 做多 持仓订单 和 下单5手 限价做空挂单 订单。但是在这种情况下，你不能再下单 限价做多挂单（因为单向总交易量将会超出限定范围）或 下单超过5手的 限价做空 订单。</td> <td>double</td></tr> <tr><td>SYMBOL_SWAP_LONG</td> <td>做多订单 库存费(利息)</td> <td>double</td></tr> <tr><td>SYMBOL_SWAP_SHORT</td> <td>做空订单 库存费(利息)</td> <td>double</td></tr> <tr><td>SYMBOL_MARGIN_INITIAL</td> <td>初始保证金 是指每一笔交易在开立头寸时所需要的保证金金额，用于在客户进入市场时检查其资产。</td> <td>double</td></tr> <tr><td>SYMBOL_MARGIN_MAINTENANCE</td> <td>维持保证金。如果设置了，它将从一手交易订单中收取的 交易品种 的保证金货币中设置保证金金额。当客户的帐户状态发生变化时，它用于检查客户的资产。如果维持保证金等于0，则使用初始保证金。</td> <td>double</td></tr> <tr><td>SYMBOL_SESSION_VOLUME</td> <td>当前交易的总交易量</td> <td>double</td></tr> <tr><td>SYMBOL_SESSION_TURNOVER</td> <td>当前的总流通量</td> <td>double</td></tr> <tr><td>SYMBOL_SESSION_INTEREST</td> <td>总持仓利息</td> <td>double</td></tr> <tr><td>SYMBOL_SESSION_BUY_ORDERS_VOLUME</td> <td>当前 做多 订单的交易量</td> <td>double</td></tr> <tr><td>SYMBOL_SESSION_SELL_ORDERS_VOLUME</td> <td>当前 做空 订单的交易量</td> <td>double</td></tr> <tr><td>SYMBOL_SESSION_OPEN</td> <td>当前开仓价格</td> <td>double</td></tr> <tr><td>SYMBOL_SESSION_CLOSE</td> <td>当前平仓价格</td> <td>double</td></tr> <tr><td>SYMBOL_SESSION_AW</td> <td>当前加权平均价格</td> <td>double</td></tr> <tr><td>SYMBOL_SESSION_PRICE_SETTLEMENT</td> <td>当前结算价格</td> <td>double</td></tr> <tr><td>SYMBOL_SESSION_PRICE_LIMIT_MIN</td> <td>当前最低价格</td> <td>double</td></tr> <tr><td>SYMBOL_SESSION_PRICE_LIMIT_MAX</td> <td>当前最高价格</td> <td>double</td></tr> <tr><td>SYMBOL_MARGIN_HEDGED</td> <td>锁仓订单（一个 交易品种 的反向持仓订单）的每手合约大小 或 预付款。锁仓持仓可以使用两种预付款计算方式。计算方式由交易商定义。 基本计算： •如果为 交易品种 指定了初始保证金(symbol__initial)，则对冲保证金被指定为绝对值(以货币形式)。 •如果没有指定初始预付款(等于0)，SYMBOL_MARGIN_HEDGED 则等于合约大小，这将被用来根据 金融工具(交易品种) 的类型(SYMBOL_TRADE_CALC_MODE)来选定适当公式计算差额。 计算最大持仓： •SYMBOL_MARGIN_HEDGED 值不被考虑。 •计算交易品种所有 做多 和 做空 的交易量。 •对于每个方向，都会计算加权平均 开盘价 和 入金货币 的加权平均转化率。 •下一步，使用根据 交易品种 的类型来选定适当公式(SYMBOL_TRADE_CALC_MODE) 计算 做多 和 做空 持仓的预付款。 •取最大值用作预付款。</td> <td>double</td></tr></tbody></table> <p>函数 SymbolInfoString()</p> <p>ENUM_SYMBOL_INFO_STRING</p> <table><thead><tr><th>标识符</th> <th>描述</th> <th>类型</th></tr></thead> <tbody><tr><td>SYMBOL_BASIS</td> <td>基础衍生资产</td> <td>string</td></tr> <tr><td>SYMBOL_CURRENCY_BASE</td> <td>交易品种的基础货币</td> <td>string</td></tr> <tr><td>SYMBOL_CURRENCY_PROFIT</td> <td>利润货币</td> <td>string</td></tr> <tr><td>SYMBOL_CURRENCY_MARGIN</td> <td>保证金货币</td> <td>string</td></tr> <tr><td>SYMBOL_BANK</td> <td>当前报价数据源</td> <td>string</td></tr> <tr><td>SYMBOL_DESCRIPTION</td> <td>交易品种描述</td> <td>string</td></tr> <tr><td>SYMBOL_FORMULA</td> <td>用于自定义 交易品种 的定价公式</td> <td>string</td></tr> <tr><td>SYMBOL_ISIN</td> <td>ISIN系统中交易品种的名称（国际证券识别号码）。国际证券识别号码是一个12位数字字母代码，是证券的唯一识别码。交易品种的属性是由交易服务器方面决定的 。</td> <td>string</td></tr> <tr><td>SYMBOL_PAGE</td> <td>包含交易品种信息的网页地址。这个地址将显示为一个链接，用于在程序端中查看交易品种的属性</td> <td>string</td></tr> <tr><td>SYMBOL_PATH</td> <td>交易品种树形路径</td> <td>string</td></tr></tbody></table> <p>一个 交易品种 的价格图表可以基于 市场卖出价(Bid) 或 最新报价为基础。为 交易品种 图表选择的价格也会影响客户端中 K线柱的生成和展示。在ENUM_SYMBOL_CHART_MODE(枚举型 交易品种图表模式)中描述了SYMBOL_CHART_MODE属性的枚举值。</p> <p>ENUM_SYMBOL_CHART_MODE</p> <table><thead><tr><th>标识符</th> <th>描述</th></tr></thead> <tbody><tr><td>SYMBOL_CHART_MODE_BID</td> <td>K线柱以卖价(Bid)为基础</td></tr> <tr><td>SYMBOL_CHART_MODE_LAST</td> <td>K线柱以最新报价为基础</td></tr></tbody></table> <p>对于每个 交易品种 而言，可以指定几种 挂单(待定订单)的过期模式。每个模式都匹配一个标志。可以使用逻辑 或(|)操作 来组合标志，例如，SYMBOL_EXPIRATION_GTC|SYMBOL_EXPIRATION_SPECIFIED。 为了检查 交易品种 是否允许某一种模式，可以使用逻辑 与(&amp;)操作 来和模式的标志相比较。</p> <p>如果交易品种的SYMBOL_EXPIRATION_SPECIFIED标志可以指定，那么在发送一个挂单时，您可以指定这个挂单的有效时间，直至成交激活前。</p> <table><thead><tr><th>标识符</th> <th>值</th> <th>描述</th></tr></thead> <tbody><tr><td>SYMBOL_EXPIRATION_GTC</td> <td>1</td> <td>订单永久有效，直到被明确取消</td></tr> <tr><td>SYMBOL_EXPIRATION_DAY</td> <td>2</td> <td>订单在交易日当天有效</td></tr> <tr><td>SYMBOL_EXPIRATION_SPECIFIED</td> <td>4</td> <td>订单中指定的到期时间</td></tr> <tr><td>SYMBOL_EXPIRATION_SPECIFIED_DAY</td> <td>8</td> <td>订单中指定的到期日期</td></tr></tbody></table> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+
//| 检测是否允许指定的到期模式                                           |
//+------------------------------------------------------------------+
bool IsExpirationTypeAllowed(string symbol,int exp_type)
  {
//--- 获得描述允许到期模式的属性值
   int expiration=(int)SymbolInfoInteger(symbol,SYMBOL_EXPIRATION_MODE);
//--- 如果exp_type模式被允许，返回true
   return((expiration &amp; exp_type)==exp_type);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>当使用OrderSend()函数发送交易请求时，应该为一些操作指定来自ENUM_ORDER_TYPE枚举的订单类型。并不是所有类型的订单都可以适用于一个特定的 交易品种。SYMBOL_ORDER_MODE属性描述了允许的订单类型的标识。</p> <p>例如</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+
//| 该函数打印出交易品种允许的订单类型                                       |
//+------------------------------------------------------------------+
void Check_SYMBOL_ORDER_MODE(string symbol)
  {
//--- 接收描述允许订单类型的属性的值
   int symbol_order_mode=(int)SymbolInfoInteger(symbol,SYMBOL_ORDER_MODE);
//--- 检查市价单（市场执行）
   if((SYMBOL_ORDER_MARKET &amp; symbol_order_mode)==SYMBOL_ORDER_MARKET)
      Print(symbol+&quot;: Market orders are allowed (Buy and Sell)&quot;);
//--- 检查限价单
   if((SYMBOL_ORDER_LIMIT &amp; symbol_order_mode)==SYMBOL_ORDER_LIMIT)
      Print(symbol+&quot;: Buy Limit and Sell Limit orders are allowed&quot;);
//--- 检查止损单
   if((SYMBOL_ORDER_STOP &amp; symbol_order_mode)==SYMBOL_ORDER_STOP)
      Print(symbol+&quot;: Buy Stop and Sell Stop orders are allowed&quot;);
//--- 检查止损限价订单
   if((SYMBOL_ORDER_STOP_LIMIT &amp; symbol_order_mode)==SYMBOL_ORDER_STOP_LIMIT)
      Print(symbol+&quot;: Buy Stop Limit and Sell Stop Limit orders are allowed&quot;);
//--- 检查是否允许下止损订单
   if((SYMBOL_ORDER_SL &amp; symbol_order_mode)==SYMBOL_ORDER_SL)
      Print(symbol+&quot;: Stop Loss orders are allowed&quot;);
//--- 检查是否允许下获利订单
   if((SYMBOL_ORDER_TP &amp; symbol_order_mode)==SYMBOL_ORDER_TP)
      Print(symbol+&quot;: Take Profit orders are allowed&quot;);
//---
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>为计算 交易品种 的保证金要求，可以使用枚举型ENUM_SYMBOL_CALC_MODE来获取信息。</p> <p>ENUM_SYMBOL_CALC_MODE</p> <table><thead><tr><th>标识符</th> <th>描述</th> <th>公式</th></tr></thead> <tbody><tr><td>SYMBOL_CALC_MODE_FOREX</td> <td>外汇模式 —— 按外汇品种计算利润和保证金</td> <td>保证金： Lots * Contract_Size / Leverage Contract_Size / Leverage * Margin_Rate 利润： (close_price - open_price) * Contract_Size * Lots</td></tr> <tr><td>SYMBOL_CALC_MODE_FOREX_NO_LEVERAGE</td> <td>外汇无杠杆模式 —— 不考虑杠杆作用的情况下来计算外汇品种的利润和预付款</td> <td>保证金： Lots * Contract_Size * Margin_Rate 利润： (close_price - open_price) * Contract_Size * Lots</td></tr> <tr><td>SYMBOL_CALC_MODE_FUTURES</td> <td>期货模式 —— 按期货品种计算保证金和利润</td> <td>保证金： Lots * InitialMargin * Percentage / 100 * Margin_Rate 利润： (close_price - open_price) * TickPrice / TickSize * Lots</td></tr> <tr><td>SYMBOL_CALC_MODE_CFD</td> <td>CFD模式 —— 按合约产品计算保证金和利润</td> <td>保证金： Lots * ContractSize * MarketPrice * Percentage / 100 * Margin_Rate 利润： (close_price - open_price) * Contract_Size * Lots</td></tr> <tr><td>SYMBOL_CALC_MODE_CFDINDEX</td> <td>CFD指数模式 —— 通过指数计算保证金和利润</td> <td>保证金： (Lots * ContractSize * MarketPrice) * TickPrice / TickSize * Margin_Rate 利润： (close_price - open_price) * Contract_Size * Lots</td></tr> <tr><td>SYMBOL_CALC_MODE_CFDLEVERAGE</td> <td>CFD杠杆模式 —— 通过杠杆交易计算保证金和利润</td> <td>保证金： (Lots * ContractSize * MarketPrice * Percentage) / Leverage * Margin_Rate 利润： (close_price - open_price) * Contract_Size * Lots</td></tr> <tr><td>SYMBOL_CALC_MODE_EXCH_STOCKS</td> <td>交换模式 —— 计算股票交易中，交易证券的保证金和赢利</td> <td>保证金： Lots * ContractSize * LastPrice * Margin_Rate 利润： (close_price - open_price) * Contract_Size * Lots</td></tr> <tr><td>SYMBOL_CALC_MODE_EXCH_FUTURES</td> <td>期货模式—— 计算股票交易中，交易期货合约的保证金和赢利</td> <td>保证金： Lots * InitialMargin or Lots * MaintenanceMargin * Margin_Rate 利润： (close_price - open_price) * Lots*TickPrice / TickSize</td></tr> <tr><td>SYMBOL_CALC_MODE_EXCH_FUTURES_FORTS</td> <td>期货期权模式—— 计算期权交易中，交易期货合约的保证金和赢利。根据以下规则，保证金可能会因MarginDiscount 偏差的数额而减少： 1. 如果买入价格（做多订单）少于预估价格，MarginDiscount = Lots*((PriceSettle-PriceOrder)<em>TickPrice/TickSize) 2. 如果卖出价格（做空）超过预估价格，MarginDiscount = Lots</em>((PriceOrder-PriceSettle)*TickPrice/TickSize) 在这里： PriceSettle —— 前一交易日的预估价格（清算）； PriceOrde——订单（请求）中设置的加权平均持仓价格或持仓价格； TickPrice —— 订单价（成本价格的点变化） TickSize——订单大小（最低价格变化的步骤）</td> <td>保证金： Lots * InitialMargin or Lots * MaintenanceMargin * Margin_Rate 利润： (close_price - open_price) * Lots * TickPrice / TickSize</td></tr> <tr><td>SYMBOL_CALC_MODE_SERV_COLLATERAL</td> <td>担保模式 —— 在交易账户中使用交易品种作为非交易资产。持仓的市值根据交易量，当前市价，合约大小和流动比率进行计算。价值包括在资产中，被加入到净值。这种交易品种的持仓提高了可用预付款的数额，并用作可交易工具持仓的额外预付款（担保）。</td> <td>预付款： no 利润： no 市值： Lots*ContractSize * MarketPrice * LiqudityRate</td></tr></tbody></table> <p>交易品种 有多种交易方式，某一 交易品种 的交易方式信息反映在ENUM_SYMBOL_TRADE_MODE枚举值中。</p> <p>ENUM_SYMBOL_TRADE_MODE</p> <table><thead><tr><th>标识符</th> <th>描述</th></tr></thead> <tbody><tr><td>SYMBOL_TRADE_MODE_DISABLED</td> <td>交易品种禁止交易</td></tr> <tr><td>SYMBOL_TRADE_MODE_LONGONLY</td> <td>仅允许买入(做多)持仓</td></tr> <tr><td>SYMBOL_TRADE_MODE_SHORTONLY</td> <td>仅允许卖出(做空)持仓</td></tr> <tr><td>SYMBOL_TRADE_MODE_CLOSEONLY</td> <td>仅允许平仓操作</td></tr> <tr><td>SYMBOL_TRADE_MODE_FULL</td> <td>没有交易限制</td></tr></tbody></table> <p>ENUM_SYMBOL_TRADE_EXECUTION枚举中定义了每一个 交易品种 可能的订单执行方式</p> <p>ENUM_SYMBOL_TRADE_EXECUTION</p> <table><thead><tr><th>标识符</th> <th>描述</th></tr></thead> <tbody><tr><td>SYMBOL_TRADE_MODE_DISABLED</td> <td>交易品种禁止交易</td></tr> <tr><td>SYMBOL_TRADE_MODE_LONGONLY</td> <td>仅允许买入(做多)持仓</td></tr> <tr><td>SYMBOL_TRADE_MODE_SHORTONLY</td> <td>仅允许卖出(做空)持仓</td></tr> <tr><td>SYMBOL_TRADE_MODE_CLOSEONLY</td> <td>仅允许平仓操作</td></tr> <tr><td>SYMBOL_TRADE_MODE_FULL</td> <td>没有交易限制</td></tr></tbody></table> <p>ENUM_SYMBOL_TRADE_EXECUTION枚举中定义了每一个 交易品种 可能的订单执行方式</p> <p>ENUM_SYMBOL_TRADE_EXECUTION</p> <table><thead><tr><th>标识符</th> <th>描述</th></tr></thead> <tbody><tr><td>SYMBOL_TRADE_EXECUTION_REQUEST</td> <td>请求执行</td></tr> <tr><td>SYMBOL_TRADE_EXECUTION_INSTANT</td> <td>立即执行</td></tr> <tr><td>SYMBOL_TRADE_EXECUTION_MARKET</td> <td>市场执行</td></tr> <tr><td>SYMBOL_TRADE_EXECUTION_EXCHANGE</td> <td>交换执行</td></tr></tbody></table> <p>在枚举型常量ENUM_SYMBOL_SWAP_MODE中指定了仓位的隔夜利息计算方式。利息计算方式决定了 SYMBOL_SWAP_LONG 和 SYMBOL_SWAP_SHORT 参数的度量单位。例如，如果以客户入金的货币来收取利息，那么那些参数的值则指定为客户入金货币的金额。</p> <p>ENUM_SYMBOL_TRADE_EXECUTION</p> <table><thead><tr><th>标识符</th> <th>描述</th></tr></thead> <tbody><tr><td>SYMBOL_SWAP_MODE_DISABLED</td> <td>禁用利息（无利息）</td></tr> <tr><td>SYMBOL_SWAP_MODE_POINTS</td> <td>以点数收取利息</td></tr> <tr><td>SYMBOL_SWAP_MODE_CURRENCY_SYMBOL</td> <td>以交易品种基础货币的金额收取利息</td></tr> <tr><td>SYMBOL_SWAP_MODE_CURRENCY_MARGIN</td> <td>以交易品种保证金货币的金额收取利息</td></tr> <tr><td>SYMBOL_SWAP_MODE_CURRENCY_DEPOSIT</td> <td>以客户入金货币的金额收取利息</td></tr> <tr><td>SYMBOL_SWAP_MODE_INTEREST_CURRENT</td> <td>利息作为指定的年利息(标准银行年为360天)时，由 金融工具 的价格指定年度利息。</td></tr> <tr><td>SYMBOL_SWAP_MODE_INTEREST_OPEN</td> <td>利息作为指定的年利息(标准银行年为360天)时，由 持仓的开盘价格收取。</td></tr> <tr><td>SYMBOL_SWAP_MODE_REOPEN_CURRENT</td> <td>重新持仓收取利息。交易日结束，平仓。第二天以收盘价 +/- 指定点数 (参数 SYMBOL_SWAP_LONG 和SYMBOL_SWAP_SHORT)重新持仓</td></tr> <tr><td>SYMBOL_SWAP_MODE_REOPEN_BID</td> <td>重新持仓收取利息。交易日结束，平仓。第二天以当前卖价(Bid) +/- 指定点数 (参数 SYMBOL_SWAP_LONG 和 SYMBOL_SWAP_SHORT)重新持仓</td></tr></tbody></table> <p>ENUM_DAY_OF_WEEK枚举值用于指定一周的天数。</p> <p>ENUM_DAY_OF_WEEK</p> <table><thead><tr><th>标识符</th> <th>描述</th></tr></thead> <tbody><tr><td>SUNDAY</td> <td>星期日</td></tr> <tr><td>MONDAY</td> <td>星期一</td></tr> <tr><td>TUESDAY</td> <td>星期二</td></tr> <tr><td>WEDNESDAY</td> <td>星期三</td></tr> <tr><td>THURSDAY</td> <td>星期四</td></tr> <tr><td>FRIGAY</td> <td>星期五</td></tr> <tr><td>SATURDAY</td> <td>星期六</td></tr></tbody></table> <p>期权是一份合约，给予的是权限，而非责任，为了在指定价格或在特定日期前买入或出售基础资产（商品，股票，期货等等）。以下枚举描述了期权的属性，包括期权类型和由其产生的权限。</p> <p>ENUM_SYMBOL_OPTION_RIGHT</p> <table><thead><tr><th>标识符</th> <th>描述</th></tr></thead> <tbody><tr><td>SYMBOL_OPTION_RIGHT_CALL</td> <td>看涨期权就是提供给您在指定价格购买资产的权限</td></tr> <tr><td>SYMBOL_OPTION_RIGHT_PUT</td> <td>看跌期权就是提供给您在特定价格出售资产的权限</td></tr></tbody></table> <p>ENUM_SYMBOL_OPTION_MODE</p> <table><thead><tr><th>标识符</th> <th>描述</th></tr></thead> <tbody><tr><td>SYMBOL_OPTION_MODE_EUROPEAN</td> <td>欧式期权可能只能在特定日期行使 (到期，执行日期，交付日期)</td></tr> <tr><td>SYMBOL_OPTION_MODE_AMERICAN</td> <td>美式期权可以在任何交易日或到期之前行使。在指定周期买家可以行使期权</td></tr></tbody></table> <h3 id="_2-4-4-账户属性"><a href="#_2-4-4-账户属性" class="header-anchor">#</a> 2.4.4 账户属性</h3> <p>使用 AccountInfoInteger()， AccountInfoDouble() 和 AccountInfoString() 函数可以获得当前账户信息，该函数的参数可以接受来自相应的ENUM_ACCOUNT_INFO枚举的值。</p> <p>AccountInfoInteger() 函数</p> <p>ENUM_ACCOUNT_INFO_INTEGER</p> <table><thead><tr><th>标识符</th> <th>描述</th> <th>类型</th></tr></thead> <tbody><tr><td>ACCOUNT_LOGIN</td> <td>账号数字</td> <td>long</td></tr> <tr><td>ACCOUNT_TRADE_MODE</td> <td>账户交易方式</td> <td>ENUM_ACCOUNT_TRADE_MODE</td></tr> <tr><td>ACCOUNT_LEVERAGE</td> <td>账户杠杆</td> <td>long</td></tr> <tr><td>ACCOUNT_LIMIT_ORDERS</td> <td>最大持单和挂单的允许数量</td> <td>int</td></tr> <tr><td>ACCOUNT_MARGIN_SO_MODE</td> <td>设置最小允许的保证金模式</td> <td>ENUM_ACCOUNT_STOPOUT_MODE</td></tr> <tr><td>ACCOUNT_TRADE_ALLOWED</td> <td>账户允许交易</td> <td>bool</td></tr> <tr><td>ACCOUNT_TRADE_EXPERT</td> <td>允许EA交易</td> <td>bool</td></tr> <tr><td>ACCOUNT_MARGIN_MODE</td> <td>预付款计算模式</td> <td>ENUM_ACCOUNT_MARGIN_MODE</td></tr></tbody></table> <p>函数 AccountInfoDouble()</p> <p>ENUM_ACCOUNT_INFO_DOUBLE</p> <table><thead><tr><th>标识符</th> <th>描述</th> <th>类型</th></tr></thead> <tbody><tr><td>ACCOUNT_BALANCE</td> <td>账户余额</td> <td>double</td></tr> <tr><td>ACCOUNT_CREDIT</td> <td>账户信用额度</td> <td>double</td></tr> <tr><td>ACCOUNT_PROFIT</td> <td>账户当前盈利</td> <td>double</td></tr> <tr><td>ACCOUNT_EQUITY</td> <td>账户净值</td> <td>double</td></tr> <tr><td>ACCOUNT_MARGIN</td> <td>账户已用预付款(保证金)</td> <td>double</td></tr> <tr><td>ACCOUNT_MARGIN_FREE</td> <td>账户可用预付款(保证金)</td> <td>double</td></tr> <tr><td>ACCOUNT_MARGIN_LEVEL</td> <td>账户预付款(保证金)比例百分比形式</td> <td>double</td></tr> <tr><td>ACCOUNT_MARGIN_SO_CALL</td> <td>追加保证金水平，依据建立的ACCOUNT_MARGIN_SO_MODE，以百分比形式 或 存入货币时期表示</td> <td>double</td></tr> <tr><td>ACCOUNT_MARGIN_SO_SO</td> <td>保证金停用水平，依据建立的ACCOUNT_MARGIN_SO_MODE，以百分比形式 或 存入货币时期表示</td> <td>double</td></tr> <tr><td>ACCOUNT_MARGIN_INITIAL</td> <td>初始预付款。账户上保留的金额需要涵盖所有挂单的预付款</td> <td>double</td></tr> <tr><td>ACCOUNT_MARGIN_MAINTENANCE</td> <td>维持预付款。账户上保留的最小净值需要涵盖所有持仓的最小金额</td> <td>double</td></tr> <tr><td>ACCOUNT_ASSETS</td> <td>账户的流动资产</td> <td>double</td></tr> <tr><td>ACCOUNT_LIABILITIES</td> <td>账户的流动负债</td> <td>double</td></tr> <tr><td>ACCOUNT_COMMISSION_BLOCKED</td> <td>账户的当前锁定手续费金额</td> <td>double</td></tr></tbody></table> <p>函数 AccountInfoString()</p> <p>ENUM_ACCOUNT_INFO_STRING</p> <table><thead><tr><th>标识符</th> <th>描述</th> <th>类型</th></tr></thead> <tbody><tr><td>ACCOUNT_NAME</td> <td>帐户名称</td> <td>string</td></tr> <tr><td>ACCOUNT_SERVER</td> <td>交易服务器名称</td> <td>string</td></tr> <tr><td>ACCOUNT_CURRENCY</td> <td>账户货币</td> <td>string</td></tr> <tr><td>ACCOUNT_COMPANY</td> <td>提供账户的公司名称</td> <td>string</td></tr></tbody></table> <p>交易服务器可以开设的账户类型有以下几种。MQL5程序可以使用枚举型常量ENUM_ACCOUNT_TRADE_MODE 来获得当前账户的类型.</p> <table><thead><tr><th>标识符</th> <th>描述</th></tr></thead> <tbody><tr><td>ACCOUNT_TRADE_MODE_DEMO</td> <td>模拟账户</td></tr> <tr><td>ACCOUNT_TRADE_MODE_CONTEST</td> <td>竞赛账户</td></tr> <tr><td>ACCOUNT_TRADE_MODE_REAL</td> <td>真实账户</td></tr></tbody></table> <p>如果净值不足以保持持仓，止损离场的情况，例如强制平仓发生。出现止损离场的最小预付款水平能够以百分比或货币条款来设置。若要找到账户设置的模式，请使用ENUM_ACCOUNT_STOPOUT_MODE 枚举。</p> <p>如果帐户净值不足以维持已持有的订单头寸，则会触发止损离场的情况，即强制平仓。触发强制平仓发生的最低保证金水平，可以用 百分比 或 货币金额的形式设定。要获得帐户的模式，请使用ENUM_ACCOUNT_STOPOUT_MODE枚举值。</p> <table><thead><tr><th>标识符</th> <th>描述</th></tr></thead> <tbody><tr><td>ACCOUNT_STOPOUT_MODE_PERCENT</td> <td>账户以百分比方式触发强制平仓</td></tr> <tr><td>ACCOUNT_STOPOUT_MODE_MONEY</td> <td>账户以货币金额方式触发强制平仓</td></tr></tbody></table> <p>ENUM_ACCOUNT_MARGIN_MODE</p> <table><thead><tr><th>标识符</th> <th>描述</th></tr></thead> <tbody><tr><td>ACCOUNT_MARGIN_MODE_RETAIL_NETTING</td> <td>用于OTC市场（场外交易市场，又称柜台交易市场）“单边持仓”模式下的持仓说明 (一个交易品种只存在一个持仓）。预付款计算基于交易品种的类型 (SYMBOL_TRADE_CALC_MODE)。</td></tr> <tr><td>ACCOUNT_MARGIN_MODE_EXCHANGE</td> <td>用于外汇交易市场。预付款计算基于交易品种设置中指定的折扣。折扣由交易商设定，但不能低于交易所设定的值。</td></tr> <tr><td>ACCOUNT_MARGIN_MODE_RETAIL_HEDGING</td> <td>用于交易市场的个人头寸是可能的(一个 交易品种 允许对冲，可以存在多个头寸)。保证金是根据 交易品种 类型(SYMBOL_TRADE_CALC_MODE)计算的，考虑到对冲的差额(SYMBOL_MARGIN_HEDGED)</td></tr></tbody></table> <p>输出简单账户信息的脚本示例。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+
//| 脚本程序起始函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 公司名称
   string company=AccountInfoString(ACCOUNT_COMPANY);
//--- 客户名称
   string name=AccountInfoString(ACCOUNT_NAME);
//--- 账号
   long login=AccountInfoInteger(ACCOUNT_LOGIN);
//--- 服务器名称
   string server=AccountInfoString(ACCOUNT_SERVER);
//--- 账户货币
   string currency=AccountInfoString(ACCOUNT_CURRENCY);
//--- 模拟，竞赛或真实账户
   ENUM_ACCOUNT_TRADE_MODE account_type=(ENUM_ACCOUNT_TRADE_MODE)AccountInfoInteger(ACCOUNT_TRADE_MODE);
//--- 现在将枚举的值转换为一个可理解的形式
   string trade_mode;
   switch(account_type)
     {
      case  ACCOUNT_TRADE_MODE_DEMO:
         trade_mode=&quot;demo&quot;;
         break;
      case  ACCOUNT_TRADE_MODE_CONTEST:
         trade_mode=&quot;contest&quot;;
         break;
      default:
         trade_mode=&quot;real&quot;;
         break;
     }
//--- 以百分比或货币形式设置止损离场
   ENUM_ACCOUNT_STOPOUT_MODE stop_out_mode=(ENUM_ACCOUNT_STOPOUT_MODE)AccountInfoInteger(ACCOUNT_MARGIN_SO_MODE);
//--- 获取当出现预付款调用和止损离场时的水平的值
   double margin_call=AccountInfoDouble(ACCOUNT_MARGIN_SO_CALL);
   double stop_out=AccountInfoDouble(ACCOUNT_MARGIN_SO_SO);
//--- 显示账户信息简介
   PrintFormat(&quot;这个帐户是 '%s' #%d %s 属于 '%s' 在服务器 '%s'上&quot;,
               name,login,trade_mode,company,server);
   PrintFormat(&quot;帐户资金 - %s, 追加保证金 和 强制止损平仓 水平设置为 %s&quot;,
               currency,(stop_out_mode==ACCOUNT_STOPOUT_MODE_PERCENT)?&quot;百分比&quot;:&quot; 金额&quot;);
   PrintFormat(&quot;追加保证金=%G, 强制止损平仓=%G&quot;,margin_call,stop_out);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><h3 id="_2-4-5-测试统计"><a href="#_2-4-5-测试统计" class="header-anchor">#</a> 2.4.5 测试统计</h3> <p>测试结束之后，会统计计算不同的参数的交易结果。通过指定来自ENUM_STATISTICS 枚举的参数ID，可以使用 TesterStatistics() 函数来获得参数值。</p> <p>虽然两种类型的参数（int和double）都用于计算统计，但是函数会以double格式返回全部的值。double型的所有统计值默认以入金货币表示，除非另有说明。</p> <p>ENUM_STATISTICS</p> <table><thead><tr><th>ID</th> <th>统计参数的描述</th> <th>类型</th></tr></thead> <tbody><tr><td>STAT_INITIAL_DEPOSIT</td> <td>初始入金存款的金额</td> <td>double</td></tr> <tr><td>STAT_WITHDRAWAL</td> <td>从账户出金取款的金额</td> <td>double</td></tr> <tr><td>STAT_PROFIT</td> <td>测试后的净利润，STAT_GROSS_PROFIT 和 STAT_GROSS_LOSS 的总和(STAT_GROSS_LOSS 始终小于或等于0)</td> <td>double</td></tr> <tr><td>STAT_GROSS_PROFIT</td> <td>总利润，所有获利（正值）交易的总和。该值大于或等于0</td> <td>double</td></tr> <tr><td>STAT_GROSS_LOSS</td> <td>总亏损，所有亏损交易的总和。该值小于或等于0</td> <td>double</td></tr> <tr><td>STAT_MAX_PROFITTRADE</td> <td>最大收益 —— 所有获利交易中的最大值。该值大于或等于0</td> <td>double</td></tr> <tr><td>STAT_MAX_LOSSTRADE</td> <td>最大亏损 —— 所有亏损交易中的最低值。该值小于或等于0</td> <td>double</td></tr> <tr><td>STAT_CONPROFITMAX</td> <td>一组连续获利交易中的最大收益。该值大于或等于0</td> <td>double</td></tr> <tr><td>STAT_CONPROFITMAX_TRADES</td> <td>已经形成STAT_CONPROFITMAX (一组获利交易中的最大收益)的交易的数量</td> <td>double</td></tr> <tr><td>STAT_MAX_CONWINS</td> <td>最长的一组获利交易的总利润</td> <td>double</td></tr> <tr><td>STAT_MAX_CONPROFIT_TRADES</td> <td>最长的一组获利交易中的交易总数量 STAT_MAX_CONWINS</td> <td>double</td></tr> <tr><td>STAT_CONLOSSMAX</td> <td>一组连续亏损交易中的最大亏损。该值小于或等于0</td> <td>double</td></tr> <tr><td>STAT_CONLOSSMAX_TRADES</td> <td>已经形成 STAT_CONLOSSMAX (一组亏损交易中的最大亏损)的交易的数量</td> <td>int</td></tr> <tr><td>STAT_MAX_CONLOSSES</td> <td>最长一组亏损交易的总亏损</td> <td>double</td></tr> <tr><td>STAT_MAX_CONLOSS_TRADES</td> <td>最长的一组亏损交易中的交易数量 STAT_MAX_CONLOSSES</td> <td>int</td></tr> <tr><td>STAT_BALANCEMIN</td> <td>余额的最小值</td> <td>double</td></tr> <tr><td>STAT_BALANCE_DD</td> <td>以货币计算，最大的余额跌幅。在交易处理过程中，余额可能有大幅度下跌，这里采用最大的值</td> <td>double</td></tr> <tr><td>STAT_BALANCEDD_PERCENT</td> <td>以百分比计算余额下跌，记录于货币计算的最大余额跌幅的时期 (STAT_BALANCE_DD)。</td> <td>double</td></tr> <tr><td>STAT_BALANCE_DDREL_PERCENT</td> <td>以百分比计算最大余额跌幅。在交易处理过程中，余额可能有大幅度下跌，每次相关的下跌值都以百分比计算返回最大的值</td> <td>double</td></tr> <tr><td>STAT_BALANCE_DD_RELATIVE</td> <td>以货币计算余额下跌，记录于百分比计算的最大余额跌幅时期 (STAT_BALANCE_DDREL_PERCENT)</td> <td>double</td></tr> <tr><td>STAT_EQUITYMIN</td> <td>最小净值</td> <td>double</td></tr> <tr><td>STAT_EQUITY_DD</td> <td>以货币计算，最大的净值跌幅。在交易处理过程中，净值上可能出现大幅度下跌，这里采用最大的值</td> <td>double</td></tr> <tr><td>STAT_EQUITYDD_PERCENT</td> <td>以百分比计算下跌，记录于货币计算的最大净值跌幅的时期 (STAT_EQUITY_DD)。</td> <td>double</td></tr> <tr><td>STAT_EQUITY_DDREL_PERCENT</td> <td>以百分比计算最大净值跌幅。在交易处理过程中，净值可能有大幅度下跌，每次相关的下跌值都以百分比计算返回最大的值</td> <td>double</td></tr> <tr><td>STAT_EQUITY_DD_RELATIVE</td> <td>以货币计算净值下跌，记录于百分比计算的最大净值跌幅时期(STAT_EQUITY_DDREL_PERCENT)。</td> <td>double</td></tr> <tr><td>STAT_EXPECTED_PAYOFF</td> <td>期望收益</td> <td>double</td></tr> <tr><td>STAT_PROFIT_FACTOR</td> <td>利润因子，等于STAT_GROSS_PROFIT/STAT_GROSS_LOSS比率。如果STAT_GROSS_LOSS=0, 利润因子就等于 DBL_MAX</td> <td>double</td></tr> <tr><td>STAT_RECOVERY_FACTOR</td> <td>采收率，等于 STAT_PROFIT/STAT_BALANCE_DD的比率</td> <td>double</td></tr> <tr><td>STAT_SHARPE_RATIO</td> <td>夏普比率</td> <td>double</td></tr> <tr><td>STAT_MIN_MARGINLEVEL</td> <td>保证金水平的最小值</td> <td>double</td></tr> <tr><td>STAT_CUSTOM_ONTESTER</td> <td>由OnTester()函数返回的计算自定义优化标准的值。</td> <td>double</td></tr> <tr><td>STAT_DEALS</td> <td>成交数量</td> <td>int</td></tr> <tr><td>STAT_TRADES</td> <td>交易的数量</td> <td>int</td></tr> <tr><td>STAT_PROFIT_TRADES</td> <td>获利交易</td> <td>int</td></tr> <tr><td>STAT_LOSS_TRADES</td> <td>亏损交易</td> <td>int</td></tr> <tr><td>STAT_SHORT_TRADES</td> <td>做空交易</td> <td>int</td></tr> <tr><td>STAT_LONG_TRADES</td> <td>做多交易</td> <td>int</td></tr> <tr><td>STAT_PROFIT_SHORTTRADES</td> <td>获利的做空交易</td> <td>int</td></tr> <tr><td>STAT_PROFIT_LONGTRADES</td> <td>获利的做多交易</td> <td>int</td></tr> <tr><td>STAT_PROFITTRADES_AVGCON</td> <td>一组获利交易的平均长度</td> <td>int</td></tr> <tr><td>STAT_LOSSTRADES_AVGCON</td> <td>一组亏损交易的平均长度</td> <td>int</td></tr></tbody></table> <h2 id="_2-5-交易常量"><a href="#_2-5-交易常量" class="header-anchor">#</a> 2.5 交易常量</h2> <p>用于规划交易策略的各种常量分为以下几组:</p> <p>• 历史数据库属性 —— 接收一般信息；
• 订单属性 —— 获得交易订单信息；
• 仓位属性 —— 获得当前仓位价格信息；
• 交易属性 —— 获得交易信息；
• 交易操作类型 —— 交易可行性描述；
• 交易事务类型 —— 描述可能的交易事务类型；
• DOM(市场深度)交易订单 —— 按照要求操作的方向，在DOM（Depth of the market)中交易订单。</p> <h3 id="_2-5-1-历史数据库属性"><a href="#_2-5-1-历史数据库属性" class="header-anchor">#</a> 2.5.1 历史数据库属性</h3> <p>当访问时间序列时，函数SeriesInfoInteger() 用来获得额外 交易品种信息。作为函数参数传递所需属性的标识符是枚举型常量 ENUM_SERIES_INFO_INTEGER中的一个。</p> <p>ENUM_SERIES_INFO_INTEGER</p> <table><thead><tr><th>标识符</th> <th>描述</th> <th>类型</th></tr></thead> <tbody><tr><td>SERIES_BARS_COUNT</td> <td>交易品种 当前时间框架中K线柱的数量</td> <td>long</td></tr> <tr><td>SERIES_FIRSTDATE</td> <td>当前 交易品种 时间框架 中第一根K线的时间</td> <td>datetime</td></tr> <tr><td>SERIES_LASTBAR_DATE</td> <td>当前 交易品种 时间框架 中最后一根K线的开盘时间</td> <td>datetime</td></tr> <tr><td>SERIES_SERVER_FIRSTDATE</td> <td>服务器上该 交易品种 的历史数据中第一根K线的日期时间，无论 时间框架 。</td> <td>datetime</td></tr> <tr><td>SERIES_TERMINAL_FIRSTDATE</td> <td>客户端上该 交易品种 的历史数据中第一根K线的日期时间，无论 时间框架 。</td> <td>datetime</td></tr> <tr><td>SERIES_SYNCHRONIZED</td> <td>当前 交易品种 的时间框架图表 数据同步标帜</td> <td>bool</td></tr></tbody></table> <h3 id="_2-5-2-订单属性"><a href="#_2-5-2-订单属性" class="header-anchor">#</a> 2.5.2 订单属性</h3> <p>执行交易操作的请求被正式化为订单。每个订单都有各种各样的属性以供阅读。可以通过函数OrderGet.()和HistoryOrderGet…()获得关于它们的信息。</p> <p>用于函数OrderGetInteger()和HistoryOrderGetInteger()</p> <p>ENUM_ORDER_PROPERTY_INTEGER</p> <table><thead><tr><th>标识符</th> <th>描述</th> <th>类型</th></tr></thead> <tbody><tr><td>ORDER_TICKET</td> <td>订单编号。每个订单分配一个唯一的号码</td> <td>long</td></tr> <tr><td>ORDER_TIME_SETUP</td> <td>订单设置时间</td> <td>datetime</td></tr> <tr><td>ORDER_TYPE</td> <td>订单类型</td> <td>ENUM_ORDER_TYPE</td></tr> <tr><td>ORDER_STATE</td> <td>订单状态</td> <td>ENUM_ORDER_STATE</td></tr> <tr><td>ORDER_TIME_EXPIRATION</td> <td>订单过期时间</td> <td>datetime</td></tr> <tr><td>ORDER_TIME_DONE</td> <td>订单 执行 或 取消 的时间</td> <td>datetime</td></tr> <tr><td>ORDER_TIME_SETUP_MSC</td> <td>01.01.1970以来订单设置的时间，单位: ms</td> <td>long</td></tr> <tr><td>ORDER_TIME_DONE_MSC</td> <td>01.01.1970以来订单 执行 或 取消 的时间，单位: ms</td> <td>long</td></tr> <tr><td>ORDER_TYPE_FILLING</td> <td>订单填充(成交手数计算)类型</td> <td>ENUM_ORDER_TYPE_FILLING</td></tr> <tr><td>ORDER_TYPE_TIME</td> <td>订单存活周期</td> <td>ENUM_ORDER_TYPE_TIME</td></tr> <tr><td>ORDER_MAGIC</td> <td>EA交易安置在订单之中的ID（为确保每个EA交易的订单都有一个唯一的魔术识别码）</td> <td>long</td></tr> <tr><td>ORDER_REASON</td> <td>下单的原因 或 来源</td> <td>ENUM_ORDER_REASON</td></tr> <tr><td>ORDER_POSITION_ID</td> <td>仓位标识符，当它被执行时，它将被设置为一个订单。每一个执行的订单都会导致一笔 交易 打开 或 修改已经存在的仓位。此时，该位置的标识符将被设置为已执行的订单。</td> <td>long</td></tr> <tr><td>ORDER_POSITION_BY_ID</td> <td>反向持仓标识符，用于关闭订单ORDER_TYPE_CLOSE_BY</td> <td>long</td></tr></tbody></table> <p>函数 OrderGetDouble() 和 HistoryOrderGetDouble()</p> <p>ENUM_ORDER_PROPERTY_DOUBLE</p> <table><thead><tr><th>标识符</th> <th>描述</th> <th>类型</th></tr></thead> <tbody><tr><td>ORDER_VOLUME_INITIAL</td> <td>订单最初交易量</td> <td>double</td></tr> <tr><td>ORDER_VOLUME_CURRENT</td> <td>订单当前交易量</td> <td>double</td></tr> <tr><td>ORDER_PRICE_OPEN</td> <td>订单开仓价格</td> <td>double</td></tr> <tr><td>ORDER_SL</td> <td>止损位</td> <td>double</td></tr> <tr><td>ORDER_TP</td> <td>止盈位</td> <td>double</td></tr> <tr><td>ORDER_PRICE_CURRENT</td> <td>交易品种订单的当前价格</td> <td>double</td></tr> <tr><td>ORDER_PRICE_STOPLIMIT</td> <td>追损和限价订单的限制价格</td> <td>double</td></tr></tbody></table> <p>函数 OrderGetString() 和 HistoryOrderGetString()</p> <p>ENUM_ORDER_PROPERTY_STRING</p> <table><thead><tr><th>标识符</th> <th>描述</th> <th>类型</th></tr></thead> <tbody><tr><td>ORDER_SYMBOL</td> <td>订单的交易品种</td> <td>string</td></tr> <tr><td>ORDER_COMMENT</td> <td>订单的注释</td> <td>string</td></tr></tbody></table> <p>当使用OrderSend()函数发送交易请求时，一些操作需要指示订单类型。订单类型在特殊结构MqlTradeRequest的 类型(type) 字段中指定，并且可以接受ENUM_ORDER_TYPE枚举的值。</p> <table><thead><tr><th>标识符</th> <th>描述</th></tr></thead> <tbody><tr><td>ORDER_TYPE_BUY</td> <td>做多订单</td></tr> <tr><td>ORDER_TYPE_SELL</td> <td>做空订单</td></tr> <tr><td>ORDER_TYPE_BUY_LIMIT</td> <td>限价挂多单</td></tr> <tr><td>ORDER_TYPE_SELL_LIMIT</td> <td>限价挂空单</td></tr> <tr><td>ORDER_TYPE_BUY_STOP</td> <td>到达指定价格之上，挂限价多单</td></tr> <tr><td>ORDER_TYPE_SELL_STOP_LIMIT</td> <td>到达指定价格之上，挂限价空单</td></tr> <tr><td>ORDER_TYPE_CLOSE_BY</td> <td>通过反向持仓单平仓的订单</td></tr></tbody></table> <p>每个订单都有描述其状态的标识符。要获取订单的状态信息，请使用ORDER_STATE修饰符来使用 OrderGetInteger() 或 HistoryOrderGetInteger()。 可使用的取值范围存储在ENUM_ORDER_STATE枚举中。</p> <table><thead><tr><th>标识符</th> <th>描述</th></tr></thead> <tbody><tr><td>ORDER_STATE_STARTED</td> <td>订单已被选中，但经纪平台未接收</td></tr> <tr><td>ORDER_STATE_PLACED</td> <td>订单已被接受</td></tr> <tr><td>ORDER_STATE_CANCELED</td> <td>客户撤销订单</td></tr> <tr><td>ORDER_STATE_PARTIAL</td> <td>订单部分成交</td></tr> <tr><td>ORDER_STATE_FILLED</td> <td>订单全部成交</td></tr> <tr><td>ORDER_STATE_REJECTED</td> <td>驳回订单</td></tr> <tr><td>ORDER_STATE_EXPIRED</td> <td>订单过期</td></tr> <tr><td>ORDER_STATE_REQUEST_ADD</td> <td>注册订单（已放置到交易系统）</td></tr> <tr><td>ORDER_STATE_REQUEST_MODIFY</td> <td>更改订单（改变其参数）</td></tr> <tr><td>ORDER_STATE_REQUEST_CANCEL</td> <td>删除订单（从交易系统中删除）</td></tr></tbody></table> <table><thead><tr><th>标识符</th> <th>描述</th></tr></thead> <tbody><tr><td>ORDER_FILLING_FOK</td> <td>FOK(Fill or Kill)类型成交策略意味着订单只能按指定的交易量(手数)执行。如果当前市场无法提供 金融工具 需要的交易量(手数)，则订单将无法成交。需要的交易量可以使用市场此刻提供的几种可用来源来执行。</td></tr> <tr><td>ORDER_FILLING_IOC</td> <td>IOC(Immediate or Cancel)该类型意味着交易者同意在订单指定范围内，以市场可用的最大交易量执行交易。如果无法执行全部订单交易量，那么剩下的交易量将被取消。</td></tr> <tr><td>ORDER_FILLING_RETURN</td> <td>该类型只用于市场订单 (ORDER_TYPE_BUY 和 ORDER_TYPE_SELL)，限价和追损限价订单 (ORDER_TYPE_BUY_LIMIT，ORDER_TYPE_SELL_LIMIT，ORDER_TYPE_BUY_STOP_LIMIT 和 ORDER_TYPE_SELL_STOP_LIMIT ) 并且只用于 市场执行 或 外汇交易 执行的交易品种。如果部分执行市场或剩下交易量的限价订单没有取消，则仍会进一步处理。 为了激活ORDER_TYPE_BUY_STOP_LIMIT 和 ORDER_TYPE_SELL_STOP_LIMIT 订单，将会创建ORDER_FILLING_RETURN执行类型相应的限价订单 ORDER_TYPE_BUY_LIMIT/ORDER_TYPE_SELL_LIMIT 。</td></tr></tbody></table> <p>当使用OrderSend() 函数发送交易请求时，订单有效期设置在特殊结构MqlTradeRequest 中的type_time字段，允许使用枚举ENUM_ORDER_TYPE_TIME的值之一，使用ORDER_TYPE_TIME修饰符和OrderGetInteger() 或 HistoryOrderGetInteger() 函数可以获得该属性的值。</p> <table><thead><tr><th>标识符</th> <th>描述</th></tr></thead> <tbody><tr><td>ORDER_TIME_GTC</td> <td>(Good Till Cancel)一直持有只到取消订单</td></tr> <tr><td>ORDER_TIME_DAY</td> <td>当前交易日结束时取消订单</td></tr> <tr><td>ORDER_TIME_SPECIFIED</td> <td>到指定的过期时间即取消订单</td></tr> <tr><td>ORDER_TIME_SPECIFIED_DAY</td> <td>订单将生效直至指定日期的23:59:59。如果该时间超出了交易期，那么该订单会在最近的交易时间内到期。 该订单的有效期为指定日期的23:59:59。如果这个时间是在交易时段之外(休市时间)，该订单将在最近的交易日结束时到期。</td></tr></tbody></table> <p>订单放置的原因包含在ORDER_REASON属性中。一个订单可能来自一个MQL5程序，或一个移动应用程序，或 作为强制平仓的结果，等等。ORDER_REASON的可能值在ENUM_ORDER_REASON枚举中描述。</p> <table><thead><tr><th>标识符</th> <th>描述</th></tr></thead> <tbody><tr><td>ORDER_REASON_CLIENT</td> <td>从PC桌面客户端下单</td></tr> <tr><td>ORDER_REASON_MOBILE</td> <td>从移动端(iPhone 或 安卓)下单</td></tr> <tr><td>ORDER_REASON_WEB</td> <td>从网页端下单</td></tr> <tr><td>ORDER_REASON_EXPERT</td> <td>从MQL5程序下单，例如EA 或 脚本</td></tr> <tr><td>ORDER_REASON_SL</td> <td>因激活止损而下单</td></tr> <tr><td>ORDER_REASON_TP</td> <td>因激活止赢而下单</td></tr> <tr><td>ORDER_REASON_SO</td> <td>因强制平仓事件而下单</td></tr></tbody></table> <h3 id="_2-5-3-仓位属性"><a href="#_2-5-3-仓位属性" class="header-anchor">#</a> 2.5.3 仓位属性</h3> <p>执行交易操作，如 交易手数的变化 和/或 改变下单方向(做多 或 做空)的结果，会导致一个 仓位 的 出现 或 消失。交易操作以 订单为基础管理，由OrderSend()函数以交易请求的形式发送。对于每个 金融工具(交易品种)，一个时刻只有一个持有的 仓位。仓位具有一组属性，可以通过PositionGet…()函数来获取。</p> <p>函数 PositionGetInteger()</p> <p>ENUM_POSITION_PROPERTY_INTEGER</p> <table><thead><tr><th>标识符</th> <th>描述</th> <th>类型</th></tr></thead> <tbody><tr><td>POSITION_TICKET</td> <td>仓位的编号。分配给每个新打开的仓位的唯一编号。它通常与打开该位置的订单的编号相匹配，除非由于服务器上的服务操作而更改了编号，例如，当计算隔夜利息而重新打开订单时。要查找用于打开订单价位的命令，请应用POSITION_IDENTIFIER属性。 POSITION_TICKET值对应于MqlTradeRequest::position</td> <td>long</td></tr> <tr><td>POSITION_TIME</td> <td>仓位打开时间</td> <td>datetime</td></tr> <tr><td>POSITION_TIME_MSC</td> <td>自01.01.1970以来持仓的时间，单位:ms</td> <td>long</td></tr> <tr><td>POSITION_TIME_UPDATE</td> <td>自01.01.1970以来最近更新持仓后的时间，单位:秒</td> <td>long</td></tr> <tr><td>POSITION_TIME_UPDATE_MSC</td> <td>自01.01.1970以来最近更新持仓后的时间，单位:ms</td> <td>long</td></tr> <tr><td>POSITION_TYPE</td> <td>仓位类型</td> <td>ENUM_POSITION_TYPE</td></tr> <tr><td>POSITION_MAGIC</td> <td>仓位保证一识别魔术号码（参考 ORDER_MAGIC ）</td> <td>long</td></tr> <tr><td>POSITION_IDENTIFIER</td> <td>仓位标识符 是分配给每个重新打开的仓位的唯一数字编号。在仓位的整个生命周期中它不会发生变化，它对应于一个用来打开一个价位的订单的编号。 仓位标识符在每个订单 (ORDER_POSITION_ID)和交易 (DEAL_POSITION_ID)中指定，用于打开、修改或关闭它。使用此属性搜索与该仓位相关的订单和交易。 当在 净值模式 (netting mode)中反转一个仓位时(使用单向交易 买入/售出 )， POSITION_IDENTIFIER不会改变。然而，POSITION_TICKET被替换为导致反转的订单的编号。在对冲(锁仓)模式下不支持仓位反转。</td> <td>long</td></tr> <tr><td>POSITION_REASON</td> <td>持仓的原因</td> <td>ENUM_POSITION_REASON</td></tr></tbody></table> <p>函数 PositionGetDouble()</p> <p>ENUM_POSITION_PROPERTY_DOUBLE</p> <table><thead><tr><th>标识符</th> <th>描述</th> <th>类型</th></tr></thead> <tbody><tr><td>POSITION_VOLUME</td> <td>仓位成交量</td> <td>double</td></tr> <tr><td>POSITION_PRICE_OPEN</td> <td>仓位价格</td> <td>double</td></tr> <tr><td>POSITION_SL</td> <td>仓位止损价位</td> <td>double</td></tr> <tr><td>POSITION_TP</td> <td>仓位止盈价位</td> <td>double</td></tr> <tr><td>POSITION_PRICE_CURRENT</td> <td>仓位当前价位</td> <td>double</td></tr> <tr><td>POSITION_SWAP</td> <td>隔夜利息</td> <td>double</td></tr> <tr><td>POSITION_PROFIT</td> <td>当前利润</td> <td>double</td></tr></tbody></table> <p>函数 PositionGetString()</p> <p>ENUM_POSITION_PROPERTY_STRING</p> <table><thead><tr><th>标识符</th> <th>描述</th> <th>类型</th></tr></thead> <tbody><tr><td>POSITION_SYMBOL</td> <td>仓位的交易品种</td> <td>string</td></tr> <tr><td>POSITION_COMMENT</td> <td>仓位注释文本</td> <td>string</td></tr></tbody></table> <table><thead><tr><th>标识符</th> <th>描述</th></tr></thead> <tbody><tr><td>POSITION_TYPE_BUY</td> <td>做多(买入)</td></tr> <tr><td>POSITION_TYPE_SELL</td> <td>做空(售出)</td></tr></tbody></table> <p>打开一个仓位的原因包含在POSITION_REASON属性中。一个打开的仓位可能来自，桌面客户端、移动应用程序、专家顾问EA等的订单被激活。POSITION_REASON的取值范围在ENUM_POSITION_REASON枚举值中描述。</p> <table><thead><tr><th>标识符</th> <th>描述</th></tr></thead> <tbody><tr><td>POSITION_REASON_CLIENT</td> <td>来自桌面客户端的订单被激活</td></tr> <tr><td>POSITION_REASON_MOBILE</td> <td>来自移动端的订单被激活</td></tr> <tr><td>POSITION_REASON_WEB</td> <td>来自网页端的订单被激活</td></tr> <tr><td>POSITION_REASON_EXPERT</td> <td>来自MQL程序的订单被激活</td></tr></tbody></table> <h3 id="_2-5-4-交易属性"><a href="#_2-5-4-交易属性" class="header-anchor">#</a> 2.5.4 交易属性</h3> <p>一笔交易的执行是基于一个订单的交易请求，反映实际执行的结果。每个交易(请求)都具有一组属性来描述，可以获取其属性信息。为了读取属性的值，可以使用HistoryDealGet…()类型的函数，从对应的枚举值中返回结果值。</p> <p>函数 HistoryDealGetInteger()</p> <p>ENUM_DEAL_PROPERTY_INTEGER</p> <table><thead><tr><th>标识符</th> <th>描述</th> <th>类型</th></tr></thead> <tbody><tr><td>DEAL_TICKET</td> <td>交易的编号。分配给每笔交易的唯一号码</td> <td>long</td></tr> <tr><td>DEAL_ORDER</td> <td>交易订单号</td> <td>long</td></tr> <tr><td>DEAL_TIME_MSC</td> <td>交易时间</td> <td>datetime</td></tr> <tr><td>DEAL_TIME_MSC</td> <td>自01.01.1970以来交易执行的时间，单位:ms</td> <td>long</td></tr> <tr><td>DEAL_TYPE</td> <td>交易类型</td> <td>ENUM_DEAL_TYPE</td></tr> <tr><td>DEAL_ENTRY</td> <td>交易记录条目 ---- 记录进入，记录输进，反向记录。</td> <td>ENUM_DEAL_ENTRY</td></tr> <tr><td>DEAL_MAGIC</td> <td>订单唯一识别魔术号（参见 ORDER_MAGIC ）</td> <td>long</td></tr> <tr><td>DEAL_REASON</td> <td>交易执行的原因或来源</td> <td>ENUM_DEAL_REASON</td></tr> <tr><td>DEAL_POSITION_ID</td> <td>一笔正在执行的交易，在开始、修改或结束时，分配的仓位的标识符。每个仓位都有一个唯一的标识符，该标识符被分配给在该交易品种的所有的仓位的整个生命周期中。</td> <td>long</td></tr></tbody></table> <p>函数 HistoryDealGetDouble()</p> <p>ENUM_DEAL_PROPERTY_DOUBLE</p> <table><thead><tr><th>标识符</th> <th>描述</th> <th>类型</th></tr></thead> <tbody><tr><td>DEAL_VOLUME</td> <td>成交量</td> <td>double</td></tr> <tr><td>DEAL_PRICE</td> <td>成交价格</td> <td>double</td></tr> <tr><td>DEAL_COMMISSION</td> <td>订单佣金(手续费)</td> <td>double</td></tr> <tr><td>DEAL_SWAP</td> <td>平仓时的隔夜利息</td> <td>double</td></tr> <tr><td>DEAL_PROFIT</td> <td>交易利润</td> <td>double</td></tr></tbody></table> <p>函数 HistoryDealGetString()</p> <p>ENUM_DEAL_PROPERTY_STRING</p> <table><thead><tr><th>标识符</th> <th>描述</th> <th>类型</th></tr></thead> <tbody><tr><td>DEAL_SYMBOL</td> <td>交易品种</td> <td>string</td></tr> <tr><td>DEAL_COMMENT</td> <td>交易注释</td> <td>string</td></tr> <tr><td>DEAL_EXTERNAL_ID</td> <td>在 外部 交易系统中的交易标识符(在外汇交易中)</td> <td>string</td></tr></tbody></table> <p>每笔交易的特征是一个类型，其取值范围ENUM_DEAL_TYPE中枚举。为了获得关于交易类型的信息，可以使用DEAL_TYPE修饰符来使用HistoryDealGetInteger()函数。</p> <table><thead><tr><th>标识符</th> <th>描述</th></tr></thead> <tbody><tr><td>DEAL_TYPE_BUY</td> <td>做多</td></tr> <tr><td>DEAL_TYPE_SELL</td> <td>做空</td></tr> <tr><td>DEAL_TYPE_BALANCE</td> <td>余额</td></tr> <tr><td>DEAL_TYPE_CREDIT</td> <td>信用额</td></tr> <tr><td>DEAL_TYPE_CHARGE</td> <td>额外的费用</td></tr> <tr><td>DEAL_TYPE_CORRECTION</td> <td>修正</td></tr> <tr><td>DEAL_TYPE_BONUS</td> <td>奖金</td></tr> <tr><td>DEAL_TYPE_COMMISSION</td> <td>额外手续费</td></tr> <tr><td>DEAL_TYPE_COMMISSION_DAILY</td> <td>日手续费</td></tr> <tr><td>DEAL_TYPE_COMMISSION_MONTHLY</td> <td>月手续费</td></tr> <tr><td>DEAL_TYPE_COMMISSION_AGENT_DAILY</td> <td>日代理手续费</td></tr> <tr><td>DEAL_TYPE_COMMISSION_AGENT_MONTHLY</td> <td>月代理手续费</td></tr> <tr><td>DEAL_TYPE_INTEREST</td> <td>利率</td></tr> <tr><td>DEAL_TYPE_BUY_CANCELED</td> <td>取消的 做多 交易。可能会有之前执行的 做多 交易被取消的情况。这样的话，之前执行的交易类型 (DEAL_TYPE_BUY) 会被改为 DEAL_TYPE_BUY_CANCELED，并且其 利润/亏损 归零。执行获得的 利润/亏损 会使用单独的结余操作被 收取/取出。</td></tr> <tr><td>DEAL_TYPE_SELL_CANCELED</td> <td>取消的 做空 交易。可能会有之前执行的 做空 交易被取消的情况。这样的话，之前执行的交易类型 (DEAL_TYPE_SELL)会被改为 DEAL_TYPE_SELL_CANCELED，并且其利润/亏损归零。执行获得的 利润/亏损 会使用单独的结余操作被 收取/取出。</td></tr> <tr><td>DEAL_DIVIDEND</td> <td>股息操作</td></tr> <tr><td>DEAL_DIVIDEND_FRANKED</td> <td>税务减免（免税）股息操作</td></tr> <tr><td>DEAL_TAX</td> <td>税费</td></tr></tbody></table> <p>交易的差别不仅在于它们在ENUM_DEAL_TYPE中设置的类型，还包括它们改变价位的方式。这可以是一个简单的开仓价位，或一个先前打开的订单(头寸)(市场进入)的积加量，与相反的交易订单(头寸)相应的成交量(市场退出)的相差量，或 仓位(头寸)反转，如果相反方向的交易订单(头寸)的成交量(手数)覆盖了先前打开的订单(头寸)的成交量。</p> <p>所有这些情况都是由ENUM_DEAL_ENTRY枚举中的值来描述的。为了获得有关交易的信息，可以使用DEAL_ENTRY修饰符，来使用HistoryDealGetInteger()函数。</p> <table><thead><tr><th>标识符</th> <th>描述</th></tr></thead> <tbody><tr><td>DEAL_ENTRY_IN</td> <td>交易记录进入</td></tr> <tr><td>DEAL_ENTRY_OUT</td> <td>交易记录出场</td></tr> <tr><td>DEAL_ENTRY_INOUT</td> <td>交易记录累积</td></tr> <tr><td>DEAL_ENTRY_OUT_BY</td> <td>交易通过反向持仓来出场</td></tr></tbody></table> <p>交易执行的原因包含在DEAL_REASON属性中。一笔交易的执行，可能是来自触发了 移动应用程序或 MQL5程序中 的订单，以及在强制平仓事件、变更保证金计算等方面的结果。对于由于余额、信用、佣金和其他操作而导致的非订单交易的交易，DEAL_REASON_CLIENT被指定为原因。</p> <p>ENUM_DEAL_REASON</p> <table><thead><tr><th>标识符</th> <th>描述</th></tr></thead> <tbody><tr><td>DEAL_REASON_CLIENT</td> <td>因来自桌面客户端的订单被激活执行交易</td></tr> <tr><td>DEAL_REASON_MOBILE</td> <td>因来自移动程序端的订单被激活执行交易</td></tr> <tr><td>DEAL_REASON_WEB</td> <td>因来自网页平台的订单被激活执行交易</td></tr> <tr><td>DEAL_REASON_EXPERT</td> <td>因激活从MQL5程序下单的订单来执行交易，例如EA交易或脚本</td></tr> <tr><td>DEAL_REASON_SL</td> <td>因激活止损来执行交易</td></tr> <tr><td>DEAL_REASON_TP</td> <td>因激活止赢来执行交易</td></tr> <tr><td>DEAL_REASON_SO</td> <td>因强制止损平仓事件来执行交易</td></tr> <tr><td>DEAL_REASON_ROLLOVER</td> <td>因三日翻转来执行交易</td></tr> <tr><td>DEAL_REASON_VMARGIN</td> <td>因收取变动预付款后执行交易</td></tr> <tr><td>DEAL_REASON_SPLIT</td> <td>宣布分割期间拥有持仓的品种进行分割（价格降低）后执行交易</td></tr></tbody></table> <h3 id="_2-5-5-交易操作类型"><a href="#_2-5-5-交易操作类型" class="header-anchor">#</a> 2.5.5 交易操作类型</h3> <p>通过使用OrderSend()函数可以进行交易，发送一个价位，可以打开一个订单，同样的，也可以用来放置、修改 或 删除一个挂单。每个订单都提交一个的交易操作类型。在枚举常量ENUM_TRADE_REQUEST_ACTIONS中描述了交易操作类型。</p> <p>ENUM_TRADE_REQUEST_ACTIONS</p> <table><thead><tr><th>标识符</th> <th>描述</th></tr></thead> <tbody><tr><td>TRADE_ACTION_DEAL</td> <td>以指定的参数立即执行交易订单(市场订单)</td></tr> <tr><td>TRADE_ACTION_PENDING</td> <td>在指定的条件下(挂单)执行交易订单</td></tr> <tr><td>TRADE_ACTION_SLTP</td> <td>修改已持有订单的止损和止盈</td></tr> <tr><td>TRADE_ACTION_MODIFY</td> <td>修改先前放置的订单的参数</td></tr> <tr><td>TRADE_ACTION_REMOVE</td> <td>删除先前放置的挂单</td></tr> <tr><td>TRADE_ACTION_CLOSE_BY</td> <td>通过反向持仓来平仓</td></tr></tbody></table> <p>打开 做多(Buy) 订单TRADE_ACTION_DEAL 交易操作的示例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#define EXPERT_MAGIC 123456   // EA交易的唯一识别魔术号
//+------------------------------------------------------------------+
//| 打开 做多(Buy) 持仓订单                                             |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 声明并初始化交易请求和交易请求结果
   MqlTradeRequest request={0};
   MqlTradeResult  result={0};
//--- 请求的参数
   request.action   =TRADE_ACTION_DEAL;                     // 交易操作类型
   request.symbol   =Symbol();                              // 交易品种
   request.volume   =0.1;                                   // 交易量0.1手
   request.type     =ORDER_TYPE_BUY;                        // 订单类型
   request.price    =SymbolInfoDouble(Symbol(),SYMBOL_ASK); // 持仓价格
   request.deviation=5;                                     // 允许价格偏差(滑点)
   request.magic    =EXPERT_MAGIC;                          // 订单唯一识别魔术号
//--- 发送请求
   if(!OrderSend(request,result))
      PrintFormat(&quot;OrderSend error %d&quot;,GetLastError());     // 如果发送订单请求出错，输出错误代码
//--- 输出操作信息,可在 EA 日志中看到这条信息
   PrintFormat(&quot;retcode=%u  deal=%I64u  order=%I64u&quot;,result.retcode,result.deal,result.order);
  }
//+------------------------------------------------------------------+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>打开 做空(Sell) 订单TRADE_ACTION_DEAL 交易操作的示例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#define EXPERT_MAGIC 123456   // EA交易的唯一识别魔术号
//+------------------------------------------------------------------+
//| 打开 做空(Sell) 持仓                                               |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 声明并初始化交易请求和交易请求结果
   MqlTradeRequest request={0};
   MqlTradeResult  result={0};
//--- 请求参数
   request.action   =TRADE_ACTION_DEAL;                     // 交易操作类型
   request.symbol   =Symbol();                              // 交易品种
   request.volume   =0.2;                                   // 交易量0.2 手
   request.type     =ORDER_TYPE_SELL;                       // 订单类型
   request.price    =SymbolInfoDouble(Symbol(),SYMBOL_BID); // 持仓价格
   request.deviation=5;                                     // 允许价格偏差(滑点)
   request.magic    =EXPERT_MAGIC;                          // 订单唯一识别魔术号
//--- 发送请求
   if(!OrderSend(request,result))
      PrintFormat(&quot;OrderSend error %d&quot;,GetLastError());     // 如果发送订单请求出错，输出错误代码
//--- 输出操作信息,可在 EA 日志中看到这条信息
   PrintFormat(&quot;retcode=%u  deal=%I64u  order=%I64u&quot;,result.retcode,result.deal,result.order);
  }
//+------------------------------------------------------------------+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>平仓TRADE_ACTION_DEAL 交易操作的示例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#define EXPERT_MAGIC 123456   // EA交易的唯一识别魔术号
//+------------------------------------------------------------------+
//| 关闭全部持仓                                                       |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 声明并初始化交易请求和交易请求结果
   MqlTradeRequest request;
   MqlTradeResult  result;
   int total=PositionsTotal(); // 持仓数
//--- 循环遍历所有持仓
   for(int i=total-1; i&gt;=0; i--)
     {
      //--- 订单的参数
      ulong  position_ticket=PositionGetTicket(i);    // 持仓价格
      string position_symbol=PositionGetString(POSITION_SYMBOL);  // 交易品种
      int    digits=(int)SymbolInfoInteger(position_symbol,SYMBOL_DIGITS);  // 小数位数
      ulong  magic=PositionGetInteger(POSITION_MAGIC);   // 持仓的唯一识别魔术号
      double volume=PositionGetDouble(POSITION_VOLUME);  // 持仓交易量
      ENUM_POSITION_TYPE type=(ENUM_POSITION_TYPE)PositionGetInteger(POSITION_TYPE); // 持仓类型
      //--- 输出持仓信息
      PrintFormat(&quot;#%I64u %s  %s  %.2f  %s [%I64d]&quot;,
                  position_ticket,
                  position_symbol,
                  EnumToString(type),
                  volume,
                  DoubleToString(PositionGetDouble(POSITION_PRICE_OPEN),digits),
                  magic);
      //--- 如果唯一识别魔术号匹配
      if(magic==EXPERT_MAGIC)
        {
         //--- 归零请求和结果值
         ZeroMemory(request);
         ZeroMemory(result);
         //--- 设置操作参数
         request.action   =TRADE_ACTION_DEAL;        // 交易操作类型
         request.position =position_ticket;          // 持仓价格
         request.symbol   =position_symbol;          // 交易品种
         request.volume   =volume;                   // 持仓交易量
         request.deviation=5;                        // 允许价格偏差
         request.magic    =EXPERT_MAGIC;             // 持仓幻数
         //--- 根据持仓类型设置价格和订单类型
         if(type==POSITION_TYPE_BUY)
           {
            request.price=SymbolInfoDouble(position_symbol,SYMBOL_BID);
            request.type =ORDER_TYPE_SELL;
           }
         else
           {
            request.price=SymbolInfoDouble(position_symbol,SYMBOL_ASK);
            request.type =ORDER_TYPE_BUY;
           }
         //--- 输出平仓关闭信息
         PrintFormat(&quot;Close #%I64d %s %s&quot;,position_ticket,position_symbol,EnumToString(type));
         //--- 发送请求
         if(!OrderSend(request,result))
            PrintFormat(&quot;OrderSend error %d&quot;,GetLastError());  // 如果不能发送请求，输出错误代码
         //--- 操作信息
         PrintFormat(&quot;retcode=%u  deal=%I64u  order=%I64u&quot;,result.retcode,result.deal,result.order);
         //---
        }
     }
  }
//+------------------------------------------------------------------+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br></div></div><p>挂单 TRADE_ACTION_PENDING 交易操作的示例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#property description &quot;Example of placing pending orders&quot;
#property script_show_inputs
#define EXPERT_MAGIC 123456                             // EA交易的唯一识别魔术号
input ENUM_ORDER_TYPE orderType=ORDER_TYPE_BUY_LIMIT;   // 订单类型
//+------------------------------------------------------------------+
//| 下挂单                                                            |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 声明并初始化交易请求和交易请求结果
   MqlTradeRequest request={0};
   MqlTradeResult  result={0};
//--- 下挂单的参数
   request.action   =TRADE_ACTION_PENDING;                             // 交易操作类型
   request.symbol   =Symbol();                                         // 交易品种
   request.volume   =0.1;                                              //0.1手交易量
   request.deviation=2;                                                // 允许价格偏差
   request.magic    =EXPERT_MAGIC;                                     // 订单幻数
   int offset = 50;                                                    // 以点数从当前价抵消下单
   double price;                                                       // 订单触动价
   double point=SymbolInfoDouble(_Symbol,SYMBOL_POINT);                // value of point
   int digits=SymbolInfoInteger(_Symbol,SYMBOL_DIGITS);                // 小数位数 (精确度)
   //--- 检查操作类型
   if(orderType==ORDER_TYPE_BUY_LIMIT)
     {
      request.type     =ORDER_TYPE_BUY_LIMIT;                          // 订单类型
      price=SymbolInfoDouble(Symbol(),SYMBOL_ASK)-offset*point;        // 持仓价格
      request.price    =NormalizeDouble(price,digits);                 //正常开盘价
     }
   else if(orderType==ORDER_TYPE_SELL_LIMIT)
     {
      request.type     =ORDER_TYPE_SELL_LIMIT;                          // 挂单的类型
      price=SymbolInfoDouble(Symbol(),SYMBOL_ASK)+offset*point;         // 持仓价
      request.price    =NormalizeDouble(price,digits);                  // 正常开盘价
     }
   else if(orderType==ORDER_TYPE_BUY_STOP)
     {
      request.type =ORDER_TYPE_BUY_STOP;                                // 订单类型
      price        =SymbolInfoDouble(Symbol(),SYMBOL_ASK)+offset*point; // 开盘价
      request.price=NormalizeDouble(price,digits);                      // 正常开盘价
     }
   else if(orderType==ORDER_TYPE_SELL_STOP)
     {
      request.type     =ORDER_TYPE_SELL_STOP;                           // 订单类型
      price=SymbolInfoDouble(Symbol(),SYMBOL_ASK)-offset*point;         // 开盘价
      request.price    =NormalizeDouble(price,digits);                  // 正常开盘价
     }
   else Alert(&quot;本例仅用于挂单&quot;); // 如果没有挂单被选择
//--- 发送请求
   if(!OrderSend(request,result))
      PrintFormat(&quot;OrderSend error %d&quot;,GetLastError());   // 如果不能发送请求，输出错误代码
//--- 操作信息
   PrintFormat(&quot;retcode=%u  deal=%I64u  order=%I64u&quot;,result.retcode,result.deal,result.order);
  }
//+------------------------------------------------------------------+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br></div></div><p>修改持仓止损和止赢值的 TRADE_ACTION_SLTP 交易操作的示例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#define EXPERT_MAGIC 123456  // EA交易的唯一识别魔术号
//+------------------------------------------------------------------+
//| 修改持仓的止损和止赢                                                |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 声明并初始化交易请求和交易请求结果
   MqlTradeRequest request;
   MqlTradeResult  result;
   int total=PositionsTotal(); // 持仓数
//--- 循环遍历所有持仓
   for(int i=0; i&lt;total ; i++)
     {
      //--- 订单的参数
      ulong  position_ticket=PositionGetTicket(i);// 持仓价格
      string position_symbol=PositionGetString(POSITION_SYMBOL); // 交易品种
      int    digits=(int)SymbolInfoInteger(position_symbol,SYMBOL_DIGITS); // 小数位数
      ulong  magic=PositionGetInteger(POSITION_MAGIC); // 持仓的幻数
      double volume=PositionGetDouble(POSITION_VOLUME);    // 持仓交易量
      double sl=PositionGetDouble(POSITION_SL);  // 持仓止损
      double tp=PositionGetDouble(POSITION_TP);  // 持仓止赢
      ENUM_POSITION_TYPE type=(ENUM_POSITION_TYPE)PositionGetInteger(POSITION_TYPE);
// 挂仓订单的类型
      //--- 输出持仓信息
      PrintFormat(&quot;#%I64u %s  %s  %.2f  %s  sl: %s  tp: %s  [%I64d]&quot;,
                  position_ticket,
                  position_symbol,
                  EnumToString(type),
                  volume,
                  DoubleToString(PositionGetDouble(POSITION_PRICE_OPEN),digits),
                  DoubleToString(sl,digits),
                  DoubleToString(tp,digits),
                  magic);
      //--- 如果唯一识别魔术号匹配，则不修改止损和止赢
      if(magic==EXPERT_MAGIC &amp;&amp; sl==0 &amp;&amp; tp==0)
        {
         //--- 计算当前价格水平
         double price=PositionGetDouble(POSITION_PRICE_OPEN);
         double bid=SymbolInfoDouble(position_symbol,SYMBOL_BID);
         double ask=SymbolInfoDouble(position_symbol,SYMBOL_ASK);
         int    stop_level=(int)SymbolInfoInteger(position_symbol,SYMBOL_TRADE_STOPS_LEVEL);
         double price_level;
         //--- 如果最小值被接受，那么当前平仓价的点数偏距不设置
         if(stop_level&lt;=0)
            stop_level=150; // 设置当前平仓价的150点偏距
         else
            stop_level+=50; // 为了可靠性而设置偏距到(SYMBOL_TRADE_STOPS_LEVEL + 50) 点

         //--- 计算并凑整止损和止赢值
         price_level=stop_level*SymbolInfoDouble(position_symbol,SYMBOL_POINT);
         if(type==POSITION_TYPE_BUY)
           {
            sl=NormalizeDouble(bid-price_level,digits);
            tp=NormalizeDouble(ask+price_level,digits);
           }
         else
           {
            sl=NormalizeDouble(ask+price_level,digits);
            tp=NormalizeDouble(bid-price_level,digits);
           }
         //--- 归零请求和结果值
         ZeroMemory(request);
         ZeroMemory(result);
         //--- 设置操作参数
         request.action  =TRADE_ACTION_SLTP; // 交易操作类型
         request.position=position_ticket;   // 持仓价格
         request.symbol=position_symbol;     // 交易品种
         request.sl      =sl;                // 持仓止损
         request.tp      =tp;                // 持仓止赢
         request.magic=EXPERT_MAGIC;         // 持仓的唯一识别魔术号
         //--- 输出更改信息
         PrintFormat(&quot;Modify #%I64d %s %s&quot;,position_ticket,position_symbol,EnumToString(type));
         //--- 发送请求
         if(!OrderSend(request,result))
            PrintFormat(&quot;OrderSend error %d&quot;,GetLastError());  // 如果不能发送请求，输出错误代码
         //--- 操作信息
         PrintFormat(&quot;retcode=%u  deal=%I64u  order=%I64u&quot;,result.retcode,result.deal,result.order);
        }
     }
  }
//+------------------------------------------------------------------+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br></div></div><p>删除挂单的TRADE_ACTION_REMOVE 交易操作的示例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#define EXPERT_MAGIC 123456  // EA交易的唯一识别魔术号
//+------------------------------------------------------------------+
//| 删除挂单                                                          |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 声明并初始化交易请求和交易请求结果
   MqlTradeRequest request={0};
   MqlTradeResult  result={0};
   int total=OrdersTotal(); // 下挂单的总数
//--- 循环遍历所有的挂单
   for(int i=total-1; i&gt;=0; i--)
     {
      ulong  order_ticket=OrderGetTicket(i);                   // 订单的编号
      ulong  magic=OrderGetInteger(ORDER_MAGIC);               // 订单的唯一识别魔术号
      //--- 如果唯一识别魔术号匹配
      if(magic==EXPERT_MAGIC)
        {
         //--- 归零请求和结果值
         ZeroMemory(request);
         ZeroMemory(result);
         //--- 设置持仓参数
         request.action=TRADE_ACTION_REMOVE;                   // 交易操作的类型
         request.order = order_ticket;                         // 订单价格
         //--- 发送请求
         if(!OrderSend(request,result))
            PrintFormat(&quot;OrderSend error %d&quot;,GetLastError());  // 如果不能发送请求，输出错误代码
         //--- 操作信息
         PrintFormat(&quot;retcode=%u  deal=%I64u  order=%I64u&quot;,result.retcode,result.deal,result.order);
        }
     }
  }
//+------------------------------------------------------------------+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p>关闭反向持仓的TRADE_ACTION_CLOSE_BY 交易操作的示例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#define EXPERT_MAGIC 123456  // EA交易的唯一识别魔术号
//+------------------------------------------------------------------+
//| 关闭所有反向持仓                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 声明并初始化交易请求和交易请求结果
   MqlTradeRequest request;
   MqlTradeResult  result;
   int total=PositionsTotal(); // 持仓数
//--- 循环遍历所有持仓
   for(int i=total-1; i&gt;=0; i--)
     {
      //--- 订单的参数
      ulong  position_ticket=PositionGetTicket(i);   // 持仓价格
      string position_symbol=PositionGetString(POSITION_SYMBOL);  // 交易品种
      int    digits=(int)SymbolInfoInteger(position_symbol,SYMBOL_DIGITS);  // 持仓价格
      ulong  magic=PositionGetInteger(POSITION_MAGIC);   // 持仓的幻数
      double volume=PositionGetDouble(POSITION_VOLUME);  // 持仓交易量
      double sl=PositionGetDouble(POSITION_SL);   // 持仓的止损
      double tp=PositionGetDouble(POSITION_TP);    // 持仓的止赢
      ENUM_POSITION_TYPE type=(ENUM_POSITION_TYPE)PositionGetInteger(POSITION_TYPE);
// 持仓类型
      //--- 输出持仓信息
      PrintFormat(&quot;#%I64u %s  %s  %.2f  %s  sl: %s  tp: %s  [%I64d]&quot;,
                  position_ticket,
                  position_symbol,
                  EnumToString(type),
                  volume,
                  DoubleToString(PositionGetDouble(POSITION_PRICE_OPEN),digits),
                  DoubleToString(sl,digits),
                  DoubleToString(tp,digits),
                  magic);
      //--- 如果唯一识别魔术号匹配
      if(magic==EXPERT_MAGIC)
        {
         for(int j=0; j&lt;i; j++)
           {
            string symbol=PositionGetSymbol(j); // 反向持仓交易品种
            //--- 如果反向持仓交易品种和初始交易品种匹配
            if(symbol==position_symbol &amp;&amp; PositionGetInteger(POSITION_MAGIC)==EXPERT_MAGIC)
              {
               //--- 设置反向持仓类型
               ENUM_POSITION_TYPE type_by=(ENUM_POSITION_TYPE)PositionGetInteger(POSITION_TYPE);
               //--- 离开，如果初始持仓和反向持仓类型匹配
               if(type==type_by)
                  continue;
               //--- 归零请求 和 结果值
               ZeroMemory(request);
               ZeroMemory(result);
               //--- 设置操作参数
               request.action=TRADE_ACTION_CLOSE_BY;   // 交易操作类型
               request.position=position_ticket;       // 持仓价格
               request.position_by=PositionGetInteger(POSITION_TICKET); // 反向持仓价格
               //request.symbol     =position_symbol;
               request.magic=EXPERT_MAGIC;  // 持仓的幻数
               //--- 输出反向持仓平仓的信息
               PrintFormat(&quot;Close #%I64d %s %s by #%I64d&quot;,position_ticket,position_symbol,EnumToString(type),request.position_by);
               //--- 发送请求
               if(!OrderSend(request,result))
                  PrintFormat(&quot;OrderSend error %d&quot;,GetLastError());// 如果发送失败，输出错误代码

               //--- 操作信息
               PrintFormat(&quot;retcode=%u  deal=%I64u  order=%I64u&quot;,result.retcode,result.deal,result.order);
              }
           }
        }
     }
  }
//+------------------------------------------------------------------+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br></div></div><h3 id="_2-5-6-交易事件-务-类型"><a href="#_2-5-6-交易事件-务-类型" class="header-anchor">#</a> 2.5.6 交易事件(务)类型</h3> <p>当在交易账户上执行一些明确的操作动作时，它的状态会发生变化。这些操作动作包括：
• 使用 OrderSend 和 OrderSendAsync 函数在客户端从任何MQL5应用发送交易请求及其进一步执行：
• 通过程序端图形界面发送交易请求及其进一步执行；
• 在服务器上激活挂单和止损订单；
• 在交易服务器上执行操作。</p> <p>这些操作的结果会执行以下交易事件(务)：
• 处理交易请求；
• 改变持仓订单；
• 改变订单历史记录；
• 改变交易历史记录；
• 改变仓位。</p> <p>例如,当发送一个 做多(Buy) 市场订单,它会被这样处理,在帐户中创建一个适当的 做多(Buy) 订单,然后执行该订单,执行成功后，从打开订单的列表将其删除,后将其添加到订单历史列表中,一个合适的交易被添加到历史记录中，并且创建一个新的仓位。所有这些操作行动都是交易事件(务)。</p> <p>若要让程序员跟踪交易账户相关执行的操作，MQL语言提供了OnTradeTransaction 函数。该处理程序允许MQL5应用程序获得账户中的 交易事务 的相关信息。交易事件(务) 描述使用MqlTradeTransaction 结构，以第一个参数OnTradeTransaction提交。</p> <p>交易事件(务)类型以MqlTradeTransaction结构的类型参数提交。可能的交易事件(务)类型通过以下枚举值予以说明：</p> <p>ENUM_TRADE_TRANSACTION_TYPE</p> <table><thead><tr><th>标识符</th> <th>描述</th></tr></thead> <tbody><tr><td>TRADE_TRANSACTION_ORDER_ADD</td> <td>添加新的持仓订单。</td></tr> <tr><td>TRADE_TRANSACTION_ORDER_UPDATE</td> <td>更新一个持仓订单。更新不仅包括明显的客户端 或 交易服务器的变化，还包括设置时的订单状态的变化（例如， 从 ORDER_STATE_STARTED 转换到 ORDER_STATE_PLACED 或 从 ORDER_STATE_PLACED 转换到 ORDER_STATE_PARTIAL等等)</td></tr> <tr><td>TRADE_TRANSACTION_ORDER_DELETE</td> <td>从打开的订单列表中删除一个订单。可能的原因是：设置了适当的请求 或 执行成交(填充)并移动到了历史订单记录，可以导致从打开的订单中删除订单。</td></tr> <tr><td>TRADE_TRANSACTION_DEAL_ADD</td> <td>添加一笔交易到历史记录。订单执行操作 或 执行账户余额操作。</td></tr> <tr><td>TRADE_TRANSACTION_DEAL_UPDATE</td> <td>更新历史记录中的一笔交易。在服务器上更改以前执行的交易时可能会出现这种情况。例如，交易在外部交易系统(外汇交易)上发生了变化，在此之前，该笔交易是由经纪平台转移到外部服务器的。</td></tr> <tr><td>TRADE_TRANSACTION_DEAL_DELETE</td> <td>删除历史记录的一笔交易。可能会有之前执行的交易从服务器删除的情况。例如，交易在外部交易系统(外汇交易)上被删除，在此之前，该笔交易是由经纪平台转移到外部服务器的。</td></tr> <tr><td>TRADE_TRANSACTION_HISTORY_ADD</td> <td>由于执行 或 取消 而向历史记录添加订单</td></tr> <tr><td>TRADE_TRANSACTION_HISTORY_UPDATE</td> <td>更改订单历史记录中的订单。这个类型用于加强交易服务器的功能。</td></tr> <tr><td>TRADE_TRANSACTION_HISTORY_DELETE</td> <td>删除订单历史记录中的订单。这个类型用于加强交易服务器的功能。</td></tr> <tr><td>TRADE_TRANSACTION_POSITION</td> <td>改变与交易执行无关的持仓。这种事务类型表示持仓可以在交易服务器上改变。持仓交易量，开盘价，止损和止盈价位可以改变。更改的数据以 MqlTradeTransaction 结构通过 OnTradeTransaction 处理器来提交。持仓变化（添加，更改或关闭），作为交易执行的结果，不会引起 TRADE_TRANSACTION_POSITION 事务的出现。</td></tr> <tr><td>TRADE_TRANSACTION_REQUEST</td> <td>服务器处理交易请求和处理结果的通知已经收到。只有 type(类型) 字段（交易事务类型）必须以MqlTradeTransaction 结构分析该事务。 OnTradeTransaction (请求和结果)的 第二 和 第三 参数必须分析额外的数据。</td></tr></tbody></table> <p>当在交易账户上执行一些明确的操作动作时，它的状态会发生变化。这些操作动作包括：
•使用 OrderSend 和 OrderSendAsync 函数在客户端从任何MQL5应用发送交易请求及其进一步执行：
•通过程序端图形界面发送交易请求及其进一步执行；
•在服务器上激活挂单和止损订单；
•在交易服务器上执行操作。</p> <p>这些操作的结果会执行以下交易事件(务)：
•处理交易请求；
•改变持仓订单；
•改变订单历史记录；
•改变交易历史记录；
•改变仓位。</p> <p>例如,当发送一个 做多(Buy) 市场订单,它会被这样处理,在帐户中创建一个适当的 做多(Buy) 订单,然后执行该订单,执行成功后，从打开订单的列表将其删除,后将其添加到订单历史列表中,一个合适的交易被添加到历史记录中，并且创建一个新的仓位。所有这些操作行动都是交易事件(务)。</p> <p>若要让程序员跟踪交易账户相关执行的操作，MQL语言提供了OnTradeTransaction 函数。该处理程序允许MQL5应用程序获得账户中的 交易事务 的相关信息。交易事件(务) 描述使用MqlTradeTransaction 结构，以第一个参数OnTradeTransaction提交。</p> <p>交易事件(务)类型以MqlTradeTransaction结构的类型参数提交。可能的交易事件(务)类型通过以下枚举值予以说明：</p> <p>ENUM_TRADE_TRANSACTION_TYPE</p> <table><thead><tr><th>标识符</th> <th>描述</th></tr></thead> <tbody><tr><td>TRADE_TRANSACTION_ORDER_ADD</td> <td>添加新的持仓订单。</td></tr> <tr><td>TRADE_TRANSACTION_ORDER_UPDATE</td> <td>更新一个持仓订单。更新不仅包括明显的客户端 或 交易服务器的变化，还包括设置时的订单状态的变化（例如， 从 ORDER_STATE_STARTED 转换到 ORDER_STATE_PLACED 或 从 ORDER_STATE_PLACED 转换到 ORDER_STATE_PARTIAL等等)</td></tr> <tr><td>TRADE_TRANSACTION_ORDER_DELETE</td> <td>从打开的订单列表中删除一个订单。可能的原因是：设置了适当的请求 或 执行成交(填充)并移动到了历史订单记录，可以导致从打开的订单中删除订单。</td></tr> <tr><td>TRADE_TRANSACTION_DEAL_ADD</td> <td>添加一笔交易到历史记录。订单执行操作 或 执行账户余额操作。</td></tr> <tr><td>TRADE_TRANSACTION_DEAL_UPDATE</td> <td>更新历史记录中的一笔交易。在服务器上更改以前执行的交易时可能会出现这种情况。例如，交易在外部交易系统(外汇交易)上发生了变化，在此之前，该笔交易是由经纪平台转移到外部服务器的。</td></tr> <tr><td>TRADE_TRANSACTION_DEAL_DELETE</td> <td>删除历史记录的一笔交易。可能会有之前执行的交易从服务器删除的情况。例如，交易在外部交易系统(外汇交易)上被删除，在此之前，该笔交易是由经纪平台转移到外部服务器的。</td></tr> <tr><td>TRADE_TRANSACTION_HISTORY_ADD</td> <td>由于执行 或 取消 而向历史记录添加订单</td></tr> <tr><td>TRADE_TRANSACTION_HISTORY_UPDATE</td> <td>更改订单历史记录中的订单。这个类型用于加强交易服务器的功能。</td></tr> <tr><td>TRADE_TRANSACTION_HISTORY_DELETE</td> <td>删除订单历史记录中的订单。这个类型用于加强交易服务器的功能。</td></tr> <tr><td>TRADE_TRANSACTION_POSITION</td> <td>改变与交易执行无关的持仓。这种事务类型表示持仓可以在交易服务器上改变。持仓交易量，开盘价，止损和止盈价位可以改变。更改的数据以 MqlTradeTransaction 结构通过 OnTradeTransaction 处理器来提交。持仓变化（添加，更改或关闭），作为交易执行的结果，不会引起 TRADE_TRANSACTION_POSITION 事务的出现。</td></tr> <tr><td>TRADE_TRANSACTION_REQUEST</td> <td>服务器处理交易请求和处理结果的通知已经收到。只有 type(类型) 字段（交易事务类型）必须以MqlTradeTransaction 结构分析该事务。 OnTradeTransaction (请求和结果)的 第二 和 第三 参数必须分析额外的数据。</td></tr></tbody></table> <p>根据 交易事件(务)类型 的不同，在描述它的MqlTradeTransaction结构中填充了各种参数。提交数据的详细描述请参考“交易事件(务)结构”。</p> <p>相关参考</p> <p>交易事件(务)结构，OnTradeTransaction</p> <h3 id="_2-5-7-市场深度-dom-的交易订单"><a href="#_2-5-7-市场深度-dom-的交易订单" class="header-anchor">#</a> 2.5.7 市场深度(DOM)的交易订单</h3> <p>对股票来说，深度市场(DOM----Depth Of Market)窗口是可用的，你能看到当前 买入 和 卖出 的订单。交易操作的期望目标，要求数量和要求价格对每个订单都是指定的。</p> <p>通过MQL5为获得现行状态的DOM信息，可以使用 MarketBookGet() 函数，它在DOM 目录&quot;screen shot&quot;下的MqlBookInfo 结构数组中。</p> <p>为了通过MQL5获取关于 市场深度 当前状态的信息，可以使用MarketBookGet()函数，将市场深度“屏幕快照(screen shot)”放置到结构的MqlBookInfo数组中。Type(类型) 字段中数组的每个元素都包含关于订单的方向的信息——ENUM_BOOK_TYPE枚举值。</p> <p>ENUM_BOOK_TYPE</p> <table><thead><tr><th>标识符</th> <th>描述</th></tr></thead> <tbody><tr><td>BOOK_TYPE_SELL</td> <td>卖出订单（Offer）</td></tr> <tr><td>BOOK_TYPE_BUY</td> <td>买入订单（Bid）</td></tr> <tr><td>BOOK_TYPE_SELL_MARKET</td> <td>市场的卖出订单</td></tr> <tr><td>BOOK_TYPE_BUY_MARKET</td> <td>市场的买入订单</td></tr></tbody></table> <p>相关参考</p> <p>结构和类 ， DOM结构 ， 交易操作类型 ， 市场信息</p> <h3 id="_2-5-8-信号属性"><a href="#_2-5-8-信号属性" class="header-anchor">#</a> 2.5.8 信号属性</h3> <p>使用交易信号和信号复制设置时会使用以下枚举。</p> <p>双精度(double)类型的交易信号类型属性的枚举：</p> <p>ENUM_SIGNAL_BASE_DOUBLE</p> <table><thead><tr><th>ID</th> <th>描述</th></tr></thead> <tbody><tr><td>SIGNAL_BASE_BALANCE</td> <td>账户余额</td></tr> <tr><td>SIGNAL_BASE_EQUITY</td> <td>账户净值</td></tr> <tr><td>SIGNAL_BASE_GAIN</td> <td>账户获利</td></tr> <tr><td>SIGNAL_BASE_MAX_DRAWDOWN</td> <td>账户最大跌幅</td></tr> <tr><td>SIGNAL_BASE_PRICE</td> <td>信号订阅价格</td></tr> <tr><td>SIGNAL_BASE_ROI</td> <td>投资利润率(%)</td></tr></tbody></table> <p>整数型(integer) 交易信号类型属性的枚举：</p> <p>ENUM_SIGNAL_BASE_INTEGER</p> <table><thead><tr><th>ID</th> <th>描述</th></tr></thead> <tbody><tr><td>SIGNAL_BASE_DATE_PUBLISHED</td> <td>发布日期 (提供订阅的日期)</td></tr> <tr><td>SIGNAL_BASE_DATE_STARTED</td> <td>监控起始日期</td></tr> <tr><td>SIGNAL_BASE_DATE_UPDATED</td> <td>信号交易统计的最近更新日期</td></tr> <tr><td>SIGNAL_BASE_ID</td> <td>信号 ID</td></tr> <tr><td>SIGNAL_BASE_LEVERAGE</td> <td>账户杠杆</td></tr> <tr><td>SIGNAL_BASE_PIPS</td> <td>利润点</td></tr> <tr><td>SIGNAL_BASE_RATING</td> <td>持仓评级</td></tr> <tr><td>SIGNAL_BASE_SUBSCRIBERS</td> <td>订阅人数量</td></tr> <tr><td>SIGNAL_BASE_TRADES</td> <td>交易数量</td></tr> <tr><td>SIGNAL_BASE_TRADE_MODE</td> <td>账户类型 (0----真实，1----模拟，2----竞赛)</td></tr></tbody></table> <p>字符串型(string) 交易信号类型属性的枚举：</p> <p>ENUM_SIGNAL_BASE_STRING</p> <table><thead><tr><th>ID</th> <th>描述</th></tr></thead> <tbody><tr><td>SIGNAL_BASE_AUTHOR_LOGIN</td> <td>发布者登录</td></tr> <tr><td>SIGNAL_BASE_BROKER</td> <td>交易商名称（公司名）</td></tr> <tr><td>SIGNAL_BASE_BROKER_SERVER</td> <td>交易商服务器</td></tr> <tr><td>SIGNAL_BASE_NAME</td> <td>信号名称</td></tr> <tr><td>SIGNAL_BASE_CURRENCY</td> <td>信号基础货币</td></tr></tbody></table> <p>双精度(double)信号复制设置类型属性的枚举：</p> <p>ENUM_SIGNAL_INFO_DOUBLE</p> <table><thead><tr><th>ID</th> <th>描述</th></tr></thead> <tbody><tr><td>SIGNAL_INFO_EQUITY_LIMIT</td> <td>净值限制</td></tr> <tr><td>SIGNAL_INFO_SLIPPAGE</td> <td>滑点(用于下市价单时同步持仓和复制交易)</td></tr> <tr><td>SIGNAL_INFO_VOLUME_PERCENT</td> <td>最大的使用入金百分比(%), r/o</td></tr></tbody></table> <p>整数型(integer) 信号复制设置类型属性的枚举：</p> <p>ENUM_SIGNAL_INFO_INTEGER</p> <table><thead><tr><th></th> <th>描述</th></tr></thead> <tbody><tr><td>SIGNAL_INFO_CONFIRMATIONS_DISABLED</td> <td>确认禁用标识</td></tr> <tr><td>SIGNAL_INFO_COPY_SLTP</td> <td>复制止损和止盈标识</td></tr> <tr><td>SIGNAL_INFO_DEPOSIT_PERCENT</td> <td>入金比例 (%)</td></tr> <tr><td>SIGNAL_INFO_ID</td> <td>信号 ID, r/o</td></tr> <tr><td>SIGNAL_INFO_SUBSCRIPTION_ENABLED</td> <td>订阅启用标识</td></tr> <tr><td>SIGNAL_INFO_TERMS_AGREE</td> <td>&quot;同意信号服务使用条款&quot; 标识, r/o</td></tr></tbody></table> <p>字符串型(string) 信号复制设置类型属性的枚举：</p> <p>ENUM_SIGNAL_INFO_STRING</p> <table><thead><tr><th>ID</th> <th>描述</th></tr></thead> <tbody><tr><td>SIGNAL_INFO_NAME</td> <td>信号名称，r/o</td></tr></tbody></table> <p>相关参考</p> <p>交易信号</p> <h2 id="_2-6-命名常量"><a href="#_2-6-命名常量" class="header-anchor">#</a> 2.6 命名常量</h2> <p>所有在MQL5中使用的常量被分成如下几组：</p> <p>• 预定义的宏替换 —— 在编译过程中值被替换;
• 数学常量 —— 一些数学表达式的值
• 数值类型常量 —— 一些简单类型的限制约束
• 不能初始化原因代码 —— 不能初始化原因的描述
• 检测对象指针 —— 由CheckPointer()函数返回的指针类型的枚举值;
• 其他常量 —— 所有其他常量</p> <h3 id="_2-6-1-预定义的宏替换"><a href="#_2-6-1-预定义的宏替换" class="header-anchor">#</a> 2.6.1 预定义的宏替换</h3> <p>(大量代替值......用机器翻译的鬼佬要死吧？ —— 智能交易*姚 提示)</p> <p>为了简化调试过程并获取关于mql5程序的操作的信息，有一个特殊的宏常量，在编译时设置了这些值。使用这些常量的最简单方法是通过Print()函数输出值，如示例中所示。</p> <table><thead><tr><th>常量</th> <th>描述</th></tr></thead> <tbody><tr><td><strong>DATE</strong></td> <td>文件编译日期，无时间(小时,分钟,秒的值等于0)</td></tr> <tr><td><strong>DATETIME</strong></td> <td>文件编译日期和时间</td></tr> <tr><td><strong>LINE</strong></td> <td>源代码文件中宏的位置的代码行号</td></tr> <tr><td><strong>FILE</strong></td> <td>当前编译文件的名称</td></tr> <tr><td><strong>PATH</strong></td> <td>当前正在编译的文件的绝对路径</td></tr> <tr><td><strong>FUNCTION</strong></td> <td>宏所在的函数主体的名称</td></tr> <tr><td><strong>FUNCSIG</strong></td> <td>函数的形式参数，其主体是宏所在的位置。对函数的完整描述的日志记录可以用于识别重载函数。</td></tr> <tr><td><strong>MQLBUILD</strong>, <strong>MQL5BUILD</strong></td> <td>编译器构造版本号</td></tr></tbody></table> <p><strong>示例：</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#property copyright &quot;Copyright © 2009, MetaQuotes Software Corp.&quot;
#property link      &quot;https://www.metaquotes.net&quot;
//+------------------------------------------------------------------+
//| EA初始化函数                                                      |
//+------------------------------------------------------------------+
void OnInit()
  {
//--- EA交易初始化输出信息示例
   Print(&quot; __FUNCTION__ = &quot;,__FUNCTION__,&quot;  __LINE__ = &quot;,__LINE__);
//--- 设置定时器事件间的间隔
   EventSetTimer(5);
//---
  }
//+------------------------------------------------------------------+
//| EA无法初始化函数                                                   |
//+------------------------------------------------------------------+
void OnDeinit(const int reason)
  {
//--- EA交易无法初始化输出信息示例
   Print(&quot; __FUNCTION__ = &quot;,__FUNCTION__,&quot;  __LINE__ = &quot;,__LINE__);
//---
  }
//+------------------------------------------------------------------+
//| EA订单号函数                                                     |
//+------------------------------------------------------------------+
void OnTick()
  {
//--- 订单收据输出信息
   Print(&quot; __MQLBUILD__ = &quot;,__MQLBUILD__,&quot;  __FILE__ = &quot;,__FILE__);
   Print(&quot; __FUNCTION__ = &quot;,__FUNCTION__,&quot;  __LINE__ = &quot;,__LINE__);
   test1(__FUNCTION__);
   test2();
//---
  }
//+------------------------------------------------------------------+
//| test1                                                            |
//+------------------------------------------------------------------+
void test1(string par)
  {
//--- 函数内部信息输出
   Print(&quot; __FUNCTION__ = &quot;,__FUNCTION__,&quot;  __LINE__ = &quot;,__LINE__,&quot; par = &quot;,par);
  }
//+------------------------------------------------------------------+
//| test2                                                            |
//+------------------------------------------------------------------+
void test2()
  {
//--- 函数内部信息输出
   Print(&quot; __FUNCTION__ = &quot;,__FUNCTION__,&quot;  __LINE__ = &quot;,__LINE__);
  }
//+------------------------------------------------------------------+
//| OnTimer 事件处理                                                    |
//+------------------------------------------------------------------+
void OnTimer()
  {
//---
   Print(&quot; __FUNCTION__ = &quot;,__FUNCTION__,&quot;  __LINE__ = &quot;,__LINE__);
   test1(__FUNCTION__);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br></div></div><h3 id="_2-6-2-数学常量"><a href="#_2-6-2-数学常量" class="header-anchor">#</a> 2.6.2 数学常量</h3> <p>包含具体数值的一些特殊常量保留给一些数学表达式。这些常量数值可以在程序的任何地方使用，而不必使用数学函数来计算它们。</p> <table><thead><tr><th>常量</th> <th>描述</th> <th>值</th></tr></thead> <tbody><tr><td>M_E</td> <td>e</td> <td>2.71828182845904523536</td></tr> <tr><td>M_LOG2E</td> <td>log2(e)</td> <td>1.44269504088896340736</td></tr> <tr><td>M_LOG10E</td> <td>log10(e)</td> <td>0.434294481903251827651</td></tr> <tr><td>M_LN2</td> <td>ln(2)</td> <td>0.693147180559945309417</td></tr> <tr><td>M_LN10</td> <td>ln(10)</td> <td>2.30258509299404568402</td></tr> <tr><td>M_PI</td> <td>pi</td> <td>3.14159265358979323846</td></tr> <tr><td>M_PI_2</td> <td>pi/2</td> <td>1.57079632679489661923</td></tr> <tr><td>M_PI_4</td> <td>pi/4</td> <td>0.785398163397448309616</td></tr> <tr><td>M_1_PI</td> <td>1/pi</td> <td>0.318309886183790671538</td></tr> <tr><td>M_2_PI</td> <td>2/pi</td> <td>0.636619772367581343076</td></tr> <tr><td>M_2_SQRTPI</td> <td>2/sqrt(pi)</td> <td>1.12837916709551257390</td></tr> <tr><td>M_SQRT2</td> <td>sqrt(2)</td> <td>1.41421356237309504880</td></tr> <tr><td>M_SQRT1_2</td> <td>1/sqrt(2)</td> <td>0.707106781186547524401</td></tr></tbody></table> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+
//| 脚本程序启动函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 打印常量值
   Print(&quot;M_E = &quot;,DoubleToString(M_E,16));
   Print(&quot;M_LOG2E = &quot;,DoubleToString(M_LOG2E,16));
   Print(&quot;M_LOG10E = &quot;,DoubleToString(M_LOG10E,16));
   Print(&quot;M_LN2 = &quot;,DoubleToString(M_LN2,16));
   Print(&quot;M_LN10 = &quot;,DoubleToString(M_LN10,16));
   Print(&quot;M_PI = &quot;,DoubleToString(M_PI,16));
   Print(&quot;M_PI_2 = &quot;,DoubleToString(M_PI_2,16));
   Print(&quot;M_PI_4 = &quot;,DoubleToString(M_PI_4,16));
   Print(&quot;M_1_PI = &quot;,DoubleToString(M_1_PI,16));
   Print(&quot;M_2_PI = &quot;,DoubleToString(M_2_PI,16));
   Print(&quot;M_2_SQRTPI = &quot;,DoubleToString(M_2_SQRTPI,16));
   Print(&quot;M_SQRT2 = &quot;,DoubleToString(M_SQRT2,16));
   Print(&quot;M_SQRT1_2 = &quot;,DoubleToString(M_SQRT1_2,16));
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="_2-6-3-数值类型的常量"><a href="#_2-6-3-数值类型的常量" class="header-anchor">#</a> 2.6.3 数值类型的常量</h3> <p>每个简单的数值类型用于特定类型的任务，并允许在正确使用时优化mql5程序的操作。为了更好的代码可读性和正确处理计算结果，有一些常量允许接收关于特定类型的简单数据的限制信息。</p> <table><thead><tr><th>常量</th> <th>描述</th> <th>值</th></tr></thead> <tbody><tr><td>CHAR_MIN</td> <td>最小值，可以用char类型表示。</td> <td>-128</td></tr> <tr><td>CHAR_MAX</td> <td>最大值，可以用char类型表示。</td> <td>127</td></tr> <tr><td>UCHAR_MAX</td> <td>最大值，可以用uchar类型表示。</td> <td>255</td></tr> <tr><td>SHORT_MIN</td> <td>最小值，可以用short类型表示。</td> <td>-32768</td></tr> <tr><td>SHORT_MAX</td> <td>最大值，可以用short类型表示。</td> <td>32767</td></tr> <tr><td>USHORT_MAX</td> <td>最大值，可以用ushort类型表示。</td> <td>65535</td></tr> <tr><td>INT_MIN</td> <td>最小值，可以用int类型表示。</td> <td>-2147483648</td></tr> <tr><td>INT_MAX</td> <td>最大值，可以用int类型表示。</td> <td>2147483647</td></tr> <tr><td>UINT_MAX</td> <td>最大值，可以用uint类型表示。</td> <td>4294967295</td></tr> <tr><td>LONG_MIN</td> <td>最小值，可以用 long类型表示。</td> <td>-9223372036854775808</td></tr> <tr><td>LONG_MAX</td> <td>最大值，可以用 long类型表示。</td> <td>9223372036854775807</td></tr> <tr><td>ULONG_MAX</td> <td>最大值，可以用 ulong类型表示。</td> <td>18446744073709551615</td></tr> <tr><td>DBL_MIN</td> <td>最小正值，可以用 double类型表示。</td> <td>2.2250738585072014e-308</td></tr> <tr><td>DBL_MAX</td> <td>最大值，可以用 double类型表示。</td> <td>1.7976931348623158e+308</td></tr> <tr><td>DBL_EPSILON</td> <td>最小值，满足条件 1.0+DBL_EPSILON != 1.0（双精度类型）</td> <td>2.2204460492503131e-016</td></tr> <tr><td>DBL_DIG</td> <td>双精度型有效小数位数字</td> <td>15</td></tr> <tr><td>DBL_MANT_DIG</td> <td>双精度型尾数算在内的二进制</td> <td>53</td></tr> <tr><td>DBL_MAX_10_EXP</td> <td>双精度型指数角度最大小数值</td> <td>308</td></tr> <tr><td>DBL_MAX_EXP</td> <td>双精度型指数角度最大二进制值</td> <td>1024</td></tr> <tr><td>DBL_MIN_10_EXP</td> <td>双精度型指数角度最小小数</td> <td>(-307)</td></tr> <tr><td>DBL_MIN_EXP</td> <td>双精度型指数角度最小二进制值</td> <td>(-1021)</td></tr> <tr><td>FLT_MIN</td> <td>最小正值，可以用 float类型表示。</td> <td>1.175494351e-38</td></tr> <tr><td>FLT_MAX</td> <td>最大值，可以用 float类型表示。</td> <td>3.402823466e+38</td></tr> <tr><td>FLT_EPSILON</td> <td>最小值，满足因素： 1.0+DBL_EPSILON != 1.0 （浮点类型）</td> <td>1.192092896e?C07</td></tr> <tr><td>FLT_DIG</td> <td>浮点型有效角度数位</td> <td>6</td></tr> <tr><td>FLT_MANT_DIG</td> <td>浮点型二进制计算点数</td> <td>24</td></tr> <tr><td>FLT_MAX_10_EXP</td> <td>浮点型指数角度最大小数值</td> <td>38</td></tr> <tr><td>FLT_MAX_EXP</td> <td>浮点型最大二进制值</td> <td>128</td></tr> <tr><td>FLT_MIN_10_EXP</td> <td>浮点型指数角度最小小数值</td> <td>-37</td></tr> <tr><td>FLT_MIN_EXP</td> <td>浮点型指数角度最小二进制值</td> <td>(-125)</td></tr></tbody></table> <p><strong>示例：</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>void OnStart()
  {
//--- 打印常量值
   printf(&quot;CHAR_MIN = %d&quot;,CHAR_MIN);
   printf(&quot;CHAR_MAX = %d&quot;,CHAR_MAX);
   printf(&quot;UCHAR_MAX = %d&quot;,UCHAR_MAX);
   printf(&quot;SHORT_MIN = %d&quot;,SHORT_MIN);
   printf(&quot;SHORT_MAX = %d&quot;,SHORT_MAX);
   printf(&quot;USHORT_MAX = %d&quot;,USHORT_MAX);
   printf(&quot;INT_MIN = %d&quot;,INT_MIN);
   printf(&quot;INT_MAX = %d&quot;,INT_MAX);
   printf(&quot;UINT_MAX = %u&quot;,UINT_MAX);
   printf(&quot;LONG_MIN = %I64d&quot;,LONG_MIN);
   printf(&quot;LONG_MAX = %I64d&quot;,LONG_MAX);
   printf(&quot;ULONG_MAX = %I64u&quot;,ULONG_MAX);
   printf(&quot;EMPTY_VALUE = %.16e&quot;,EMPTY_VALUE);
   printf(&quot;DBL_MIN = %.16e&quot;,DBL_MIN);
   printf(&quot;DBL_MAX = %.16e&quot;,DBL_MAX);
   printf(&quot;DBL_EPSILON = %.16e&quot;,DBL_EPSILON);
   printf(&quot;DBL_DIG = %d&quot;,DBL_DIG);
   printf(&quot;DBL_MANT_DIG = %d&quot;,DBL_MANT_DIG);
   printf(&quot;DBL_MAX_10_EXP =  %d&quot;,DBL_MAX_10_EXP);
   printf(&quot;DBL_MAX_EXP = %d&quot;,DBL_MAX_EXP);
   printf(&quot;DBL_MIN_10_EXP = %d&quot;,DBL_MIN_10_EXP);
   printf(&quot;DBL_MIN_EXP = %d&quot;,DBL_MIN_EXP);
   printf(&quot;FLT_MIN = %.8e&quot;,FLT_MIN);
   printf(&quot;FLT_MAX = %.8e&quot;,FLT_MAX);
   printf(&quot;FLT_EPSILON = %.8e&quot;,FLT_EPSILON);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h3 id="_2-6-4-不能初始化原因代码"><a href="#_2-6-4-不能初始化原因代码" class="header-anchor">#</a> 2.6.4 不能初始化原因代码</h3> <p>使用 UninitializeReason() 函数可以返回初始化错误代码，可能值如下：</p> <table><thead><tr><th>常量</th> <th>值</th> <th>描述</th></tr></thead> <tbody><tr><td>REASON_PROGRAM</td> <td>0</td> <td>调用ExpertRemove()函数终止了EA操作</td></tr> <tr><td>REASON_REMOVE</td> <td>1</td> <td>程序从图表中删除</td></tr> <tr><td>REASON_RECOMPILE</td> <td>2</td> <td>程序重新编译</td></tr> <tr><td>REASON_CHARTCHANGE</td> <td>3</td> <td>更改了交易品种或图表时间周期框架</td></tr> <tr><td>REASON_CHARTCLOSE</td> <td>4</td> <td>图表关闭</td></tr> <tr><td>REASON_PARAMETERS</td> <td>5</td> <td>用户改变了输入参数</td></tr> <tr><td>REASON_ACCOUNT</td> <td>6</td> <td>由于账户设置的改变，如激活了另一个账户或者重新连接交易服务器的情况。</td></tr> <tr><td>REASON_TEMPLATE</td> <td>7</td> <td>应用了新模板</td></tr> <tr><td>REASON_INITFAILED</td> <td>8</td> <td>此值表示OnInit()处理器，返回了一个非零值</td></tr> <tr><td>REASON_CLOSE</td> <td>9</td> <td>程序端已关闭</td></tr></tbody></table> <p>无法初始化的错误原因代码通过预定义函数 OnDeinit（整数常量错误代码）传递参数。</p> <p><strong>示例：</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+
//| 获得文本描述                                                       |
//+------------------------------------------------------------------+
string getUninitReasonText(int reasonCode)
  {
   string text=&quot;&quot;;
//---
   switch(reasonCode)
     {
      case REASON_ACCOUNT:
         text=&quot;帐号已改变Account was changed&quot;;break;
      case REASON_CHARTCHANGE:
         text=&quot;交易品种 或 时间框架改变Symbol or timeframe was changed&quot;;break;
      case REASON_CHARTCLOSE:
         text=&quot;图表已关闭Chart was closed&quot;;break;
      case REASON_PARAMETERS:
         text=&quot;输入参数改变Input-parameter was changed&quot;;break;
      case REASON_RECOMPILE:
         text=&quot;程序文件 &quot;+__FILE__+&quot; 重编译&quot;;break;
      case REASON_REMOVE:
         text=&quot;程序文件 &quot;+__FILE__+&quot; 已从图表移除&quot;;break;
      case REASON_TEMPLATE:
         text=&quot;图表上应用了新的模版New template was applied to chart&quot;;break;
      default:text=&quot;其它原因Another reason&quot;;
     }
//---
   return text;
  }
//+------------------------------------------------------------------+
//| EA无法初始化函数                                                  |
//+------------------------------------------------------------------+
void OnDeinit(const int reason)
  {
//--- 获得无法初始化原因代码的第一种方法
   Print(__FUNCTION__,&quot;_Uninitalization reason code = &quot;,reason);
//--- 获得无法初始化原因代码的第二种方法
   Print(__FUNCTION__,&quot;_UninitReason = &quot;,getUninitReasonText(_UninitReason));
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><h3 id="_2-6-5-检测对象指针"><a href="#_2-6-5-检测对象指针" class="header-anchor">#</a> 2.6.5 检测对象指针</h3> <p>CheckPointer() 函数用于检测对象指针类型。返回值为 ENUM_POINTER_TYPE 枚举值之一。如果使用了不正确的指针，程序将立即终止执行。</p> <p>由 new() 操作符创建的对象属于POINTER_DYNAMIC类型。delete()操作符可以而且应该只用于这些指针。</p> <p>所有POINTER_AUTOMATIC类型的其它指针，表示该对象由MQL5程序环境自动创建，在使用后自动删除。</p> <p>ENUM_POINTER_TYPE</p> <table><thead><tr><th>常量</th> <th>描述</th></tr></thead> <tbody><tr><td>POINTER_INVALID</td> <td>错误指针</td></tr> <tr><td>POINTER_DYNAMIC</td> <td>new() 操作符创建的对象指针</td></tr> <tr><td>POINTER_AUTOMATIC</td> <td>任意自动创建的对象指针(非new()创建)</td></tr></tbody></table> <p>相关参考</p> <p>运行错误 ， 对象删除操作符删除 ， 检测指针</p> <h3 id="_2-6-6-其它常量"><a href="#_2-6-6-其它常量" class="header-anchor">#</a> 2.6.6 其它常量</h3> <p>CLR_NONE常量用于描述没有指定颜色的情况，这意味着图形对象或一个指标的图形序列不会被绘制出来。这个常量不包含在web颜色常量列表中，但是它可以应用到需要颜色参数的任何地方。</p> <p>INVALID_HANDLE 常数能用来检测处理文件 (参见 FileOpen() 和 FileFindFirst() ）。</p> <table><thead><tr><th>常量</th> <th>描述</th> <th>值</th></tr></thead> <tbody><tr><td>CHARTS_MAX</td> <td>在客户终端中同时打开图表的最大可能数量。</td> <td>&gt;100</td></tr> <tr><td>clrNONE</td> <td>未指定颜色</td> <td>-1</td></tr> <tr><td>EMPTY_VALUE</td> <td>指标缓冲区的空值</td> <td>DBL_MAX</td></tr> <tr><td>INVALID_HANDLE</td> <td>错误处理</td> <td>-1</td></tr> <tr><td>IS_DEBUG_MODE</td> <td>MQL5程序运行的 调试方式 标帜</td> <td>非零值 ---- 调试模式, 其它模式为 0</td></tr> <tr><td>IS_PROFILE_MODE</td> <td>MQL5程序运行 分析模式 的标帜</td> <td>非零值 ---- 分析模式, 其它模式为 0</td></tr> <tr><td>NULL</td> <td>任意类型的零(空)值</td> <td>0</td></tr> <tr><td>WHOLE_ARRAY</td> <td>表示直到数组末尾，还剩余的项目数量。即，整个数组将被遍历处理。</td> <td>-1</td></tr> <tr><td>WRONG_VALUE</td> <td>常量可以 隐式 地转换为任何枚举类型。</td> <td>-1</td></tr></tbody></table> <p>EMPTY_VALUE常量通常对应于图表中不需要显示的指标的值。例如，对于内置的标准差(Standard Deviation)指标,周期为20，即表示在历史数据图表中的前19根K线(柱)对应的指标线并没有显示在图表中。如果使用iStdDev()函数创建此指标，并通过CopyBuffer()将这些K线(柱对应的指标缓冲区数组中的值复制到另一个数组中，那么将会发现这些值等于EMPTY_VALUE。</p> <p>可以为 自定义指标 选择空值，用于当不需要该指标在图表中显示时，可以使用函数 PlotIndexSetDouble() 的修饰符 PLOT_EMPTY_VALUE 。</p> <p>可以将NULL常量分配给任何简单类型的变量 或 对象结构 或 类指针。字符串变量的空(NULL)赋值意味着该变量的全部初始化。</p> <p>当有必要返回枚举值时，WRONG_VALUE常量即是为这种情况准备的，并且这必须是一个错误值。例如，当我们需要告知返回值是该枚举的值时。让我们以一个函数CheckLineStyle()为例，它返回以其名称指定的对象的行样式。如果由ObjectGetInteger()检查结果为真，则返回ENUM_LINE_STYLE的值;否则WRONG_VALUE返回。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>void OnStart()
  {
   if(CheckLineStyle(&quot;MyChartObject&quot;)==WRONG_VALUE)
      printf(&quot;Error line style getting.&quot;);
  }
//+------------------------------------------------------------------+
//| 为名称指定物件返回线型                                              |
//+------------------------------------------------------------------+
ENUM_LINE_STYLE CheckLineStyle(string name)
  {
   long style;
//---
   if(ObjectGetInteger(0,name,OBJPROP_STYLE,0,style))
      return((ENUM_LINE_STYLE)style);
   else
      return(WRONG_VALUE);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>WHOLE_ARRAY常量用于需要指定处理数组中元素数量的函数:</p> <p>• ArrayCopy();
• ArrayMinimum();
• ArrayMaximum();
• FileReadArray();
• FileWriteArray().</p> <p>如果想要列举，指定位置中的所有数组值从头到尾都是需要处理的，你应该指定WHOLE_ARRAY值。</p> <p>IS_PROFILE_MODE常量允许在 分析模式 中更改程序操作，以便正确地收集数据。分析允许度量单个程序片段(通常包含函数)的执行时间，以及计算此类调用的数量。在分析模式下，可能会禁止Sleep()，以在 分析模式 中确定执行时间，比如在这个例子中:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//--- Sleep 可能大大影响（改变）分析结果
if(!IS_PROFILE_MODE) Sleep(100); // 在分析模式禁用 Sleep() 调用
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>IS_PROFILE_MODE常量值由编译器在编译期间设置，而在常规模式下设置为零。当在 分析模式 下启动一个程序时，将执行一个特殊的编译，并将IS_PROFILE_MODE替换为非零值。</p> <p>当您需要在 调试模式 中稍微更改mql5程序的操作时，IS_DEBUG_MODE常量会非常有用。例如，在 调试模式 中，您可能需要在终端日志中显示额外的调试信息，或者在图表中创建附加的图形对象。</p> <p>下面的示例创建一个标签(Label)对象，并根据脚本运行模式设置了描述和颜色。为了从MetaEditor中运行 调试模式 的脚本，请按F5键。如果您从客户端的浏览窗口运行脚本，那么对象标签的颜色和文本将会不同。</p> <p><strong>示例：</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+
//|                                             Check_DEBUG_MODE.mq5 |
//|                      Copyright © 2009, MetaQuotes Software Corp. |
//|                                        https://www.metaquotes.net |
//+------------------------------------------------------------------+
#property copyright &quot;Copyright © 2009, MetaQuotes Software Corp.&quot;
#property link      &quot;https://www.metaquotes.net&quot;
//+------------------------------------------------------------------+
//| 脚本程序启动函数                                                   |
//+------------------------------------------------------------------+
void OnStart()
  {
//---
   string label_name=&quot;invisible_label&quot;;
   if(ObjectFind(0,label_name)&lt;0)
     {
      Print(&quot;Object&quot;,label_name,&quot;not found. Error code = &quot;,GetLastError());
      //--- 创建标签
      ObjectCreate(0,label_name,OBJ_LABEL,0,0,0);
      //--- 设置 X 坐标
      ObjectSetInteger(0,label_name,OBJPROP_XDISTANCE,200);
      //--- 设置 Y 坐标
      ObjectSetInteger(0,label_name,OBJPROP_YDISTANCE,300);
      ResetLastError();
      if(IS_DEBUG_MODE) // 调试方式
        {
         //--- 显示脚本执行模式信息
         ObjectSetString(0,label_name,OBJPROP_TEXT,&quot;DEBUG MODE&quot;);
         //--- 设置文本颜色成红色
         if(!ObjectSetInteger(0,label_name,OBJPROP_COLOR,clrRed))
            Print(&quot;Unable to set the color. Error&quot;,GetLastError());
        }
      else              // 操作模式
        {
         ObjectSetString(0,label_name,OBJPROP_TEXT,&quot;RELEASE MODE&quot;);
         //--- 设置文本颜色为不可见
         if(!ObjectSetInteger(0,label_name,OBJPROP_COLOR,CLR_NONE))
            Print(&quot;Unable to set the color. Error &quot;,GetLastError());
        }
      ChartRedraw();
      DebugBreak();    // 如果处于调试模式，则会终止
     }
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><p>Crypt 方法</p> <p>ENUM_CRYPT_METHOD枚举用于指定在CryptEncode()和CryptDecode()函数中使用的数据转换方法。</p> <p>ENUM_CRYPT_METHOD</p> <table><thead><tr><th>常量</th> <th>描述</th></tr></thead> <tbody><tr><td>CRYPT_BASE64</td> <td>BASE64</td></tr> <tr><td>CRYPT_AES128</td> <td>AES 128位密钥加密（16字节）</td></tr> <tr><td>CRYPT_AES256</td> <td>AES 256位密钥加密（32 字节）</td></tr> <tr><td>CRYPT_DES</td> <td>DES 56位密钥加密（7字节）</td></tr> <tr><td>CRYPT_HASH_SHA1</td> <td>SHA1 哈希计算</td></tr> <tr><td>CRYPT_HASH_SHA256</td> <td>SHA256 哈希计算</td></tr> <tr><td>CRYPT_HASH_MD5</td> <td>MD5 哈希计算</td></tr> <tr><td>CRYPT_ARCH_ZIP</td> <td>ZIP 归档</td></tr></tbody></table> <p>相关参考</p> <p>DebugBreak, 执行MQL程序属性, CryptEncode(), CryptDecode()</p> <h2 id="_2-7-数据结构"><a href="#_2-7-数据结构" class="header-anchor">#</a> 2.7 数据结构</h2> <p>MQL5语言提供9种预定义的 结构 ：</p> <p>• MqlDateTime 用于处理 日期和时间；
• MqlParam 用于IndicatorCreate()函数创建指标的句柄时，可以传送输入参数;
• MqlRates 用于操作历史数据，它包含关于价格、交易量 和 点差;
• MqlBookInfo 用于获取DOM市场深度信息(Depth of Market)；
• MqlTradeRequest 用于创建交易操作的交易请求;
• MqlTradeCheckResult 用于在发送之前检查已准备好的交易请求;
• MqlTradeResult 通过OrderSend()函数，获得交易服务器回应交易请求的信息；
• MqlTradeTransaction 包括交易事务的描述；
• MqlTick 是为快速检索当前价格中最需要的信息而设计的。</p> <h3 id="_2-7-1-mqldatetime"><a href="#_2-7-1-mqldatetime" class="header-anchor">#</a> 2.7.1 MqlDateTime</h3> <p>数据类型结构。
用于处理 日期和时间。数据类型结构包括int的8个字段 ：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>struct MqlDateTime
  {
   int year;           // 年
   int mon;            // 月
   int day;            // 日
   int hour;           // 小时
   int min;            // 分钟
   int sec;            // 秒
   int day_of_week;    // 一周内的星期几 (0-星期天, 1-星期一, ... ,6-星期六)
   int day_of_year;    // 一年内的第几天 (0 表示 1月1 日)
  };
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>注意</p> <p>字段day_of_year，如果是闰年，则从三月开始，该数字就会与非闰年的相应天数有所不同。</p> <p>示例</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>void OnStart()
  {
//---
   datetime date1=D'2008.03.01';
   datetime date2=D'2009.03.01';

   MqlDateTime str1,str2;
   TimeToStruct(date1,str1);
   TimeToStruct(date2,str2);
   printf(&quot;%02d.%02d.%4d, day of year = %d&quot;,str1.day,str1.mon,
          str1.year,str1.day_of_year);
   printf(&quot;%02d.%02d.%4d, day of year = %d&quot;,str2.day,str2.mon,
          str2.year,str2.day_of_year);
  }
/*  Result:
   01.03.2008, day of year = 60
   01.03.2009, day of year = 59
*/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>相关参考</p> <p>TimeToStruct， 结构和类</p> <h3 id="_2-7-2-mqlparam"><a href="#_2-7-2-mqlparam" class="header-anchor">#</a> 2.7.2 MqlParam</h3> <p>输入参量结构。
指标输入参数的结构。当使用 IndicatorCreate() 函数创建技术指标的句柄时， MqlParam结构是专门设计用来提供 输入参数的。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>struct MqlParam
  {
   ENUM_DATATYPE     type;           // 输入参数 类型,  ENUM_DATATYPE 枚举值
   long              integer_value;  // 存储 整数类型 字段
   double            double_value;   // 存储 双精度类型 字段
   string            string_value;   // 存储 字符串类型 字段
  };
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>一个指标所有的输入参数都以MqlParam类型的数组的形式来传递，该数组每个元素的”type类型”字段指定了按元素传递的参数的数据类型。必须首先将指标的值放在每个元素的适当字段中(即integer_value，double_value或string_value中)，这取决于在”type(类型)”字段中指定的ENUM_DATATYPE枚举的值。</p> <p>如果IND_CUSTOM的值以第三个指标类型传递到IndicatorCreate()函数中，输入参数数组中的第一个元素(type)的值一定是 ENUM_DATATYPE 枚举值中的TYPE_STRING ，而string_value字段中一定包含自定义指标的名称。</p> <h3 id="_2-7-3-mqlrates"><a href="#_2-7-3-mqlrates" class="header-anchor">#</a> 2.7.3 MqlRates</h3> <p>历史数据结构。
此结构存储有关报价、交易量和点差的信息。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>struct MqlRates
  {
   datetime time;         // 周期开始时间
   double   open;         // 开盘价
   double   high;         // 周期内的最高价
   double   low;          // 周期内的最低价
   double   close;        // 收盘价
   long     tick_volume;  // 跳价数量
   int      spread;       // 点差
   long     real_volume;  // 真实交易量
  };
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>示例:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>void OnStart()
  {
   MqlRates rates[];
   int copied=CopyRates(NULL,0,0,100,rates);
   if(copied&lt;=0)
      Print(&quot;Error copying price data &quot;,GetLastError());
   else Print(&quot;Copied &quot;,ArraySize(rates),&quot; bars&quot;);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>相关参考</p> <p>复制比率(CopyRates) ， 接入时间序列</p> <h3 id="_2-7-4-mqlbookinfo"><a href="#_2-7-4-mqlbookinfo" class="header-anchor">#</a> 2.7.4 MqlBookInfo</h3> <p>DOM结构,此结构提供市场深度信息。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>    struct MqlBookInfo
  {
   ENUM_BOOK_TYPE   type;       // 订单类型 取值范围为 ENUM_BOOK_TYPE 枚举值之一
   double           price;      // 价格
   long             volume;     // 交易量
  };
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>注意</p> <p>MqlBookInfo 结构是预定义的，因此它不需要任何声明和描述。若要使用该结构，只需声明此类型的变量即可。</p> <p>DOM仅在有限的一些 交易品种 中可以适用。</p> <p>示例</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>   MqlBookInfo priceArray[];
   bool getBook=MarketBookGet(NULL,priceArray);
   if(getBook)
     {
      int size=ArraySize(priceArray);
      Print(&quot;MarketBookInfo about &quot;,Symbol());
     }
   else
     {
      Print(&quot;Failed to receive DOM for the symbol &quot;,Symbol());
     }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>相关参考</p> <p>MarketBookAdd，MarketBookRelease， MarketBookGet， DOM中交易订单 ， 数据类型</p> <h3 id="_2-7-5-mqltraderequest"><a href="#_2-7-5-mqltraderequest" class="header-anchor">#</a> 2.7.5 MqlTradeRequest</h3> <p>交易请求结构
客户端为执行下单动作需要与交易服务器互动通讯，这是由交易请求来执行的。交易请求由特殊的预定义的MqlTradeRequest结构类型来表示，该结构包含执行交易协议所需的所有字段。请求处理结果由MqlTradeResult类型的结构表示。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>struct MqlTradeRequest
  {
   ENUM_TRADE_REQUEST_ACTIONS    action;            // 交易操作类型,取值范围为枚举值之一
   ulong                                     magic;             // EA交易 ID (唯一识别魔术号)
   ulong                                     order;             // 订单号
   string                                    symbol;            // 交易品种
   double                                   volume;            // 交易量
   double                                   price;              // 价格
   double                                  stoplimit;         // 止损限价点位
   double                                   sl;                  // 止损
   double                                   tp;                 // 止盈
   ulong                                    deviation;        // 允许滑点的偏差范围
   ENUM_ORDER_TYPE                   type;               // 订单类型
   ENUM_ORDER_TYPE_FILLING        type_filling;     // 订单交易量(手数)执行类型
   ENUM_ORDER_TYPE_TIME            type_time;      // 订单执行时间
   datetime                               expiration;       // 订单过期时间 (为 ORDER_TIME_SPECIFIED 类型订单)
   string                                   comment;        // 订单注释
   ulong                                    position;         // 仓位价格
   ulong                                   position_by;      // 反向仓位价格
  };
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>字段描述</p> <table><thead><tr><th>字段</th> <th>描述</th></tr></thead> <tbody><tr><td>action</td> <td>交易操作类型，取值范围是 ENUM_TRADE_REQUEST_ACTIONS 枚举值之一</td></tr> <tr><td>magic</td> <td>EA交易订单的ID。它允许组织分析处理交易订单。每个EA在发送交易请求时都可以设置自己独特的唯一识别魔术号ID。</td></tr> <tr><td>order</td> <td>订单编号。通常用于修改挂单。</td></tr> <tr><td>symbol</td> <td>订单的交易品种，不需要对订单进行修改和关闭平仓操作。</td></tr> <tr><td>volume</td> <td>交易请求订单的成交量(手数)，注意每笔订单的真实成交量取决于订单执行类型。</td></tr> <tr><td>price</td> <td>价格，订单执行必须达到的价格。交易品种的市场定单 ，即执行类型是“市场执行”TRADE_ACTION_DEAL类型的的订单(SYMBOL_TRADE_EXECUTION_MARKET)，不需要指定价格。</td></tr> <tr><td>stoplimit</td> <td>这里是一个 价格，当市场报价达到指定的 价格price 时(必要条件)，将放置一个限价挂单。在此之前，不挂单。</td></tr> <tr><td>sl</td> <td>在价格向不利的方向运动时，停止损失，平仓出场。即，止损</td></tr> <tr><td>tp</td> <td>在价格向有利的方向运动时，停止盈利，平仓出场。即，止盈</td></tr> <tr><td>deviation</td> <td>最大价格偏差范围，以 points 为单位指定</td></tr> <tr><td>type</td> <td>订单类型，取值范围是 ENUM_ORDER_TYPE枚举值之一</td></tr> <tr><td>type_filling</td> <td>订单成交量执行类型，取值范围是 ENUM_ORDER_TYPE_FILLING 枚举值之一</td></tr> <tr><td>type_time</td> <td>订单过期类型，取值范围是 ENUM_ORDER_TYPE_TIME 枚举值之一</td></tr> <tr><td>expiration</td> <td>订单过期时间（ORDER_TIME_SPECIFIED 类型的订单）</td></tr> <tr><td>comment</td> <td>订单注解文本</td></tr> <tr><td>position</td> <td>仓位的编号。当一个仓位被 修改 或 关闭一个确定的仓位时，将被填写。一般来说，它等于订单的编号，基于这个价位打开仓位。</td></tr> <tr><td>Position_by</td> <td>相反仓位的编号。当同一个 交易品种 中，一个仓位因一个相反方向的仓位打开，而被平仓时使用。</td></tr></tbody></table> <div class="language- line-numbers-mode"><pre class="language-text"><code>当在锁仓系统更改持仓或平仓时，要确保指明其单号(MqlTradeRequest::position)。而在单边系统，虽然是通过交易品种名称来确定持仓，也可以指明订单号。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>发送订单 执行 交易操作 需要使用 OrderSend() 函数。对于每个 交易操作 来说都需要指定强制字段；也需要填满可选字段。有7个可能的案例发送交易订单:</p> <p>请求执行
这是在 请求执行 模式下打开一个交易订单的指令(按请求的价格进行交易)。它需要指定以下9个字段:</p> <p>• action 执行
• symbol 交易品种
• volume 交易量
• price 价格
• sl止损水平
• tp 盈利水平
• deviation 误差
• type 类型
• type_filling 成交量(手数)类型</p> <p>也有可能指定“magic”和“comment” 字段的值</p> <p>立即执行
这是一个在 即时执行 模式下(按当前价格进行交易)打开一个交易订单的指令。它需要指定以下9个字段:</p> <p>• action 执行
• symbol 交易品种
• volume 交易量
• price 价格
• sl止损水平
• tp 盈利水平
• deviation 误差
• type 类型
• type_filling 成交量(手数)类型</p> <p>也有可能指定“magic”和“comment” 字段的值</p> <p>市场执行
这是一个在 市场执行 模式下打开一个交易订单的指令。它需要指定以下5个字段:</p> <p>• action 执行
• symbol 交易品种
• volume 交易量
• type 类型
• type_filling 成交量(手数)类型</p> <p>交换执行(外汇)</p> <p>这是一个在 交换执行(外汇) 模式中打开一个交易订单的指令。它需要指定以下5个字段:</p> <p>• action 执行
• symbol 交易品种
• volume 交易量
• type 类型
• type_filling 成交量(手数)类型</p> <p>也有可能指定“magic”和“comment” 字段的值</p> <p>TRADE_ACTION_DEAL交易操作打开 做多(Buy) 持仓 的示例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#define EXPERT_MAGIC 123456   // EA交易的唯一识别魔术号
//+------------------------------------------------------------------+
//| 打开买入持仓                           |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 声明并初始化交易请求和交易请求结果
   MqlTradeRequest request={0};
   MqlTradeResult  result={0};
//--- 请求的参数
   request.action = TRADE_ACTION_DEAL;  // 交易操作类型
   request.symbol = Symbol();       // 交易品种
   request.volume = 0.1;         // 0.1手交易量
   request.type  = ORDER_TYPE_BUY;   // 订单类型
   request.price = SymbolInfoDouble(Symbol(),SYMBOL_ASK); // 持仓价格
   request.deviation = 5;         // 允许价格偏差
   request.magic   = EXPERT_MAGIC;  // 订单唯一识别魔术号
//--- 发送请求
   if(!OrderSend(request,result))
      PrintFormat(&quot;OrderSend error %d&quot;,GetLastError()); // 如果不能发送请求，输出错误代码
//--- 操作信息
   PrintFormat(&quot;retcode=%u  deal=%I64u  order=%I64u&quot;,result.retcode,result.deal,result.order);
  }
//+------------------------------------------------------------------+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>TRADE_ACTION_DEAL交易操作打开 做空(Sell) 持仓 的示例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#define EXPERT_MAGIC 123456   // EA交易的唯一识别魔术号
//+------------------------------------------------------------------+
//| 打开卖出持仓                          |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 声明并初始化交易请求和交易请求结果
   MqlTradeRequest request={0};
   MqlTradeResult  result={0};
//--- 请求参数
   request.action   = TRADE_ACTION_DEAL;   // 交易操作类型
   request.symbol   = Symbol();       // 交易品种
   request.volume   = 0.2;          // 0.2 手交易量
   request.type    = ORDER_TYPE_SELL;   // 订单类型
   request.price   = SymbolInfoDouble(Symbol(),SYMBOL_BID); // 持仓价格
   request.deviation  =  5;   // 允许价格偏差
   request.magic = EXPERT_MAGIC;   // 订单唯一识别魔术号
//--- 发送请求
   if(!OrderSend(request,result))
      PrintFormat(&quot;OrderSend error %d&quot;,GetLastError()); // 如果不能发送请求，输出错误代码
//--- 操作信息
   PrintFormat(&quot;retcode=%u  deal=%I64u  order=%I64u&quot;,result.retcode,result.deal,result.order);
  }
//+------------------------------------------------------------------+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>平仓TRADE_ACTION_DEAL 交易操作的示例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#define EXPERT_MAGIC 123456   // EA交易的唯一识别魔术号
//+------------------------------------------------------------------+
//| 关闭全部持仓                          |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 声明并初始化交易请求和交易请求结果
   MqlTradeRequest request;
   MqlTradeResult  result;
   int total=PositionsTotal(); // 持仓数
//--- 重做所有持仓
   for(int i=total-1; i&gt;=0; i--)
     {
      //--- 订单的参数
      ulong  position_ticket=PositionGetTicket(i);  // 持仓价格
      string position_symbol=PositionGetString(POSITION_SYMBOL);  // 交易品种
      int    digits=(int)SymbolInfoInteger(position_symbol,SYMBOL_DIGITS);  // 小数位数
      ulong  magic=PositionGetInteger(POSITION_MAGIC); // 持仓的唯一识别魔术号
      double volume=PositionGetDouble(POSITION_VOLUME); // 持仓交易量
      ENUM_POSITION_TYPE type=(ENUM_POSITION_TYPE)PositionGetInteger(POSITION_TYPE); // 持仓类型
      //--- 输出持仓信息
      PrintFormat(&quot;#%I64u %s  %s  %.2f  %s [%I64d]&quot;,
                  position_ticket,
                  position_symbol,
                  EnumToString(type),
                  volume,
                  DoubleToString(PositionGetDouble(POSITION_PRICE_OPEN),digits),
                  magic);
      //--- 如果唯一识别魔术号匹配
      if(magic==EXPERT_MAGIC)
        {
         //--- 归零请求和结果值
         ZeroMemory(request);
         ZeroMemory(result);
         //--- 设置操作参数
         request.action   =TRADE_ACTION_DEAL;  // 交易操作类型
         request.position =position_ticket;   // 持仓价格
         request.symbol   =position_symbol;  // 交易品种
         request.volume   =volume;  // 持仓交易量
         request.deviation=5;  // 允许价格偏差
         request.magic    =EXPERT_MAGIC; // 持仓唯一识别魔术号
         //--- 根据持仓类型设置价格和订单类型
         if(type==POSITION_TYPE_BUY)
           {
            request.price=SymbolInfoDouble(position_symbol,SYMBOL_BID);
            request.type =ORDER_TYPE_SELL;
           }
         else
           {
            request.price=SymbolInfoDouble(position_symbol,SYMBOL_ASK);
            request.type =ORDER_TYPE_BUY;
           }
         //--- 输出关闭信息
         PrintFormat(&quot;Close #%I64d %s %s&quot;,position_ticket,position_symbol,EnumToString(type));
         //--- 发送请求
         if(!OrderSend(request,result))
            PrintFormat(&quot;OrderSend error %d&quot;,GetLastError()); // 如果不能发送请求，输出错误代码
         //--- 操作信息
       PrintFormat(&quot;retcode=%u  deal=%I64u  order=%I64u&quot;,result.retcode,result.deal,result.order);
         //---
        }
     }
  }
//+------------------------------------------------------------------+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br></div></div><p>SL &amp; TP修正</p> <p>交易订单在StopLoss 和/或 TakeProfit 价格上做修改，要求指定如下5个字段：
• action 执行
• symbol 交易品种
• sl 止损水平
• tp 盈利水平
• postition 仓位</p> <p>TRADE_ACTION_SLTP 交易操作更改持仓订单 止损 和 止赢 的示例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#define EXPERT_MAGIC 123456  // EA交易的唯一识别魔术号
//+------------------------------------------------------------------+
//| 更改持仓的止损和止赢                       |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 声明并初始化交易请求和交易请求结果
   MqlTradeRequest request;
   MqlTradeResult  result;
   int total=PositionsTotal(); // 持仓数
//--- 重做所有持仓
   for(int i=0; i&lt;total ; i++)
     {
      //--- 订单的参数
      ulong  position_ticket=PositionGetTicket(i);// 持仓价格
      string position_symbol=PositionGetString(POSITION_SYMBOL); // 交易品种
      int    digits=(int)SymbolInfoInteger(position_symbol,SYMBOL_DIGITS); // 小数位数
      ulong  magic=PositionGetInteger(POSITION_MAGIC); // 持仓的唯一识别魔术号
      double volume=PositionGetDouble(POSITION_VOLUME);  // 持仓交易量
      double sl=PositionGetDouble(POSITION_SL);  // 持仓止损
      double tp=PositionGetDouble(POSITION_TP);  // 持仓止赢
      ENUM_POSITION_TYPE type=(ENUM_POSITION_TYPE)PositionGetInteger(POSITION_TYPE); // 仓位的类型
      //--- 输出持仓信息
      PrintFormat(&quot;#%I64u %s  %s  %.2f  %s  sl: %s  tp: %s  [%I64d]&quot;,
                  position_ticket,
                  position_symbol,
                  EnumToString(type),
                  volume,
                  DoubleToString(PositionGetDouble(POSITION_PRICE_OPEN),digits),
                  DoubleToString(sl,digits),
                  DoubleToString(tp,digits),
                  magic);
      //--- 如果唯一识别魔术号匹配，不定义止损和止赢
      if(magic==EXPERT_MAGIC &amp;&amp; sl==0 &amp;&amp; tp==0)
        {
         //--- 计算当前价格水平
         double price=PositionGetDouble(POSITION_PRICE_OPEN);
         double bid=SymbolInfoDouble(position_symbol,SYMBOL_BID);
         double ask=SymbolInfoDouble(position_symbol,SYMBOL_ASK);
         int    stop_level=(int)SymbolInfoInteger(position_symbol,SYMBOL_TRADE_STOPS_LEVEL);
         double price_level;
         //--- 如果最小值被接受，那么当前平仓价的点数偏距不设置
         if(stop_level&lt;=0)
            stop_level=150; // 设置当前平仓价的150点偏距
         else
            stop_level+=50; // 为了可靠性而设置偏距到(SYMBOL_TRADE_STOPS_LEVEL + 50) 点

         //--- 计算并凑整止损和止赢值
         price_level=stop_level*SymbolInfoDouble(position_symbol,SYMBOL_POINT);
         if(type==POSITION_TYPE_BUY)
           {
            sl=NormalizeDouble(bid-price_level,digits);
            tp=NormalizeDouble(ask+price_level,digits);
           }
         else
           {
            sl=NormalizeDouble(ask+price_level,digits);
            tp=NormalizeDouble(bid-price_level,digits);
           }
         //--- 归零请求和结果值
         ZeroMemory(request);
         ZeroMemory(result);
         //--- 设置操作参数
         request.action  =TRADE_ACTION_SLTP; // 交易操作类型
         request.position=position_ticket;   // 持仓价格
         request.symbol=position_symbol;     // 交易品种
         request.sl      =sl;     // 持仓止损
         request.tp      =tp;      // 持仓止赢
         request.magic=EXPERT_MAGIC;    // 持仓的唯一识别魔术号
         //--- 输出更改信息
         PrintFormat(&quot;Modify #%I64d %s %s&quot;,position_ticket,position_symbol,EnumToString(type));
         //--- 发送请求
         if(!OrderSend(request,result))
            PrintFormat(&quot;OrderSend error %d&quot;,GetLastError());// 如果不能发送请求，输出错误代码
         //--- 操作信息
       PrintFormat(&quot;retcode=%u  deal=%I64u  order=%I64u&quot;,result.retcode,result.deal,result.order);
        }
     }
  }
//+------------------------------------------------------------------+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br></div></div><p>挂单</p> <p>交易操作放置一个挂单，要求指定如下11个字段：
• action 行动
• symbol 交易品种
• volume 交易量
• price 价格
• stoplimit 限制价格
• sl 止损
• tp 止盈
• type 类型
• type_filling 成交量(手数)类型
• type_time 过期时间类型
• expiration 过期时间</p> <p>也有可能指定“magic” 和“comment”域值。</p> <p>交易操作 TRADE_ACTION_PENDING 挂单的示例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#property description &quot;Example of placing pending orders&quot;
#property script_show_inputs
#define EXPERT_MAGIC 123456   // EA交易的唯一识别魔术号
input ENUM_ORDER_TYPE orderType=ORDER_TYPE_BUY_LIMIT;   // 订单类型
//+------------------------------------------------------------------+
//| 挂单                              |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 声明并初始化交易请求和交易请求结果
   MqlTradeRequest request={0};
   MqlTradeResult  result={0};
//--- 下挂单的参数
   request.action   =TRADE_ACTION_PENDING;   // 交易操作类型
   request.symbol   =Symbol();        // 交易品种
   request.volume   =0.1;          //0.1手交易量
   request.deviation=2;            // 允许价格偏差
   request.magic    =EXPERT_MAGIC;     // 订单唯一识别魔术号
   int offset = 50;            // 以点数从当前价抵消下单
   double price;              // 订单触动价
   double point=SymbolInfoDouble(_Symbol,SYMBOL_POINT);  // 交易品种 的点值
   int digits=SymbolInfoInteger(_Symbol,SYMBOL_DIGITS);  // 小数位数 (精确度)
   //--- 检查操作类型
   if(orderType==ORDER_TYPE_BUY_LIMIT)
     {
      request.type     =ORDER_TYPE_BUY_LIMIT;  // 订单类型
      price=SymbolInfoDouble(Symbol(),SYMBOL_ASK)-offset*point; // 持仓价格
      request.price    =NormalizeDouble(price,digits);    //正常开盘价
     }
   else if(orderType==ORDER_TYPE_SELL_LIMIT)
     {
      request.type     =ORDER_TYPE_SELL_LIMIT;  // 订单类型
      price=SymbolInfoDouble(Symbol(),SYMBOL_ASK)+offset*point;  // 持仓价
      request.price    =NormalizeDouble(price,digits);   // 正常开盘价
     }
   else if(orderType==ORDER_TYPE_BUY_STOP)
     {
      request.type =ORDER_TYPE_BUY_STOP;  // 订单类型
      price        =SymbolInfoDouble(Symbol(),SYMBOL_ASK)+offset*point; // 开盘价
      request.price=NormalizeDouble(price,digits);  // 正常开盘价
     }
   else if(orderType==ORDER_TYPE_SELL_STOP)
     {
      request.type     =ORDER_TYPE_SELL_STOP;  // 订单类型
      price=SymbolInfoDouble(Symbol(),SYMBOL_ASK)-offset*point; // 开盘价
      request.price    =NormalizeDouble(price,digits);   // 正常开盘价
     }
   else Alert(&quot;This example is only for placing pending orders&quot;);  // 如果没有挂单被选择
//--- 发送请求
   if(!OrderSend(request,result))
      PrintFormat(&quot;OrderSend error %d&quot;,GetLastError());  // 如果不能发送请求，输出错误代码
//--- 操作信息
   PrintFormat(&quot;retcode=%u  deal=%I64u  order=%I64u&quot;,result.retcode,result.deal,result.order);
  }
//+------------------------------------------------------------------+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br></div></div><p>修改挂单</p> <p>交易操作在修改挂单时，要求指定如下7个字段：
• action 行动
• order 订单
• price 价格
• sl 止损
• tp 止盈
• type_time 过期时间类型
• expiration 过期时间</p> <p>TRADE_ACTION_MODIFY 交易操作更改挂单价格的示例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#define EXPERT_MAGIC 123456  // EA交易的唯一识别魔术号
//+------------------------------------------------------------------+
//| 更改挂单                            |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 声明并初始化交易请求和交易请求结果
   MqlTradeRequest request={0};
   MqlTradeResult  result={0};
   int total=OrdersTotal(); // 已下挂单的总数
//--- 重做所有已下的挂单
   for(int i=0; i&lt;total; i++)
     {
      //--- 订单参数
      ulong  order_ticket=OrderGetTicket(i);  // 订单价格
      string order_symbol=Symbol();       // 交易品种
      int    digits=(int)SymbolInfoInteger(order_symbol,SYMBOL_DIGITS);  // 小数位数
      ulong  magic=OrderGetInteger(ORDER_MAGIC);  // 订单的幻数
      double volume=OrderGetDouble(ORDER_VOLUME_CURRENT);  // 订单的当前交易量
      double sl=OrderGetDouble(ORDER_SL);  // 订单的当前止损
      double tp=OrderGetDouble(ORDER_TP);  // 订单的当前止赢
      ENUM_ORDER_TYPE type=(ENUM_ORDER_TYPE)OrderGetInteger(ORDER_TYPE); // 订单类型
      int offset = 50;  // 以点数从当前价抵消下单
      double price;    // 订单触动价
      double point=SymbolInfoDouble(order_symbol,SYMBOL_POINT);  // 点值
      //--- 输出订单信息
      PrintFormat(&quot;#%I64u %s  %s  %.2f  %s  sl: %s  tp: %s  [%I64d]&quot;,
                  order_ticket,
                  order_symbol,
                  EnumToString(type),
                  volume,
                  DoubleToString(PositionGetDouble(POSITION_PRICE_OPEN),digits),
                  DoubleToString(sl,digits),
                  DoubleToString(tp,digits),
                  magic);
      //--- 如果幻数匹配，不定义止损和止赢
      if(magic==EXPERT_MAGIC &amp;&amp; sl==0 &amp;&amp; tp==0)
        {
         request.action = TRADE_ACTION_MODIFY;  // 交易操作类型
         request.order = OrderGetTicket(i);  // 订单价格
         request.symbol = Symbol();// 交易品种
request.deviation = 5;  // 允许价格偏差
        //--- 根据持仓类型设置价格水平，订单的止损和止赢
         if(type==ORDER_TYPE_BUY_LIMIT)
           {
            price = SymbolInfoDouble(Symbol(),SYMBOL_ASK)-offset*point;
            request.tp = NormalizeDouble(price+offset*point,digits);
            request.sl = NormalizeDouble(price-offset*point,digits);
            request.price    =NormalizeDouble(price,digits);  // 正常开盘价
           }
         else if(type==ORDER_TYPE_SELL_LIMIT)
           {
           price = SymbolInfoDouble(Symbol(),SYMBOL_BID)+offset*point;
            request.tp = NormalizeDouble(price-offset*point,digits);
            request.sl = NormalizeDouble(price+offset*point,digits);
            request.price    =NormalizeDouble(price,digits);  // 正常开盘价
           }
         else if(type==ORDER_TYPE_BUY_STOP)
           {
           price = SymbolInfoDouble(Symbol(),SYMBOL_BID)+offset*point;
            request.tp = NormalizeDouble(price+offset*point,digits);
            request.sl = NormalizeDouble(price-offset*point,digits);
            request.price    =NormalizeDouble(price,digits);  // 正常开盘价
           }
         else if(type==ORDER_TYPE_SELL_STOP)
           {
           price = SymbolInfoDouble(Symbol(),SYMBOL_ASK)-offset*point;
            request.tp = NormalizeDouble(price-offset*point,digits);
            request.sl = NormalizeDouble(price+offset*point,digits);
            request.price    =NormalizeDouble(price,digits);  // 正常开盘价
           }
         //--- 发送请求
         if(!OrderSend(request,result))
            PrintFormat(&quot;OrderSend error %d&quot;,GetLastError());// 如果不能发送请求，输出错误代码
         //--- 操作信息
       PrintFormat(&quot;retcode=%u  deal=%I64u  order=%I64u&quot;,result.retcode,result.deal,result.order);
         //--- 归零请求和结果值
         ZeroMemory(request);
         ZeroMemory(result);
        }
     }
  }
//+------------------------------------------------------------------+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br></div></div><p>删除挂单</p> <p>交易操作删除一个挂单，要求指定如下2个字段
• action 行动
• order 命令</p> <p>TRADE_ACTION_REMOVE 交易操作删除挂单的示例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#define EXPERT_MAGIC 123456  // EA交易的唯一识别魔术号
//+------------------------------------------------------------------+
//| 删除挂单                            |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- 声明并初始化交易请求和交易请求结果
   MqlTradeRequest request={0};
   MqlTradeResult  result={0};
   int total=OrdersTotal(); // 下挂单的总数
//--- 重做所有已下的挂单
   for(int i=total-1; i&gt;=0; i--)
     {
      ulong  order_ticket=OrderGetTicket(i);     // 订单编号
      ulong  magic=OrderGetInteger(ORDER_MAGIC);   // 订单的幻数
      //--- 如果唯一识别魔术号匹配
      if(magic==EXPERT_MAGIC)
        {
         //--- 归零请求和结果值
         ZeroMemory(request);
         ZeroMemory(result);
         //--- 设置持仓参数
         request.action=TRADE_ACTION_REMOVE;  // 交易操作的类型
         request.order = order_ticket;    // 订单价格
         //--- 发送请求
         if(!OrderSend(request,result))
            PrintFormat(&quot;OrderSend error %d&quot;,GetLastError()); // 如果不能发送请求，输出错误代码
         //--- 操作信息
       PrintFormat(&quot;retcode=%u  deal=%I64u  order=%I64u&quot;,result.retcode,result.deal,result.order);
        }
     }
  }
//+------------------------------------------------------------------+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p>相关参考
结构和类， 交易函数，订单属性</p> <h3 id="_2-7-6-mqltradecheckresult"><a href="#_2-7-6-mqltradecheckresult" class="header-anchor">#</a> 2.7.6 MqlTradeCheckResult</h3> <p>检查交易请求测试结果的结构......用于发送前自检。</p> <p>在向交易服务器发送交易请求操作之前，建议先检查一遍。执行检查可以使用OrderCheck()函数，检查请求后，将会传递一个 MqlTradeCheckResult结构类型的变量。检查结果将写入保存在这个变量中。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>struct MqlTradeCheckResult
  {
   uint         retcode;             // 回应码
   double       balance;             // 执行交易后的余额
   double       equity;              // 执行交易后的净值
   double       profit;              // 浮动盈利
   double       margin;              // 需求保证金
   double       margin_free;         // 自由保证金
   double       margin_level;        // 保证金比例水平
   string       comment;             // 回应码的注释(错误原因的描述)
  };
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>字段描述</p> <table><thead><tr><th>字段</th> <th>描述</th></tr></thead> <tbody><tr><td>retcode</td> <td>返回代码</td></tr> <tr><td>balance</td> <td>在执行交易操作后账户的余额</td></tr> <tr><td>equity</td> <td>在执行交易操作后帐户的净值</td></tr> <tr><td>profit</td> <td>在执行交易操作后的浮动利润</td></tr> <tr><td>margin</td> <td>为执行交易操作要求的保证金</td></tr> <tr><td>margin_free</td> <td>在执行交易操作后的可用保证金</td></tr> <tr><td>margin_level</td> <td>在执行交易操作后的保证金水平</td></tr> <tr><td>comment</td> <td>注解文本回应代码，描述错误原因</td></tr></tbody></table> <p>相关参考</p> <p>交易请求结构 ， 当前价格结构 ， 发送订单 ， 订单检测</p> <h3 id="_2-7-7-mqltraderesult"><a href="#_2-7-7-mqltraderesult" class="header-anchor">#</a> 2.7.7 MqlTradeResult</h3> <p>交易请求结果结构
作为一个交易请求的结果，交易服务器会返回有关交易请求处理结果的数据，作为一个特殊预定义的 结构MqlTradeResult类型。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>struct MqlTradeResult
  {
   uint     retcode;          // 操作返回码
   ulong    deal;             // 如果成交的话，这里是 交易单的编号
   ulong    order;            // 如果是放置订单成功，这里是挂单的编号
   double   volume;           // 交易量手数, 由平台确认
   double   price;            // 成交的价格, 由平台确认
   double   bid;              // 当前 Bid 价格
   double   ask;              // 当前 Ask 价格
   string   comment;          // 平台对这次交易操作的注释(默认情况下，是由交易服务器返回代码的描述)
   uint     request_id;       // 在调度期间由客户终端设置的请求ID。
   uint     retcode_external; // 外部交易系统的操作返回码
  };
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>字段描述</p> <table><thead><tr><th>字段</th> <th>描述</th></tr></thead> <tbody><tr><td>retcode</td> <td>交易服务器的返回代码</td></tr> <tr><td>deal</td> <td>交易编号，如果交易已执行，会产生一个 TRADE_ACTION_DEAL 类型的交易操作</td></tr> <tr><td>order</td> <td>订单编号，如果是放置订单，会产生一个 TRADE_ACTION_PENDING 类型的交易操作</td></tr> <tr><td>volume</td> <td>交易成交量，由平台商确认，取决于 订单成交量(手数)填充类型</td></tr> <tr><td>price</td> <td>订单价格，由平台商确认，取决于交易请求 和/或 交易操作的 deviation 字段</td></tr> <tr><td>bid</td> <td>当前市场Bid买入价（请求报价）</td></tr> <tr><td>ask</td> <td>当前市场Ask卖出价（请求报价）</td></tr> <tr><td>comment</td> <td>此次操作的平台注释文本（默认情况下，是由交易服务器返回代码的描述）</td></tr> <tr><td>request_id</td> <td>发送到交易服务器时，由客户终端设置的请求ID。</td></tr> <tr><td>retcode_external</td> <td>由外部交易系统返回的错误代码。当交易操作被发送后，这些错误代码的使用和类型取决于平台和外部交易系统。</td></tr></tbody></table> <p>交易操作结果返回到MqlTradeResult类型的变量，该变量作为第二个参数传递给OrderSend()以执行交易操作。</p> <p>当使用OrdersSend()和OrderSendAsync()函数将其发送到交易服务器时，客户终端在request_id字段中修复请求ID。终端接收来自交易服务器的执行事务的消息，并通过OnTradeTransaction()函数将其提交给处理，该函数包含以下组件作为参数:</p> <p>• MqlTradeTransaction结构中交易事务的描述;
• 从OrderSend()或OrdersSendAsync()函数发送的交易请求的描述。请求ID由客户终端发送到交易服务器，而请求本身及其request_id存储在客户终端的内存中;
• 交易请求执行结果为MqlTradeResult结构，其中包含该请求ID的request_id字段。</p> <p>OnTradeTransaction()函数接收三个输入参数，但最后两个参数只对具有TRADE_TRANSACTION_REQUEST类型的交易事务进行分析。在所有其他情况下，交易请求的数据和它的执行结果都没有填写。在交易请求的结构中可以找到参数分析的例子。</p> <p>在发送到服务器时，由客户终端为交易请求来设置request_id，主要是为使用OrderSendAsync()异步函数而引入的。这个标识符可以将执行的操作(OrderSend或OrderSendAsync函数调用)与发送给OnTradeTransaction()的结果关联起来。</p> <p>示例:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//+------------------------------------------------------------------+
//| 随着处理结果发送交易请求                                            |
//+------------------------------------------------------------------+
bool MyOrderSend(MqlTradeRequest request,MqlTradeResult result)
  {
//--- 重置最后一个错误代码为零
   ResetLastError();
//--- 发送请求
   bool success=OrderSend(request,result);
//--- 如果结果为失败----找出为什么
   if(!success)
     {
      int answer=result.retcode;
      Print(&quot;TradeLog: Trade request failed. Error = &quot;,GetLastError());
      switch(answer)
        {
         //--- 重新报价
         case 10004:
           {
            Print(&quot;TRADE_RETCODE_REQUOTE&quot;);
            Print(&quot;request.price = &quot;,request.price,&quot;   result.ask = &quot;,
                  result.ask,&quot; result.bid = &quot;,result.bid);
            break;
           }
         //--- 订单没有被服务器接受
         case 10006:
           {
            Print(&quot;TRADE_RETCODE_REJECT&quot;);
            Print(&quot;request.price = &quot;,request.price,&quot;   result.ask = &quot;,
                  result.ask,&quot; result.bid = &quot;,result.bid);
            break;
           }
         //--- 无效价格
         case 10015:
           {
            Print(&quot;TRADE_RETCODE_INVALID_PRICE&quot;);
            Print(&quot;request.price = &quot;,request.price,&quot;   result.ask = &quot;,
                  result.ask,&quot; result.bid = &quot;,result.bid);
            break;
           }
         //--- 无效 止损 和/或 止盈
         case 10016:
           {
            Print(&quot;TRADE_RETCODE_INVALID_STOPS&quot;);
            Print(&quot;request.sl = &quot;,request.sl,&quot; request.tp = &quot;,request.tp);
            Print(&quot;result.ask = &quot;,result.ask,&quot; result.bid = &quot;,result.bid);
            break;
           }
         //--- 无效交易量
         case 10014:
           {
            Print(&quot;TRADE_RETCODE_INVALID_VOLUME&quot;);
            Print(&quot;request.volume = &quot;,request.volume,&quot;   result.volume = &quot;,
                  result.volume);
            break;
           }
         //--- 无足够的钱进行交易操作
         case 10019:
           {
            Print(&quot;TRADE_RETCODE_NO_MONEY&quot;);
            Print(&quot;request.volume = &quot;,request.volume,&quot;   result.volume = &quot;,
                  result.volume,&quot;   result.comment = &quot;,result.comment);
            break;
           }
         //--- 一些其他的原因, 输出服务器响应码
         default:
           {
            Print(&quot;Other answer = &quot;,answer);
           }
        }
      //--- 返回false，通知交易请求的失败结果。
      return(false);
     }
//--- OrderSend() 返回值为 真 - 重复 answer
   return(true);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br></div></div><h3 id="_2-7-8-mqltradetransaction"><a href="#_2-7-8-mqltradetransaction" class="header-anchor">#</a> 2.7.8 MqlTradeTransaction</h3> <p>交易事务结构。</p> <p>当在交易账户上执行一些明确的操作时，它的状态会发生变化。这些操作包括：</p> <p>• 在客户端从任何MQL5应用使用 OrderSend 和 OrderSendAsync 函数发送交易请求及其进一步执行：
• 通过程序端图形界面发送交易请求及其进一步执行；
• 在服务器上激活挂单和止损订单；
• 在交易服务器上执行操作。</p> <p>这些操作的结果会执行以下交易事务：</p> <p>•处理交易请求；
•改变持仓订单；
•改变订单历史记录；
•改变交易历史记录；
•改变持仓。</p> <p>例如，当发送一个市场买入订单时，它会被处理，为账户创建相应的买入订单，然后执行订单并从持仓列表中移除，添加到历史订单，而相应的交易也会添加到历史记录并创建新的持仓。所有这些操作都是交易事务。</p> <p>在MQL5中提供了特殊的处理程序OnTradeTransaction()，以获取应用于帐户的交易事务。处理程序的第一个参数是描述交易事务的MqlTradeTransaction结构。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>struct MqlTradeTransaction
  {
   ulong                         deal;             // 交易编号
   ulong                         order;            // 订单编号
   string                        symbol;           // 交易品种 名称
   ENUM_TRADE_TRANSACTION_TYPE   type;             // 交易事务类型
   ENUM_ORDER_TYPE               order_type;       // 订单类型
   ENUM_ORDER_STATE              order_state;      // 订单状态
   ENUM_DEAL_TYPE                deal_type;        // 成交类型
   ENUM_ORDER_TYPE_TIME          time_type;        // 操作期内订单的类型
   datetime                      time_expiration;  // 订单过期时间
   double                        price;            // 价格
   double                        price_trigger;    // 限价追损订单激活价格
   double                        price_sl;         // 止损价格
   double                        price_tp;         // 止盈价格
   double                        volume;           // 交易量(手数)
   ulong                         position;         // 仓位编号
   ulong                         position_by;      // 反向仓位编号
  };
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>字段描述</p> <table><thead><tr><th>字段</th> <th>描述</th></tr></thead> <tbody><tr><td>deal</td> <td>交易单编号。</td></tr> <tr><td>order</td> <td>订单编号。</td></tr> <tr><td>symbol</td> <td>执行交易事务的 交易品种 的名称。</td></tr> <tr><td>type</td> <td>交易事务类型。取值范围是枚举型值 ENUM_TRADE_TRANSACTION_TYPE</td></tr> <tr><td>order_type</td> <td>交易订单类型。取值范围是枚举型值 ENUM_ORDER_TYPE</td></tr> <tr><td>order_state</td> <td>交易订单状态。取值范围是枚举型值 ENUM_ORDER_STATE</td></tr> <tr><td>deal_type</td> <td>成交类型。取值范围是枚举型值 ENUM_DEAL_TYPE</td></tr> <tr><td>type_time</td> <td>订单过期类型。取值范围是枚举型值 ENUM_ORDER_TYPE_TIME</td></tr> <tr><td>time_expiration</td> <td>挂单到期期限 (用于 ORDER_TIME_SPECIFIED 和 ORDER_TIME_SPECIFIED_DAY订单类型)。</td></tr> <tr><td>price</td> <td>价格。取决于 交易事务类型，它可能是订单价格，成交价格 或 仓位价格。</td></tr> <tr><td>price_trigger</td> <td>限价止损订单，止损（激活）价格 (ORDER_TYPE_BUY_STOP_LIMIT 和 ORDER_TYPE_SELL_STOP_LIMIT)。</td></tr> <tr><td>price_sl</td> <td>止损价。根据交易事务类型，它可能涉及订单，交易或持仓。</td></tr> <tr><td>price_tp</td> <td>止盈价。根据交易事务类型，它可能涉及订单，交易或持仓。</td></tr> <tr><td>volume</td> <td>交易量手数。根据交易事务类型，它可能涉及订单，交易或持仓的当前交易量。</td></tr> <tr><td>position</td> <td>被交易事务影响的仓位的编号</td></tr> <tr><td>position_by</td> <td>相反方向的仓位的编号。当以相反的方向关闭某一仓位时，即以相反方向打开的同一 交易品种 的仓位</td></tr></tbody></table> <p>接收 交易事务 分析的基本参数是在 type 字段中指定的类型。例如，如果一个 交易事务是TRADE_TRANSACTION_REQUEST类型(由服务器处理一个交易请求的结果)，那么该结构只有一个完全填充的字段 ---- type 。其他字段没有分析。在这种情况下，我们可以分析提交给OnTradeTransaction()处理程序的两个额外参数 request 和 result，如下所示。</p> <p>有了交易操作类型的数据，您可以决定对交易帐户的订单、仓位和交易的当前状态进行分析。记住，从客户终端发送到服务器的一个交易请求可以生成几个新的交易事务。他们到达终点站的优先权没有得到保证。</p> <p>根据交易类型(ENUM_TRADE_TRANSACTION_TYPE)， MqlTradeTransaction结构以不同的方式填充:</p> <p>TRADE_TRANSACTION_ORDER_* 和 TRADE_TRANSACTION_HISTORY_*</p> <p>填充MqlTradeTransaction结构中的以下字段，其中处理持有开放订单相关的有TRADE_TRANSACTION_ORDER_ADD,<br>
TRADE_TRANSACTION_ORDER_UPDATE,<br>
TRADE_TRANSACTION_ORDER_DELETE<br></p> <p>处理历史订单的有
TRADE_TRANSACTION_HISTORY_ADD,<br>
TRADE_TRANSACTION_HISTORY_UPDATE,<br>
TRADE_TRANSACTION_HISTORY_DELETE<br></p> <p>• order ---- 订单编号;
• symbol ---- 订单 交易品种 的名称。
• type ---- 交易事务的类型;
• order_type ---- 订单类型;
• orders_state ---- 订单当前状态;
• time_type ---- 订单过期类型;
• time_expiration ---- 订单过期时间(用于 ORDER_TIME_SPECIFIED 和 ORDER_TIME_SPECIFIED_DAY 过期类型);
• price ---- 由客户端指定的订单价格;
• price_trigger ---- 限价止损订单的止损价格 (仅用于 ORDER_TYPE_BUY_STOP_LIMIT 和 ORDER_TYPE_SELL_STOP_LIMIT);
• price_sl ---- 订单止损价格 (填写,如果在订单中已指明);
• price_tp ---- 订单止盈价格 (填写,如果在订单中已指明);
• volume ---- 订单当前成交量手数 (未执行成交的手数).订单的初始交易量可以使用 HistoryOrders* 函数在历史订单中找到。
• position ----由于执行打开、修改或关闭订单而影响的仓位的编号。它只用于成交市场订单，而不是成交TRADE_TRANSACTION_ORDER_ADD
• position_by ---- the ticket of the opposite position. It is only filled for the close by orders (to close a position by an opposite one).相反仓位的编号。只用于成交平仓订单(用一个相反的仓位关闭一个仓位)。</p> <p>TRADE_TRANSACTION_DEAL_*</p> <p>填充MqlTradeTransaction结构的以下字段用于交易相关的交易事务，处理 TRADE_TRANSACTION_DEAL_ADD,<br>
TRADE_TRANSACTION_DEAL_UPDATE <br>
TRADE_TRANSACTION_DEAL_DELETE：</p> <p>• deal ---- 交易编号；
• order ---- 订单编号，基于已执行的交易；
• symbol ---- 交易品种名称；
• type ---- 交易事务类型；
• deal_type ---- 交易类型；
• price ---- 交易价格；
• price_sl ---- 止损价（填写，在订单中指定的，根据已执行的交易而填写）；
• price_tp ---- 获利价（填写，在订单中指定的，根据已执行的交易而填写）；
• volume ---- 交易量手数。
• position ----由于执行打开、修改或关闭订单而影响的仓位的编号。它只用于成交市场订单，而不是成交TRADE_TRANSACTION_ORDER_ADD
• position_by ---- the ticket of the opposite position. It is only filled for the close by orders (to close a position by an opposite one).相反仓位的编号。只用于成交平仓订单(用一个相反的仓位关闭一个仓位)。</p> <p>TRADE_TRANSACTION_POSITION</p> <p>填充 MqlTradeTransaction 结构的以下字段用于改变与执行交易 (TRADE_TRANSACTION_POSITION) 无关联的持仓的相关交易事务：</p> <p>• symbol ---- 仓位 交易品种 名称；
• type ---- 交易事务类型；
• deal_type ---- 持仓类型(DEAL_TYPE_BUY 或DEAL_TYPE_SELL)；
• price ---- 仓位加权平均持仓价；
• price_sl ---- 止损价；
• price_tp ---- 止盈价；
• volume ---- 仓位持仓交易量手数，如果已经改变。</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>仓位改变（添加，修改 或 关闭订单），如执行交易的结果，不会导致发生TRADE_TRANSACTION_POSITION 交易事务。</p></div> <p>TRADE_TRANSACTION_REQUEST</p> <p>在MqlTradeTransaction结构中，只填充一个字段用于描述交易请求已被服务器处理的交易事务，并收到了处理结果(TRADE_TRANSACTION_REQUEST):</p> <p>• type ---- 交易事务类型；</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>只有 type 字段(交易事务类型)必须对此类事务进行分析。必须对OnTradeTransaction函数的第二个和第三个参数(request 和 result)进行分析，以获得额外的数据。</p></div> <p>示例</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>input <span class="token keyword">int</span> MagicNumber<span class="token operator">=</span><span class="token number">1234567</span><span class="token punctuation">;</span>

<span class="token comment">//--- 启用CTrade 交易类并声明这种类的变量</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;Trade /Trade.mqh &gt;</span></span>
CTrade trade<span class="token punctuation">;</span>
<span class="token comment">//--- 安装和删除挂单的标识</span>
<span class="token keyword">bool</span> pending_done<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token keyword">bool</span> pending_deleted<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token comment">//--- 挂单将被存储在这里</span>
ulong order_ticket<span class="token punctuation">;</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| EA初始化函数                                                      |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">int</span> <span class="token function">OnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 设置MagicNumber 标记EA的所有订单</span>
   trade<span class="token punctuation">.</span><span class="token function">SetExpertMagicNumber</span><span class="token punctuation">(</span>MagicNumber<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 交易请求将通过OrderSendAsync() 函数以非同步的模式发送</span>
   trade<span class="token punctuation">.</span><span class="token function">SetAsyncMode</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//--- 初始化变量为零</span>
   order_ticket<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token comment">//---</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span>INIT_SUCCEEDED<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| EA订单函数                                                        |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">OnTick</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//---安装挂单</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>pending_done<span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token keyword">double</span> ask<span class="token operator">=</span><span class="token function">SymbolInfoDouble</span><span class="token punctuation">(</span>_Symbol<span class="token punctuation">,</span>SYMBOL_ASK<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">double</span> buy_stop_price<span class="token operator">=</span><span class="token function">NormalizeDouble</span><span class="token punctuation">(</span>ask<span class="token operator">+</span><span class="token number">1000</span><span class="token operator">*</span>_Point<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token function">SymbolInfoInteger</span><span class="token punctuation">(</span>_Symbol<span class="token punctuation">,</span>SYMBOL_DIGITS<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">bool</span> res<span class="token operator">=</span>trade<span class="token punctuation">.</span><span class="token function">BuyStop</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">,</span>buy_stop_price<span class="token punctuation">,</span>_Symbol<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 如果BuyStop()函数成功执行</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
         pending_done<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>
         <span class="token comment">//--- 获取从ctrade发送的请求的结果</span>
         MqlTradeResult trade_result<span class="token punctuation">;</span>
         trade<span class="token punctuation">.</span><span class="token function">Result</span><span class="token punctuation">(</span>trade_result<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token comment">//--- 获得发送请求的request_id</span>
         uint request_id<span class="token operator">=</span>trade_result<span class="token punctuation">.</span>request_id<span class="token punctuation">;</span>
         <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Request has been sent to set a pending order. Request_ID=&quot;</span><span class="token punctuation">,</span>request_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token comment">//--- 存储订单 (如果使用非同步模式发送到CTrade，则将为零)</span>
         order_ticket<span class="token operator">=</span>trade_result<span class="token punctuation">.</span>order<span class="token punctuation">;</span>
         <span class="token comment">//--- 全部完成后，提前从OnTick() 处理程序退出</span>
         <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
<span class="token comment">//--- 删除挂单</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>pending_deleted<span class="token punctuation">)</span>
      <span class="token comment">//--- 附加检查</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>pending_done <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>order_ticket<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
         <span class="token comment">//--- 尝试删除挂单</span>
         <span class="token keyword">bool</span> res<span class="token operator">=</span>trade<span class="token punctuation">.</span><span class="token function">OrderDelete</span><span class="token punctuation">(</span>order_ticket<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;OrderDelete=&quot;</span><span class="token punctuation">,</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token comment">//--- 删除请求发送成功</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
           <span class="token punctuation">{</span>
            pending_deleted<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token comment">//--- 得到请求执行结果</span>
            MqlTradeResult trade_result<span class="token punctuation">;</span>
            trade<span class="token punctuation">.</span><span class="token function">Result</span><span class="token punctuation">(</span>trade_result<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//--- 获得来自结果的 request ID</span>
            uint request_id<span class="token operator">=</span>trade_result<span class="token punctuation">.</span>request_id<span class="token punctuation">;</span>
            <span class="token comment">//--- 在日志中显示</span>
            <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;The request has been sent to delete a pending order #&quot;</span><span class="token punctuation">,</span>order_ticket<span class="token punctuation">,</span>
                  <span class="token string">&quot;. Request_ID=&quot;</span><span class="token punctuation">,</span>request_id<span class="token punctuation">,</span>
                  <span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//--- 修正来自请求结果的订单</span>
            order_ticket<span class="token operator">=</span>trade_result<span class="token punctuation">.</span>order<span class="token punctuation">;</span>
           <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
<span class="token comment">//---</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| TradeTransaction 函数                                            |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token keyword">void</span> <span class="token function">OnTradeTransaction</span><span class="token punctuation">(</span><span class="token keyword">const</span> MqlTradeTransaction <span class="token operator">&amp;</span>trans<span class="token punctuation">,</span>
                        <span class="token keyword">const</span> MqlTradeRequest <span class="token operator">&amp;</span>request<span class="token punctuation">,</span>
                        <span class="token keyword">const</span> MqlTradeResult <span class="token operator">&amp;</span>result<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//--- 获取事务类型作为枚举值</span>
   ENUM_TRADE_TRANSACTION_TYPE type<span class="token operator">=</span><span class="token punctuation">(</span>ENUM_TRADE_TRANSACTION_TYPE<span class="token punctuation">)</span>trans<span class="token punctuation">.</span>type<span class="token punctuation">;</span>
<span class="token comment">//--- 如果事务是请求处理结果，那么只显示它的名称</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>type<span class="token operator">==</span>TRADE_TRANSACTION_REQUEST<span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token function">EnumToString</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 显示已处理的 request 字符串名称</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;------------RequestDescription\r\n&quot;</span><span class="token punctuation">,</span><span class="token function">RequestDescription</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 显示request 结果描述</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;------------ResultDescription\r\n&quot;</span><span class="token punctuation">,</span><span class="token function">TradeResultDescription</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//--- 存储用于下一个OnTick()处理的删除的订单</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>order<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
         <span class="token comment">//--- 通过在next OnTick() 调用的标识删除该订单</span>
         order_ticket<span class="token operator">=</span>result<span class="token punctuation">.</span>order<span class="token punctuation">;</span>
         <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot; Pending order ticket &quot;</span><span class="token punctuation">,</span>order_ticket<span class="token punctuation">,</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
   <span class="token keyword">else</span> <span class="token comment">// 显示另一事务类型的完整描述</span>
<span class="token comment">//--- 在日志中显示已接收事务的描述</span>
      <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;------------TransactionDescription\r\n&quot;</span><span class="token punctuation">,</span><span class="token function">TransactionDescription</span><span class="token punctuation">(</span>trans<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//---</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 返回事务文本描述                                                   |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
string <span class="token function">TransactionDescription</span><span class="token punctuation">(</span><span class="token keyword">const</span> MqlTradeTransaction <span class="token operator">&amp;</span>trans<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//---</span>
   string desc<span class="token operator">=</span><span class="token function">EnumToString</span><span class="token punctuation">(</span>trans<span class="token punctuation">.</span>type<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
   desc<span class="token operator">+=</span><span class="token string">&quot;Symbol: &quot;</span><span class="token operator">+</span>trans<span class="token punctuation">.</span>symbol<span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
   desc<span class="token operator">+=</span><span class="token string">&quot;Deal ticket: &quot;</span><span class="token operator">+</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span>trans<span class="token punctuation">.</span>deal<span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
   desc<span class="token operator">+=</span><span class="token string">&quot;Deal type: &quot;</span><span class="token operator">+</span><span class="token function">EnumToString</span><span class="token punctuation">(</span>trans<span class="token punctuation">.</span>deal_type<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
   desc<span class="token operator">+=</span><span class="token string">&quot;Order ticket: &quot;</span><span class="token operator">+</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span>trans<span class="token punctuation">.</span>order<span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
   desc<span class="token operator">+=</span><span class="token string">&quot;Order type: &quot;</span><span class="token operator">+</span><span class="token function">EnumToString</span><span class="token punctuation">(</span>trans<span class="token punctuation">.</span>order_type<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
   desc<span class="token operator">+=</span><span class="token string">&quot;Order state: &quot;</span><span class="token operator">+</span><span class="token function">EnumToString</span><span class="token punctuation">(</span>trans<span class="token punctuation">.</span>order_state<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
   desc<span class="token operator">+=</span><span class="token string">&quot;Order time type: &quot;</span><span class="token operator">+</span><span class="token function">EnumToString</span><span class="token punctuation">(</span>trans<span class="token punctuation">.</span>time_type<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
   desc<span class="token operator">+=</span><span class="token string">&quot;Order expiration: &quot;</span><span class="token operator">+</span><span class="token function">TimeToString</span><span class="token punctuation">(</span>trans<span class="token punctuation">.</span>time_expiration<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
   desc<span class="token operator">+=</span><span class="token string">&quot;Price: &quot;</span><span class="token operator">+</span><span class="token function">StringFormat</span><span class="token punctuation">(</span><span class="token string">&quot;%G&quot;</span><span class="token punctuation">,</span>trans<span class="token punctuation">.</span>price<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
   desc<span class="token operator">+=</span><span class="token string">&quot;Price trigger: &quot;</span><span class="token operator">+</span><span class="token function">StringFormat</span><span class="token punctuation">(</span><span class="token string">&quot;%G&quot;</span><span class="token punctuation">,</span>trans<span class="token punctuation">.</span>price_trigger<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
   desc<span class="token operator">+=</span><span class="token string">&quot;Stop Loss: &quot;</span><span class="token operator">+</span><span class="token function">StringFormat</span><span class="token punctuation">(</span><span class="token string">&quot;%G&quot;</span><span class="token punctuation">,</span>trans<span class="token punctuation">.</span>price_sl<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
   desc<span class="token operator">+=</span><span class="token string">&quot;Take Profit: &quot;</span><span class="token operator">+</span><span class="token function">StringFormat</span><span class="token punctuation">(</span><span class="token string">&quot;%G&quot;</span><span class="token punctuation">,</span>trans<span class="token punctuation">.</span>price_tp<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
   desc<span class="token operator">+=</span><span class="token string">&quot;Volume: &quot;</span><span class="token operator">+</span><span class="token function">StringFormat</span><span class="token punctuation">(</span><span class="token string">&quot;%G&quot;</span><span class="token punctuation">,</span>trans<span class="token punctuation">.</span>volume<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
<span class="token comment">//--- 返回获得的字符串</span>
   <span class="token keyword">return</span> desc<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 返回交易请求文本描述                                                |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
string <span class="token function">RequestDescription</span><span class="token punctuation">(</span><span class="token keyword">const</span> MqlTradeRequest <span class="token operator">&amp;</span>request<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//---</span>
   string desc<span class="token operator">=</span><span class="token function">EnumToString</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>action<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
   desc<span class="token operator">+=</span><span class="token string">&quot;Symbol: &quot;</span><span class="token operator">+</span>request<span class="token punctuation">.</span>symbol<span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
   desc<span class="token operator">+=</span><span class="token string">&quot;Magic Number: &quot;</span><span class="token operator">+</span><span class="token function">StringFormat</span><span class="token punctuation">(</span><span class="token string">&quot;%d&quot;</span><span class="token punctuation">,</span>request<span class="token punctuation">.</span>magic<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
   desc<span class="token operator">+=</span><span class="token string">&quot;Order ticket: &quot;</span><span class="token operator">+</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span>request<span class="token punctuation">.</span>order<span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
   desc<span class="token operator">+=</span><span class="token string">&quot;Order type: &quot;</span><span class="token operator">+</span><span class="token function">EnumToString</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>type<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
   desc<span class="token operator">+=</span><span class="token string">&quot;Order filling: &quot;</span><span class="token operator">+</span><span class="token function">EnumToString</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>type_filling<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
   desc<span class="token operator">+=</span><span class="token string">&quot;Order time type: &quot;</span><span class="token operator">+</span><span class="token function">EnumToString</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>type_time<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
   desc<span class="token operator">+=</span><span class="token string">&quot;Order expiration: &quot;</span><span class="token operator">+</span><span class="token function">TimeToString</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>expiration<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
   desc<span class="token operator">+=</span><span class="token string">&quot;Price: &quot;</span><span class="token operator">+</span><span class="token function">StringFormat</span><span class="token punctuation">(</span><span class="token string">&quot;%G&quot;</span><span class="token punctuation">,</span>request<span class="token punctuation">.</span>price<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
   desc<span class="token operator">+=</span><span class="token string">&quot;Deviation points: &quot;</span><span class="token operator">+</span><span class="token function">StringFormat</span><span class="token punctuation">(</span><span class="token string">&quot;%G&quot;</span><span class="token punctuation">,</span>request<span class="token punctuation">.</span>deviation<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
   desc<span class="token operator">+=</span><span class="token string">&quot;Stop Loss: &quot;</span><span class="token operator">+</span><span class="token function">StringFormat</span><span class="token punctuation">(</span><span class="token string">&quot;%G&quot;</span><span class="token punctuation">,</span>request<span class="token punctuation">.</span>sl<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
   desc<span class="token operator">+=</span><span class="token string">&quot;Take Profit: &quot;</span><span class="token operator">+</span><span class="token function">StringFormat</span><span class="token punctuation">(</span><span class="token string">&quot;%G&quot;</span><span class="token punctuation">,</span>request<span class="token punctuation">.</span>tp<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
   desc<span class="token operator">+=</span><span class="token string">&quot;Stop Limit: &quot;</span><span class="token operator">+</span><span class="token function">StringFormat</span><span class="token punctuation">(</span><span class="token string">&quot;%G&quot;</span><span class="token punctuation">,</span>request<span class="token punctuation">.</span>stoplimit<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
   desc<span class="token operator">+=</span><span class="token string">&quot;Volume: &quot;</span><span class="token operator">+</span><span class="token function">StringFormat</span><span class="token punctuation">(</span><span class="token string">&quot;%G&quot;</span><span class="token punctuation">,</span>request<span class="token punctuation">.</span>volume<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
   desc<span class="token operator">+=</span><span class="token string">&quot;Comment: &quot;</span><span class="token operator">+</span>request<span class="token punctuation">.</span>comment<span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
<span class="token comment">//--- 返回获得的字符串</span>
   <span class="token keyword">return</span> desc<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
<span class="token comment">//| 返回请求处理结果的文本描述                                           |</span>
<span class="token comment">//+------------------------------------------------------------------+</span>
string <span class="token function">TradeResultDescription</span><span class="token punctuation">(</span><span class="token keyword">const</span> MqlTradeResult <span class="token operator">&amp;</span>result<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
<span class="token comment">//---</span>
   string desc<span class="token operator">=</span><span class="token string">&quot;Retcode &quot;</span><span class="token operator">+</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span>result<span class="token punctuation">.</span>retcode<span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
   desc<span class="token operator">+=</span><span class="token string">&quot;Request ID: &quot;</span><span class="token operator">+</span><span class="token function">StringFormat</span><span class="token punctuation">(</span><span class="token string">&quot;%d&quot;</span><span class="token punctuation">,</span>result<span class="token punctuation">.</span>request_id<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
   desc<span class="token operator">+=</span><span class="token string">&quot;Order ticket: &quot;</span><span class="token operator">+</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span>result<span class="token punctuation">.</span>order<span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
   desc<span class="token operator">+=</span><span class="token string">&quot;Deal ticket: &quot;</span><span class="token operator">+</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span>result<span class="token punctuation">.</span>deal<span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
   desc<span class="token operator">+=</span><span class="token string">&quot;Volume: &quot;</span><span class="token operator">+</span><span class="token function">StringFormat</span><span class="token punctuation">(</span><span class="token string">&quot;%G&quot;</span><span class="token punctuation">,</span>result<span class="token punctuation">.</span>volume<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
   desc<span class="token operator">+=</span><span class="token string">&quot;Price: &quot;</span><span class="token operator">+</span><span class="token function">StringFormat</span><span class="token punctuation">(</span><span class="token string">&quot;%G&quot;</span><span class="token punctuation">,</span>result<span class="token punctuation">.</span>price<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
   desc<span class="token operator">+=</span><span class="token string">&quot;Ask: &quot;</span><span class="token operator">+</span><span class="token function">StringFormat</span><span class="token punctuation">(</span><span class="token string">&quot;%G&quot;</span><span class="token punctuation">,</span>result<span class="token punctuation">.</span>ask<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
   desc<span class="token operator">+=</span><span class="token string">&quot;Bid: &quot;</span><span class="token operator">+</span><span class="token function">StringFormat</span><span class="token punctuation">(</span><span class="token string">&quot;%G&quot;</span><span class="token punctuation">,</span>result<span class="token punctuation">.</span>bid<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
   desc<span class="token operator">+=</span><span class="token string">&quot;Comment: &quot;</span><span class="token operator">+</span>result<span class="token punctuation">.</span>comment<span class="token operator">+</span><span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">;</span>
<span class="token comment">//--- 返回获得的字符串</span>
   <span class="token keyword">return</span> desc<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br></div></div><p>相关参考</p> <p>交易事务类型，OnTradeTransaction()</p> <h3 id="_2-7-9-mqltick"><a href="#_2-7-9-mqltick" class="header-anchor">#</a> 2.7.9 MqlTick</h3> <p>返回当前价格的结构。</p> <p>这是一种存储最新价格的结构。它是为快速检索当前价格的最需要的信息而设计的。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">struct</span> <span class="token class-name">MqlTick</span>
  <span class="token punctuation">{</span>
   datetime     time<span class="token punctuation">;</span>          <span class="token comment">// 价格更新的最后时间</span>
   <span class="token keyword">double</span>       bid<span class="token punctuation">;</span>           <span class="token comment">// 当前买入价Bid</span>
   <span class="token keyword">double</span>       ask<span class="token punctuation">;</span>           <span class="token comment">// 当前卖出价Ask</span>
   <span class="token keyword">double</span>       last<span class="token punctuation">;</span>          <span class="token comment">// 上一次的交易价格 (Last)</span>
   ulong        volume<span class="token punctuation">;</span>        <span class="token comment">// 上一次价格交易量</span>
   <span class="token keyword">long</span>         time_msc<span class="token punctuation">;</span>      <span class="token comment">// 价格更新的最后时间,单位:毫秒</span>
   uint         flags          <span class="token comment">// 报价标帜</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>MqlTick类型的变量允许在SymbolInfoTick()函数的单个调用中获取Ask、Bid、Last和Volume的值。</p> <p>无论与之前报价相比是否有变化都会填充每个报价参数。因此，可以找出过去任何时刻的正确价格，无需在报价历史中搜索之前的值。例如，即使报价到达期间只有 Ask 变化，该结构仍然包含其他参数，包括之前的Ask price、volume等等。</p> <p>您可以分析报价标帜，找出具体更改了哪个数据：
• TICK_FLAG_BID —— 跳价更新了 Bid
• TICK_FLAG_ASK —— 跳价更新了 Ask
• TICK_FLAG_LAST —— 跳价更新了最终成交价 Last
• TICK_FLAG_VOLUME —— 跳价更新了交易量
• TICK_FLAG_BUY —— 跳价是 做多交易 的结果
• TICK_FLAG_SELL —— 跳价是 做空交易 的结果</p> <p>示例:</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token function">OnTick</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
   MqlTick last_tick<span class="token punctuation">;</span>
<span class="token comment">//---</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">SymbolInfoTick</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>last_tick<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      <span class="token function">Print</span><span class="token punctuation">(</span>last_tick<span class="token punctuation">.</span>time<span class="token punctuation">,</span><span class="token string">&quot;: Bid = &quot;</span><span class="token punctuation">,</span>last_tick<span class="token punctuation">.</span>bid<span class="token punctuation">,</span>
            <span class="token string">&quot; Ask = &quot;</span><span class="token punctuation">,</span>last_tick<span class="token punctuation">.</span>ask<span class="token punctuation">,</span><span class="token string">&quot;  Volume = &quot;</span><span class="token punctuation">,</span>last_tick<span class="token punctuation">.</span>volume<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
   <span class="token keyword">else</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;SymbolInfoTick() failed, error = &quot;</span><span class="token punctuation">,</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//---</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>相关参考</p> <p>结构和类, CopyTicks(), SymbolInfoTick()</p> <h2 id="_2-8-错误和警告代码"><a href="#_2-8-错误和警告代码" class="header-anchor">#</a> 2.8 错误和警告代码</h2> <p>本章内容包括如下描述：</p> <p>• 交易服务器返回的错误代码 —— 分析通过OrderSend() 函数发送的交易请求的结果；
• 编辑器警告 —— 在编辑器中出现的警告信息代码（不是错误代码）；
• 编译错误 —— 尝试编译失败后的错误信息代码；
• 运行时间(Runtime errors)错误 —— MQL5程序的属性错误代码，可以通过使用 GetLastError() 函数获得。</p> <h3 id="_2-8-1-交易服务器返回代码"><a href="#_2-8-1-交易服务器返回代码" class="header-anchor">#</a> 2.8.1 交易服务器返回代码</h3> <p>所有执行交易操作的请求都是使用OrderSend()函数作为MqlTradeRequest 结构来发送的。
函数执行结果被放置到结构MqlTradeResult中，字段retcode中包含交易服务器返回的代码。</p> <p>ENUM_TRADE_RETURN_CODES</p> <table><thead><tr><th>代码</th> <th>常量</th> <th>描述</th></tr></thead> <tbody><tr><td>10004</td> <td>TRADE_RETCODE_REQUOTE</td> <td>重新报价</td></tr> <tr><td>10006</td> <td>TRADE_RETCODE_REJECT</td> <td>拒绝请求</td></tr> <tr><td>10007</td> <td>TRADE_RETCODE_CANCEL</td> <td>交易者取消请求</td></tr> <tr><td>10008</td> <td>TRADE_RETCODE_PLACED</td> <td>放置订单</td></tr> <tr><td>10009</td> <td>TRADE_RETCODE_DONE</td> <td>交易请求完成</td></tr> <tr><td>10010</td> <td>TRADE_RETCODE_DONE_PARTIAL</td> <td>交易请求部分成交完成</td></tr> <tr><td>10011</td> <td>TRADE_RETCODE_ERROR</td> <td>请求处理错误</td></tr> <tr><td>10012</td> <td>TRADE_RETCODE_TIMEOUT</td> <td>请求超时，已被取消</td></tr> <tr><td>10013</td> <td>TRADE_RETCODE_INVALID</td> <td>无效请求</td></tr> <tr><td>10014</td> <td>TRADE_RETCODE_INVALID_VOLUME</td> <td>无效成交量(手数)</td></tr> <tr><td>10015</td> <td>TRADE_RETCODE_INVALID_PRICE</td> <td>无效价格</td></tr> <tr><td>10016</td> <td>TRADE_RETCODE_INVALID_STOPS</td> <td>无效止损</td></tr> <tr><td>10017</td> <td>TRADE_RETCODE_TRADE_DISABLED</td> <td>禁止交易</td></tr> <tr><td>10018</td> <td>TRADE_RETCODE_MARKET_CLOSED</td> <td>休市</td></tr> <tr><td>10019</td> <td>TRADE_RETCODE_NO_MONEY</td> <td>没有足够的钱实现交易请求</td></tr> <tr><td>10020</td> <td>TRADE_RETCODE_PRICE_CHANGED</td> <td>价格已改变</td></tr> <tr><td>10021</td> <td>TRADE_RETCODE_PRICE_OFF</td> <td>没有报价来处理交易请求</td></tr> <tr><td>10022</td> <td>TRADE_RETCODE_INVALID_EXPIRATION</td> <td>订单过期时间无效</td></tr> <tr><td>10023</td> <td>TRADE_RETCODE_ORDER_CHANGED</td> <td>订单状态改变</td></tr> <tr><td>10024</td> <td>TRADE_RETCODE_TOO_MANY_REQUESTS</td> <td>太频繁的交易请求</td></tr> <tr><td>10025</td> <td>TRADE_RETCODE_NO_CHANGES</td> <td>没有更改交易请求</td></tr> <tr><td>10026</td> <td>TRADE_RETCODE_SERVER_DISABLES_AT</td> <td>服务器禁止自动交易</td></tr> <tr><td>10027</td> <td>TRADE_RETCODE_CLIENT_DISABLES_AT</td> <td>客户端禁止自动交易</td></tr> <tr><td>10028</td> <td>TRADE_RETCODE_LOCKED</td> <td>处理锁定交易请求</td></tr> <tr><td>10029</td> <td>TRADE_RETCODE_FROZEN</td> <td>冻结订单 或 放置订单</td></tr> <tr><td>10030</td> <td>TRADE_RETCODE_INVALID_FILL</td> <td>无效的成交量(手数)类型</td></tr> <tr><td>10031</td> <td>TRADE_RETCODE_CONNECTION</td> <td>与服务器断开无连接</td></tr> <tr><td>10032</td> <td>TRADE_RETCODE_ONLY_REAL</td> <td>仅允许实盘帐户操作</td></tr> <tr><td>10033</td> <td>TRADE_RETCODE_LIMIT_ORDERS</td> <td>挂单数量达到限制</td></tr> <tr><td>10034</td> <td>TRADE_RETCODE_LIMIT_VOLUME</td> <td>订单成交量 和 交易品种 订单数量达到限制</td></tr> <tr><td>10035</td> <td>TRADE_RETCODE_INVALID_ORDER</td> <td>错误或禁止的 订单类型</td></tr> <tr><td>10036</td> <td>TRADE_RETCODE_POSITION_CLOSED</td> <td>指定 POSITION_IDENTIFIER的持仓订单已关闭</td></tr> <tr><td>10038</td> <td>TRADE_RETCODE_INVALID_CLOSE_VOLUME</td> <td>平仓交易量(手数)超出当前持仓交易量(手数)</td></tr> <tr><td>10039</td> <td>TRADE_RETCODE_CLOSE_ORDER_EXIST</td> <td>已经存在一个指定仓位的平仓订单。这种情况可能发生在对冲系统中: • 当试图以相反订单的方式关闭某一仓位时，该仓位的平仓订单已经存在。 • 当试图完全或部分关闭一个仓位时，如果已经存在的订单的总量和新放置的订单量超过了当前的仓位成交量(手数)。</td></tr> <tr><td>10040</td> <td>TRADE_RETCODE_LIMIT_POSITIONS</td> <td>在帐户上同时打开的订单的数量可以通过服务器的设置来限定。在到达一个限制之后，当试图下订单时，服务器将返回trade_retcode_limit_position错误。限定操作的差异取决于账户持仓类型: • 净持仓模式(单边做多) —— 仅考虑持有打开订单的数量。当达到一个限制时，平台不允许放置新订单(挂单)，因其执行可能会增加持有订单的数量。事实上，该平台只允许对已经持有的仓位的交易品种下单。而挂单则未考虑，因为它们的执行可能导致当前仓位的变化，但不能增加它们的数量。• 对冲模式(双向交易 )—— 挂单与持有的订单一起被考虑，因为一个挂单激活总是导致打开一个新的仓位。当达到一个限制时，平台不允许同时发布新的 市场订单 和 挂单。</td></tr> <tr><td>10041</td> <td>TRADE_RETCODE_REJECT_CANCEL</td> <td>挂单激活请求被拒绝，订单被取消</td></tr> <tr><td>10042</td> <td>TRADE_RETCODE_LONG_ONLY</td> <td>因为交易品种(POSITION_TYPE_BUY)设置了&quot;只允许做多&quot;的规则，所以请求被拒绝</td></tr> <tr><td>10043</td> <td>TRADE_RETCODE_SHORT_ONLY</td> <td>因为交易品种 (POSITION_TYPE_SELL)设置了&quot;只允许做空&quot;的规则，所以请求被拒绝</td></tr> <tr><td>10044</td> <td>TRADE_RETCODE_CLOSE_ONLY</td> <td>因为交易品种设置了&quot;只允许平仓&quot;的规则，所以请求被拒绝</td></tr></tbody></table> <h3 id="_2-8-2-编译器警告"><a href="#_2-8-2-编译器警告" class="header-anchor">#</a> 2.8.2 编译器警告</h3> <p>编译器警告仅用于提示信息目的，并不是错误消息。</p> <table><thead><tr><th>代码</th> <th>描述</th></tr></thead> <tbody><tr><td>21</td> <td>datetime字符串中的日期记录不完整。</td></tr> <tr><td>22</td> <td>在datetime字符串中使用了错误的日期数字，正确要求如下  年 1970 &lt;= X &lt;= 3000  月 0 &lt;X &lt;= 12  日 0 &lt;X &lt;= 31/30/28 (29 )....</td></tr> <tr><td>23</td> <td>在datetime字符串中使用了错误的时间数字，正确要求如下 小时   0 &lt;= X &lt;24 分钟  0 &lt;= X &lt;60</td></tr> <tr><td>24</td> <td>在RGB格式中使用了无效的颜色值，RGB元素中的值应该在0到255之间</td></tr> <tr><td>25</td> <td>未知的转义序列字符。  可用的转义符 : \n \r \t \ &quot; ' \X \x</td></tr> <tr><td>26</td> <td>函数的局部变量(&gt; 512Kb)太大，减少这个数字。</td></tr> <tr><td>29</td> <td>枚举已定义（副本）---- 成员将被添加到第一个定义中。</td></tr> <tr><td>30</td> <td>主要宏</td></tr> <tr><td>31</td> <td>变量已声明但在任何地方都没使用</td></tr> <tr><td>32</td> <td>构造函数必须是void(空)类型。</td></tr> <tr><td>33</td> <td>解构函数必须是void(空)类型。</td></tr> <tr><td>34</td> <td>常量不在整数范围内 (X&gt; _UI64_MAX | | X &lt;_I64_MIN)，并且转变为双精度型函数</td></tr> <tr><td>35</td> <td>太长的HEX —— 超过16个有意义的字符(高位的半字节被切除)</td></tr> <tr><td>36</td> <td>在HEX字符串&quot;0x&quot;中没有半字节</td></tr> <tr><td>37</td> <td>无功能函数 —— 没有执行任何命令</td></tr> <tr><td>38</td> <td>使用了一个未初始化的变量</td></tr> <tr><td>41</td> <td>函数没有主体，不被调用</td></tr> <tr><td>43</td> <td>在类型转换中可能丢失的数据。示例: int x = (double) z;</td></tr> <tr><td>44</td> <td>当转换一个常数时，(数据)精度的损失。示例: int x = M_PI。</td></tr> <tr><td>45</td> <td>比较的操作数存在正负符号(+-)差异。示例: (char) c1&gt; (uchar) c2。</td></tr> <tr><td>46</td> <td>函数导入问题 —— #import声明是必需的，或者函数的导入是隐式的</td></tr> <tr><td>47</td> <td>描述文本太大 —— 额外超出的字符将不会包含在可执行文件中。</td></tr> <tr><td>48</td> <td>指标缓冲区的数量比所要求的少</td></tr> <tr><td>49</td> <td>在指标中绘图图解无颜色</td></tr> <tr><td>50</td> <td>指标中无图解系列</td></tr> <tr><td>51</td> <td>在脚本中找不到'OnStart' 函数句柄</td></tr> <tr><td>52</td> <td>'OnStart' 函数参数错误</td></tr> <tr><td>53</td> <td>只在脚本中定义'OnStart' 函数</td></tr> <tr><td>54</td> <td>'OnInit' 函数参数错误</td></tr> <tr><td>55</td> <td>在脚本中不使用'OnInit'函数</td></tr> <tr><td>56</td> <td>以错误参量定义'OnDeinit'函数</td></tr> <tr><td>57</td> <td>在脚本中不使用'OnDeinit'函数</td></tr> <tr><td>58</td> <td>定义了两个'OnCalculate'函数。价格数组的'OnCalculate'函数被使用。</td></tr> <tr><td>59</td> <td>在计算复杂的整数常量时检测到的溢出。</td></tr> <tr><td>60</td> <td>或许，变量没有初始化</td></tr> <tr><td>61</td> <td>该声明可能导致无法引用在指定行上声明的局部变量。</td></tr> <tr><td>62</td> <td>该声明可能导致无法引用在指定行上声明的全局变量。</td></tr> <tr><td>63</td> <td>不能用于静态分配的数组。</td></tr> <tr><td>64</td> <td>这个变量声明隐藏了预定义的变量。</td></tr> <tr><td>65</td> <td>表达式的值始终为 true/false</td></tr> <tr><td>66</td> <td>在数学运算中使用变量或bool型表达式是不安全的。</td></tr> <tr><td>67</td> <td>将一元 负算子 应用于无符号ulong类型的结果是未定义的。</td></tr> <tr><td>68</td> <td>在#property version属性中指定的版本对于市场部分来说是不可接受的; #property version id“XXX.YYY”的正确格式</td></tr> <tr><td>69</td> <td>发现 空 控制语句</td></tr> <tr><td>70</td> <td>在事件处理函数的声明中，函数返回类型无效 或 不正确的参数。</td></tr> <tr><td>71</td> <td>需要对一种类型的 结构 进行隐式转换。</td></tr> <tr><td>72</td> <td>该声明使得不能直接访问指定字符串中声明的类成员。只能通过 范围解析操作 :: 进行访问。</td></tr> <tr><td>73</td> <td>二进制常量太大，高位的数字将被截断</td></tr> <tr><td>74</td> <td>继承类方法中的参数有一个不同的const修饰符，派生函数已经重载了父函数。</td></tr> <tr><td>75</td> <td>在 移位位操作中，移位值为 负 或 过大，则执行结果未定义。</td></tr> <tr><td>76</td> <td>函数必须 返回一个值</td></tr> <tr><td>77</td> <td>void(空)类型 函数返回了一个值</td></tr> <tr><td>78</td> <td>不是所有的控制路径都返回一个值。</td></tr> <tr><td>79</td> <td>在 全局范围 内不允许表达式。</td></tr> <tr><td>80</td> <td>检查 操作符优先级 的可能错误；使用括号来阐明这个优先</td></tr> <tr><td>81</td> <td>定义了两个 OnCalCulate() 。将使用OHLC 版本</td></tr> <tr><td>82</td> <td>Struct 结构 没有成员，大小被分配1字节</td></tr> <tr><td>83</td> <td>函数的返回值应该被检查</td></tr> <tr><td>84</td> <td>为调试编译资源指标。这会降低性能。请重新编译指标以提高性能。</td></tr> <tr><td>85</td> <td>字符串中的字符代码太大，必须在0到65535之间。</td></tr> <tr><td>86</td> <td>字符串中未识别的字符</td></tr> <tr><td>87</td> <td>没有指定指标窗口属性( 主窗口 或 子窗口 )。属性 #property indicator_chart_window (使用主窗口)被应用.</td></tr></tbody></table> <h3 id="_2-8-3-编译错误"><a href="#_2-8-3-编译错误" class="header-anchor">#</a> 2.8.3 编译错误</h3> <p>在编辑代码过程中，MetaEdtior 5会通过内置的编译器检测程序错误，并将错误消息显示出来。这些错误列举在下表中。要将源代码编译成可执行文件，请按F7。包含错误的程序不能编译，直到编译器识别出的错误被消除为止。</p> <table><thead><tr><th>代码</th> <th>描述</th></tr></thead> <tbody><tr><td>&gt;100</td> <td>文件读取错误</td></tr> <tr><td>101</td> <td>打开 *. EX5文件试图写入错误</td></tr> <tr><td>103</td> <td>没有足够内存完成编译</td></tr> <tr><td>104</td> <td>编译器不能识别的空语法单元</td></tr> <tr><td>105</td> <td>#include文件中的错误文件名</td></tr> <tr><td>106</td> <td>#include 包含文件中的文件访问错误（也许因为文件不存在）</td></tr> <tr><td>108</td> <td>与 #define不匹配的名称</td></tr> <tr><td>109</td> <td>预处理器的未知命令（有效的命令为 #include， #define， #property， #import）</td></tr> <tr><td>110</td> <td>编译器无法识别的符号</td></tr> <tr><td>111</td> <td>无法实施的函数（只有描述，却没有主体）</td></tr> <tr><td>112</td> <td>双引号 (&quot;) 省略</td></tr> <tr><td>113</td> <td>尖角括号 (&lt;) 或 双引号 (&quot;) 省略</td></tr> <tr><td>114</td> <td>单引号(')省略</td></tr> <tr><td>115</td> <td>反尖括号&quot;&gt;&quot;省略</td></tr> <tr><td>116</td> <td>声明中未指定的类型</td></tr> <tr><td>117</td> <td>无返回(return)操作 或者 在实施的所有分支中没发现返回操作符(return)。</td></tr> <tr><td>118</td> <td>预期调用参数的开启括号。</td></tr> <tr><td>119</td> <td>写入EX5 错误</td></tr> <tr><td>120</td> <td>对数组的访问无效</td></tr> <tr><td>121</td> <td>函数不是 空(void)类型，返回操作符(return)必须返回一个值</td></tr> <tr><td>122</td> <td>析构函数的错误声明。</td></tr> <tr><td>123</td> <td>冒号&quot;:&quot;缺失</td></tr> <tr><td>124</td> <td>变量已声明</td></tr> <tr><td>125</td> <td>标识符变量已声明</td></tr> <tr><td>126</td> <td>变量名称太长（&gt;250字符）</td></tr> <tr><td>127</td> <td>已经定义了该标识符的 结构</td></tr> <tr><td>128</td> <td>结构 未定义</td></tr> <tr><td>129</td> <td>同名结构成员已被定义</td></tr> <tr><td>130</td> <td>没有相关 结构 成员</td></tr> <tr><td>131</td> <td>违反了配对的括号</td></tr> <tr><td>132</td> <td>需要一个开(左)括号 &quot;(&quot;</td></tr> <tr><td>133</td> <td>不对称的括号（不是 &quot;}&quot;）</td></tr> <tr><td>134</td> <td>难以编译(过多的分支，内部堆栈级别被过度填充)</td></tr> <tr><td>135</td> <td>打开文件读取错误</td></tr> <tr><td>136</td> <td>没有足够内存下载源文件</td></tr> <tr><td>137</td> <td>预期变量</td></tr> <tr><td>138</td> <td>引用不能初始化</td></tr> <tr><td>140</td> <td>预期任务(出现在声明中)</td></tr> <tr><td>141</td> <td>需要开()左括号&quot;{&quot;</td></tr> <tr><td>142</td> <td>参数仅用于 动态数组</td></tr> <tr><td>143</td> <td>不能接受使用&quot;void&quot;类型</td></tr> <tr><td>144</td> <td>没有成对的 &quot;)&quot; 或者 &quot;]&quot;,  例如 缺少 &quot;(&quot; 或 &quot; [ &quot;</td></tr> <tr><td>145</td> <td>没有成对的 &quot;)&quot; 或者 &quot;]&quot;,  例如 缺少 &quot;)&quot; 或 &quot; ] &quot;</td></tr> <tr><td>146</td> <td>数组大小错误</td></tr> <tr><td>147</td> <td>太多参数(&gt; 64)</td></tr> <tr><td>149</td> <td>该标记不是预期的</td></tr> <tr><td>150</td> <td>无效使用操作(无效操作数)</td></tr> <tr><td>151</td> <td>表达式不允许 空(void) 型</td></tr> <tr><td>152</td> <td>需要操作符</td></tr> <tr><td>153</td> <td>滥用终止</td></tr> <tr><td>154</td> <td>需要分号&quot;;&quot;</td></tr> <tr><td>155</td> <td>需要逗号&quot;,&quot;</td></tr> <tr><td>156</td> <td>必须是一个 类 ，而不是 结构</td></tr> <tr><td>157</td> <td>需要表达式</td></tr> <tr><td>158</td> <td>在十六进制或太长(数字&gt; 511)中发现“非十六进制字符”</td></tr> <tr><td>&gt;159</td> <td>字符串常数有超过65534个字符</td></tr> <tr><td>160</td> <td>此处的函数定义无法接受</td></tr> <tr><td>161</td> <td>不是预期的程序结尾</td></tr> <tr><td>162</td> <td>禁止 结构 的前置声明</td></tr> <tr><td>163</td> <td>函数名称已定义并有另一个返回类型</td></tr> <tr><td>164</td> <td>函数名称已定义并有不同的形式参数</td></tr> <tr><td>165</td> <td>函数名称已定义并已实施</td></tr> <tr><td>166</td> <td>调用时未发现 函数重载</td></tr> <tr><td>167</td> <td>具有void类型返回值的函数不能返回值</td></tr> <tr><td>168</td> <td>函数不能定义</td></tr> <tr><td>170</td> <td>需要一个值</td></tr> <tr><td>171</td> <td>case 表达式中只有整数常量是有效的</td></tr> <tr><td>172</td> <td>switch中的case值已经被使用</td></tr> <tr><td>173</td> <td>需要整数</td></tr> <tr><td>174</td> <td>需要 #import表达式文件名称</td></tr> <tr><td>175</td> <td>在全局范围上，不允许使用表达式</td></tr> <tr><td>176</td> <td>在 &quot;;&quot; 前省略了圆括号&quot;)&quot;</td></tr> <tr><td>177</td> <td>等号左边需要一个变量</td></tr> <tr><td>178</td> <td>不能使用表达式结果</td></tr> <tr><td>179</td> <td>在 case 中，不允许声明变量。</td></tr> <tr><td>180</td> <td>从字符串到数字的隐式转换</td></tr> <tr><td>181</td> <td>从数字到字符串的隐式转换</td></tr> <tr><td>182</td> <td>重载函数 的模糊调用(同时有几个重载匹配)</td></tr> <tr><td>183</td> <td>不包含if的非法else</td></tr> <tr><td>184</td> <td>没有switch的无效case或者default</td></tr> <tr><td>185</td> <td>省略号的不恰当使用</td></tr> <tr><td>186</td> <td>初始化序列比初始化的变量具有更多的元素。</td></tr> <tr><td>187</td> <td>需要case常数</td></tr> <tr><td>188</td> <td>需要表达式常数</td></tr> <tr><td>&gt;189</td> <td>常量不能改变</td></tr> <tr><td>190</td> <td>需要 反括号 或 逗号（声明数组成员）</td></tr> <tr><td>191</td> <td>枚举标识符已经定义</td></tr> <tr><td>192</td> <td>枚举不能有访问修饰符(const, extern, static)</td></tr> <tr><td>193</td> <td>枚举成员已经声明了不同的值</td></tr> <tr><td>194</td> <td>有一个用相同名称定义的变量</td></tr> <tr><td>195</td> <td>有一个用相同名称定义的结构</td></tr> <tr><td>196</td> <td>需要列举成员名称</td></tr> <tr><td>197</td> <td>需要整数表达式</td></tr> <tr><td>198</td> <td>常数表达式中除以0(分母为0)</td></tr> <tr><td>199</td> <td>函数参数数量错误</td></tr> <tr><td>200</td> <td>参数的引用必须是一个变量</td></tr> <tr><td>201</td> <td>相同类型的变量，通过引用来传递。</td></tr> <tr><td>202</td> <td>常量不能通过非常量引用传递</td></tr> <tr><td>203</td> <td>需要正整数常量</td></tr> <tr><td>204</td> <td>访问 类 的保护成员失败</td></tr> <tr><td>205</td> <td>导入 已使用另一种方式定义</td></tr> <tr><td>208</td> <td>未生成可执行文件</td></tr> <tr><td>209</td> <td>指标中未发现 'OnCalculate' 入口点</td></tr> <tr><td>210</td> <td>只有在 循环中 才能执行 continue 操作</td></tr> <tr><td>211</td> <td>访问 私有(关闭) 类 成员 错误</td></tr> <tr><td>213</td> <td>结构 或 类 的方法没有声明</td></tr> <tr><td>214</td> <td>访问 私有 (关闭) 类 的方法错误</td></tr> <tr><td>216</td> <td>不允许复制带有对象的结构</td></tr> <tr><td>218</td> <td>数组索引超出范围</td></tr> <tr><td>219</td> <td>不允许在 结构 或 类 声明中进行数组初始化。</td></tr> <tr><td>220</td> <td>类 构造函数不能有参数</td></tr> <tr><td>221</td> <td>类 析构函数不能有参数</td></tr> <tr><td>222</td> <td>已经声明了具有相同名称和参数的 类方法 或 结构</td></tr> <tr><td>223</td> <td>需要一个操作数</td></tr> <tr><td>224</td> <td>具有相同名称的 类方法 或 结构 存在，但具有不同的参数 (声明 != 实现)</td></tr> <tr><td>225</td> <td>未声明实施函数</td></tr> <tr><td>226</td> <td>ZeroMemory()不允许有受保护成员 或 继承 的对象。</td></tr> <tr><td>227</td> <td>重载函数的模糊调用(几个重载的参数的精确匹配)</td></tr> <tr><td>228</td> <td>需要变量名称</td></tr> <tr><td>229</td> <td>此处不能声明引用。</td></tr> <tr><td>230</td> <td>枚举名称已经使用</td></tr> <tr><td>232</td> <td>需要 类 或 结构</td></tr> <tr><td>235</td> <td>不能调用 'delete' 操作去删除数组</td></tr> <tr><td>236</td> <td>需要' while'操作符</td></tr> <tr><td>237</td> <td>'delete'操作需要指针</td></tr> <tr><td>238</td> <td>'switch' 已经有 'default'</td></tr> <tr><td>239</td> <td>语法错误</td></tr> <tr><td>240</td> <td>转码序列符只能在字符串中(以“\”开头)</td></tr> <tr><td>241</td> <td>需要数组 —— 方括号'['不应用于数组，或者将 非数组 作为 数组参数 传递</td></tr> <tr><td>242</td> <td>不能通过初始化序列初始化</td></tr> <tr><td>243</td> <td>导入 (import) 不能定义</td></tr> <tr><td>244</td> <td>语法树优化器错误</td></tr> <tr><td>245</td> <td>声明太多结构（尝试简化程序）</td></tr> <tr><td>246</td> <td>不允许参数转换</td></tr> <tr><td>247</td> <td>使用“删除”操作错误</td></tr> <tr><td>248</td> <td>不允许声明引用指针</td></tr> <tr><td>249</td> <td>不允许声明引用的引用</td></tr> <tr><td>250</td> <td>不允许声明指针的指针</td></tr> <tr><td>251</td> <td>不允许在参数列表中的声明结构</td></tr> <tr><td>252</td> <td>类型转换(Type Casting)过程中的无效操作</td></tr> <tr><td>253</td> <td>指针只能为 类 或 结构 声明</td></tr> <tr><td>256</td> <td>未声明的标识符</td></tr> <tr><td>257</td> <td>可执行代码优化程序出错</td></tr> <tr><td>258</td> <td>可执行代码生成错误</td></tr> <tr><td>260</td> <td>“switch”指令的无效表达式</td></tr> <tr><td>261</td> <td>字符串常量溢出，请简化程序</td></tr> <tr><td>262</td> <td>不能转换为枚举类型</td></tr> <tr><td>263</td> <td>不能使用“virtual虚拟”数据（类 或 结构 的成员）</td></tr> <tr><td>264</td> <td>不能调用 类 的 保护方法</td></tr> <tr><td>265</td> <td>拒绝虚拟函数返回不同类型的值</td></tr> <tr><td>266</td> <td>类 不能从 结构 继承</td></tr> <tr><td>267</td> <td>结构 不能从 类 继承</td></tr> <tr><td>268</td> <td>构造函数不能是虚拟的（不允许使用virtual说明符）</td></tr> <tr><td>269</td> <td>结构 不能有virtual(虚拟) 方法</td></tr> <tr><td>270</td> <td>函数必须有主体</td></tr> <tr><td>271</td> <td>禁止重载系统函数(终端函数)</td></tr> <tr><td>272</td> <td>Const说明符对于不属于 类 或 结构 的函数是无效的</td></tr> <tr><td>274</td> <td>在常量方法中不允许改变 类 成员</td></tr> <tr><td>276</td> <td>不适当的初始化顺序</td></tr> <tr><td>277</td> <td>参数没有默认值(特定的默认参数声明)</td></tr> <tr><td>278</td> <td>覆盖默认参数(声明和实现中的不同值)</td></tr> <tr><td>279</td> <td>不允许为 对象常量 调用 非常量方法</td></tr> <tr><td>280</td> <td>对象 访问 成员 是必需的(用 .(点) 来标识 类/结构 和 非类/结构 )</td></tr> <tr><td>281</td> <td>已声明的结构名称不能在声明中使用</td></tr> <tr><td>284</td> <td>未经授权的转换(在封闭的继承中)</td></tr> <tr><td>285</td> <td>结构 和 数组 不能用作输入变量(外部参数)</td></tr> <tr><td>286</td> <td>Const说明符对 构造函数/析构函数 无效</td></tr> <tr><td>287</td> <td>不正确的字符串表达式用于datetime类型</td></tr> <tr><td>288</td> <td>未知的属性 (#property)</td></tr> <tr><td>289</td> <td>属性值错误</td></tr> <tr><td>290</td> <td>#property中的属性值为无效索引</td></tr> <tr><td>291</td> <td>调用省略参数 - &lt;func (x,)&gt;</td></tr> <tr><td>293</td> <td>对象必须通过引用传递</td></tr> <tr><td>294</td> <td>数组必须通过引用传递</td></tr> <tr><td>295</td> <td>函数被声明为可导出的</td></tr> <tr><td>296</td> <td>函数被声明为不可导出的</td></tr> <tr><td>297</td> <td>导入的函数禁止导出</td></tr> <tr><td>298</td> <td>导入的函数不能有此参数(禁止传递一个指针、包含动态数组的类 或 结构，指针、类等)</td></tr> <tr><td>299</td> <td>必需是 类</td></tr> <tr><td>300</td> <td>#import 没有关闭</td></tr> <tr><td>302</td> <td>类型不匹配</td></tr> <tr><td>&gt;303</td> <td>外部变量已经初始化</td></tr> <tr><td>304</td> <td>没有导出函数 或者 没有找到 事件处理函数的 进入点</td></tr> <tr><td>305</td> <td>不允许直接调用 显式构造函数</td></tr> <tr><td>306</td> <td>方法 被声明为常数</td></tr> <tr><td>307</td> <td>方法 没有被声明为常数</td></tr> <tr><td>308</td> <td>资源文件大小不正确</td></tr> <tr><td>309</td> <td>资源名称不正确</td></tr> <tr><td>310</td> <td>资源文件打开错误</td></tr> <tr><td>311</td> <td>资源文件读取错误</td></tr> <tr><td>312</td> <td>未知的资源文件类型</td></tr> <tr><td>313</td> <td>资源文件路径错误</td></tr> <tr><td>314</td> <td>指定的资源文件名称已经被使用</td></tr> <tr><td>315</td> <td>函数需要变量，类似宏</td></tr> <tr><td>316</td> <td>意外的宏 定义符号</td></tr> <tr><td>317</td> <td>宏的形式参数错误</td></tr> <tr><td>318</td> <td>宏的形式参数数量无效</td></tr> <tr><td>319</td> <td>宏的参数太多</td></tr> <tr><td>320</td> <td>太复杂，请简化 宏</td></tr> <tr><td>321</td> <td>EnumToString()的参数只能是一个枚举型</td></tr> <tr><td>322</td> <td>资源名称太长</td></tr> <tr><td>323</td> <td>不支持的图片格式（只支持24/32位色深的BMP格式）</td></tr> <tr><td>324</td> <td>数组不能以操作符声明</td></tr> <tr><td>325</td> <td>函数只能在 全局 范围被声明</td></tr> <tr><td>326</td> <td>不允许在当前范围声明</td></tr> <tr><td>327</td> <td>不允许使用局部变量的值初始化静态变量</td></tr> <tr><td>328</td> <td>非法声明一个没有默认构造函数 的 对象数组</td></tr> <tr><td>329</td> <td>初始化列表 只允许用于 构造函数</td></tr> <tr><td>330</td> <td>初始化列表后无定义函数</td></tr> <tr><td>331</td> <td>初始化列表 为空</td></tr> <tr><td>332</td> <td>不允许在构造函数中初始化数组</td></tr> <tr><td>333</td> <td>不允许在初始化列表中的初始化父类的成员</td></tr> <tr><td>334</td> <td>期望 整数类型 的表达式</td></tr> <tr><td>335</td> <td>数组 所需的内存超过最大值</td></tr> <tr><td>336</td> <td>结构 所需的内存超过最大值</td></tr> <tr><td>337</td> <td>声明的全局变量所需的内存超过最大值</td></tr> <tr><td>338</td> <td>局部变量所需的内存超过最大值</td></tr> <tr><td>339</td> <td>构造函数 未定义</td></tr> <tr><td>340</td> <td>图标文件的名称无效</td></tr> <tr><td>341</td> <td>不能在指定路径打开图标文件</td></tr> <tr><td>342</td> <td>图标文件不正确，不是 ICO 格式</td></tr> <tr><td>343</td> <td>使用初始化列表重新初始化 类/结构 构造函数的成员</td></tr> <tr><td>344</td> <td>不允许在 构造函数 初始化列表 中 初始化 静态 成员</td></tr> <tr><td>345</td> <td>不允许在 类/结构 的全局范围上初始化 非静态 成员</td></tr> <tr><td>346</td> <td>类/结构 的方法名称与前面声明的成员的名称相匹配</td></tr> <tr><td>347</td> <td>类/结构 的成员名称与前面声明的成员的名称相匹配</td></tr> <tr><td>348</td> <td>虚函数不能声明为静态</td></tr> <tr><td>349</td> <td>const 修饰符不允许用于静态函数</td></tr> <tr><td>350</td> <td>构造函数 或 析构函数 不能是静态的</td></tr> <tr><td>351</td> <td>类 或 结构 的 非静态成员/方法 不能从静态函数访问</td></tr> <tr><td>352</td> <td>重载操作(+，-，[]，++，等等)在操作符关键字之后。</td></tr> <tr><td>353</td> <td>并非所有操作都可以在MQL5 重载</td></tr> <tr><td>354</td> <td>定义与声明不匹配</td></tr> <tr><td>355</td> <td>为 操作符 指定的参数数量无效</td></tr> <tr><td>356</td> <td>未发现事件处理函数</td></tr> <tr><td>357</td> <td>方法 无法导出</td></tr> <tr><td>358</td> <td>常量对象的指针不能通过非常量对象格式化</td></tr> <tr><td>359</td> <td>还不支持类的模板</td></tr> <tr><td>360</td> <td>还不支持函数模板重载</td></tr> <tr><td>361</td> <td>不能应用函数模板</td></tr> <tr><td>362</td> <td>函数模板的不明确参数（可以应用几种参数类型）</td></tr> <tr><td>363</td> <td>无法确定参数类型，函数模板参数应该被格式化</td></tr> <tr><td>364</td> <td>函数模板中的参数数量不正确</td></tr> <tr><td>365</td> <td>函数模板不能是 虚拟(virtual)的</td></tr> <tr><td>366</td> <td>函数模板不能导出</td></tr> <tr><td>367</td> <td>函数模板不能导入</td></tr> <tr><td>368</td> <td>不允许包含 对象 的 结构</td></tr> <tr><td>369</td> <td>不允许包含对象的字符串数组和 结构</td></tr> <tr><td>370</td> <td>静态 类/结构 成员 必须被显式初始化</td></tr> <tr><td>371</td> <td>编译器限制：字符串不能包含超过65 535个字符</td></tr> <tr><td>372</td> <td>#ifdef/#endif 相悖</td></tr> <tr><td>373</td> <td>不能返回 类 的 对象，复制构造函数没有找到</td></tr> <tr><td>374</td> <td>不能使用 非静态成员 和 方法</td></tr> <tr><td>375</td> <td>没有OnTesterDeinit() 不能使用OnTesterInit()</td></tr> <tr><td>376</td> <td>重新定义形式参数 '%s'</td></tr> <tr><td>377</td> <td>宏 <strong>FUNCSIG</strong> 和 <strong>FUNCTION</strong> 不能出现在函数主体之外</td></tr> <tr><td>378</td> <td>无效返回类型。例如，从DLL输入的函数返回 结构 或 指针 将会产生这种错误</td></tr> <tr><td>379</td> <td>模板使用错误</td></tr> <tr><td>380</td> <td>未使用</td></tr> <tr><td>381</td> <td>声明纯粹(pure)的虚拟(virtual)函数时语法出错，只允许 &quot;=NULL&quot; 或 &quot;=0&quot;</td></tr> <tr><td>382</td> <td>只有虚拟(virtual)函数可以使用纯粹(pure说明符进行声明 (&quot;=NULL&quot; 或 &quot;=0&quot;)</td></tr> <tr><td>383</td> <td>抽象类不能被实例化</td></tr> <tr><td>384</td> <td>使用dynamic_cast操作符将一个指向用户定义类型的指针作为动态转换的目标类型</td></tr> <tr><td>385</td> <td>需要&quot;函数指针&quot; 类型</td></tr> <tr><td>386</td> <td>不支持 指向方法的指针</td></tr> <tr><td>387</td> <td>错误 —— 不能定义函数指针类型</td></tr> <tr><td>388</td> <td>类型转换不可用，由于private 继承</td></tr> <tr><td>389</td> <td>const 修饰符变量应在声明期间初始化</td></tr> <tr><td>393</td> <td>只有具有公共访问的 方法 才能在接口中声明</td></tr> <tr><td>394</td> <td>无效界面 嵌入另一个界面中</td></tr> <tr><td>395</td> <td>界面只能由另一个界面衍生</td></tr> <tr><td>396</td> <td>期待一个界面</td></tr> <tr><td>397</td> <td>界面仅支持公共继承</td></tr> <tr><td>398</td> <td>一个界面不能包括成员</td></tr> <tr><td>399</td> <td>界面对象不可直接创建，只能通过继承方式</td></tr></tbody></table> <h3 id="_2-8-4-运行时间错误"><a href="#_2-8-4-运行时间错误" class="header-anchor">#</a> 2.8.4 运行时间错误</h3> <p>GetLastError() 函数是用来返回储存在预定义变量 _LastError中的上一个错误的代码。该值可以通过 ResetLastError() 函数重置为0</p> <table><thead><tr><th>常量</th> <th>代码</th> <th>描述</th></tr></thead> <tbody><tr><td>ERR_SUCCESS</td> <td>0</td> <td>操作成功完成</td></tr> <tr><td>ERR_INTERNAL_ERROR</td> <td>4001</td> <td>意外内部错误</td></tr> <tr><td>ERR_WRONG_INTERNAL_PARAMETER</td> <td>4002</td> <td>客户端函数内部调用的参数错误</td></tr> <tr><td>ERR_INVALID_PARAMETER</td> <td>4003</td> <td>当调用系统函数时参数错误</td></tr> <tr><td>ERR_NOT_ENOUGH_MEMORY</td> <td>4004</td> <td>没有足够的内存空间执行系统函数</td></tr> <tr><td>ERR_STRUCT_WITHOBJECTS_ORCLASS</td> <td>4005</td> <td>该结构包含 字符串 和/或 动态数组 的对象 和/或 此 对象的类 和/或 结构。</td></tr> <tr><td>ERR_INVALID_ARRAY</td> <td>4006</td> <td>数组类型错误，大小错误，或者 动态数组 中有一个已损害的对象</td></tr> <tr><td>ERR_ARRAY_RESIZE_ERROR</td> <td>4007</td> <td>没有足够的内存来重新定位一个数组，或者尝试改变一个静态数组的大小</td></tr> <tr><td>ERR_STRING_RESIZE_ERROR</td> <td>4008</td> <td>没有足够内存重置字符串</td></tr> <tr><td>ERR_NOTINITIALIZED_STRING</td> <td>4009</td> <td>没有初始化字符串</td></tr> <tr><td>ERR_INVALID_DATETIME</td> <td>4010</td> <td>无效人 日期 和/或 时间</td></tr> <tr><td>ERR_ARRAY_BAD_SIZE</td> <td>4011</td> <td>要求的数组大小超过2GB</td></tr> <tr><td>ERR_INVALID_POINTER</td> <td>4012</td> <td>无效指针</td></tr> <tr><td>ERR_INVALID_POINTER_TYPE</td> <td>4013</td> <td>指针类型错误</td></tr> <tr><td>ERR_FUNCTION_NOT_ALLOWED</td> <td>4014</td> <td>函数不允许调用</td></tr> <tr><td>ERR_RESOURCE_NAME_DUPLICATED</td> <td>4015</td> <td>动态名称 和 静态资源 匹配</td></tr> <tr><td>ERR_RESOURCE_NOT_FOUND</td> <td>4016</td> <td>该名称的资源在EX5文件中没有找到</td></tr> <tr><td>ERR_RESOURCE_UNSUPPOTED_TYPE</td> <td>4017</td> <td>不支持的资源类型 或 其大小超过 16 Mb</td></tr> <tr><td>ERR_RESOURCE_NAME_IS_TOO_LONG</td> <td>4018</td> <td>资源名称超过 63 个字符</td></tr> <tr><td>ERR_MATH_OVERFLOW</td> <td>4019</td> <td>计算数学函数时产生溢值(超出计算范围)</td></tr> <tr><td>图表</td> <td></td> <td></td></tr> <tr><td>ERR_CHART_WRONG_ID</td> <td>4101</td> <td>错误的图表ID编号</td></tr> <tr><td>ERR_CHART_NO_REPLY</td> <td>4102</td> <td>图表没有响应</td></tr> <tr><td>ERR_CHART_NOT_FOUND</td> <td>4103</td> <td>图表未找到</td></tr> <tr><td>ERR_CHART_NO_EXPERT</td> <td>4104</td> <td>在图表中没有任何EA处理这个事件</td></tr> <tr><td>ERR_CHART_CANNOT_OPEN</td> <td>4105</td> <td>图表打开错误</td></tr> <tr><td>ERR_CHART_CANNOT_CHANGE</td> <td>4106</td> <td>改变图表交易品种 或 周期 失败</td></tr> <tr><td>ERR_CHART_WRONG_PARAMETER</td> <td>4107</td> <td>使用图表函数的参数错误</td></tr> <tr><td>ERR_CHART_CANNOT_CREATE_TIMER</td> <td>4108</td> <td>创建定时器失败</td></tr> <tr><td>ERR_CHART_WRONG_PROPERTY</td> <td>4109</td> <td>错误图表属性ID</td></tr> <tr><td>ERR_CHART_SCREENSHOT_FAILED</td> <td>4110</td> <td>生成截屏错误</td></tr> <tr><td>ERR_CHART_NAVIGATE_FAILED</td> <td>4111</td> <td>图表导航操作错误</td></tr> <tr><td>ERR_CHART_TEMPLATE_FAILED</td> <td>4112</td> <td>应用模板错误</td></tr> <tr><td>ERR_CHART_WINDOW_NOT_FOUND</td> <td>4113</td> <td>未找到子窗口(副图窗口)包含的指标</td></tr> <tr><td>ERR_CHART_INDICATOR_CANNOT_ADD</td> <td>4114</td> <td>添加指标到图表错误</td></tr> <tr><td>ERR_CHART_INDICATOR_CANNOT_DEL</td> <td>4115</td> <td>删除图表指标错误</td></tr> <tr><td>ERR_CHART_INDICATOR_NOT_FOUND</td> <td>4116</td> <td>指定图表上未发现指标</td></tr> <tr><td>图解对象</td> <td></td> <td></td></tr> <tr><td>ERR_OBJECT_ERROR</td> <td>4201</td> <td>图解对象的错误</td></tr> <tr><td>ERR_OBJECT_NOT_FOUND</td> <td>4202</td> <td>未发现图解对象</td></tr> <tr><td>ERR_OBJECT_WRONG_PROPERTY</td> <td>4203</td> <td>图解对象属性ID错误</td></tr> <tr><td>ERR_OBJECT_GETDATE_FAILED</td> <td>4204</td> <td>无法获得与值对应的日期时间</td></tr> <tr><td>ERR_OBJECT_GETVALUE_FAILED</td> <td>4205</td> <td>无法获得与日期时间对应的值</td></tr> <tr><td>市场信息</td> <td></td> <td></td></tr> <tr><td>ERR_MARKET_UNKNOWN_SYMBOL</td> <td>4301</td> <td>未知交易品种</td></tr> <tr><td>ERR_MARKET_NOT_SELECTED</td> <td>4302</td> <td>市场报价中未选中该交易品种</td></tr> <tr><td>ERR_MARKET_WRONG_PROPERTY</td> <td>4303</td> <td>交易品种的属性标识符错误</td></tr> <tr><td>ERR_MARKET_LASTTIME_UNKNOWN</td> <td>4304</td> <td>最后一个跳价的时间是未知的(没有收到报价)</td></tr> <tr><td>ERR_MARKET_SELECT_ERROR</td> <td>4305</td> <td>在 市场报价 窗口中 添加 或 删除 交易品种错误</td></tr> <tr><td>历史访问</td> <td></td> <td></td></tr> <tr><td>ERR_HISTORY_NOT_FOUND</td> <td>4401</td> <td>请求查看的历史记录未找到</td></tr> <tr><td>ERR_HISTORY_WRONG_PROPERTY</td> <td>4402</td> <td>历史记录属性ID错误</td></tr> <tr><td>ERR_HISTORY_TIMEOUT</td> <td>4403</td> <td>历史请求超时过多</td></tr> <tr><td>ERR_HISTORY_BARS_LIMIT</td> <td>4404</td> <td>请求K柱的数量受到程序端设置的限制</td></tr> <tr><td>ERR_HISTORY_LOAD_ERRORS</td> <td>4405</td> <td>加载历史数据时发生多个错误</td></tr> <tr><td>ERR_HISTORY_SMALL_BUFFER</td> <td>4407</td> <td>接受数组太小，无法存储所有请求的历史数据</td></tr> <tr><td>全局变量</td> <td></td> <td></td></tr> <tr><td>ERR_GLOBALVARIABLE_NOT_FOUND</td> <td>4501</td> <td>客户端全局变量未找到</td></tr> <tr><td>ERR_GLOBALVARIABLE_EXISTS</td> <td>4502</td> <td>相同名称的客户端全局变量已经存在</td></tr> <tr><td>ERR_GLOBALVARIABLE_NOT_MODIFIED</td> <td>4503</td> <td>全局变量未被修改</td></tr> <tr><td>ERR_GLOBALVARIABLE_CANNOTREAD</td> <td>4504</td> <td>无法通过全局变量值读取文件</td></tr> <tr><td>ERR_GLOBALVARIABLE_CANNOTWRITE</td> <td>4505</td> <td>无法通过全局变量值写入文件</td></tr> <tr><td>ERR_MAIL_SEND_FAILED</td> <td>4510</td> <td>发送邮件失败</td></tr> <tr><td>ERR_PLAY_SOUND_FAILED</td> <td>4511</td> <td>声音播放失败</td></tr> <tr><td>ERR_MQL5_WRONG_PROPERTY</td> <td>4512</td> <td>程序属性标识符错误</td></tr> <tr><td>ERR_TERMINAL_WRONG_PROPERTY</td> <td>4513</td> <td>客户端属性标识符错误</td></tr> <tr><td>ERR_FTP_SEND_FAILED</td> <td>4514</td> <td>通过ftp发送文件失败</td></tr> <tr><td>ERR_NOTIFICATION_SEND_FAILED</td> <td>4515</td> <td>发送 通知(短消息,需要 google 框架支持) 失败</td></tr> <tr><td>ERR_NOTIFICATION_WRONG_PARAMETER</td> <td>4516</td> <td>发送通知的无效参数 —— 空字符串或 NULL 被传递到 SendNotification() 函数</td></tr> <tr><td>ERR_NOTIFICATION_WRONG_SETTINGS</td> <td>4517</td> <td>错误的程序端通知设置（未指定ID或未设置权限）</td></tr> <tr><td>ERR_NOTIFICATION_TOO_FREQUENT</td> <td>4518</td> <td>发送通知过于频繁</td></tr> <tr><td>ERR_FTP_NOSERVER</td> <td>4519</td> <td>未指定FTP 服务器</td></tr> <tr><td>ERR_FTP_NOLOGIN</td> <td>4520</td> <td>未指定FTP登录名</td></tr> <tr><td>ERR_FTP_FILE_ERROR</td> <td>4521</td> <td>在MQL5\Files目录未找到发送至FTP服务器的文件</td></tr> <tr><td>ERR_FTP_CONNECT_FAILED</td> <td>4522</td> <td>FTP 连接失败</td></tr> <tr><td>ERR_FTP_CHANGEDIR</td> <td>4523</td> <td>在服务器上未找到FTP路径</td></tr> <tr><td>ERR_FTP_CLOSED</td> <td>4524</td> <td>FTP 连接关闭</td></tr> <tr><td>自定义指标缓冲区</td> <td></td> <td></td></tr> <tr><td>ERR_BUFFERS_NO_MEMORY</td> <td>4601</td> <td>没有足够内存建立指标缓冲区</td></tr> <tr><td>ERR_BUFFERS_WRONG_INDEX</td> <td>4602</td> <td>错误指标缓冲区索引值</td></tr> <tr><td>自定义指标属性</td> <td></td> <td></td></tr> <tr><td>ERR_CUSTOM_WRONG_PROPERTY</td> <td>4603</td> <td>自定义指标的错误ID</td></tr> <tr><td>账户</td> <td></td> <td></td></tr> <tr><td>ERR_ACCOUNT_WRONG_PROPERTY</td> <td>4701</td> <td>账户属性ID错误</td></tr> <tr><td>ERR_TRADE_WRONG_PROPERTY</td> <td>4751</td> <td>交易属性ID错误</td></tr> <tr><td>ERR_TRADE_DISABLED</td> <td>4752</td> <td>EA交易被禁止</td></tr> <tr><td>ERR_TRADE_POSITION_NOT_FOUND</td> <td>4753</td> <td>未找到仓位</td></tr> <tr><td>ERR_TRADE_ORDER_NOT_FOUND</td> <td>4754</td> <td>未找到订单</td></tr> <tr><td>ERR_TRADE_DEAL_NOT_FOUND</td> <td>4755</td> <td>未找到交易单</td></tr> <tr><td>ERR_TRADE_SEND_FAILED</td> <td>4756</td> <td>交易需求发送失败</td></tr> <tr><td>ERR_TRADE_CALC_FAILED</td> <td>4758</td> <td>计算利润或保证金(预付款)失败</td></tr> <tr><td>指标</td> <td></td> <td></td></tr> <tr><td>ERR_INDICATOR_UNKNOWN_SYMBOL</td> <td>4801</td> <td>未知交易品种</td></tr> <tr><td>ERR_INDICATOR_CANNOT_CREATE</td> <td>4802</td> <td>不能创建指标</td></tr> <tr><td>ERR_INDICATOR_NO_MEMORY</td> <td>4803</td> <td>没有足够内存添加指标</td></tr> <tr><td>ERR_INDICATOR_CANNOT_APPLY</td> <td>4804</td> <td>指标不能应用于另一指标</td></tr> <tr><td>ERR_INDICATOR_CANNOT_ADD</td> <td>4805</td> <td>指标应用到图表错误</td></tr> <tr><td>ERR_INDICATOR_DATA_NOT_FOUND</td> <td>4806</td> <td>需求数据未找到</td></tr> <tr><td>ERR_INDICATOR_WRONG_HANDLE</td> <td>4807</td> <td>指标句柄处理错误</td></tr> <tr><td>ERR_INDICATOR_WRONG_PARAMETERS</td> <td>4808</td> <td>创建指标时使用的参数数量错误</td></tr> <tr><td>ERR_INDICATOR_PARAMETERS_MISSING</td> <td>4809</td> <td>创建指标时没有参数</td></tr> <tr><td>ERR_INDICATOR_CUSTOM_NAME</td> <td>4810</td> <td>数组中的第一个参数必须是自定义指标的名称</td></tr> <tr><td>ERR_INDICATOR_PARAMETER_TYPE</td> <td>4811</td> <td>创建指标时，数组中参数类型无效</td></tr> <tr><td>ERR_INDICATOR_WRONG_INDEX</td> <td>4812</td> <td>请求的指标缓冲区索引错误</td></tr> <tr><td>市场深度</td> <td></td> <td></td></tr> <tr><td>ERR_BOOKS_CANNOT_ADD</td> <td>4901</td> <td>不能添加市场深度</td></tr> <tr><td>ERR_BOOKS_CANNOT_DELETE</td> <td>4902</td> <td>不能移动市场深度</td></tr> <tr><td>ERR_BOOKS_CANNOT_GET</td> <td>4903</td> <td>市场深度数据未获得</td></tr> <tr><td>ERR_BOOKS_CANNOT_SUBSCRIBE</td> <td>4904</td> <td>从市场深度接收新数据时出错</td></tr> <tr><td>文件操作</td> <td></td> <td></td></tr> <tr><td>ERR_TOO_MANY_FILES</td> <td>5001</td> <td>不能同时打开超过64个文件</td></tr> <tr><td>ERR_WRONG_FILENAME</td> <td>5002</td> <td>无效文件名</td></tr> <tr><td>ERR_TOO_LONG_FILENAME</td> <td>5003</td> <td>太长文件名</td></tr> <tr><td>ERR_CANNOT_OPEN_FILE</td> <td>5004</td> <td>文件打开错误</td></tr> <tr><td>ERR_FILE_CACHEBUFFER_ERROR</td> <td>5005</td> <td>读取文件缓冲区没有足够内存</td></tr> <tr><td>ERR_CANNOT_DELETE_FILE</td> <td>5006</td> <td>文件删除错误</td></tr> <tr><td>ERR_INVALID_FILEHANDLE</td> <td>5007</td> <td>文件句柄关闭，或者根本没打开</td></tr> <tr><td>ERR_WRONG_FILEHANDLE</td> <td>5008</td> <td>文件句柄处理错误</td></tr> <tr><td>ERR_FILE_NOTTOWRITE</td> <td>5009</td> <td>文件必须打开后写入</td></tr> <tr><td>ERR_FILE_NOTTOREAD</td> <td>5010</td> <td>文件必须打开后读取</td></tr> <tr><td>ERR_FILE_NOTBIN</td> <td>5011</td> <td>文件必须以二进制打开</td></tr> <tr><td>ERR_FILE_NOTTXT</td> <td>5012</td> <td>文件必须以文本形式打开</td></tr> <tr><td>ERR_FILE_NOTTXTORCSV</td> <td>5013</td> <td>文件必须以文本或者CSV打开</td></tr> <tr><td>ERR_FILE_NOTCSV</td> <td>5014</td> <td>文件必须以CSV格式打开</td></tr> <tr><td>ERR_FILE_READERROR</td> <td>5015</td> <td>文件读取错误</td></tr> <tr><td>ERR_FILE_BINSTRINGSIZE</td> <td>5016</td> <td>字符串大小必须制定，因为文件以二进制打开</td></tr> <tr><td>ERR_INCOMPATIBLE_FILE</td> <td>5017</td> <td>文本文件必须以字符串数组打开，或其他数组-二进制</td></tr> <tr><td>ERR_FILE_IS_DIRECTORY</td> <td>5018</td> <td>没有文件，只有目录</td></tr> <tr><td>ERR_FILE_NOT_EXIST</td> <td>5019</td> <td>文件不存在</td></tr> <tr><td>ERR_FILE_CANNOT_REWRITE</td> <td>5020</td> <td>文件不能覆盖写入</td></tr> <tr><td>ERR_WRONG_DIRECTORYNAME</td> <td>5021</td> <td>错误的目录名称</td></tr> <tr><td>ERR_DIRECTORY_NOT_EXIST</td> <td>5022</td> <td>目录不存在</td></tr> <tr><td>ERR_FILE_ISNOT_DIRECTORY</td> <td>5023</td> <td>只有文件，没有目录</td></tr> <tr><td>ERR_CANNOT_DELETE_DIRECTORY</td> <td>5024</td> <td>目录不能更改</td></tr> <tr><td>ERR_CANNOT_CLEAN_DIRECTORY</td> <td>5025</td> <td>清除目录失败（或许一个或多个文件阻止了清除操作，导致失败）</td></tr> <tr><td>ERR_FILE_WRITEERROR</td> <td>5026</td> <td>将资源写入文件失败</td></tr> <tr><td>ERR_FILE_ENDOFFILE</td> <td>5027</td> <td>已到文件末端，不能阅读CSV文件的下一片数据（FileReadString， FileReadNumber，FileReadDatetime，FileReadBool）</td></tr> <tr><td>字符串转换</td> <td></td> <td></td></tr> <tr><td>ERR_NO_STRING_DATE</td> <td>5030</td> <td>字符串中无日期</td></tr> <tr><td>ERR_WRONG_STRING_DATE</td> <td>5031</td> <td>字符串日期错误</td></tr> <tr><td>ERR_WRONG_STRING_TIME</td> <td>5032</td> <td>字符串时间错误</td></tr> <tr><td>ERR_STRING_TIME_ERROR</td> <td>5033</td> <td>转变字符串到日期错误</td></tr> <tr><td>ERR_STRING_OUT_OF_MEMORY</td> <td>5034</td> <td>没有足够空间建立字符串</td></tr> <tr><td>ERR_STRING_SMALL_LEN</td> <td>5035</td> <td>字符串太短</td></tr> <tr><td>ERR_STRING_TOO_BIGNUMBER</td> <td>5036</td> <td>太大的数，比ULONG_MAX还大</td></tr> <tr><td>ERR_WRONG_FORMATSTRING</td> <td>5037</td> <td>字符串格式无效</td></tr> <tr><td>ERR_TOO_MANY_FORMATTERS</td> <td>5038</td> <td>格式说明符数量比参数多</td></tr> <tr><td>ERR_TOO_MANY_PARAMETERS</td> <td>5039</td> <td>参数多于格式说明符</td></tr> <tr><td>ERR_WRONG_STRING_PARAMETER</td> <td>5040</td> <td>字符串类型参数损坏</td></tr> <tr><td>ERR_STRINGPOS_OUTOFRANGE</td> <td>5041</td> <td>位置在字符串之外</td></tr> <tr><td>ERR_STRING_ZEROADDED</td> <td>5042</td> <td>字符串末尾添加0，无用操作</td></tr> <tr><td>ERR_STRING_UNKNOWNTYPE</td> <td>5043</td> <td>当转换字符串时，数据类型未知</td></tr> <tr><td>ERR_WRONG_STRING_OBJECT</td> <td>5044</td> <td>损坏的字符串对象</td></tr> <tr><td>数组操作</td> <td></td> <td></td></tr> <tr><td>ERR_INCOMPATIBLE_ARRAYS</td> <td>5050</td> <td>复制不兼容数组，字符串数组只能复制成字符串数组，数字数组 ---- 只能复制数字数组</td></tr> <tr><td>ERR_SMALL_ASSERIES_ARRAY</td> <td>5051</td> <td>接收数组被声明为AS_SERIES，它的大小不够。</td></tr> <tr><td>ERR_SMALL_ARRAY</td> <td>5052</td> <td>太小的数组，起始位置在数组的之外</td></tr> <tr><td>ERR_ZEROSIZE_ARRAY</td> <td>5053</td> <td>长度数组为0</td></tr> <tr><td>ERR_NUMBER_ARRAYS_ONLY</td> <td>5054</td> <td>必须是数字数组</td></tr> <tr><td>ERR_ONEDIM_ARRAYS_ONLY</td> <td>5055</td> <td>必须是一维数组</td></tr> <tr><td>ERR_SERIES_ARRAY</td> <td>5056</td> <td>不能使用时间序列</td></tr> <tr><td>ERR_DOUBLE_ARRAY_ONLY</td> <td>5057</td> <td>必须是双精度类型数组</td></tr> <tr><td>ERR_FLOAT_ARRAY_ONLY</td> <td>5058</td> <td>必须是浮点型数组</td></tr> <tr><td>ERR_LONG_ARRAY_ONLY</td> <td>5059</td> <td>必须是长型数组</td></tr> <tr><td>ERR_INT_ARRAY_ONLY</td> <td>5060</td> <td>必须是整型数组</td></tr> <tr><td>ERR_SHORT_ARRAY_ONLY</td> <td>5061</td> <td>必须是短型数组</td></tr> <tr><td>ERR_CHAR_ARRAY_ONLY</td> <td>5062</td> <td>必须是字符型数据</td></tr> <tr><td>ERR_STRING_ARRAY_ONLY</td> <td>5063</td> <td>仅字符串数组</td></tr> <tr><td>OpenCL操作</td> <td></td> <td></td></tr> <tr><td>ERR_OPENCL_NOT_SUPPORTED</td> <td>5100</td> <td>该计算机不支持OpenCL 函数</td></tr> <tr><td>ERR_OPENCL_INTERNAL</td> <td>5101</td> <td>运行 OpenCL 时发生的内部错误</td></tr> <tr><td>ERR_OPENCL_INVALID_HANDLE</td> <td>5102</td> <td>无效的 OpenCL 句柄</td></tr> <tr><td>ERR_OPENCL_CONTEXT_CREATE</td> <td>5103</td> <td>创建 OpenCL 语境 的错误</td></tr> <tr><td>ERR_OPENCL_QUEUE_CREATE</td> <td>5104</td> <td>在OpenCL创建运行队列失败</td></tr> <tr><td>ERR_OPENCL_PROGRAM_CREATE</td> <td>5105</td> <td>编译 OpenCL 程序 时发生的错误</td></tr> <tr><td>ERR_OPENCL_TOO_LONG_KERNEL_NAME</td> <td>5106</td> <td>过长的内核名称 (OpenCL kernel)</td></tr> <tr><td>ERR_OPENCL_KERNEL_CREATE</td> <td>5107</td> <td>创建 OpenCL kernel 错误</td></tr> <tr><td>ERR_OPENCL_SET_KERNEL_PARAMETER</td> <td>5108</td> <td>当为OpenCL kernel设置参数 时发生的错误</td></tr> <tr><td>ERR_OPENCL_EXECUTE</td> <td>5109</td> <td>OpenCL 程序 运行时间错误</td></tr> <tr><td>ERR_OPENCL_WRONG_BUFFER_SIZE</td> <td>5110</td> <td>无效的 OpenCL 缓存大小</td></tr> <tr><td>ERR_OPENCL_WRONG_BUFFER_OFFSET</td> <td>5111</td> <td>无效的 OpenCL 缓存补偿</td></tr> <tr><td>ERR_OPENCL_BUFFER_CREATE</td> <td>5112</td> <td>创建 OpenCL 缓存 失败</td></tr> <tr><td>ERR_OPENCL_TOO_MANY_OBJECTS</td> <td>5113</td> <td>OpenCL 对象过多</td></tr> <tr><td>ERR_OPENCL_SELECTDEVICE</td> <td>5114</td> <td>OpenCL 设备选择错误</td></tr> <tr><td>WebRequest操作</td> <td></td> <td></td></tr> <tr><td>ERR_WEBREQUEST_INVALID_ADDRESS</td> <td>5200</td> <td>无效 URL</td></tr> <tr><td>ERR_WEBREQUEST_CONNECT_FAILED</td> <td>5201</td> <td>连接指定URL失败</td></tr> <tr><td>ERR_WEBREQUEST_TIMEOUT</td> <td>5202</td> <td>超时</td></tr> <tr><td>ERR_WEBREQUEST_REQUEST_FAILED</td> <td>5203</td> <td>HTTP 请求失败</td></tr> <tr><td>自定义交易品种</td> <td></td> <td></td></tr> <tr><td>ERR_NOT_CUSTOM_SYMBOL</td> <td>5300</td> <td>必须指定一个自定义交易品种</td></tr> <tr><td>ERR_CUSTOM_SYMBOL_WRONG_NAME</td> <td>5301</td> <td>自定义交易品种名称无效。交易品种名称只能包含拉丁字母不可含有标点符号，空格或特殊字符（仅可以包含&quot;.&quot;，&quot;_&quot;，&quot;&amp;&quot; 和 &quot;#&quot;符号）。不建议使用下列字符&lt;，&gt;，:，&quot;，/，\，|，?，*。</td></tr> <tr><td>ERR_CUSTOM_SYMBOL_NAME_LONG</td> <td>5302</td> <td>自定义交易品种的名称过长。交易品种名称的总长度不可超过32个字符，包括末位的0字符</td></tr> <tr><td>ERR_CUSTOM_SYMBOL_PATH_LONG</td> <td>5303</td> <td>自定义交易品种的路径过长。路径长度不应超过128个字符，包括&quot;Custom\&quot;，交易品种名称，组分隔符和末位的0字符</td></tr> <tr><td>ERR_CUSTOM_SYMBOL_EXIST</td> <td>5304</td> <td>已存在同名的自定义交易品种</td></tr> <tr><td>ERR_CUSTOM_SYMBOL_ERROR</td> <td>5305</td> <td>创建，删除或更改自定义交易品种时出现错误</td></tr> <tr><td>ERR_CUSTOM_SYMBOL_SELECTED</td> <td>5306</td> <td>您正在试图删除市场报价中选定的自定义交易品种</td></tr> <tr><td>ERR_CUSTOM_SYMBOL_PROPERTY_WRONG</td> <td>5307</td> <td>无效的自定义交易品种属性</td></tr> <tr><td>ERR_CUSTOM_SYMBOL_PARAMETER_ERROR</td> <td>5308</td> <td>设置自定义交易品种属性时的参数错误</td></tr> <tr><td>ERR_CUSTOM_SYMBOL_PARAMETER_LONG</td> <td>5309</td> <td>设置自定义交易品种属性时过长的字符串参数</td></tr> <tr><td>ERR_CUSTOM_TICKS_WRONG_ORDER</td> <td>5310</td> <td>数组中的跳价不是按时间顺序排列的</td></tr> <tr><td>自定义错误</td> <td></td> <td></td></tr> <tr><td>ERR_USER_ERROR_FIRST</td> <td>65536</td> <td>用户自定义 错误起始于该代码</td></tr></tbody></table> <p>相关参考</p> <p>交易服务器返回代码</p> <h2 id="_2-9-输入和输出常量"><a href="#_2-9-输入和输出常量" class="header-anchor">#</a> 2.9 输入和输出常量</h2> <p>常量：</p> <p>•文件打开标帜
•文件属性
•文件内部(指针)位置
•使用字符编码集
•消息盒子(对话框)</p> <h3 id="_2-9-1-文件打开标帜"><a href="#_2-9-1-文件打开标帜" class="header-anchor">#</a> 2.9.1 文件打开标帜</h3> <p>文件打开标帜的 值 指定了文件访问模式。标帜的定义如下:</p> <table><thead><tr><th>标识符</th> <th>值</th> <th>描述</th></tr></thead> <tbody><tr><td>FILE_READ</td> <td>1</td> <td>打开文件用于读取，在 FileOpen() 中使用此标签。 打开文件时，标帜FILE_WRITE 和/或FILE_READ 模式是必需之一</td></tr> <tr><td>FILE_WRITE</td> <td>2</td> <td>打开文件用于写入，在 FileOpen() 中使用此标签。 打开文件时，标帜FILE_WRITE 和/或FILE_READ 模式是必需之一</td></tr> <tr><td>FILE_BIN</td> <td>4</td> <td>二进制 读/书 模式（不需要转换字符串），在 FileOpen() 中使用此标签</td></tr> <tr><td>FILE_CSV</td> <td>8</td> <td>CSV文件（所有元素转换到恰当的字符串类型，Unicode 或者ANSI，并用分隔符分开）在 FileOpen() 中使用此标签</td></tr> <tr><td>FILE_TXT</td> <td>16</td> <td>简单文本文件（与CSV文件相同，但不考虑分隔符），在 FileOpen() 中使用此标签</td></tr> <tr><td>FILE_ANSI</td> <td>32</td> <td>ANSI类型字符串（单字节的字符），在 FileOpen() 中使用此标签</td></tr> <tr><td>FILE_UNICODE</td> <td>64</td> <td>UNICODE类型字符串（双字节的字符），在 FileOpen() 中使用此标签</td></tr> <tr><td>FILE_SHARE_READ</td> <td>128</td> <td>多个程序共享读取，在 FileOpen() 中使用此标签, 但是当打开文件时，此标签不能替代必要的 FILE_WRITE 和/或 FILE_READ 标帜</td></tr> <tr><td>FILE_SHARE_WRITE</td> <td>256</td> <td>多个程序共享写入，在 FileOpen() 中使用此标签, 但是当打开文件时，此标签不能替代必要的 FILE_WRITE 和/或 FILE_READ 标帜</td></tr> <tr><td>FILE_REWRITE</td> <td>512</td> <td>使用 FileCopy() 和 FileMove() 函数可以重新写入文件，文件应该在打开时，用于 写入(FILE_WRITE)，否则不能打开文件。</td></tr> <tr><td>FILE_COMMON</td> <td>4096</td> <td>所有客户端在共用文件夹中的文件路径 \Terminal\Common\Files， 此标签在FileIsExist()，,FileOpen() ， FileCopy() ， FileMove() 函数中使用。</td></tr></tbody></table> <p>打开文件时可以指定一个或多个标帜。这是标帜的组合。标帜的组合使用逻辑 或(|) 的符号，它位于枚举标帜之间。例如，打开CSV格式的文件同时指定 读取 和 写入模式，请指定标帜组合FILE_READ|FILE_WRITE|FILE_CSV</p> <p>示例:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>int filehandle=FileOpen(filename,FILE_READ|FILE_WRITE|FILE_CSV);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>当指定 读取 和 写入 标帜时，有几种特性：
• 如果只指定了FILE_READ，表示尝试打开一个现有的文件。如果文件不存在，文件打开失败，就不会创建新文件。
• FILE_READ|FILE_WRITE —— 如果指定的文件名称不存在，则会创建一个新文件。
• 如果只指定了 FILE_WRITE —— 该文件会被再次创建，其大小为零。</p> <p>打开文件时，需要指定FILE_WRITE 和/或 FILE_READ。
打开文件时定义读取类型的标帜具有优先级。最高优先级的标帜是FILE_CSV，然后是FILE_BIN，而FILE_TXT最低。因此，如果同时指定了多个标帜(FILE_TXT|FILE_CSV或FILE_TXT FILE_BIN或FILE_BIN|FILE_CSV)，那么将使用具有最高优先级的标帜。</p> <p>定义编码类型的标帜也具有优先级。FILE_UNICODE比FILE_ANSI具有更高的优先级。因此，如果指定组合FILE_UNICODE|FILE_ANSI，将会使用标记FILE_UNICODE。</p> <p>如果没有显示FILE_UNICODE或FILE_ANSI，那么就默认隐含了FILE_UNICODE。如果不指定FILE_CSV、FILE_BIN或FILE_TXT，则会默认隐含FILE_CSV。</p> <p>如果一个文件作为文本文件(FILE_TXT或FILE_CSV)打开，并且在文件开头发现了一个特殊的双字节指标 0xff,0xfe，即使在打开时使用了FILE_ANSI编码标帜，该文件的编码也会被指定为FILE_UNICODE。</p> <p>相关参考
文件函数</p> <h3 id="_2-9-2-文件属性"><a href="#_2-9-2-文件属性" class="header-anchor">#</a> 2.9.2 文件属性</h3> <p>FileGetInteger() 函数用于获取文件属性。在调用期间，从ENUM_FILE_PROPERTY_INTEGER 枚举请求所需的属性标识符传递给它。</p> <p>ENUM_FILE_PROPERTY_INTEGER</p> <table><thead><tr><th>ID</th> <th>ID 描述</th></tr></thead> <tbody><tr><td>FILE_EXISTS</td> <td>检查文件是否存在</td></tr> <tr><td>FILE_CREATE_DATE</td> <td>创建日期</td></tr> <tr><td>FILE_MODIFY_DATE</td> <td>最近的更改日期</td></tr> <tr><td>FILE_ACCESS_DATE</td> <td>最后访问文件的日期</td></tr> <tr><td>FILE_SIZE</td> <td>文件的字节大小</td></tr> <tr><td>FILE_POSITION</td> <td>文件指针的位置</td></tr> <tr><td>FILE_END</td> <td>获取文件结束标志</td></tr> <tr><td>FILE_LINE_END</td> <td>获取行结束标志</td></tr> <tr><td>FILE_IS_COMMON</td> <td>该文件在所有终端的共享文件夹中打开(请参考FILE_COMMON)</td></tr> <tr><td>FILE_IS_TEXT</td> <td>文件打开为文本文件 (请参考 FILE_TXT)</td></tr> <tr><td>FILE_IS_BINARY</td> <td>文件打开为二进制文件 (请参考 FILE_BIN)</td></tr> <tr><td>FILE_IS_CSV</td> <td>文件打开为 CSV 文件(请参考 FILE_CSV)</td></tr> <tr><td>FILE_IS_ANSI</td> <td>文件打开为 ANSI 文件(请参考 FILE_ANSI)</td></tr> <tr><td>FILE_IS_READABLE</td> <td>打开文件为可读文件 (请参考 FILE_READ)</td></tr> <tr><td>FILE_IS_WRITABLE</td> <td>打开文件为可写入文件 (请参考 FILE_WRITE)</td></tr></tbody></table> <p>调用FileGetInteger() 函数有两个不同的选项。第一个选项，用于获取文件属性，指定使用FileOpen()函数打开文件时获得的句柄。该选项允许获得文件的全部属性。</p> <p>FileGetInteger() 函数的第二个选项通过文件名称返回文件属性的值。使用该选项，只能获得下面的一般属性：</p> <p>•FILE_EXISTS —— 指定名称的文件存在
•FILE_CREATE_DATE —— 带有指定名称的文件的创建日期
•FILE_MODIFY_DATE —— 带有指定名称的文件的修改日期
•FILE_ACCESS_DATE —— 带有指定名称的文件的最近访问日期
•FILE_SIZE —— 带有指定名称的文件的大小
当尝试获取超出上述指定的其它属性时，FileGetInteger()调用的第二个选项将返回一个错误。</p> <h3 id="_2-9-3-文件内部-指针-位置"><a href="#_2-9-3-文件内部-指针-位置" class="header-anchor">#</a> 2.9.3 文件内部(指针)位置</h3> <p>大多数文件函数都与数据 读/写 操作相关。同时，使用FileSeek()可以指定文件指针在文件内的位置，然后执行下一个 读或写 操作。ENUM_FILE_POSITION枚举包含有效的指针位置，相对于您可以指定下一个操作的字节转换。</p> <p>ENUM_FILE_POSITION</p> <table><thead><tr><th>标识符</th> <th>描述</th></tr></thead> <tbody><tr><td>SEEK_SET</td> <td>文件起点</td></tr> <tr><td>SEEK_CUR</td> <td>文件指针的当前位置</td></tr> <tr><td>SEEK_END</td> <td>文件末尾</td></tr></tbody></table> <p>相关参考</p> <p>文件结束 ， 文件结束行</p> <h3 id="_2-9-4-使用字符编码集"><a href="#_2-9-4-使用字符编码集" class="header-anchor">#</a> 2.9.4 使用字符编码集</h3> <p>(在字符串转换操作时使用的字符编码集)
当转换 字符串 变量到 字符型数组 中时，MQL5使用的字符编码集对应的是当前Windows操作系统默认的ANSI (CP_ACP)。如果指定不同类型的字符编码集，可以将它设置为CharArrayToString()、StringToCharArray()和FileOpen()函数的附加参数。</p> <p>下表列出了一些最流行的编码集的内置常量。没有提到的字符编码集可以通过相对应的代码来指定。</p> <p>内置字符编码集常量</p> <table><thead><tr><th>常量</th> <th>值</th> <th>描述</th></tr></thead> <tbody><tr><td>CP_ACP</td> <td>0</td> <td>当前Windows操作系统ANSI字符编码集</td></tr> <tr><td>CP_OEMCP</td> <td>1</td> <td>当前系统OEM字符编码集</td></tr> <tr><td>CP_MACCP</td> <td>2</td> <td>当前Macintosh系统的字符编码集。 注释：这个值主要在早期创建的程序代码中使用，现在没用了，新的Macintosh电脑使用Unicode编码集。</td></tr> <tr><td>CP_THREAD_ACP</td> <td>3</td> <td>当前线程的Windows ANSI字符编码集</td></tr> <tr><td>CP_SYMBOL</td> <td>42</td> <td>符号字符编码集</td></tr> <tr><td>CP_UTF7</td> <td>65000</td> <td>UTF-7字符编码集</td></tr> <tr><td>CP_UTF8</td> <td>65001</td> <td>UTF-8字符编码集</td></tr></tbody></table> <p>相关参考</p> <p>客户端属性</p> <h3 id="_2-9-5-对话框常量"><a href="#_2-9-5-对话框常量" class="header-anchor">#</a> 2.9.5 对话框常量</h3> <p>此部分包含MessageBox()函数的返回代码。如果消息窗口有一个 取消 按钮，则该函数将返回IDCANCEL，表示 ESC键 或 取消按钮被按下。如果消息窗口中没有 取消 按钮，按ESC也不会产生任何效果。</p> <table><thead><tr><th>常量</th> <th>值</th> <th>描述</th></tr></thead> <tbody><tr><td>IDOK</td> <td>1</td> <td>按“确认”键</td></tr> <tr><td>IDCANCEL</td> <td>2</td> <td>按“取消”键</td></tr> <tr><td>IDABORT</td> <td>3</td> <td>按“停止”键</td></tr> <tr><td>IDRETRY</td> <td>4</td> <td>按“重试”键</td></tr> <tr><td>IDIGNORE</td> <td>5</td> <td>按“忽略”键</td></tr> <tr><td>IDYES</td> <td>6</td> <td>按“是”键</td></tr> <tr><td>IDNO</td> <td>7</td> <td>按“否”键</td></tr> <tr><td>IDTRYAGAIN</td> <td>10</td> <td>按“再试一次”键</td></tr> <tr><td>IDCONTINUE</td> <td>11</td> <td>按“继续”键</td></tr></tbody></table> <p>MessageBox()函数的主标帜定义了对话框窗口的内容和行为。这个值可以是下列标帜的组合:</p> <table><thead><tr><th>常量</th> <th>值</th> <th>描述</th></tr></thead> <tbody><tr><td>MB_OK</td> <td>0x00000000</td> <td>对话框只包括一个按钮：确定OK 默认</td></tr> <tr><td>MB_OKCANCEL</td> <td>0x00000001</td> <td>对话框包括两个按钮：确定OK和 取消 Cancel</td></tr> <tr><td>MB_ABORTRETRYIGNORE</td> <td>0x00000002</td> <td>对话框包括三个按钮：停止Abort,重试Retry 和 忽略Ignore</td></tr> <tr><td>MB_YESNOCANCEL</td> <td>0x00000003</td> <td>对话框包括三个按钮：是Yes, 否No 和 取消 Cancel</td></tr> <tr><td>MB_YESNO</td> <td>0x00000004</td> <td>对话框包括两个按钮：是Yes 和 否No</td></tr> <tr><td>MB_RETRYCANCEL</td> <td>0x00000005</td> <td>对话框包括两个按钮：重试Retry 和 取消Cancel</td></tr> <tr><td>MB_CANCELTRYCONTINUE</td> <td>0x00000006</td> <td>对话框包括三个按钮：取消Cancel, 再试一次Try Again, 继续 Continue</td></tr></tbody></table> <p>在消息对话框窗口中显示图标icon，必需指定额外的符加标签：</p> <table><thead><tr><th>常量</th> <th>值</th> <th>描述</th></tr></thead> <tbody><tr><td>MB_ICONSTOP, MB_ICONERROR, MB_ICONHAND</td> <td>0x00000010</td> <td>STOP停止标志图标</td></tr> <tr><td>MB_ICONQUESTION</td> <td>0x00000020</td> <td>疑问标志图标</td></tr> <tr><td>MB_ICONEXCLAMATION, MB_ICONWARNING</td> <td>0x00000030</td> <td>惊叹/警示 标志图标</td></tr> <tr><td>MB_ICONINFORMATION, MB_ICONASTERISK</td> <td>0x00000040</td> <td>包围标志图标</td></tr></tbody></table> <p>如下标签定义默认按钮：</p> <table><thead><tr><th>常量</th> <th>值</th> <th>描述</th></tr></thead> <tbody><tr><td>MB_DEFBUTTON1</td> <td>0x00000000</td> <td>第一个按钮MB_DEFBUTTON1 -是默认的，如果没有指定其他按钮MB_DEFBUTTON2、 MB_DEFBUTTON3或 MB_DEFBUTTON4。</td></tr> <tr><td>MB_DEFBUTTON2</td> <td>0x00000100</td> <td>默认第二按钮</td></tr> <tr><td>MB_DEFBUTTON3</td> <td>0x00000200</td> <td>默认第三按钮</td></tr> <tr><td>MB_DEFBUTTON4</td> <td>0x00000300</td> <td>默认第四按钮</td></tr></tbody></table></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/mql5yao/Chapter/one.html" class="prev">
        01 第一章 语言基础
      </a></span> <span class="next"><a href="/mql5yao/Chapter/three.html">
        03 第三章 MQL5程序
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/mql5yao/assets/js/app.f23448f4.js" defer></script><script src="/mql5yao/assets/js/3.a8269cb7.js" defer></script><script src="/mql5yao/assets/js/2.45a03fa6.js" defer></script>
  </body>
</html>
